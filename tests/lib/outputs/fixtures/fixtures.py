from datetime import datetime

from prowler.config.config import prowler_version
from prowler.lib.outputs.finding import Finding
from tests.providers.aws.utils import AWS_ACCOUNT_NUMBER, AWS_REGION_EU_WEST_1


def generate_finding_output(
    status: str = "PASS",
    status_extended: str = "",
    severity: str = "high",
    muted: bool = False,
    account_uid: str = AWS_ACCOUNT_NUMBER,
    account_name: str = AWS_ACCOUNT_NUMBER,
    region: str = AWS_REGION_EU_WEST_1,
    resource_details: str = "",
    resource_uid: str = "",
    resource_name: str = "",
    resource_tags: str = "",
    compliance: dict = {"test-compliance": "test-compliance"},
    timestamp: datetime = datetime.now(),
    provider: str = "aws",
) -> Finding:
    return Finding(
        auth_method="profile: default",
        timestamp=timestamp,
        account_uid=account_uid,
        account_name=account_name,
        account_email="",
        account_organization_uid="test-organization-id",
        account_organization_name="test-organization",
        account_tags=["test-tag:test-value"],
        finding_uid="test-unique-finding",
        provider=provider,
        check_id="test-check-id",
        check_title="test-check-id",
        check_type="test-type",
        status=status,
        status_extended=status_extended,
        muted=muted,
        service_name="test-service",
        subservice_name="",
        severity=severity,
        resource_type="test-resource",
        resource_uid=resource_uid,
        resource_name=resource_name,
        resource_details=resource_details,
        resource_tags=resource_tags,
        partition=provider,
        region=region,
        description="check description",
        risk="test-risk",
        related_url="test-url",
        remediation_recommendation_text="",
        remediation_recommendation_url="",
        remediation_code_nativeiac="",
        remediation_code_terraform="",
        remediation_code_cli="",
        remediation_code_other="",
        compliance=compliance,
        categories="test-category",
        depends_on="test-dependency",
        related_to="test-related-to",
        notes="test-notes",
        prowler_version=prowler_version,
    )
