{
  "Framework": "HIPAA",
  "Name": "HIPAA compliance framework for Azure",
  "Version": "",
  "Provider": "Azure",
  "Description": "The Health Insurance Portability and Accountability Act of 1996 (HIPAA) is legislation that helps US workers to retain health insurance coverage when they change or lose jobs. The legislation also seeks to encourage electronic health records to improve the efficiency and quality of the US healthcare system through improved information sharing. This framework maps HIPAA requirements to Microsoft Azure security best practices.",
  "Requirements": [
    {
      "Id": "164_308_a_1_ii_a",
      "Name": "164.308(a)(1)(ii)(A) Risk analysis",
      "Description": "Conduct an accurate and thorough assessment of the potential risks and vulnerabilities to the confidentiality, integrity, and availability of electronic protected health information held by the covered entity or business associate.",
      "Attributes": [
        {
          "ItemId": "164_308_a_1_ii_a",
          "Section": "164.308 Administrative Safeguards",
          "Service": "azure"
        }
      ],
      "Checks": [
        "defender_ensure_defender_for_server_is_on",
        "defender_ensure_defender_for_app_services_is_on",
        "defender_ensure_defender_for_sql_servers_is_on",
        "defender_ensure_defender_for_storage_is_on",
        "defender_ensure_defender_for_keyvault_is_on",
        "defender_ensure_defender_for_arm_is_on",
        "defender_ensure_defender_for_dns_is_on",
        "defender_ensure_defender_for_containers_is_on",
        "defender_ensure_defender_for_cosmosdb_is_on",
        "defender_ensure_mcas_is_enabled",
        "policy_ensure_asc_enforcement_enabled"
      ]
    },
    {
      "Id": "164_308_a_1_ii_b",
      "Name": "164.308(a)(1)(ii)(B) Risk Management",
      "Description": "Implement security measures sufficient to reduce risks and vulnerabilities to a reasonable and appropriate level to comply with 164.306(a): Ensure the confidentiality, integrity, and availability of all electronic protected health information the covered entity or business associate creates, receives, maintains, or transmits.",
      "Attributes": [
        {
          "ItemId": "164_308_a_1_ii_b",
          "Section": "164.308 Administrative Safeguards",
          "Service": "azure"
        }
      ],
      "Checks": [
        "storage_ensure_encryption_with_customer_managed_keys",
        "storage_infrastructure_encryption_is_enabled",
        "storage_blob_public_access_level_is_disabled",
        "storage_default_network_access_rule_is_denied",
        "storage_ensure_private_endpoints_in_storage_accounts",
        "sqlserver_tde_encryption_enabled",
        "sqlserver_tde_encrypted_with_cmk",
        "sqlserver_unrestricted_inbound_access",
        "keyvault_key_rotation_enabled",
        "keyvault_rbac_enabled",
        "keyvault_private_endpoints",
        "vm_ensure_attached_disks_encrypted_with_cmk",
        "vm_ensure_unattached_disks_encrypted_with_cmk",
        "network_ssh_internet_access_restricted",
        "network_rdp_internet_access_restricted",
        "network_http_internet_access_restricted",
        "network_udp_internet_access_restricted",
        "iam_subscription_roles_owner_custom_not_created",
        "iam_custom_role_has_permissions_to_administer_resource_locks",
        "cosmosdb_account_firewall_use_selected_networks",
        "cosmosdb_account_use_private_endpoints",
        "aks_clusters_public_access_disabled",
        "aks_clusters_created_with_private_nodes"
      ]
    },
    {
      "Id": "164_308_a_1_ii_d",
      "Name": "164.308(a)(1)(ii)(D) Information system activity review",
      "Description": "Implement procedures to regularly review records of information system activity, such as audit logs, access reports, and security incident tracking reports.",
      "Attributes": [
        {
          "ItemId": "164_308_a_1_ii_d",
          "Section": "164.308 Administrative Safeguards",
          "Service": "azure"
        }
      ],
      "Checks": [
        "monitor_diagnostic_setting_with_appropriate_categories",
        "monitor_diagnostic_settings_exists",
        "monitor_alert_create_policy_assignment",
        "monitor_alert_delete_policy_assignment",
        "monitor_alert_create_update_nsg",
        "monitor_alert_delete_nsg",
        "monitor_alert_create_update_security_solution",
        "monitor_alert_delete_security_solution",
        "sqlserver_auditing_enabled",
        "sqlserver_auditing_retention_90_days",
        "keyvault_logging_enabled",
        "network_watcher_enabled",
        "network_flow_log_captured_sent",
        "network_flow_log_more_than_90_days",
        "app_http_logs_enabled",
        "appinsights_ensure_is_configured"
      ]
    },
    {
      "Id": "164_308_a_3_i",
      "Name": "164.308(a)(3)(i) Workforce security",
      "Description": "Implement policies and procedures to ensure that all members of its workforce have appropriate access to electronic protected health information, as provided under paragraph (a)(4) of this section, and to prevent those workforce members who do not have access under paragraph (a)(4) of this section from obtaining access to electronic protected health information.",
      "Attributes": [
        {
          "ItemId": "164_308_a_3_i",
          "Section": "164.308 Administrative Safeguards",
          "Service": "azure"
        }
      ],
      "Checks": [
        "storage_blob_public_access_level_is_disabled",
        "storage_default_network_access_rule_is_denied",
        "sqlserver_unrestricted_inbound_access",
        "network_ssh_internet_access_restricted",
        "network_rdp_internet_access_restricted",
        "network_http_internet_access_restricted",
        "iam_subscription_roles_owner_custom_not_created",
        "iam_role_user_access_admin_restricted",
        "containerregistry_not_publicly_accessible",
        "app_function_not_publicly_accessible",
        "aisearch_service_not_publicly_accessible",
        "cosmosdb_account_firewall_use_selected_networks"
      ]
    },
    {
      "Id": "164_308_a_3_ii_a",
      "Name": "164.308(a)(3)(ii)(A) Authorization and/or supervision",
      "Description": "Implement procedures for the authorization and/or supervision of workforce members who work with electronic protected health information or in locations where it might be accessed.",
      "Attributes": [
        {
          "ItemId": "164_308_a_3_ii_a",
          "Section": "164.308 Administrative Safeguards",
          "Service": "azure"
        }
      ],
      "Checks": [
        "monitor_diagnostic_setting_with_appropriate_categories",
        "monitor_diagnostic_settings_exists",
        "sqlserver_auditing_enabled",
        "keyvault_logging_enabled",
        "entra_privileged_user_has_mfa",
        "entra_non_privileged_user_has_mfa",
        "entra_security_defaults_enabled",
        "entra_conditional_access_policy_require_mfa_for_management_api",
        "entra_user_with_vm_access_has_mfa",
        "network_flow_log_captured_sent",
        "app_http_logs_enabled"
      ]
    },
    {
      "Id": "164_308_a_3_ii_b",
      "Name": "164.308(a)(3)(ii)(B) Workforce clearance procedure",
      "Description": "Implement procedures to determine that the access of a workforce member to electronic protected health information is appropriate.",
      "Attributes": [
        {
          "ItemId": "164_308_a_3_ii_b",
          "Section": "164.308 Administrative Safeguards",
          "Service": "entra"
        }
      ],
      "Checks": [
        "iam_subscription_roles_owner_custom_not_created",
        "iam_role_user_access_admin_restricted",
        "iam_custom_role_has_permissions_to_administer_resource_locks",
        "entra_global_admin_in_less_than_five_users",
        "entra_policy_default_users_cannot_create_security_groups",
        "entra_policy_ensure_default_user_cannot_create_apps",
        "entra_policy_guest_invite_only_for_admin_roles",
        "entra_policy_guest_users_access_restrictions"
      ]
    },
    {
      "Id": "164_308_a_3_ii_c",
      "Name": "164.308(a)(3)(ii)(C) Termination procedures",
      "Description": "Implement procedures for terminating access to electronic protected health information when the employment of, or other arrangement with, a workforce member ends or as required by determinations made as specified in paragraph (a)(3)(ii)(b).",
      "Attributes": [
        {
          "ItemId": "164_308_a_3_ii_c",
          "Section": "164.308 Administrative Safeguards",
          "Service": "azure"
        }
      ],
      "Checks": [
        "storage_key_rotation_90_days",
        "keyvault_key_rotation_enabled",
        "keyvault_rbac_key_expiration_set",
        "keyvault_rbac_secret_expiration_set",
        "keyvault_key_expiration_set_in_non_rbac",
        "keyvault_non_rbac_secret_expiration_set"
      ]
    },
    {
      "Id": "164_308_a_4_i",
      "Name": "164.308(a)(4)(i) Information access management",
      "Description": "Implement policies and procedures for authorizing access to electronic protected health information that are consistent with the applicable requirements of subpart E of this part.",
      "Attributes": [
        {
          "ItemId": "164_308_a_4_i",
          "Section": "164.308 Administrative Safeguards",
          "Service": "azure"
        }
      ],
      "Checks": [
        "iam_subscription_roles_owner_custom_not_created",
        "iam_role_user_access_admin_restricted",
        "iam_custom_role_has_permissions_to_administer_resource_locks",
        "keyvault_rbac_enabled",
        "entra_global_admin_in_less_than_five_users",
        "entra_policy_restricts_user_consent_for_apps",
        "entra_policy_user_consent_for_verified_apps"
      ]
    },
    {
      "Id": "164_308_a_4_ii_a",
      "Name": "164.308(a)(4)(ii)(A) Isolating health care clearinghouse functions",
      "Description": "If a health care clearinghouse is part of a larger organization, the clearinghouse must implement policies and procedures that protect the electronic protected health information of the clearinghouse from unauthorized access by the larger organization.",
      "Attributes": [
        {
          "ItemId": "164_308_a_4_ii_a",
          "Section": "164.308 Administrative Safeguards",
          "Service": "azure"
        }
      ],
      "Checks": [
        "storage_ensure_encryption_with_customer_managed_keys",
        "storage_infrastructure_encryption_is_enabled",
        "storage_ensure_private_endpoints_in_storage_accounts",
        "storage_default_network_access_rule_is_denied",
        "sqlserver_tde_encryption_enabled",
        "sqlserver_tde_encrypted_with_cmk",
        "sqlserver_auditing_enabled",
        "keyvault_key_rotation_enabled",
        "keyvault_logging_enabled",
        "keyvault_private_endpoints",
        "vm_ensure_attached_disks_encrypted_with_cmk",
        "vm_backup_enabled",
        "cosmosdb_account_use_private_endpoints",
        "databricks_workspace_cmk_encryption_enabled",
        "databricks_workspace_vnet_injection_enabled"
      ]
    },
    {
      "Id": "164_308_a_4_ii_b",
      "Name": "164.308(a)(4)(ii)(B) Access authorization",
      "Description": "Implement policies and procedures for granting access to electronic protected health information, as one illustrative example, through access to a workstation, transaction, program, process, or other mechanism.",
      "Attributes": [
        {
          "ItemId": "164_308_a_4_ii_b",
          "Section": "164.308 Administrative Safeguards",
          "Service": "azure"
        }
      ],
      "Checks": [
        "iam_subscription_roles_owner_custom_not_created",
        "iam_role_user_access_admin_restricted",
        "iam_custom_role_has_permissions_to_administer_resource_locks",
        "keyvault_rbac_enabled",
        "aks_cluster_rbac_enabled",
        "cosmosdb_account_use_aad_and_rbac",
        "sqlserver_azuread_administrator_enabled",
        "entra_global_admin_in_less_than_five_users"
      ]
    },
    {
      "Id": "164_308_a_4_ii_c",
      "Name": "164.308(a)(4)(ii)(C) Access establishment and modification",
      "Description": "Implement policies and procedures that, based upon the covered entity's or the business associate's access authorization policies, establish, document, review, and modify a user's right of access to a workstation, transaction, program, or process.",
      "Attributes": [
        {
          "ItemId": "164_308_a_4_ii_c",
          "Section": "164.308 Administrative Safeguards",
          "Service": "azure"
        }
      ],
      "Checks": [
        "iam_subscription_roles_owner_custom_not_created",
        "iam_role_user_access_admin_restricted",
        "storage_key_rotation_90_days",
        "keyvault_key_rotation_enabled",
        "keyvault_rbac_key_expiration_set",
        "keyvault_rbac_secret_expiration_set",
        "entra_global_admin_in_less_than_five_users",
        "entra_policy_default_users_cannot_create_security_groups",
        "entra_policy_ensure_default_user_cannot_create_apps"
      ]
    },
    {
      "Id": "164_308_a_5_ii_b",
      "Name": "164.308(a)(5)(ii)(B) Protection from malicious software",
      "Description": "Procedures for guarding against, detecting, and reporting malicious software.",
      "Attributes": [
        {
          "ItemId": "164_308_a_5_ii_b",
          "Section": "164.308 Administrative Safeguards",
          "Service": "azure"
        }
      ],
      "Checks": [
        "defender_ensure_defender_for_server_is_on",
        "defender_ensure_wdatp_is_enabled",
        "defender_assessments_vm_endpoint_protection_installed",
        "defender_ensure_system_updates_are_applied",
        "defender_container_images_scan_enabled",
        "defender_container_images_resolved_vulnerabilities"
      ]
    },
    {
      "Id": "164_308_a_5_ii_c",
      "Name": "164.308(a)(5)(ii)(C) Log-in monitoring",
      "Description": "Procedures for monitoring log-in attempts and reporting discrepancies.",
      "Attributes": [
        {
          "ItemId": "164_308_a_5_ii_c",
          "Section": "164.308 Administrative Safeguards",
          "Service": "azure"
        }
      ],
      "Checks": [
        "defender_ensure_defender_for_server_is_on",
        "defender_ensure_mcas_is_enabled",
        "monitor_diagnostic_setting_with_appropriate_categories",
        "entra_security_defaults_enabled",
        "sqlserver_auditing_enabled",
        "keyvault_logging_enabled"
      ]
    },
    {
      "Id": "164_308_a_5_ii_d",
      "Name": "164.308(a)(5)(ii)(D) Password management",
      "Description": "Procedures for creating, changing, and safeguarding passwords.",
      "Attributes": [
        {
          "ItemId": "164_308_a_5_ii_d",
          "Section": "164.308 Administrative Safeguards",
          "Service": "entra"
        }
      ],
      "Checks": [
        "entra_security_defaults_enabled",
        "entra_privileged_user_has_mfa",
        "entra_non_privileged_user_has_mfa",
        "storage_key_rotation_90_days",
        "keyvault_key_rotation_enabled",
        "keyvault_rbac_key_expiration_set",
        "keyvault_rbac_secret_expiration_set"
      ]
    },
    {
      "Id": "164_308_a_6_i",
      "Name": "164.308(a)(6)(i) Security incident procedures",
      "Description": "Implement policies and procedures to address security incidents.",
      "Attributes": [
        {
          "ItemId": "164_308_a_6_i",
          "Section": "164.308 Administrative Safeguards",
          "Service": "azure"
        }
      ],
      "Checks": [
        "monitor_alert_create_update_nsg",
        "monitor_alert_delete_nsg",
        "monitor_alert_create_update_security_solution",
        "monitor_alert_delete_security_solution",
        "monitor_alert_service_health_exists",
        "defender_ensure_defender_for_server_is_on",
        "defender_ensure_notify_alerts_severity_is_high",
        "defender_ensure_notify_emails_to_owners",
        "defender_additional_email_configured_with_a_security_contact",
        "defender_attack_path_notifications_properly_configured"
      ]
    },
    {
      "Id": "164_308_a_6_ii",
      "Name": "164.308(a)(6)(ii) Response and reporting",
      "Description": "Identify and respond to suspected or known security incidents; mitigate, to the extent practicable, harmful effects of security incidents that are known to the covered entity or business associate; and document security incidents and their outcomes.",
      "Attributes": [
        {
          "ItemId": "164_308_a_6_ii",
          "Section": "164.308 Administrative Safeguards",
          "Service": "azure"
        }
      ],
      "Checks": [
        "monitor_diagnostic_setting_with_appropriate_categories",
        "monitor_diagnostic_settings_exists",
        "monitor_alert_create_update_nsg",
        "monitor_alert_delete_nsg",
        "defender_ensure_defender_for_server_is_on",
        "defender_ensure_notify_alerts_severity_is_high",
        "defender_ensure_notify_emails_to_owners",
        "defender_additional_email_configured_with_a_security_contact",
        "sqlserver_auditing_enabled",
        "keyvault_logging_enabled",
        "network_flow_log_captured_sent",
        "app_http_logs_enabled"
      ]
    },
    {
      "Id": "164_308_a_7_i",
      "Name": "164.308(a)(7)(i) Contingency plan",
      "Description": "Establish (and implement as needed) policies and procedures for responding to an emergency or other occurrence (for example, fire, vandalism, system failure, and natural disaster) that damages systems that contain electronic protected health information.",
      "Attributes": [
        {
          "ItemId": "164_308_a_7_i",
          "Section": "164.308 Administrative Safeguards",
          "Service": "azure"
        }
      ],
      "Checks": [
        "vm_backup_enabled",
        "vm_sufficient_daily_backup_retention_period",
        "storage_blob_versioning_is_enabled",
        "storage_ensure_soft_delete_is_enabled",
        "storage_ensure_file_shares_soft_delete_is_enabled",
        "storage_geo_redundant_enabled",
        "keyvault_recoverable",
        "sqlserver_auditing_retention_90_days"
      ]
    },
    {
      "Id": "164_308_a_7_ii_a",
      "Name": "164.308(a)(7)(ii)(A) Data backup plan",
      "Description": "Establish and implement procedures to create and maintain retrievable exact copies of electronic protected health information.",
      "Attributes": [
        {
          "ItemId": "164_308_a_7_ii_a",
          "Section": "164.308 Administrative Safeguards",
          "Service": "azure"
        }
      ],
      "Checks": [
        "vm_backup_enabled",
        "vm_sufficient_daily_backup_retention_period",
        "storage_blob_versioning_is_enabled",
        "storage_ensure_soft_delete_is_enabled",
        "storage_ensure_file_shares_soft_delete_is_enabled",
        "storage_geo_redundant_enabled",
        "keyvault_recoverable",
        "sqlserver_auditing_retention_90_days",
        "postgresql_flexible_server_log_retention_days_greater_3"
      ]
    },
    {
      "Id": "164_308_a_7_ii_b",
      "Name": "164.308(a)(7)(ii)(B) Disaster recovery plan",
      "Description": "Establish (and implement as needed) procedures to restore any loss of data.",
      "Attributes": [
        {
          "ItemId": "164_308_a_7_ii_b",
          "Section": "164.308 Administrative Safeguards",
          "Service": "azure"
        }
      ],
      "Checks": [
        "vm_backup_enabled",
        "vm_sufficient_daily_backup_retention_period",
        "storage_blob_versioning_is_enabled",
        "storage_ensure_soft_delete_is_enabled",
        "storage_geo_redundant_enabled",
        "keyvault_recoverable"
      ]
    },
    {
      "Id": "164_308_a_7_ii_c",
      "Name": "164.308(a)(7)(ii)(C) Emergency mode operation plan",
      "Description": "Establish (and implement as needed) procedures to enable continuation of critical business processes for protection of the security of electronic protected health information while operating in emergency mode.",
      "Attributes": [
        {
          "ItemId": "164_308_a_7_ii_c",
          "Section": "164.308 Administrative Safeguards",
          "Service": "azure"
        }
      ],
      "Checks": [
        "vm_backup_enabled",
        "vm_sufficient_daily_backup_retention_period",
        "storage_blob_versioning_is_enabled",
        "storage_ensure_soft_delete_is_enabled",
        "storage_geo_redundant_enabled",
        "keyvault_recoverable"
      ]
    },
    {
      "Id": "164_308_a_8",
      "Name": "164.308(a)(8) Evaluation",
      "Description": "Perform a periodic technical and nontechnical evaluation, based initially upon the standards implemented under this rule and subsequently, in response to environmental or operational changes affecting the security of electronic protected health information, that establishes the extent to which an entity's security policies and procedures meet the requirements of this subpart.",
      "Attributes": [
        {
          "ItemId": "164_308_a_8",
          "Section": "164.308 Administrative Safeguards",
          "Service": "azure"
        }
      ],
      "Checks": [
        "defender_ensure_defender_for_server_is_on",
        "defender_ensure_mcas_is_enabled",
        "sqlserver_vulnerability_assessment_enabled",
        "sqlserver_va_periodic_recurring_scans_enabled",
        "sqlserver_va_scan_reports_configured",
        "sqlserver_va_emails_notifications_admins_enabled",
        "policy_ensure_asc_enforcement_enabled"
      ]
    },
    {
      "Id": "164_310_a_1",
      "Name": "164.310(a)(1) Facility access controls",
      "Description": "Implement policies and procedures to limit physical access to its electronic information systems and the facility or facilities in which they are housed, while ensuring that properly authorized access is allowed.",
      "Attributes": [
        {
          "ItemId": "164_310_a_1",
          "Section": "164.310 Physical Safeguards",
          "Service": "azure"
        }
      ],
      "Checks": [
        "network_ssh_internet_access_restricted",
        "network_rdp_internet_access_restricted",
        "network_http_internet_access_restricted",
        "network_bastion_host_exists",
        "vm_jit_access_enabled",
        "aks_clusters_public_access_disabled",
        "aks_clusters_created_with_private_nodes"
      ]
    },
    {
      "Id": "164_310_d_1",
      "Name": "164.310(d)(1) Device and media controls",
      "Description": "Implement policies and procedures that govern the receipt and removal of hardware and electronic media that contain electronic protected health information into and out of a facility, and the movement of these items within the facility.",
      "Attributes": [
        {
          "ItemId": "164_310_d_1",
          "Section": "164.310 Physical Safeguards",
          "Service": "azure"
        }
      ],
      "Checks": [
        "storage_ensure_encryption_with_customer_managed_keys",
        "storage_infrastructure_encryption_is_enabled",
        "vm_ensure_attached_disks_encrypted_with_cmk",
        "vm_ensure_unattached_disks_encrypted_with_cmk",
        "vm_ensure_using_managed_disks",
        "sqlserver_tde_encryption_enabled",
        "databricks_workspace_cmk_encryption_enabled"
      ]
    },
    {
      "Id": "164_312_a_1",
      "Name": "164.312(a)(1) Access control",
      "Description": "Implement technical policies and procedures for electronic information systems that maintain electronic protected health information to allow access only to those persons or software programs that have been granted access rights as specified in 164.308(a)(4).",
      "Attributes": [
        {
          "ItemId": "164_312_a_1",
          "Section": "164.312 Technical Safeguards",
          "Service": "azure"
        }
      ],
      "Checks": [
        "storage_blob_public_access_level_is_disabled",
        "storage_default_network_access_rule_is_denied",
        "storage_ensure_private_endpoints_in_storage_accounts",
        "sqlserver_unrestricted_inbound_access",
        "network_ssh_internet_access_restricted",
        "network_rdp_internet_access_restricted",
        "network_http_internet_access_restricted",
        "iam_subscription_roles_owner_custom_not_created",
        "iam_role_user_access_admin_restricted",
        "entra_privileged_user_has_mfa",
        "containerregistry_not_publicly_accessible",
        "app_function_not_publicly_accessible",
        "aisearch_service_not_publicly_accessible",
        "cosmosdb_account_firewall_use_selected_networks",
        "cosmosdb_account_use_private_endpoints",
        "aks_clusters_public_access_disabled"
      ]
    },
    {
      "Id": "164_312_a_2_i",
      "Name": "164.312(a)(2)(i) Unique user identification",
      "Description": "Assign a unique name and/or number for identifying and tracking user identity.",
      "Attributes": [
        {
          "ItemId": "164_312_a_2_i",
          "Section": "164.312 Technical Safeguards",
          "Service": "azure"
        }
      ],
      "Checks": [
        "sqlserver_auditing_enabled",
        "sqlserver_azuread_administrator_enabled",
        "entra_security_defaults_enabled",
        "storage_default_to_entra_authorization_enabled",
        "cosmosdb_account_use_aad_and_rbac",
        "postgresql_flexible_server_entra_id_authentication_enabled"
      ]
    },
    {
      "Id": "164_312_a_2_ii",
      "Name": "164.312(a)(2)(ii) Emergency access procedure",
      "Description": "Establish (and implement as needed) procedures for obtaining necessary electronic protected health information during an emergency.",
      "Attributes": [
        {
          "ItemId": "164_312_a_2_ii",
          "Section": "164.312 Technical Safeguards",
          "Service": "azure"
        }
      ],
      "Checks": [
        "vm_backup_enabled",
        "vm_sufficient_daily_backup_retention_period",
        "storage_blob_versioning_is_enabled",
        "storage_ensure_soft_delete_is_enabled",
        "storage_geo_redundant_enabled",
        "keyvault_recoverable"
      ]
    },
    {
      "Id": "164_312_a_2_iv",
      "Name": "164.312(a)(2)(iv) Encryption and decryption",
      "Description": "Implement a mechanism to encrypt and decrypt electronic protected health information.",
      "Attributes": [
        {
          "ItemId": "164_312_a_2_iv",
          "Section": "164.312 Technical Safeguards",
          "Service": "azure"
        }
      ],
      "Checks": [
        "storage_ensure_encryption_with_customer_managed_keys",
        "storage_infrastructure_encryption_is_enabled",
        "storage_secure_transfer_required_is_enabled",
        "sqlserver_tde_encryption_enabled",
        "sqlserver_tde_encrypted_with_cmk",
        "keyvault_key_rotation_enabled",
        "vm_ensure_attached_disks_encrypted_with_cmk",
        "vm_ensure_unattached_disks_encrypted_with_cmk",
        "databricks_workspace_cmk_encryption_enabled",
        "monitor_storage_account_with_activity_logs_cmk_encrypted"
      ]
    },
    {
      "Id": "164_312_b",
      "Name": "164.312(b) Audit controls",
      "Description": "Implement hardware, software, and/or procedural mechanisms that record and examine activity in information systems that contain or use electronic protected health information.",
      "Attributes": [
        {
          "ItemId": "164_312_b",
          "Section": "164.312 Technical Safeguards",
          "Service": "azure"
        }
      ],
      "Checks": [
        "monitor_diagnostic_setting_with_appropriate_categories",
        "monitor_diagnostic_settings_exists",
        "monitor_alert_create_policy_assignment",
        "monitor_alert_delete_policy_assignment",
        "monitor_alert_create_update_nsg",
        "monitor_alert_delete_nsg",
        "monitor_alert_create_update_sqlserver_fr",
        "monitor_alert_delete_sqlserver_fr",
        "sqlserver_auditing_enabled",
        "sqlserver_auditing_retention_90_days",
        "keyvault_logging_enabled",
        "network_watcher_enabled",
        "network_flow_log_captured_sent",
        "network_flow_log_more_than_90_days",
        "app_http_logs_enabled",
        "appinsights_ensure_is_configured",
        "postgresql_flexible_server_log_checkpoints_on",
        "postgresql_flexible_server_log_connections_on",
        "postgresql_flexible_server_log_disconnections_on",
        "mysql_flexible_server_audit_log_enabled",
        "mysql_flexible_server_audit_log_connection_activated"
      ]
    },
    {
      "Id": "164_312_c_1",
      "Name": "164.312(c)(1) Integrity",
      "Description": "Implement policies and procedures to protect electronic protected health information from improper alteration or destruction.",
      "Attributes": [
        {
          "ItemId": "164_312_c_1",
          "Section": "164.312 Technical Safeguards",
          "Service": "azure"
        }
      ],
      "Checks": [
        "storage_ensure_encryption_with_customer_managed_keys",
        "storage_blob_versioning_is_enabled",
        "storage_secure_transfer_required_is_enabled",
        "keyvault_key_rotation_enabled",
        "keyvault_recoverable",
        "sqlserver_tde_encryption_enabled",
        "vm_ensure_attached_disks_encrypted_with_cmk"
      ]
    },
    {
      "Id": "164_312_c_2",
      "Name": "164.312(c)(2) Mechanism to authenticate electronic protected health information",
      "Description": "Implement electronic mechanisms to corroborate that electronic protected health information has not been altered or destroyed in an unauthorized manner.",
      "Attributes": [
        {
          "ItemId": "164_312_c_2",
          "Section": "164.312 Technical Safeguards",
          "Service": "azure"
        }
      ],
      "Checks": [
        "storage_ensure_encryption_with_customer_managed_keys",
        "storage_blob_versioning_is_enabled",
        "storage_secure_transfer_required_is_enabled",
        "keyvault_key_rotation_enabled",
        "keyvault_logging_enabled",
        "sqlserver_auditing_enabled",
        "network_flow_log_captured_sent"
      ]
    },
    {
      "Id": "164_312_d",
      "Name": "164.312(d) Person or entity authentication",
      "Description": "Implement procedures to verify that a person or entity seeking access to electronic protected health information is the one claimed.",
      "Attributes": [
        {
          "ItemId": "164_312_d",
          "Section": "164.312 Technical Safeguards",
          "Service": "entra"
        }
      ],
      "Checks": [
        "entra_security_defaults_enabled",
        "entra_privileged_user_has_mfa",
        "entra_non_privileged_user_has_mfa",
        "entra_conditional_access_policy_require_mfa_for_management_api",
        "entra_user_with_vm_access_has_mfa",
        "entra_trusted_named_locations_exists",
        "sqlserver_azuread_administrator_enabled",
        "postgresql_flexible_server_entra_id_authentication_enabled"
      ]
    },
    {
      "Id": "164_312_e_1",
      "Name": "164.312(e)(1) Transmission security",
      "Description": "Implement technical security measures to guard against unauthorized access to electronic protected health information that is being transmitted over an electronic communications network.",
      "Attributes": [
        {
          "ItemId": "164_312_e_1",
          "Section": "164.312 Technical Safeguards",
          "Service": "azure"
        }
      ],
      "Checks": [
        "storage_secure_transfer_required_is_enabled",
        "storage_ensure_minimum_tls_version_12",
        "sqlserver_recommended_minimal_tls_version",
        "app_minimum_tls_version_12",
        "app_ensure_http_is_redirected_to_https",
        "app_ensure_using_http20",
        "app_function_ftps_deployment_disabled",
        "app_ftp_deployment_disabled",
        "network_ssh_internet_access_restricted",
        "network_rdp_internet_access_restricted",
        "mysql_flexible_server_minimum_tls_version_12",
        "mysql_flexible_server_ssl_connection_enabled",
        "postgresql_flexible_server_enforce_ssl_enabled"
      ]
    },
    {
      "Id": "164_312_e_2_i",
      "Name": "164.312(e)(2)(i) Integrity controls",
      "Description": "Implement security measures to ensure that electronically transmitted electronic protected health information is not improperly modified without detection until disposed of.",
      "Attributes": [
        {
          "ItemId": "164_312_e_2_i",
          "Section": "164.312 Technical Safeguards",
          "Service": "azure"
        }
      ],
      "Checks": [
        "monitor_diagnostic_setting_with_appropriate_categories",
        "storage_secure_transfer_required_is_enabled",
        "storage_ensure_minimum_tls_version_12",
        "storage_blob_versioning_is_enabled",
        "defender_ensure_defender_for_server_is_on",
        "sqlserver_auditing_enabled",
        "keyvault_logging_enabled",
        "network_flow_log_captured_sent"
      ]
    },
    {
      "Id": "164_312_e_2_ii",
      "Name": "164.312(e)(2)(ii) Encryption",
      "Description": "Implement a mechanism to encrypt electronic protected health information whenever deemed appropriate.",
      "Attributes": [
        {
          "ItemId": "164_312_e_2_ii",
          "Section": "164.312 Technical Safeguards",
          "Service": "azure"
        }
      ],
      "Checks": [
        "storage_ensure_encryption_with_customer_managed_keys",
        "storage_infrastructure_encryption_is_enabled",
        "storage_secure_transfer_required_is_enabled",
        "storage_ensure_minimum_tls_version_12",
        "sqlserver_tde_encryption_enabled",
        "sqlserver_tde_encrypted_with_cmk",
        "sqlserver_recommended_minimal_tls_version",
        "keyvault_key_rotation_enabled",
        "vm_ensure_attached_disks_encrypted_with_cmk",
        "vm_ensure_unattached_disks_encrypted_with_cmk",
        "app_minimum_tls_version_12",
        "app_ensure_http_is_redirected_to_https",
        "mysql_flexible_server_minimum_tls_version_12",
        "mysql_flexible_server_ssl_connection_enabled",
        "postgresql_flexible_server_enforce_ssl_enabled",
        "databricks_workspace_cmk_encryption_enabled"
      ]
    }
  ]
}
