{
  "Framework": "ISMS-P",
  "Version": "1.0",
  "Provider": "AWS",
  "Description": "ISMS-P (Information Security Management System-Personal Information) framework for AWS.",
  "Requirements": [
    {
      "Id": "codebuild_project_user_controlled_buildspec",
      "Description": "Ensure CodeBuild Project uses a controlled buildspec",
      "Checks": [
        "codebuild_project_user_controlled_buildspec"
      ],
      "Attributes": [
        {
          "Section": "codebuild",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure CodeBuild Project uses a controlled buildspec",
          "RationaleStatement": "The CodeBuild projects with user controlled buildspec",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Use buildspec.yml from a trusted source which user cant interfere with",
              "Url": "https://docs.aws.amazon.com/codebuild/latest/userguide/security.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.8.1, 2.8.2, 2.8.5"
        }
      ]
    },
    {
      "Id": "codebuild_project_older_90_days",
      "Description": "Ensure CodeBuild Project has been invoked in the last 90 days",
      "Checks": [
        "codebuild_project_older_90_days"
      ],
      "Attributes": [
        {
          "Section": "codebuild",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure CodeBuild Project has been invoked in the last 90 days",
          "RationaleStatement": "Older CodeBuild projects can be checked to see if they are currently in use.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Check if CodeBuild project are really in use and remove the stale ones",
              "Url": "https://docs.aws.amazon.com/codebuild/latest/userguide/delete-project.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.8.1, 2.8.5, 2.9.1, 2.9.7"
        }
      ]
    },
    {
      "Id": "organizations_scp_check_deny_regions",
      "Description": "Check if AWS Regions are restricted with SCP policies",
      "Checks": [
        "organizations_scp_check_deny_regions"
      ],
      "Attributes": [
        {
          "Section": "organizations",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "As best practice, AWS Regions should be restricted and only allow the ones that are needed.",
          "RationaleStatement": "The risk associated with not restricting AWS Regions with Service Control Policies (SCPs) is that it can lead to unauthorized access or use of resources in regions that are not intended for use. This can result in increased costs due to inefficiencies in resource usage and can also expose sensitive data to unauthorized access or breaches. By restricting access to AWS Regions with SCP policies, organizations can help ensure that only authorized personnel have access to the resources they need, while minimizing the risk of security breaches and compliance violations.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Restrict AWS Regions using SCP policies.",
              "Url": "https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps_examples_general.html#example-scp-deny-region"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.5, 2.6.1, 2.10.1"
        }
      ]
    },
    {
      "Id": "organizations_tags_policies_enabled_and_attached",
      "Description": "Check if an AWS Organization has tags policies enabled and attached.",
      "Checks": [
        "organizations_tags_policies_enabled_and_attached"
      ],
      "Attributes": [
        {
          "Section": "organizations",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if an AWS Organization has tags policies enabled and attached.",
          "RationaleStatement": "If an AWS Organization tags policies are not enabled and attached, it is not possible to enforce tags on AWS resources.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Enable and attach AWS Organizations tags policies.",
              "Url": "https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_tag-policies.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.1.3, 2.6.2, 2.9.1"
        }
      ]
    },
    {
      "Id": "organizations_delegated_administrators",
      "Description": "Check if AWS Organizations delegated administrators are trusted",
      "Checks": [
        "organizations_delegated_administrators"
      ],
      "Attributes": [
        {
          "Section": "organizations",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "This check verify if there are AWS Organizations delegated administrators and if they are trusted (you can define your trusted delegated administrator in Prowler configuration)",
          "RationaleStatement": "The risk associated with having untrusted delegated administrators within an AWS Organizations is that they may have the ability to access and make changes to sensitive data and resources within an organization's AWS accounts. This can result in unauthorized access or data breaches, which can lead to financial losses, damage to reputation, and legal liabilities. It's important to carefully vet and monitor AWS Organizations delegated administrators to ensure that they are trustworthy and have a legitimate need for access to the organization's resources.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Review delegated administrators",
              "Url": "https://docs.aws.amazon.com/organizations/latest/userguide/orgs_delegate_policies.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.2.1, 2.5.5"
        }
      ]
    },
    {
      "Id": "organizations_account_part_of_organizations",
      "Description": "Check if account is part of an AWS Organizations",
      "Checks": [
        "organizations_account_part_of_organizations"
      ],
      "Attributes": [
        {
          "Section": "organizations",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure that AWS Organizations service is currently in use.",
          "RationaleStatement": "The risk associated with not being part of an AWS Organizations is that it can lead to a lack of centralized management and control over the AWS accounts in an organization. This can make it difficult to enforce security policies consistently across all accounts, and can also result in increased costs due to inefficiencies in resource usage. Additionally, not being part of an AWS Organizations can make it harder to track and manage account usage and access.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Create or Join an AWS Organization",
              "Url": "https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_org_create.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "1.1.4, 1.2.1, 2.1.1, 2.1.2, 2.9.1"
        }
      ]
    },
    {
      "Id": "shield_advanced_protection_in_classic_load_balancers",
      "Description": "Check if Classic Load Balancers are protected by AWS Shield Advanced.",
      "Checks": [
        "shield_advanced_protection_in_classic_load_balancers"
      ],
      "Attributes": [
        {
          "Section": "shield",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Classic Load Balancers are protected by AWS Shield Advanced.",
          "RationaleStatement": "AWS Shield Advanced provides expanded DDoS attack protection for your resources.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Add as a protected resource in AWS Shield Advanced.",
              "Url": "https://docs.aws.amazon.com/waf/latest/developerguide/configure-new-protection.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/waf/latest/developerguide/configure-new-protection.html",
          "ISMS-P Codes": "2.6.1, 2.10.1, 2.10.3, 2.11.1"
        }
      ]
    },
    {
      "Id": "shield_advanced_protection_in_route53_hosted_zones",
      "Description": "Check if Route53 hosted zones are protected by AWS Shield Advanced.",
      "Checks": [
        "shield_advanced_protection_in_route53_hosted_zones"
      ],
      "Attributes": [
        {
          "Section": "shield",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Route53 hosted zones are protected by AWS Shield Advanced.",
          "RationaleStatement": "AWS Shield Advanced provides expanded DDoS attack protection for your resources.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Add as a protected resource in AWS Shield Advanced.",
              "Url": "https://docs.aws.amazon.com/waf/latest/developerguide/configure-new-protection.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/waf/latest/developerguide/configure-new-protection.html",
          "ISMS-P Codes": "2.6.1, 2.10.1, 2.10.3, 2.11.1"
        }
      ]
    },
    {
      "Id": "shield_advanced_protection_in_cloudfront_distributions",
      "Description": "Check if Cloudfront distributions are protected by AWS Shield Advanced.",
      "Checks": [
        "shield_advanced_protection_in_cloudfront_distributions"
      ],
      "Attributes": [
        {
          "Section": "shield",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Cloudfront distributions are protected by AWS Shield Advanced.",
          "RationaleStatement": "AWS Shield Advanced provides expanded DDoS attack protection for your resources.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Add as a protected resource in AWS Shield Advanced.",
              "Url": "https://docs.aws.amazon.com/waf/latest/developerguide/configure-new-protection.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/waf/latest/developerguide/configure-new-protection.html",
          "ISMS-P Codes": "2.6.1, 2.10.1, 2.10.3, 2.11.1"
        }
      ]
    },
    {
      "Id": "shield_advanced_protection_in_global_accelerators",
      "Description": "Check if Global Accelerators are protected by AWS Shield Advanced.",
      "Checks": [
        "shield_advanced_protection_in_global_accelerators"
      ],
      "Attributes": [
        {
          "Section": "shield",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Global Accelerators are protected by AWS Shield Advanced.",
          "RationaleStatement": "AWS Shield Advanced provides expanded DDoS attack protection for your resources.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Add as a protected resource in AWS Shield Advanced.",
              "Url": "https://docs.aws.amazon.com/waf/latest/developerguide/configure-new-protection.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/waf/latest/developerguide/configure-new-protection.html",
          "ISMS-P Codes": "2.6.1, 2.10.1, 2.10.3, 2.11.1"
        }
      ]
    },
    {
      "Id": "shield_advanced_protection_in_associated_elastic_ips",
      "Description": "Check if Elastic IP addresses with associations are protected by AWS Shield Advanced.",
      "Checks": [
        "shield_advanced_protection_in_associated_elastic_ips"
      ],
      "Attributes": [
        {
          "Section": "shield",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Elastic IP addresses with associations are protected by AWS Shield Advanced.",
          "RationaleStatement": "AWS Shield Advanced provides expanded DDoS attack protection for your resources.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Add as a protected resource in AWS Shield Advanced.",
              "Url": "https://docs.aws.amazon.com/waf/latest/developerguide/configure-new-protection.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/waf/latest/developerguide/configure-new-protection.html",
          "ISMS-P Codes": "2.6.1, 2.10.1, 2.10.3, 2.11.1"
        }
      ]
    },
    {
      "Id": "shield_advanced_protection_in_internet_facing_load_balancers",
      "Description": "Check if internet-facing Application Load Balancers are protected by AWS Shield Advanced.",
      "Checks": [
        "shield_advanced_protection_in_internet_facing_load_balancers"
      ],
      "Attributes": [
        {
          "Section": "shield",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if internet-facing Application Load Balancers are protected by AWS Shield Advanced.",
          "RationaleStatement": "AWS Shield Advanced provides expanded DDoS attack protection for your resources.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Add as a protected resource in AWS Shield Advanced.",
              "Url": "https://docs.aws.amazon.com/waf/latest/developerguide/configure-new-protection.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/waf/latest/developerguide/configure-new-protection.html",
          "ISMS-P Codes": "2.6.1, 2.10.1, 2.10.3, 2.11.1"
        }
      ]
    },
    {
      "Id": "ssm_documents_set_as_public",
      "Description": "Check if there are SSM Documents set as public.",
      "Checks": [
        "ssm_documents_set_as_public"
      ],
      "Attributes": [
        {
          "Section": "ssm",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if there are SSM Documents set as public.",
          "RationaleStatement": "SSM Documents may contain private information or even secrets and tokens.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "https://github.com/cloudmatos/matos/tree/master/remediations/aws/ssm/ssm-doc-block",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Carefully review the contents of the document before is shared. Enable SSM Block public sharing for documents.",
              "Url": "https://docs.aws.amazon.com/systems-manager/latest/userguide/ssm-before-you-share.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/systems-manager/latest/userguide/ssm-before-you-share.html",
          "ISMS-P Codes": "2.5.4, 2.6.1, 2.6.2, 2.11.1"
        }
      ]
    },
    {
      "Id": "ssm_document_secrets",
      "Description": "Find secrets in SSM Documents.",
      "Checks": [
        "ssm_document_secrets"
      ],
      "Attributes": [
        {
          "Section": "ssm",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Find secrets in SSM Documents.",
          "RationaleStatement": "Secrets hardcoded into SSM Documents by malware and bad actors to gain lateral access to other services.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Implement automated detective control (e.g. using tools like Prowler) to scan accounts for passwords and secrets. Use Secrets Manager service to store and retrieve passwords and secrets.",
              "Url": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-secretsmanager-secret-generatesecretstring.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-secretsmanager-secret-generatesecretstring.html",
          "ISMS-P Codes": "2.5.4, 2.7.2, 2.10.9, 2.11.1"
        }
      ]
    },
    {
      "Id": "ssm_managed_compliant_patching",
      "Description": "Check if EC2 instances managed by Systems Manager are compliant with patching requirements.",
      "Checks": [
        "ssm_managed_compliant_patching"
      ],
      "Attributes": [
        {
          "Section": "ssm",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if EC2 instances managed by Systems Manager are compliant with patching requirements.",
          "RationaleStatement": "Without the most recent security patches your system is potentially vulnerable to cyberattacks. Even the best-designed software can not anticipate every future threat to cybersecurity. Poor patch management can leave an organizations data exposed subjecting them to malware and ransomware attacks.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Consider using SSM in all accounts and services to at least monitor for missing patches on servers. Use a robust process to apply security fixes as soon as they are made available. Patch compliance data from Patch Manager can be sent to AWS Security Hub to centralize security issues.",
              "Url": "https://docs.aws.amazon.com/systems-manager/latest/userguide/patch-compliance-identify.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/systems-manager/latest/userguide/patch-compliance-identify.html",
          "ISMS-P Codes": "2.9.1, 2.9.2, 2.10.8"
        }
      ]
    },
    {
      "Id": "secretsmanager_automatic_rotation_enabled",
      "Description": "Check if Secrets Manager secret rotation is enabled.",
      "Checks": [
        "secretsmanager_automatic_rotation_enabled"
      ],
      "Attributes": [
        {
          "Section": "secretsmanager",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Secrets Manager secret rotation is enabled.",
          "RationaleStatement": "Rotating secrets minimizes exposure to attacks using stolen secrets.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws secretsmanager rotate-secret --region <REGION> --secret-id <SECRET-ID> --rotation-lambda-arn <LAMBDA-ARN> --rotation-rules AutomaticallyAfterDays=30",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Implement automated detective control to scan accounts for passwords and secrets. Use secrets manager service to store and retrieve passwords and secrets.",
              "Url": "https://docs.aws.amazon.com/secretsmanager/latest/userguide/rotating-secrets_strategies.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/secretsmanager/latest/userguide/rotating-secrets_strategies.html",
          "ISMS-P Codes": "2.7.2, 2.9.7, 2.10.1"
        }
      ]
    },
    {
      "Id": "kms_cmk_are_used",
      "Description": "Check if there are CMK KMS keys not used.",
      "Checks": [
        "kms_cmk_are_used"
      ],
      "Attributes": [
        {
          "Section": "kms",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if there are CMK KMS keys not used.",
          "RationaleStatement": "Unused keys may increase service cost.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws kms schedule-key-deletion --key-id <key_id> --pending-window-in-days 7",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Before deleting a customer master key (CMK), you might want to know how many cipher-texts were encrypted under that key.",
              "Url": "https://docs.aws.amazon.com/kms/latest/developerguide/deleting-keys-determining-usage.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.7.2, 2.9.7, 2.10.1"
        }
      ]
    },
    {
      "Id": "kms_key_not_publicly_accessible",
      "Description": "Check exposed KMS keys",
      "Checks": [
        "kms_key_not_publicly_accessible"
      ],
      "Attributes": [
        {
          "Section": "kms",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check exposed KMS keys",
          "RationaleStatement": "Exposed KMS Keys or wide policy permissions my leave data unprotected.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "https://github.com/cloudmatos/matos/tree/master/remediations/aws/kms/exposed-key",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "To determine the full extent of who or what currently has access to a customer master key (CMK) in AWS KMS, you must examine the CMK key policy, all grants that apply to the CMK and potentially all AWS Identity and Access Management (IAM) policies. You might do this to determine the scope of potential usage of a CMK.",
              "Url": "https://docs.aws.amazon.com/kms/latest/developerguide/determining-access.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/kms/latest/developerguide/determining-access.html",
          "ISMS-P Codes": "2.5.6, 2.7.2, 2.10.1"
        }
      ]
    },
    {
      "Id": "kms_cmk_rotation_enabled",
      "Description": "Ensure rotation for customer created KMS CMKs is enabled.",
      "Checks": [
        "kms_cmk_rotation_enabled"
      ],
      "Attributes": [
        {
          "Section": "kms",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure rotation for customer created KMS CMKs is enabled.",
          "RationaleStatement": "Cryptographic best practices discourage extensive reuse of encryption keys. Consequently, Customer Master Keys (CMKs) should be rotated to prevent usage of compromised keys.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws kms enable-key-rotation --key-id <key_id>",
              "NativeIaC": "",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/ensure-kms-have-rotation-policy#terraform"
            },
            "Recommendation": {
              "Text": "For every KMS Customer Master Keys (CMKs), ensure that Rotate this key every year is enabled.",
              "Url": "https://docs.aws.amazon.com/kms/latest/developerguide/rotate-keys.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://aws.amazon.com/blogs/security/how-to-get-ready-for-certificate-transparency/",
          "ISMS-P Codes": "2.7.1, 2.7.2, 2.9.7, 2.10.1"
        }
      ]
    },
    {
      "Id": "eventbridge_bus_exposed",
      "Description": "Ensure that your AWS EventBridge event bus is not exposed to everyone",
      "Checks": [
        "eventbridge_bus_exposed"
      ],
      "Attributes": [
        {
          "Section": "eventbridge",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure that your AWS EventBridge event bus is not exposed to everyone.",
          "RationaleStatement": "If your AWS EventBridge event bus is exposed to everyone, unauthorized users can access your event bus and potentially view or modify your events.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws events remove-permission --event-bus-name <event_bus_name> --statement-id <statement_id>",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudWatchEvents/event-bus-exposed.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "To restrict access to your AWS EventBridge event bus, remove the permission that allows everyone to access it.",
              "Url": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/events/CloudWatchEvents-CrossAccountEventDelivery.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/events/CWE_GettingStarted.html",
          "ISMS-P Codes": "2.6.2, 2.10.2"
        }
      ]
    },
    {
      "Id": "eventbridge_bus_cross_account_access",
      "Description": "Ensure that AWS EventBridge event buses do not allow unknown cross-account access for delivery of events.",
      "Checks": [
        "eventbridge_bus_cross_account_access"
      ],
      "Attributes": [
        {
          "Section": "eventbridge",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure that AWS EventBridge event buses do not allow unknown cross-account access for delivery of events.",
          "RationaleStatement": "If an AWS EventBridge event bus allows unknown cross-account access for delivery of events, it can lead to unauthorized access to the event bus and its events.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws events remove-permission --event-bus-name <event_bus_name> --statement-id <statement_id>",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudWatchEvents/event-bus-cross-account-access.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "To remediate this issue, remove the unknown cross-account access for delivery of events from the AWS EventBridge event bus.",
              "Url": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/events/CloudWatchEvents-CrossAccountEventDelivery.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/events/CWE_GettingStarted.html",
          "ISMS-P Codes": "2.5.1, 2.6.2"
        }
      ]
    },
    {
      "Id": "eventbridge_schema_registry_cross_account_access",
      "Description": "Ensure that AWS EventBridge schema registries do not allow unknown cross-account access for delivery of events.",
      "Checks": [
        "eventbridge_schema_registry_cross_account_access"
      ],
      "Attributes": [
        {
          "Section": "eventbridge",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure that AWS EventBridge schema registries do not allow unknown cross-account access for delivery of events.",
          "RationaleStatement": "The schema registry is a central location for storing and managing schemas. If the schema registry is not properly secured, it can lead to unauthorized access to the schema registry and the schemas stored within it.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "To remediate this issue, ensure that the schema registry is not publicly accessible and that only authorized accounts have access to the schema registry.",
              "Url": "https://docs.aws.amazon.com/eventbridge/latest/userguide/eb-schema.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://aws.amazon.com/about-aws/whats-new/2021/09/cross-account-discovery-amazon-eventbridge-schema/",
          "ISMS-P Codes": "2.6.2, 2.10.2"
        }
      ]
    },
    {
      "Id": "cloudwatch_log_metric_filter_unauthorized_api_calls",
      "Description": "Ensure a log metric filter and alarm exist for unauthorized API calls.",
      "Checks": [
        "cloudwatch_log_metric_filter_unauthorized_api_calls"
      ],
      "Attributes": [
        {
          "Section": "cloudwatch",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure a log metric filter and alarm exist for unauthorized API calls.",
          "RationaleStatement": "Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_1#procedure",
              "NativeIaC": "",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_1#fix---buildtime"
            },
            "Recommendation": {
              "Text": "It is recommended that a metric filter and alarm be established for unauthorized requests.",
              "Url": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html",
          "ISMS-P Codes": "2.6.2, 2.9.4, 2.9.5, 2.10.2"
        }
      ]
    },
    {
      "Id": "cloudwatch_changes_to_network_route_tables_alarm_configured",
      "Description": "Ensure route table changes are monitored",
      "Checks": [
        "cloudwatch_changes_to_network_route_tables_alarm_configured"
      ],
      "Attributes": [
        {
          "Section": "cloudwatch",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Real-time monitoring of API calls can be achieved by directing Cloud Trail Logs to CloudWatch Logs, or an external Security information and event management (SIEM)environment, and establishing corresponding metric filters and alarms. Routing tablesare used to route network traffic between subnets and to network gateways. It isrecommended that a metric filter and alarm be established for changes to route tables.",
          "RationaleStatement": "CloudWatch is an AWS native service that allows you to ob serve and monitor resources and applications. CloudTrail Logs can also be sent to an external Security informationand event management (SIEM) environment for monitoring and alerting.Monitoring changes to route tables will help ensure that all VPC traffic flows through anexpected path and prevent any accidental or intentional modifications that may lead touncontrolled network traffic. An alarm should be triggered every time an AWS API call isperformed to create, replace, delete, or disassociate a Route Table.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_13#procedure",
              "NativeIaC": "",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_13#fix---buildtime"
            },
            "Recommendation": {
              "Text": "If you are using CloudTrails and CloudWatch, perform the following to setup the metric filter, alarm, SNS topic, and subscription: 1. Create a metric filter based on filter pattern provided which checks for route table changes and the <cloudtrail_log_group_name> taken from audit step 1. aws logs put-metric-filter --log-group-name <cloudtrail_log_group_name> -- filter-name `<route_table_changes_metric>` --metric-transformations metricName= `<route_table_changes_metric>` ,metricNamespace='CISBenchmark',metricValue=1 --filter-pattern '{($.eventSource = ec2.amazonaws.com) && (($.eventName = CreateRoute) || ($.eventName = CreateRouteTable) || ($.eventName = ReplaceRoute) || ($.eventName = ReplaceRouteTableAssociation) || ($.eventName = DeleteRouteTable) || ($.eventName = DeleteRoute) || ($.eventName = DisassociateRouteTable)) }' Note: You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together. 2. Create an SNS topic that the alarm will notify aws sns create-topic --name <sns_topic_name> Note: you can execute this command once and then re-use the same topic for all monitoring alarms. 3. Create an SNS subscription to the topic created in step 2 aws sns subscribe --topic-arn <sns_topic_arn> --protocol <protocol_for_sns> - -notification-endpoint <sns_subscription_endpoints> Note: you can execute this command once and then re-use the SNS subscription for all monitoring alarms. 4. Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step 1 and an SNS topic created in step 2 aws cloudwatch put-metric-alarm --alarm-name `<route_table_changes_alarm>` --metric-name `<route_table_changes_metric>` --statistic Sum --period 300 - -threshold 1 --comparison-operator GreaterThanOrEqualToThreshold -- evaluation-periods 1 --namespace 'CISBenchmark' --alarm-actions <sns_topic_arn>",
              "Url": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html",
          "ISMS-P Codes": "2.6.2, 2.9.1, 2.9.4, 2.9.5, 2.11.1"
        }
      ]
    },
    {
      "Id": "cloudwatch_changes_to_network_gateways_alarm_configured",
      "Description": "Ensure a log metric filter and alarm exist for changes to network gateways.",
      "Checks": [
        "cloudwatch_changes_to_network_gateways_alarm_configured"
      ],
      "Attributes": [
        {
          "Section": "cloudwatch",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure a log metric filter and alarm exist for changes to network gateways.",
          "RationaleStatement": "Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_12#procedure",
              "NativeIaC": "",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_12#fix---buildtime"
            },
            "Recommendation": {
              "Text": "It is recommended that a metric filter and alarm be established for unauthorized requests.",
              "Url": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html",
          "ISMS-P Codes": "2.9.1, 2.10.9, 2.11.1, 2.11.2"
        }
      ]
    },
    {
      "Id": "cloudwatch_log_metric_filter_for_s3_bucket_policy_changes",
      "Description": "Ensure a log metric filter and alarm exist for S3 bucket policy changes.",
      "Checks": [
        "cloudwatch_log_metric_filter_for_s3_bucket_policy_changes"
      ],
      "Attributes": [
        {
          "Section": "cloudwatch",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure a log metric filter and alarm exist for S3 bucket policy changes.",
          "RationaleStatement": "Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_8#procedure",
              "NativeIaC": "",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_8#fix---buildtime"
            },
            "Recommendation": {
              "Text": "It is recommended that a metric filter and alarm be established for unauthorized requests.",
              "Url": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html",
          "ISMS-P Codes": "2.9.1, 2.10.9, 2.11.1, 2.11.2"
        }
      ]
    },
    {
      "Id": "cloudwatch_log_group_kms_encryption_enabled",
      "Description": "Check if CloudWatch log groups are protected by AWS KMS.",
      "Checks": [
        "cloudwatch_log_group_kms_encryption_enabled"
      ],
      "Attributes": [
        {
          "Section": "cloudwatch",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if CloudWatch log groups are protected by AWS KMS.",
          "RationaleStatement": "Using customer managed KMS to encrypt CloudWatch log group provide additional confidentiality and control over the log data.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "associate-kms-key --log-group-name <value> --kms-key-id <value>",
              "NativeIaC": "",
              "Other": "https://docs.prowler.com/checks/aws/logging-policies/logging_21#aws-console",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Associate KMS Key with Cloudwatch log group.",
              "Url": "https://docs.aws.amazon.com/cli/latest/reference/logs/associate-kms-key.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/cli/latest/reference/logs/associate-kms-key.html",
          "ISMS-P Codes": "2.7.1"
        }
      ]
    },
    {
      "Id": "cloudwatch_log_metric_filter_and_alarm_for_cloudtrail_configuration_changes_enabled",
      "Description": "Ensure a log metric filter and alarm exist for CloudTrail configuration changes.",
      "Checks": [
        "cloudwatch_log_metric_filter_and_alarm_for_cloudtrail_configuration_changes_enabled"
      ],
      "Attributes": [
        {
          "Section": "cloudwatch",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure a log metric filter and alarm exist for CloudTrail configuration changes.",
          "RationaleStatement": "Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_5#procedure",
              "NativeIaC": "",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_5#fix---buildtime"
            },
            "Recommendation": {
              "Text": "It is recommended that a metric filter and alarm be established for unauthorized requests.",
              "Url": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html",
          "ISMS-P Codes": "2.9.1, 2.9.5, 2.11.1"
        }
      ]
    },
    {
      "Id": "cloudwatch_cross_account_sharing_disabled",
      "Description": "Check if CloudWatch has allowed cross-account sharing.",
      "Checks": [
        "cloudwatch_cross_account_sharing_disabled"
      ],
      "Attributes": [
        {
          "Section": "cloudwatch",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if CloudWatch has allowed cross-account sharing.",
          "RationaleStatement": "Cross-Account access to CloudWatch could increase the risk of compromising information between accounts.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Grant usage permission on a per-resource basis to enforce least privilege and Zero Trust principles.",
              "Url": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/Cross-Account-Cross-Region.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/Cross-Account-Cross-Region.html",
          "ISMS-P Codes": "2.5.1, 2.6.2"
        }
      ]
    },
    {
      "Id": "cloudwatch_log_group_retention_policy_specific_days_enabled",
      "Description": "Check if CloudWatch Log Groups have a retention policy of specific days.",
      "Checks": [
        "cloudwatch_log_group_retention_policy_specific_days_enabled"
      ],
      "Attributes": [
        {
          "Section": "cloudwatch",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if CloudWatch Log Groups have a retention policy of specific days.",
          "RationaleStatement": "If log groups have a low retention policy of less than specific days, crucial logs and data can be lost.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/logging-policies/logging_13#cli-command",
              "NativeIaC": "https://docs.prowler.com/checks/aws/logging-policies/logging_13#cloudformation",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/logging-policies/logging_13#terraform"
            },
            "Recommendation": {
              "Text": "Add Log Retention policy of specific days to log groups. This will persist logs and traces for a long time.",
              "Url": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/AWS_Logs.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/AWS_Logs.html",
          "ISMS-P Codes": "2.9.5, 2.9.7"
        }
      ]
    },
    {
      "Id": "cloudwatch_changes_to_vpcs_alarm_configured",
      "Description": "Ensure a log metric filter and alarm exist for VPC changes.",
      "Checks": [
        "cloudwatch_changes_to_vpcs_alarm_configured"
      ],
      "Attributes": [
        {
          "Section": "cloudwatch",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure a log metric filter and alarm exist for VPC changes.",
          "RationaleStatement": "Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_14#procedure",
              "NativeIaC": "",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_14#fix---buildtime"
            },
            "Recommendation": {
              "Text": "It is recommended that a metric filter and alarm be established for unauthorized requests.",
              "Url": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html",
          "ISMS-P Codes": "2.9.1, 2.11.1, 2.11.3"
        }
      ]
    },
    {
      "Id": "cloudwatch_log_group_no_secrets_in_logs",
      "Description": "Check if secrets exists in CloudWatch logs.",
      "Checks": [
        "cloudwatch_log_group_no_secrets_in_logs"
      ],
      "Attributes": [
        {
          "Section": "cloudwatch",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if secrets exists in CloudWatch logs",
          "RationaleStatement": "Storing sensitive data in CloudWatch logs could allow an attacker with read-only access to escalate their privileges or gain unauthorised access to systems.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "It is recommended that sensitive information is not logged to CloudWatch logs. Alternatively, sensitive data may be masked using a protection policy",
              "Url": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/mask-sensitive-log-data.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html",
          "ISMS-P Codes": "2.5.3, 2.7.1"
        }
      ]
    },
    {
      "Id": "cloudwatch_log_metric_filter_aws_organizations_changes",
      "Description": "Ensure a log metric filter and alarm exist for AWS Organizations changes.",
      "Checks": [
        "cloudwatch_log_metric_filter_aws_organizations_changes"
      ],
      "Attributes": [
        {
          "Section": "cloudwatch",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure a log metric filter and alarm exist for AWS Organizations changes.",
          "RationaleStatement": "Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudWatchLogs/organizations-changes-alarm.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "It is recommended that a metric filter and alarm be established for unauthorized requests.",
              "Url": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html",
          "ISMS-P Codes": "2.9.1, 2.9.5, 2.11.1, 2.11.3"
        }
      ]
    },
    {
      "Id": "cloudwatch_log_metric_filter_disable_or_scheduled_deletion_of_kms_cmk",
      "Description": "Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created KMS CMKs.",
      "Checks": [
        "cloudwatch_log_metric_filter_disable_or_scheduled_deletion_of_kms_cmk"
      ],
      "Attributes": [
        {
          "Section": "cloudwatch",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created KMS CMKs.",
          "RationaleStatement": "Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_7#procedure",
              "NativeIaC": "",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_7#fix---buildtime"
            },
            "Recommendation": {
              "Text": "It is recommended that a metric filter and alarm be established for unauthorized requests.",
              "Url": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html",
          "ISMS-P Codes": "2.7.2, 2.9.5, 2.11.1, 2.11.3"
        }
      ]
    },
    {
      "Id": "cloudwatch_log_metric_filter_authentication_failures",
      "Description": "Ensure a log metric filter and alarm exist for AWS Management Console authentication failures.",
      "Checks": [
        "cloudwatch_log_metric_filter_authentication_failures"
      ],
      "Attributes": [
        {
          "Section": "cloudwatch",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure a log metric filter and alarm exist for AWS Management Console authentication failures.",
          "RationaleStatement": "Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_6#procedure",
              "NativeIaC": "",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_6#fix---buildtime"
            },
            "Recommendation": {
              "Text": "It is recommended that a metric filter and alarm be established for unauthorized requests.",
              "Url": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html",
          "ISMS-P Codes": "2.9.5, 2.11.1, 2.11.3"
        }
      ]
    },
    {
      "Id": "cloudwatch_log_metric_filter_sign_in_without_mfa",
      "Description": "Ensure a log metric filter and alarm exist for Management Console sign-in without MFA.",
      "Checks": [
        "cloudwatch_log_metric_filter_sign_in_without_mfa"
      ],
      "Attributes": [
        {
          "Section": "cloudwatch",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure a log metric filter and alarm exist for Management Console sign-in without MFA.",
          "RationaleStatement": "Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_2#procedure",
              "NativeIaC": "",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_2#fix---buildtime"
            },
            "Recommendation": {
              "Text": "It is recommended that a metric filter and alarm be established for unauthorized requests.",
              "Url": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html",
          "ISMS-P Codes": "2.9.5, 2.11.1, 2.11.3"
        }
      ]
    },
    {
      "Id": "cloudwatch_log_metric_filter_security_group_changes",
      "Description": "Ensure a log metric filter and alarm exist for security group changes.",
      "Checks": [
        "cloudwatch_log_metric_filter_security_group_changes"
      ],
      "Attributes": [
        {
          "Section": "cloudwatch",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure a log metric filter and alarm exist for security group changes.",
          "RationaleStatement": "Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_10#procedure",
              "NativeIaC": "",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_10#fix---buildtime"
            },
            "Recommendation": {
              "Text": "It is recommended that a metric filter and alarm be established for unauthorized requests.",
              "Url": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html",
          "ISMS-P Codes": "2.9.1, 2.9.5, 2.11.1, 2.11.3"
        }
      ]
    },
    {
      "Id": "cloudwatch_changes_to_network_acls_alarm_configured",
      "Description": "Ensure a log metric filter and alarm exist for changes to Network Access Control Lists (NACL).",
      "Checks": [
        "cloudwatch_changes_to_network_acls_alarm_configured"
      ],
      "Attributes": [
        {
          "Section": "cloudwatch",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure a log metric filter and alarm exist for changes to Network Access Control Lists (NACL).",
          "RationaleStatement": "Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_11#procedure",
              "NativeIaC": "",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_11#fix---buildtime"
            },
            "Recommendation": {
              "Text": "It is recommended that a metric filter and alarm be established for unauthorized requests.",
              "Url": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html",
          "ISMS-P Codes": "2.9.1, 2.9.5, 2.11.1, 2.11.3"
        }
      ]
    },
    {
      "Id": "cloudwatch_log_metric_filter_root_usage",
      "Description": "Ensure a log metric filter and alarm exist for usage of root account.",
      "Checks": [
        "cloudwatch_log_metric_filter_root_usage"
      ],
      "Attributes": [
        {
          "Section": "cloudwatch",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure a log metric filter and alarm exist for usage of root account.",
          "RationaleStatement": "Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_3#procedure",
              "NativeIaC": "",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_3#fix---buildtime"
            },
            "Recommendation": {
              "Text": "It is recommended that a metric filter and alarm be established for unauthorized requests.",
              "Url": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html",
          "ISMS-P Codes": "2.5.5, 2.9.4, 2.11.1 2.11.3"
        }
      ]
    },
    {
      "Id": "cloudwatch_log_metric_filter_policy_changes",
      "Description": "Ensure a log metric filter and alarm exist for IAM policy changes.",
      "Checks": [
        "cloudwatch_log_metric_filter_policy_changes"
      ],
      "Attributes": [
        {
          "Section": "cloudwatch",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure a log metric filter and alarm exist for IAM policy changes.",
          "RationaleStatement": "Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_4#procedure",
              "NativeIaC": "",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_4#fix---buildtime"
            },
            "Recommendation": {
              "Text": "It is recommended that a metric filter and alarm be established for unauthorized requests.",
              "Url": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html",
          "ISMS-P Codes": "2.5.6, 2.9.1, 2.9.5, 2.11.1, 2.11.3"
        }
      ]
    },
    {
      "Id": "cloudwatch_log_metric_filter_and_alarm_for_aws_config_configuration_changes_enabled",
      "Description": "Ensure a log metric filter and alarm exist for AWS Config configuration changes.",
      "Checks": [
        "cloudwatch_log_metric_filter_and_alarm_for_aws_config_configuration_changes_enabled"
      ],
      "Attributes": [
        {
          "Section": "cloudwatch",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure a log metric filter and alarm exist for AWS Config configuration changes.",
          "RationaleStatement": "Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_9#procedure",
              "NativeIaC": "",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_9#fix---buildtime"
            },
            "Recommendation": {
              "Text": "It is recommended that a metric filter and alarm be established for unauthorized requests.",
              "Url": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html",
          "ISMS-P Codes": "2.9.1, 2.9.5, 2.11.1, 2.11.3"
        }
      ]
    },
    {
      "Id": "glue_etl_jobs_amazon_s3_encryption_enabled",
      "Description": "Check if Glue ETL Jobs have S3 encryption enabled.",
      "Checks": [
        "glue_etl_jobs_amazon_s3_encryption_enabled"
      ],
      "Attributes": [
        {
          "Section": "glue",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Glue ETL Jobs have S3 encryption enabled.",
          "RationaleStatement": "If not enabled sensitive information at rest is not protected.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws glue create-security-configuration --name s3-encrypted-sec-config --encryption-configuration {'S3Encryption': [{'S3EncryptionMode': 'SSE-KMS','KmsKeyArn': <kms_arn>}]}",
              "NativeIaC": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_41#cloudformation",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Glue/s3-encryption-enabled.html",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_41#terraform"
            },
            "Recommendation": {
              "Text": "Provide the encryption properties that are used by crawlers, jobs and development endpoints.",
              "Url": "https://docs.aws.amazon.com/glue/latest/dg/console-security-configurations.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/glue/latest/dg/console-security-configurations.html",
          "ISMS-P Codes": "2.7.1, 2.8.1"
        }
      ]
    },
    {
      "Id": "glue_development_endpoints_s3_encryption_enabled",
      "Description": "Check if Glue development endpoints have S3 encryption enabled.",
      "Checks": [
        "glue_development_endpoints_s3_encryption_enabled"
      ],
      "Attributes": [
        {
          "Section": "glue",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Glue development endpoints have S3 encryption enabled.",
          "RationaleStatement": "Data exfiltration could happen if information is not protected. KMS keys provide additional security level to IAM policies.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws glue create-security-configuration --name s3-encrypted-sec-config --encryption-configuration {'S3Encryption': [{'S3EncryptionMode': 'SSE-KMS','KmsKeyArn': <kms_arn>}]}",
              "NativeIaC": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_41#cloudformation",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Glue/s3-encryption-enabled.html",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_41#terraform"
            },
            "Recommendation": {
              "Text": "Specify AWS KMS keys to use for input and output from S3 and EBS.",
              "Url": "https://docs.aws.amazon.com/glue/latest/dg/encryption-security-configuration.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/glue/latest/dg/encryption-security-configuration.html",
          "ISMS-P Codes": "2.7.1, 2.8.1"
        }
      ]
    },
    {
      "Id": "glue_data_catalogs_metadata_encryption_enabled",
      "Description": "Check if Glue data catalog settings have metadata encryption enabled.",
      "Checks": [
        "glue_data_catalogs_metadata_encryption_enabled"
      ],
      "Attributes": [
        {
          "Section": "glue",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Glue data catalog settings have metadata encryption enabled.",
          "RationaleStatement": "If not enabled sensitive information at rest is not protected.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws glue put-data-catalog-encryption-settings --data-catalog-encryption-settings EncryptionAtRest={CatalogEncryptionMode=SSE-KMS,SseAwsKmsKeyId=<ksm_key_arn>",
              "NativeIaC": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_37#cloudformation",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Glue/data-catalog-encryption-at-rest.html",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_37#terraform"
            },
            "Recommendation": {
              "Text": "Enable Encryption. Use a CMK where possible. It will provide additional management and privacy benefits.",
              "Url": "https://docs.aws.amazon.com/glue/latest/dg/encrypt-glue-data-catalog.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.7.1"
        }
      ]
    },
    {
      "Id": "glue_data_catalogs_connection_passwords_encryption_enabled",
      "Description": "Check if Glue data catalog settings have encrypt connection password enabled.",
      "Checks": [
        "glue_data_catalogs_connection_passwords_encryption_enabled"
      ],
      "Attributes": [
        {
          "Section": "glue",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Glue data catalog settings have encrypt connection password enabled.",
          "RationaleStatement": "If not enabled sensitive information at rest is not protected.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws glue put-data-catalog-encryption-settings --data-catalog-encryption-settings ConnectionPasswordEncryption={ReturnConnectionPasswordEncrypted=True,AwsKmsKeyId=<ksm_key_arn>",
              "NativeIaC": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_37#cloudformation",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_37#terraform"
            },
            "Recommendation": {
              "Text": "On the AWS Glue console, you can enable this option on the Data catalog settings page.",
              "Url": "https://docs.aws.amazon.com/glue/latest/dg/encrypt-connection-passwords.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.7.1, 2.8.1"
        }
      ]
    },
    {
      "Id": "glue_development_endpoints_cloudwatch_logs_encryption_enabled",
      "Description": "Check if Glue development endpoints have CloudWatch logs encryption enabled.",
      "Checks": [
        "glue_development_endpoints_cloudwatch_logs_encryption_enabled"
      ],
      "Attributes": [
        {
          "Section": "glue",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Glue development endpoints have CloudWatch logs encryption enabled.",
          "RationaleStatement": "If not enabled sensitive information at rest is not protected.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws glue create-security-configuration --name cw-encrypted-sec-config --encryption-configuration {'CloudWatchEncryption': [{'CloudWatchEncryptionMode': 'SSE-KMS','KmsKeyArn': <kms_arn>}]}",
              "NativeIaC": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_41#cloudformation",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Glue/cloud-watch-logs-encryption-enabled.html",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_41#terraform"
            },
            "Recommendation": {
              "Text": "Enable Encryption in the Security configurations.",
              "Url": "https://docs.aws.amazon.com/glue/latest/dg/console-security-configurations.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/glue/latest/dg/console-security-configurations.html",
          "ISMS-P Codes": "2.7.1, 2.7.2, 2.9.4"
        }
      ]
    },
    {
      "Id": "glue_database_connections_ssl_enabled",
      "Description": "Check if Glue database connection has SSL connection enabled.",
      "Checks": [
        "glue_database_connections_ssl_enabled"
      ],
      "Attributes": [
        {
          "Section": "glue",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Glue database connection has SSL connection enabled.",
          "RationaleStatement": "Data exfiltration could happen if information is not protected in transit.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Configure encryption settings for crawlers, ETL jobs and development endpoints using security configurations in AWS Glue.",
              "Url": "https://docs.aws.amazon.com/glue/latest/dg/encryption-in-transit.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/glue/latest/dg/encryption-in-transit.html",
          "ISMS-P Codes": "2.6.4, 2.7.1, 2.10.5"
        }
      ]
    },
    {
      "Id": "glue_etl_jobs_job_bookmark_encryption_enabled",
      "Description": "Check if Glue ETL Jobs have Job bookmark encryption enabled.",
      "Checks": [
        "glue_etl_jobs_job_bookmark_encryption_enabled"
      ],
      "Attributes": [
        {
          "Section": "glue",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Glue ETL Jobs have Job bookmark encryption enabled.",
          "RationaleStatement": "If not enabled sensitive information at rest is not protected.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws glue create-security-configuration --name jb-encrypted-sec-config --encryption-configuration {'JobBookmarksEncryption': [{'JobBookmarksEncryptionMode': 'SSE-KMS','KmsKeyArn': <kms_arn>}]}",
              "NativeIaC": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_41#cloudformation",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Glue/job-bookmark-encryption-enabled.html",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_41#terraform"
            },
            "Recommendation": {
              "Text": "Enable Encryption in the Security configurations.",
              "Url": "https://docs.aws.amazon.com/glue/latest/dg/console-security-configurations.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/glue/latest/dg/console-security-configurations.html",
          "ISMS-P Codes": "2.7.1, 2.8.1"
        }
      ]
    },
    {
      "Id": "glue_development_endpoints_job_bookmark_encryption_enabled",
      "Description": "Check if Glue development endpoints have Job bookmark encryption enabled.",
      "Checks": [
        "glue_development_endpoints_job_bookmark_encryption_enabled"
      ],
      "Attributes": [
        {
          "Section": "glue",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Glue development endpoints have Job bookmark encryption enabled.",
          "RationaleStatement": "If not enabled sensitive information at rest is not protected.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws glue create-security-configuration --name jb-encrypted-sec-config --encryption-configuration {'JobBookmarksEncryption': [{'JobBookmarksEncryptionMode': 'SSE-KMS','KmsKeyArn': <kms_arn>}]}",
              "NativeIaC": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_41#cloudformation",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Glue/job-bookmark-encryption-enabled.html",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_41#terraform"
            },
            "Recommendation": {
              "Text": "Enable Encryption in the Security configurations.",
              "Url": "https://docs.aws.amazon.com/glue/latest/dg/console-security-configurations.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/glue/latest/dg/console-security-configurations.html",
          "ISMS-P Codes": "2.7.1, 2.8.1"
        }
      ]
    },
    {
      "Id": "glue_etl_jobs_cloudwatch_logs_encryption_enabled",
      "Description": "Check if Glue ETL Jobs have CloudWatch Logs encryption enabled.",
      "Checks": [
        "glue_etl_jobs_cloudwatch_logs_encryption_enabled"
      ],
      "Attributes": [
        {
          "Section": "glue",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Glue ETL Jobs have CloudWatch Logs encryption enabled.",
          "RationaleStatement": "If not enabled sensitive information at rest is not protected.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws glue create-security-configuration --name cw-encrypted-sec-config --encryption-configuration {'CloudWatchEncryption': [{'CloudWatchEncryptionMode': 'SSE-KMS','KmsKeyArn': <kms_arn>}]}",
              "NativeIaC": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_41#cloudformation",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Glue/cloud-watch-logs-encryption-enabled.html",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_41#terraform"
            },
            "Recommendation": {
              "Text": "Enable Encryption in the Security configurations.",
              "Url": "https://docs.aws.amazon.com/glue/latest/dg/console-security-configurations.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/glue/latest/dg/console-security-configurations.html",
          "ISMS-P Codes": "2.7.1, 2.7.2, 2.9.4"
        }
      ]
    },
    {
      "Id": "s3_bucket_server_access_logging_enabled",
      "Description": "Check if S3 buckets have server access logging enabled",
      "Checks": [
        "s3_bucket_server_access_logging_enabled"
      ],
      "Attributes": [
        {
          "Section": "s3",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if S3 buckets have server access logging enabled",
          "RationaleStatement": "Server access logs can assist you in security and access audits, help you learn about your customer base, and understand your Amazon S3 bill.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/s3-policies/s3_13-enable-logging#cli-command",
              "NativeIaC": "",
              "Other": "https://docs.prowler.com/checks/aws/s3-policies/s3_13-enable-logging#aws-console",
              "Terraform": "https://docs.prowler.com/checks/aws/s3-policies/s3_13-enable-logging#terraform"
            },
            "Recommendation": {
              "Text": "Ensure that S3 buckets have Logging enabled. CloudTrail data events can be used in place of S3 bucket logging. If that is the case, this finding can be considered a false positive.",
              "Url": "https://docs.aws.amazon.com/AmazonS3/latest/dev/security-best-practices.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.4, 2.9.4, 2.11.1"
        }
      ]
    },
    {
      "Id": "s3_bucket_object_versioning",
      "Description": "Check if S3 buckets have object versioning enabled",
      "Checks": [
        "s3_bucket_object_versioning"
      ],
      "Attributes": [
        {
          "Section": "s3",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if S3 buckets have object versioning enabled",
          "RationaleStatement": "With versioning, you can easily recover from both unintended user actions and application failures.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "https://docs.prowler.com/checks/aws/s3-policies/s3_16-enable-versioning#aws-console",
              "Terraform": "https://docs.prowler.com/checks/aws/s3-policies/s3_16-enable-versioning#terraform"
            },
            "Recommendation": {
              "Text": "Configure versioning using the Amazon console or API for buckets with sensitive information that is changing frequently, and backup may not be enough to capture all the changes.",
              "Url": "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/Versioning.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.9.1, 2.9.3, 2.12.1, 2.12.2"
        }
      ]
    },
    {
      "Id": "s3_bucket_kms_encryption",
      "Description": "Check if S3 buckets have KMS encryption enabled.",
      "Checks": [
        "s3_bucket_kms_encryption"
      ],
      "Attributes": [
        {
          "Section": "s3",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if S3 buckets have KMS encryption enabled.",
          "RationaleStatement": "Amazon S3 KMS encryption provides a way to set the encryption behavior for an S3 bucket using a managed key. This will ensure data-at-rest is encrypted.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/S3/encrypted-with-kms-customer-master-keys.html",
              "NativeIaC": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/S3/encrypted-with-kms-customer-master-keys.html",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default#terraform"
            },
            "Recommendation": {
              "Text": "Ensure that S3 buckets have encryption at rest enabled using KMS.",
              "Url": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingKMSEncryption.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingKMSEncryption.html",
          "ISMS-P Codes": "2.7.1"
        }
      ]
    },
    {
      "Id": "s3_bucket_no_mfa_delete",
      "Description": "Check if S3 bucket MFA Delete is not enabled.",
      "Checks": [
        "s3_bucket_no_mfa_delete"
      ],
      "Attributes": [
        {
          "Section": "s3",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if S3 bucket MFA Delete is not enabled.",
          "RationaleStatement": "Your security credentials are compromised or unauthorized access is granted.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws s3api put-bucket-versioning --profile my-root-profile --bucket my-bucket-name --versioning-configuration Status=Enabled,MFADelete=Enabled --mfa 'arn:aws:iam::00000000:mfa/root-account-mfa-device 123456'",
              "NativeIaC": "",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/s3-policies/bc_aws_s3_24#terraform"
            },
            "Recommendation": {
              "Text": "Adding MFA delete to an S3 bucket, requires additional authentication when you change the version state of your bucket or you delete and object version adding another layer of security in the event your security credentials are compromised or unauthorized access is granted.",
              "Url": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/MultiFactorAuthenticationDelete.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.7.1, , 2.9.1, 2.10.1"
        }
      ]
    },
    {
      "Id": "s3_bucket_public_write_acl",
      "Description": "Ensure there are no S3 buckets writable by Everyone or Any AWS customer.",
      "Checks": [
        "s3_bucket_public_write_acl"
      ],
      "Attributes": [
        {
          "Section": "s3",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure there are no S3 buckets writable by Everyone or Any AWS customer.",
          "RationaleStatement": "Even if you enable all possible bucket ACL options available in the Amazon S3 console the ACL alone does not allow everyone to download objects from your bucket. Depending on which option you select any user could perform some actions.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws s3api put-bucket-acl --bucket <bucket_name> --acl private",
              "NativeIaC": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/S3/s3-bucket-public-write-access.html",
              "Other": "",
              "Terraform": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/S3/s3-bucket-public-write-access.html"
            },
            "Recommendation": {
              "Text": "You can enable block public access settings only for access points, buckets and AWS accounts. Amazon S3 does not support block public access settings on a per-object basis. When you apply block public access settings to an account, the settings apply to all AWS Regions globally. The settings might not take effect in all Regions immediately or simultaneously, but they eventually propagate to all Regions.",
              "Url": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.2, 2.6.1, 2.6.4"
        }
      ]
    },
    {
      "Id": "s3_bucket_acl_prohibited",
      "Description": "Check if S3 buckets have ACLs enabled",
      "Checks": [
        "s3_bucket_acl_prohibited"
      ],
      "Attributes": [
        {
          "Section": "s3",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if S3 buckets have ACLs enabled",
          "RationaleStatement": "S3 ACLs are a legacy access control mechanism that predates IAM. IAM and bucket policies are currently the preferred methods.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws s3api put-bucket-ownership-controls --bucket <bucket-name> --ownership-controls Rules=[{ObjectOwnership=BucketOwnerEnforced}]",
              "NativeIaC": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-ownershipcontrols.html",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Ensure that S3 ACLs are disabled (BucketOwnerEnforced). Use IAM policies and bucket policies to manage access.",
              "Url": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/about-object-ownership.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.2, 2.5.3, 2.6.1, 2.6.4"
        }
      ]
    },
    {
      "Id": "s3_bucket_policy_public_write_access",
      "Description": "Check if S3 buckets have policies which allow WRITE access.",
      "Checks": [
        "s3_bucket_policy_public_write_access"
      ],
      "Attributes": [
        {
          "Section": "s3",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if S3 buckets have policies which allow WRITE access.",
          "RationaleStatement": "Non intended users can put objects in a given bucket.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "https://docs.prowler.com/checks/aws/s3-policies/s3_18-write-permissions-public#aws-console",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Ensure proper bucket policy is in place with the least privilege principle applied.",
              "Url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_examples_s3_rw-bucket.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.2, 2.6.4"
        }
      ]
    },
    {
      "Id": "s3_bucket_public_access",
      "Description": "Ensure there are no S3 buckets open to Everyone or Any AWS user.",
      "Checks": [
        "s3_bucket_public_access"
      ],
      "Attributes": [
        {
          "Section": "s3",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure there are no S3 buckets open to Everyone or Any AWS user.",
          "RationaleStatement": "Even if you enable all possible bucket ACL options available in the Amazon S3 console the ACL alone does not allow everyone to download objects from your bucket. Depending on which option you select any user could perform some actions.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws s3api put-public-access-block --public-access-block-configuration BlockPublicAcls=true,IgnorePublicAcls=true,BlockPublicPolicy=true,RestrictPublicBuckets=true --bucket <bucket_name>",
              "NativeIaC": "",
              "Other": "https://github.com/cloudmatos/matos/tree/master/remediations/aws/s3/s3/block-public-access",
              "Terraform": "https://docs.prowler.com/checks/aws/networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached#terraform"
            },
            "Recommendation": {
              "Text": "You can enable block public access settings only for access points, buckets and AWS accounts. Amazon S3 does not support block public access settings on a per-object basis. When you apply block public access settings to an account, the settings apply to all AWS Regions globally. The settings might not take effect in all Regions immediately or simultaneously, but they eventually propagate to all Regions.",
              "Url": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.2, 2.6.4"
        }
      ]
    },
    {
      "Id": "s3_bucket_public_list_acl",
      "Description": "Ensure there are no S3 buckets listable by Everyone or Any AWS customer.",
      "Checks": [
        "s3_bucket_public_list_acl"
      ],
      "Attributes": [
        {
          "Section": "s3",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure there are no S3 buckets listable by Everyone or Any AWS customer.",
          "RationaleStatement": "Even if you enable all possible bucket ACL options available in the Amazon S3 console the ACL alone does not allow everyone to download objects from your bucket. Depending on which option you select any user could perform some actions.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws s3api put-bucket-acl --bucket <bucket_name> --acl private",
              "NativeIaC": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/S3/s3-bucket-public-read-access.html",
              "Other": "",
              "Terraform": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/S3/s3-bucket-public-read-access.html"
            },
            "Recommendation": {
              "Text": "You can enable block public access settings only for access points, buckets and AWS accounts. Amazon S3 does not support block public access settings on a per-object basis. When you apply block public access settings to an account, the settings apply to all AWS Regions globally. The settings might not take effect in all Regions immediately or simultaneously, but they eventually propagate to all Regions.",
              "Url": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.2, 2.6.4"
        }
      ]
    },
    {
      "Id": "s3_bucket_default_encryption",
      "Description": "Check if S3 buckets have default encryption (SSE) enabled or use a bucket policy to enforce it.",
      "Checks": [
        "s3_bucket_default_encryption"
      ],
      "Attributes": [
        {
          "Section": "s3",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if S3 buckets have default encryption (SSE) enabled or use a bucket policy to enforce it.",
          "RationaleStatement": "Amazon S3 default encryption provides a way to set the default encryption behavior for an S3 bucket. This will ensure data-at-rest is encrypted.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws s3api put-bucket-encryption --bucket <bucket_name> --server-side-encryption-configuration '{'Rules': [{'ApplyServerSideEncryptionByDefault': {'SSEAlgorithm': 'AES256'}}]}'",
              "NativeIaC": "https://docs.prowler.com/checks/aws/s3-policies/s3_14-data-encrypted-at-rest#cloudformation",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/s3-policies/s3_14-data-encrypted-at-rest#terraform"
            },
            "Recommendation": {
              "Text": "Ensure that S3 buckets have encryption at rest enabled.",
              "Url": "https://aws.amazon.com/blogs/security/how-to-prevent-uploads-of-unencrypted-objects-to-amazon-s3/"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.7.1, 2.7.2, 2.11.1"
        }
      ]
    },
    {
      "Id": "s3_account_level_public_access_blocks",
      "Description": "Check S3 Account Level Public Access Block.",
      "Checks": [
        "s3_account_level_public_access_blocks"
      ],
      "Attributes": [
        {
          "Section": "s3",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check S3 Account Level Public Access Block.",
          "RationaleStatement": "Public access policies may be applied to sensitive data buckets.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws s3control put-public-access-block --public-access-block-configuration BlockPublicAcls=true,IgnorePublicAcls=true,BlockPublicPolicy=true,RestrictPublicBuckets=true --account-id <account_id>",
              "NativeIaC": "https://docs.prowler.com/checks/aws/s3-policies/bc_aws_s3_21#cloudformation",
              "Other": "https://github.com/cloudmatos/matos/tree/master/remediations/aws/s3/s3control/block-public-access",
              "Terraform": "https://docs.prowler.com/checks/aws/s3-policies/bc_aws_s3_21#terraform"
            },
            "Recommendation": {
              "Text": "You can enable Public Access Block at the account level to prevent the exposure of your data stored in S3.",
              "Url": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.4, 2.6.6"
        }
      ]
    },
    {
      "Id": "s3_bucket_secure_transport_policy",
      "Description": "Check if S3 buckets have secure transport policy.",
      "Checks": [
        "s3_bucket_secure_transport_policy"
      ],
      "Attributes": [
        {
          "Section": "s3",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if S3 buckets have secure transport policy.",
          "RationaleStatement": "If HTTPS is not enforced on the bucket policy, communication between clients and S3 buckets can use unencrypted HTTP. As a result, sensitive information could be transmitted in clear text over the network or internet.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "https://docs.prowler.com/checks/aws/s3-policies/s3_15-secure-data-transport#aws-console",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Ensure that S3 buckets have encryption in transit enabled.",
              "Url": "https://aws.amazon.com/premiumsupport/knowledge-center/s3-bucket-policy-for-config-rule/"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.7.1, 2.10.5"
        }
      ]
    },
    {
      "Id": "s3_bucket_level_public_access_block",
      "Description": "Check S3 Bucket Level Public Access Block.",
      "Checks": [
        "s3_bucket_level_public_access_block"
      ],
      "Attributes": [
        {
          "Section": "s3",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check S3 Bucket Level Public Access Block.",
          "RationaleStatement": "Public access policies may be applied to sensitive data buckets.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws s3api put-public-access-block --region <REGION_NAME> --public-access-block-configuration BlockPublicAcls=true,IgnorePublicAcls=true,BlockPublicPolicy=true,RestrictPublicBuckets=true --bucket <BUCKET_NAME>",
              "NativeIaC": "",
              "Other": "https://github.com/cloudmatos/matos/tree/master/remediations/aws/s3/s3/block-public-access",
              "Terraform": "https://docs.prowler.com/checks/aws/s3-policies/bc_aws_s3_20#terraform"
            },
            "Recommendation": {
              "Text": "You can enable Public Access Block at the bucket level to prevent the exposure of your data stored in S3.",
              "Url": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
          "ISMS-P Codes": "2.6.1, 2.6.4, 2.6.6"
        }
      ]
    },
    {
      "Id": "s3_bucket_object_lock",
      "Description": "Check if S3 buckets have object lock enabled",
      "Checks": [
        "s3_bucket_object_lock"
      ],
      "Attributes": [
        {
          "Section": "s3",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if S3 buckets have object lock enabled",
          "RationaleStatement": "Store objects using a write-once-read-many (WORM) model to help you prevent objects from being deleted or overwritten for a fixed amount of time or indefinitely. That helps to prevent ransomware attacks.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/general-policies/ensure-that-s3-bucket-has-lock-configuration-enabled-by-default#cli-command",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/S3/object-lock.html",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/ensure-that-s3-bucket-has-lock-configuration-enabled-by-default#terraform"
            },
            "Recommendation": {
              "Text": "Ensure that your Amazon S3 buckets have Object Lock feature enabled in order to prevent the objects they store from being deleted.",
              "Url": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/object-lock-overview.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.4, 2.9.1, 2.11.1, 2.12.1"
        }
      ]
    },
    {
      "Id": "emr_cluster_account_public_block_enabled",
      "Description": "EMR Account Public Access Block enabled.",
      "Checks": [
        "emr_cluster_account_public_block_enabled"
      ],
      "Attributes": [
        {
          "Section": "emr",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "EMR Account Public Access Block enabled.",
          "RationaleStatement": "EMR Clusters must have Account Public Access Block enabled.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "https://github.com/cloudmatos/matos/tree/master/remediations/aws/emr/block-emr-public-access",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Enable EMR Account Public Access Block.",
              "Url": "https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-block-public-access.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-block-public-access.html",
          "ISMS-P Codes": "2.6.1, 2.6.4, 2.6.6, 2.10.1"
        }
      ]
    },
    {
      "Id": "emr_cluster_master_nodes_no_public_ip",
      "Description": "EMR Cluster without Public IP.",
      "Checks": [
        "emr_cluster_master_nodes_no_public_ip"
      ],
      "Attributes": [
        {
          "Section": "emr",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "EMR Cluster without Public IP.",
          "RationaleStatement": "EMR Cluster should not have Public IP.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Only make acceptable EMR clusters public.",
              "Url": "https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-block-public-access.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-block-public-access.html",
          "ISMS-P Codes": "2.6.2, 2.6.4, 2.6.6"
        }
      ]
    },
    {
      "Id": "emr_cluster_publicly_accesible",
      "Description": "Publicly accessible EMR Cluster.",
      "Checks": [
        "emr_cluster_publicly_accesible"
      ],
      "Attributes": [
        {
          "Section": "emr",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Publicly accessible EMR Cluster.",
          "RationaleStatement": "EMR Clusters should not be publicly accessible.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/networking-policies/ensure-that-amazon-emr-clusters-security-groups-are-not-open-to-the-world#terraform"
            },
            "Recommendation": {
              "Text": "Only make acceptable EMR clusters public.",
              "Url": "https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-block-public-access.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-block-public-access.html",
          "ISMS-P Codes": "2.6.2, 2.6.4, 2.6.6, 2.10.1"
        }
      ]
    },
    {
      "Id": "documentdb_cluster_storage_encrypted",
      "Description": "Check if DocumentDB cluster storage is encrypted.",
      "Checks": [
        "documentdb_cluster_storage_encrypted"
      ],
      "Attributes": [
        {
          "Section": "documentdb",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if DocumentDB cluster storage is encrypted.",
          "RationaleStatement": "Ensure that encryption of data at rest is enabled for your Amazon DocumentDB (with MongoDB compatibility) database clusters for additional data security and regulatory compliance.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_28/",
              "NativeIaC": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DocumentDB/encryption-enabled.html#",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_28/"
            },
            "Recommendation": {
              "Text": "Enable Encryption. Use a CMK where possible. It will provide additional management and privacy benefits.",
              "Url": "https://docs.aws.amazon.com/securityhub/latest/userguide/documentdb-controls.html#documentdb-1"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/securityhub/latest/userguide/documentdb-controls.html#documentdb-1",
          "ISMS-P Codes": "2.7.1"
        }
      ]
    },
    {
      "Id": "documentdb_cluster_backup_retention",
      "Description": "Check if DocumentDB Clusters have backup enabled.",
      "Checks": [
        "documentdb_cluster_backup_retention"
      ],
      "Attributes": [
        {
          "Section": "documentdb",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if DocumentDB Clusters have backup enabled.",
          "RationaleStatement": "Ensure that your Amazon DocumentDB database clusters have set a minimum backup retention period in order to achieve compliance requirements in your organization.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DocumentDB/sufficient-backup-retention-period.html#",
              "NativeIaC": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DocumentDB/sufficient-backup-retention-period.html#",
              "Other": "",
              "Terraform": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DocumentDB/sufficient-backup-retention-period.html#"
            },
            "Recommendation": {
              "Text": "Enable automated backup for production data. Define a retention period and periodically test backup restoration. A Disaster Recovery process should be in place to govern Data Protection approach.",
              "Url": "https://docs.aws.amazon.com/securityhub/latest/userguide/documentdb-controls.html#documentdb-2"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/securityhub/latest/userguide/documentdb-controls.html#documentdb-2",
          "ISMS-P Codes": "2.9.3, 2.9.7, 2.12.1"
        }
      ]
    },
    {
      "Id": "documentdb_cluster_cloudwatch_log_export",
      "Description": "Check if DocumentDB clusters are using the log export feature.",
      "Checks": [
        "documentdb_cluster_cloudwatch_log_export"
      ],
      "Attributes": [
        {
          "Section": "documentdb",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if DocumentDB clusters are using the log export feature.",
          "RationaleStatement": "Ensure that all your Amazon DocumentDB clusters are using the Log Exports feature in order to publish audit logs directly to CloudWatch Logs. The events recorded by Log Exports include events such as successful and failed authentication attempts, creating indexes, or dropping collections in DocumentDB databases.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DocumentDB/enable-profiler.html",
              "NativeIaC": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DocumentDB/enable-profiler.html",
              "Other": "",
              "Terraform": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DocumentDB/enable-profiler.html"
            },
            "Recommendation": {
              "Text": "Enabled DocumentDB Log export functionality to analyze, monitor, and archive auditing events for security and compliance requirements.",
              "Url": "https://docs.aws.amazon.com/securityhub/latest/userguide/documentdb-controls.html#documentdb-4"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/securityhub/latest/userguide/documentdb-controls.html#documentdb-4",
          "ISMS-P Codes": "2.9.2, 2.9.5, 2.12.1"
        }
      ]
    },
    {
      "Id": "documentdb_cluster_deletion_protection_enabled",
      "Description": "Check if DocumentDB Clusters has deletion protection enabled.",
      "Checks": [
        "documentdb_cluster_deletion_protection_enabled"
      ],
      "Attributes": [
        {
          "Section": "documentdb",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Neptune Clusters has deletion protection enabled.",
          "RationaleStatement": "Enabling cluster deletion protection offers an additional layer of protection against accidental database deletion or deletion by an unauthorized user. A Neptune DB cluster can't be deleted while deletion protection is enabled. You must first disable deletion protection before a delete request can succeed.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DocumentDB/deletion-protection.html#",
              "NativeIaC": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DocumentDB/deletion-protection.html#",
              "Other": "",
              "Terraform": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DocumentDB/deletion-protection.html#"
            },
            "Recommendation": {
              "Text": "Enable deletion protection for production DocumentDB Clusters.",
              "Url": "https://docs.aws.amazon.com/securityhub/latest/userguide/documentdb-controls.html#documentdb-5"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/securityhub/latest/userguide/documentdb-controls.html#documentdb-5",
          "ISMS-P Codes": "2.8.1, 2.9.3, 2.11.1"
        }
      ]
    },
    {
      "Id": "sns_subscription_not_using_http_endpoints",
      "Description": "Ensure there are no SNS subscriptions using HTTP endpoints",
      "Checks": [
        "sns_subscription_not_using_http_endpoints"
      ],
      "Attributes": [
        {
          "Section": "sns",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure there are no SNS subscriptions using HTTP endpoints",
          "RationaleStatement": "When you use HTTPS, messages are automatically encrypted during transit, even if the SNS topic itself isn't encrypted. Without HTTPS, a network-based attacker can eavesdrop on network traffic or manipulate it using an attack such as man-in-the-middle.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "To enforce only encrypted connections over HTTPS, add the aws:SecureTransport condition in the IAM policy that's attached to unencrypted SNS topics. This forces message publishers to use HTTPS instead of HTTP",
              "Url": "https://docs.aws.amazon.com/sns/latest/dg/sns-security-best-practices.html#enforce-encryption-data-in-transit"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/sns/latest/dg/sns-security-best-practices.html#enforce-encryption-data-in-transit",
          "ISMS-P Codes": "2.5.6, 2.7.1, 2.10.5"
        }
      ]
    },
    {
      "Id": "sns_topics_kms_encryption_at_rest_enabled",
      "Description": "Ensure there are no SNS Topics unencrypted",
      "Checks": [
        "sns_topics_kms_encryption_at_rest_enabled"
      ],
      "Attributes": [
        {
          "Section": "sns",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure there are no SNS Topics unencrypted",
          "RationaleStatement": "If not enabled sensitive information at rest is not protected.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws sns set-topic-attributes --topic-arn <TOPIC_ARN> --attribute-name 'KmsMasterKeyId' --attribute-value <KEY>",
              "NativeIaC": "https://docs.prowler.com/checks/aws/general-policies/general_15#cloudformation",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/SNS/topic-encrypted-with-kms-customer-master-keys.html",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/general_15#terraform"
            },
            "Recommendation": {
              "Text": "Use Amazon SNS with AWS KMS.",
              "Url": "https://docs.aws.amazon.com/sns/latest/dg/sns-server-side-encryption.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/sns/latest/dg/sns-server-side-encryption.html",
          "ISMS-P Codes": "2.7.1"
        }
      ]
    },
    {
      "Id": "sns_topics_not_publicly_accessible",
      "Description": "Check if SNS topics have policy set as Public",
      "Checks": [
        "sns_topics_not_publicly_accessible"
      ],
      "Attributes": [
        {
          "Section": "sns",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if SNS topics have policy set as Public",
          "RationaleStatement": "Publicly accessible services could expose sensitive data to bad actors.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/SNS/topics-everyone-publish.html",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/SNS/topics-everyone-publish.html",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/ensure-sns-topic-policy-is-not-public-by-only-allowing-specific-services-or-principals-to-access-it#terraform"
            },
            "Recommendation": {
              "Text": "Ensure there is a business requirement for service to be public.",
              "Url": "https://docs.aws.amazon.com/config/latest/developerguide/sns-topic-policy.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/config/latest/developerguide/sns-topic-policy.html",
          "ISMS-P Codes": "2.6.1, 2.6.6, 2.10.1"
        }
      ]
    },
    {
      "Id": "macie_is_enabled",
      "Description": "Check if Amazon Macie is enabled.",
      "Checks": [
        "macie_is_enabled"
      ],
      "Attributes": [
        {
          "Section": "macie",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Amazon Macie is enabled.",
          "RationaleStatement": "Amazon Macie is a fully managed data security and data privacy service that uses machine learning and pattern matching to help you discover, monitor and protect your sensitive data in AWS.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws macie2 enable-macie",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Enable Amazon Macie and create appropriate jobs to discover sensitive data.",
              "Url": "https://aws.amazon.com/macie/getting-started/"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "1.2.1, 1.2.4, 2.1.1, 2.9.4, 3.1.1, 3.1.2"
        }
      ]
    },
    {
      "Id": "inspector2_is_enabled",
      "Description": "Check if Inspector2 is enabled",
      "Checks": [
        "inspector2_is_enabled"
      ],
      "Attributes": [
        {
          "Section": "inspector2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Inspector2 is enabled",
          "RationaleStatement": "Without using AWS Inspector, you may not be aware of all the security vulnerabilities in your AWS resources, which could lead to unauthorized access, data breaches, or other security incidents.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws inspector2 enable",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Inspector/amazon-inspector-findings.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Enable Inspector2",
              "Url": "https://docs.aws.amazon.com/inspector/latest/user/what-is-inspector.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/inspector/latest/user/findings-understanding.html",
          "ISMS-P Codes": "2.9.5, 2.10.9, 2.11.1, 2.11.2, 2.11.3"
        }
      ]
    },
    {
      "Id": "inspector2_active_findings_exist",
      "Description": "Check if Inspector2 findings exist",
      "Checks": [
        "inspector2_active_findings_exist"
      ],
      "Attributes": [
        {
          "Section": "inspector2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Inspector2 findings exist",
          "RationaleStatement": "Without using AWS Inspector, you may not be aware of all the security vulnerabilities in your AWS resources, which could lead to unauthorized access, data breaches, or other security incidents.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Inspector/amazon-inspector-findings.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Review the active findings from Inspector2",
              "Url": "https://docs.aws.amazon.com/inspector/latest/user/what-is-inspector.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/inspector/latest/user/findings-understanding.html",
          "ISMS-P Codes": "2.9.5, 2.10.9, 2.11.1, 2.11.2, 2.11.3"
        }
      ]
    },
    {
      "Id": "config_recorder_all_regions_enabled",
      "Description": "Ensure AWS Config is enabled in all regions.",
      "Checks": [
        "config_recorder_all_regions_enabled"
      ],
      "Attributes": [
        {
          "Section": "config",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure AWS Config is enabled in all regions.",
          "RationaleStatement": "The AWS configuration item history captured by AWS Config enables security analysis, resource change tracking and compliance auditing.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/logging-policies/logging_5-enable-aws-config-regions#cli-command",
              "NativeIaC": "",
              "Other": "https://docs.prowler.com/checks/aws/logging-policies/logging_5-enable-aws-config-regions#aws-console",
              "Terraform": "https://docs.prowler.com/checks/aws/logging-policies/logging_5-enable-aws-config-regions#terraform"
            },
            "Recommendation": {
              "Text": "It is recommended to enable AWS Config in all regions.",
              "Url": "https://aws.amazon.com/blogs/mt/aws-config-best-practices/"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://aws.amazon.com/blogs/mt/aws-config-best-practices/",
          "ISMS-P Codes": "2.9.4"
        }
      ]
    },
    {
      "Id": "cognito_user_pool_blocks_compromised_credentials_sign_in_attempts",
      "Description": "Ensure that advanced security features are enabled for Amazon Cognito User Pools to block sign-in by users with suspected compromised credentials",
      "Checks": [
        "cognito_user_pool_blocks_compromised_credentials_sign_in_attempts"
      ],
      "Attributes": [
        {
          "Section": "cognito",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Amazon Cognito User Pools can be configured to block sign-in by users with suspected compromised credentials. This feature uses Amazon Cognito advanced security features to detect anomalous sign-in attempts and block them. When enabled, Amazon Cognito User Pools will block sign-in by users with suspected compromised credentials. This helps protect your users from unauthorized access to their accounts.",
          "RationaleStatement": "If advanced security features are not enabled for an Amazon Cognito User Pool, users with compromised credentials may be able to sign in to their accounts. This could lead to unauthorized access to user data and other resources.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "To enable advanced security features for an Amazon Cognito User Pool, follow the steps below:",
              "Url": "https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-user-pool-settings-advanced-security.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-user-pool-settings-advanced-security.html",
          "ISMS-P Codes": "2.5.2, 2.5.3, 2.10.1"
        }
      ]
    },
    {
      "Id": "cognito_user_pool_temporary_password_expiration",
      "Description": "Ensure that the user pool has a temporary password expiration period of 7 days or less",
      "Checks": [
        "cognito_user_pool_temporary_password_expiration"
      ],
      "Attributes": [
        {
          "Section": "cognito",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Temporary passwords are set by the administrator and are used to allow users to sign in and change their password. Temporary passwords are valid for a limited period of time, after which they expire. Temporary passwords are used when an administrator creates a new user account or resets a user password. The temporary password expiration period is the length of time that the temporary password is valid. The default value is 7 days. You can set the expiration period to a value between 0 and 365 days.",
          "RationaleStatement": "If the temporary password expiration period is too long, it increases the risk of unauthorized access to the user account. If the temporary password expiration period is too short, it increases the risk of users being unable to sign in and change their password.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Set the temporary password expiration period to 7 days or less.",
              "Url": "https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-policies.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-policies.html",
          "ISMS-P Codes": "2.5.4, 2.10.1"
        }
      ]
    },
    {
      "Id": "cognito_user_pool_password_policy_uppercase",
      "Description": "Ensure that the password policy for your user pool requires at least one uppercase letter",
      "Checks": [
        "cognito_user_pool_password_policy_uppercase"
      ],
      "Attributes": [
        {
          "Section": "cognito",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "User pools allow you to configure a password policy for your user pool to specify requirements for user passwords. You can require that passwords have a minimum length, contain at least one uppercase letter, and contain at least one number. You can also require that passwords have at least one special character. You can also set the password policy to require that passwords be case-sensitive.",
          "RationaleStatement": "If the password policy for your user pool does not require at least one uppercase letter, it may be easier for an attacker to guess or crack user passwords.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "To require that the password policy for your user pool requires at least one uppercase letter, you can use the AWS Management Console or the AWS CLI. For more information, see the documentation on user pool settings and policies.",
              "Url": "https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-policies.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-policies.html",
          "ISMS-P Codes": "2.5.4, 2.8.1, 2.10.1"
        }
      ]
    },
    {
      "Id": "cognito_user_pool_password_policy_number",
      "Description": "Ensure that the password policy for your user pool requires a number",
      "Checks": [
        "cognito_user_pool_password_policy_number"
      ],
      "Attributes": [
        {
          "Section": "cognito",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Checks whether the password policy for your user pool requires a number.",
          "RationaleStatement": "If the password policy for your user pool does not require a number, the user pool is less secure and more vulnerable to attacks.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "To require a number in the password policy for your user pool, perform the following actions:",
              "Url": "https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-policies.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-policies.html",
          "ISMS-P Codes": "2.5.4, 2.8.1, 2.10.1"
        }
      ]
    },
    {
      "Id": "cognito_identity_pool_guest_access_disabled",
      "Description": "Ensure Cognito Identity Pool has guest access disabled",
      "Checks": [
        "cognito_identity_pool_guest_access_disabled"
      ],
      "Attributes": [
        {
          "Section": "cognito",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Guest access allows unauthenticated users to access your identity pool. This is useful for public websites that allow users to sign in with a social identity provider, but it can also be a security risk. If you don't need guest access, you should disable it.",
          "RationaleStatement": "If guest access is enabled, unauthenticated users can access your identity pool. This can be a security risk if you don't need guest access.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Gues access should be disabled for Cognito Identity Pool. To disable guest access, follow the steps in the Amazon Cognito documentation.",
              "Url": "https://docs.aws.amazon.com/location/latest/developerguide/authenticating-using-cognito.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/location/latest/developerguide/authenticating-using-cognito.html",
          "ISMS-P Codes": "2.5.2, 2.6.1, 2.10.1"
        }
      ]
    },
    {
      "Id": "cognito_user_pool_deletion_protection_enabled",
      "Description": "Ensure cognito user pools deletion protection enabled to prevent accidental deletion",
      "Checks": [
        "cognito_user_pool_deletion_protection_enabled"
      ],
      "Attributes": [
        {
          "Section": "cognito",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Deletion protection is a feature that allows you to lock a user pool to prevent it from being deleted. When deletion protection is enabled, you cannot delete the user pool. By default, deletion protection is disabled",
          "RationaleStatement": "If deletion protection is not enabled, the user pool can be deleted by any user with the necessary permissions. This can lead to loss of data and service disruption",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Deletion protection should be enabled for the user pool to prevent accidental deletion",
              "Url": "https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-deletion-protection.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-deletion-protection.html",
          "ISMS-P Codes": "2.9.1, 2.9.2, 2.10.1"
        }
      ]
    },
    {
      "Id": "cognito_user_pool_password_policy_lowercase",
      "Description": "Ensure Cognito User Pool has password policy to require at least one lowercase letter",
      "Checks": [
        "cognito_user_pool_password_policy_lowercase"
      ],
      "Attributes": [
        {
          "Section": "cognito",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "User pool password policy should require at least one lowercase letter.",
          "RationaleStatement": "If the password policy does not require at least one lowercase letter, it may be easier for an attacker to crack the password.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "To require at least one lowercase letter in the password, update the password policy for the user pool.",
              "Url": "https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-policies.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-policies.html",
          "ISMS-P Codes": "2.5.4, 2.8.1, 2.10.1"
        }
      ]
    },
    {
      "Id": "cognito_user_pool_blocks_potential_malicious_sign_in_attempts",
      "Description": "Ensure that your Amazon Cognito user pool blocks potential malicious sign-in attempts",
      "Checks": [
        "cognito_user_pool_blocks_potential_malicious_sign_in_attempts"
      ],
      "Attributes": [
        {
          "Section": "cognito",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Amazon Cognito provides adaptive authentication, which helps protect your applications from malicious actors and compromised credentials by evaluating the risk associated with each user login and providing the appropriate level of security to mitigate that risk. Adaptive authentication is a feature of advanced security that you can enable for your user pool. When adaptive authentication is enabled, Amazon Cognito evaluates the risk associated with each user login and provides the appropriate level of security to mitigate that risk. You can configure adaptive authentication to block sign-in attempts that are likely to be malicious.",
          "RationaleStatement": "If adaptive authentication with automatic risk response as block sign-in is not enabled, your user pool may not be able to block sign-in attempts that are likely to be malicious.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "To enable adaptive authentication with automatic risk response as block sign-in, perform the following actions:",
              "Url": "https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-user-pool-settings-advanced-security.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-user-pool-settings-advanced-security.html",
          "ISMS-P Codes": "2.5.3, 2.6.1, 2.10.1"
        }
      ]
    },
    {
      "Id": "cognito_user_pool_advanced_security_enabled",
      "Description": "Ensure cognito user pools has advanced security enabled with full-function",
      "Checks": [
        "cognito_user_pool_advanced_security_enabled"
      ],
      "Attributes": [
        {
          "Section": "cognito",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Advanced security features for Amazon Cognito User Pools provide additional security for your user pool. These features include compromised credentials protection, phone number verification, and account takeover protection.",
          "RationaleStatement": "If advanced security features are not enabled, your user pool is more vulnerable to unauthorized access.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "To enable advanced security features for an Amazon Cognito User Pool, follow the instructions in the Amazon Cognito documentation.",
              "Url": "https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-user-pool-settings-advanced-security.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-user-pool-settings-advanced-security.html",
          "ISMS-P Codes": "2.5.3, 2.10.1, 2.11.1"
        }
      ]
    },
    {
      "Id": "cognito_user_pool_client_token_revocation_enabled",
      "Description": "Ensure that token revocation is enabled for Amazon Cognito User Pools",
      "Checks": [
        "cognito_user_pool_client_token_revocation_enabled"
      ],
      "Attributes": [
        {
          "Section": "cognito",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Token revocation is a security feature that allows you to revoke tokens and end sessions for users. When you enable token revocation, Amazon Cognito automatically revokes tokens for users who sign out or are deleted. This helps protect your users' data and prevent unauthorized access to your resources.",
          "RationaleStatement": "If token revocation is not enabled, users' tokens will not be revoked when they sign out or are deleted. This can lead to unauthorized access to your resources.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "To enable token revocation for an Amazon Cognito User Pool, use the Amazon Cognito console or the AWS CLI. For more information, see the Amazon Cognito documentation.",
              "Url": "https://docs.aws.amazon.com/cognito/latest/developerguide/token-revocation.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/cognito/latest/developerguide/token-revocation.html",
          "ISMS-P Codes": "2.5.3, 2.10.1"
        }
      ]
    },
    {
      "Id": "cognito_user_pool_password_policy_minimum_length_14",
      "Description": "Ensure that the password policy for your user pools require a minimum length of 14 or greater",
      "Checks": [
        "cognito_user_pool_password_policy_minimum_length_14"
      ],
      "Attributes": [
        {
          "Section": "cognito",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "User pools allow you to configure a password policy for your user pool to specify complexity requirements for user passwords. The password policy for your user pools should require a minimum length of 14 or greater.",
          "RationaleStatement": "If the password policy for your user pools does not require a minimum length of 14 or greater, it may be easier for attackers to guess or brute force user passwords.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "To require a minimum length of 14 or greater for user passwords in your user pools, you can update the password policy for your user pool using the AWS Management Console, AWS CLI, or SDK.",
              "Url": "https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-policies.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-policies.html",
          "ISMS-P Codes": "2.5.4, 2.8.1, 2.10.1"
        }
      ]
    },
    {
      "Id": "cognito_user_pool_client_prevent_user_existence_errors",
      "Description": "Amazon Cognito User Pool should prevent user existence errors",
      "Checks": [
        "cognito_user_pool_client_prevent_user_existence_errors"
      ],
      "Attributes": [
        {
          "Section": "cognito",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Amazon Cognito User Pool should be configured to prevent user existence errors. This setting prevents user existence errors by requiring the user to enter a username and password to sign in. If the user does not exist, the user will receive an error message.",
          "RationaleStatement": "Revealing user existence errors can be a security risk as it can allow an attacker to determine if a user exists in the system. This can be used to perform user enumeration attacks.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "To prevent user existence errors, you should configure the Amazon Cognito User Pool to require a username and password to sign in. If the user does not exist, the user will receive an error message.",
              "Url": "https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-user-pool-managing-errors.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-user-pool-managing-errors.html",
          "ISMS-P Codes": "2.5.2, 2.5.3, 2.11.3"
        }
      ]
    },
    {
      "Id": "cognito_user_pool_mfa_enabled",
      "Description": "Ensure Multi-Factor Authentication (MFA) is enabled for Amazon Cognito User Pools",
      "Checks": [
        "cognito_user_pool_mfa_enabled"
      ],
      "Attributes": [
        {
          "Section": "cognito",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Checks whether Multi-Factor Authentication (MFA) is enabled for Amazon Cognito User Pools.",
          "RationaleStatement": "If MFA is not enabled, unauthorized users could gain access to the user pool and potentially compromise the security of the application.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "To enable MFA for an Amazon Cognito User Pool, follow the instructions in the Amazon Cognito documentation.",
              "Url": "https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-mfa.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-mfa.html",
          "ISMS-P Codes": "2.5.3, 2.5.4, 2.10.1"
        }
      ]
    },
    {
      "Id": "cognito_user_pool_password_policy_symbol",
      "Description": "Ensure that the password policy for your Amazon Cognito user pool requires at least one symbol.",
      "Checks": [
        "cognito_user_pool_password_policy_symbol"
      ],
      "Attributes": [
        {
          "Section": "cognito",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check whether the password policy for your Amazon Cognito user pool requires at least one symbol.",
          "RationaleStatement": "If the password policy for your Amazon Cognito user pool does not require at least one symbol, it can be easier for attackers to crack passwords.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "To require at least one symbol in the password policy for your Amazon Cognito user pool, you can use the AWS Management Console or the AWS CLI.",
              "Url": "https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-policies.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-policies.html",
          "ISMS-P Codes": "2.5.4, 2.10.1"
        }
      ]
    },
    {
      "Id": "cognito_user_pool_waf_acl_attached",
      "Description": "Ensure that Amazon Cognito User Pool is associated with a WAF Web ACL",
      "Checks": [
        "cognito_user_pool_waf_acl_attached"
      ],
      "Attributes": [
        {
          "Section": "cognito",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Web ACLs are used to control access to your content. You can use a Web ACL to control who can access your content. You can also use a Web ACL to block requests based on IP address, HTTP headers, HTTP body, URI, or URI query string parameters. You can associate a Web ACL with a Cognito User Pool to control access to your content.",
          "RationaleStatement": "If a Web ACL is not associated with a Cognito User Pool, then the content is not protected by the Web ACL. This could lead to unauthorized access to your content.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "The Web ACL should be associated with the Cognito User Pool. To associate a Web ACL with a Cognito User Pool, use the AWS Management Console.",
              "Url": "https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-waf.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-waf.html",
          "ISMS-P Codes": "2.6.1, 2.10.1, 2.11.1"
        }
      ]
    },
    {
      "Id": "cognito_user_pool_self_registration_disabled",
      "Description": "Ensure self registration is disabled for Amazon Cognito User Pools",
      "Checks": [
        "cognito_user_pool_self_registration_disabled"
      ],
      "Attributes": [
        {
          "Section": "cognito",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Checks whether self registration is disabled for the Amazon Cognito User Pool. Self registration allows users to sign up for an account in the user pool. If self registration is enabled, users can sign up for an account in the user pool without any intervention from the administrator. This can lead to unauthorized access to the application.",
          "RationaleStatement": "If self registration is enabled, users can sign up for an account in the user pool without any intervention from the administrator. This can lead to unauthorized access to the application.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "To disable self registration for the Amazon Cognito User Pool, perform the following actions:",
              "Url": "https://docs.aws.amazon.com/cognito/latest/developerguide/signing-up-users-in-your-app.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_SignUp.html",
          "ISMS-P Codes": "2.5.1, 2.5.2, 2.10.1"
        }
      ]
    },
    {
      "Id": "fms_policy_compliant",
      "Description": "Ensure that all FMS policies inside an admin account are compliant",
      "Checks": [
        "fms_policy_compliant"
      ],
      "Attributes": [
        {
          "Section": "fms",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "This check ensures all FMS policies inside an admin account are compliant",
          "RationaleStatement": "If FMS policies are not compliant, means there are resources unprotected by the policies",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws fms list-policies",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Ensure FMS is enabled and all the policies are compliant across your AWS accounts",
              "Url": "https://docs.aws.amazon.com/waf/latest/developerguide/getting-started-fms-intro.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/waf/latest/developerguide/getting-started-fms-intro.html",
          "ISMS-P Codes": "2.5.1, 2.9.1, 2.10.1"
        }
      ]
    },
    {
      "Id": "ssmincidents_enabled_with_plans",
      "Description": "Ensure SSM Incidents is enabled with response plans.",
      "Checks": [
        "ssmincidents_enabled_with_plans"
      ],
      "Attributes": [
        {
          "Section": "ssm",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure SSM Incidents is enabled with response plans.",
          "RationaleStatement": "Not having SSM Incidents enabled can increase the risk of delayed detection and response to security incidents, unauthorized access, limited visibility into incidents and vulnerabilities",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws ssm-incidents create-response-plan",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Enable SSM Incidents and create response plans",
              "Url": "https://docs.aws.amazon.com/incident-manager/latest/userguide/response-plans.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/incident-manager/latest/userguide/response-plans.html",
          "ISMS-P Codes": "2.11.2, 2.11.4"
        }
      ]
    },
    {
      "Id": "cloudfront_distributions_https_enabled",
      "Description": "Check if CloudFront distributions are set to HTTPS.",
      "Checks": [
        "cloudfront_distributions_https_enabled"
      ],
      "Attributes": [
        {
          "Section": "cloudfront",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if CloudFront distributions are set to HTTPS.",
          "RationaleStatement": "If not enabled sensitive information in transit is not protected. Surveillance and other threats are risks may exists.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudFront/security-policy.html",
              "NativeIaC": "https://docs.prowler.com/checks/aws/networking-policies/networking_32#cloudformation",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/networking-policies/networking_32#terraform"
            },
            "Recommendation": {
              "Text": "Use HTTPS everywhere possible. It will enforce privacy and protect against account hijacking and other threats.",
              "Url": "https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/using-https.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/IAM/latest/UserGuide/what-is-access-analyzer.html",
          "ISMS-P Codes": "2.7.1, 2.10.3, 2.10.5"
        }
      ]
    },
    {
      "Id": "cloudfront_distributions_geo_restrictions_enabled",
      "Description": "Check if Geo restrictions are enabled in CloudFront distributions.",
      "Checks": [
        "cloudfront_distributions_geo_restrictions_enabled"
      ],
      "Attributes": [
        {
          "Section": "cloudfront",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Geo restrictions are enabled in CloudFront distributions.",
          "RationaleStatement": "Consider countries where service should not be accessed, by legal or compliance requirements. Additionally if not restricted the attack vector is increased.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudFront/geo-restriction.html",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "If possible, define and enable Geo restrictions for this service.",
              "Url": "https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/georestrictions.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/georestrictions.html",
          "ISMS-P Codes": "2.5.2, 2.6.1, 2.10.3"
        }
      ]
    },
    {
      "Id": "cloudfront_distributions_field_level_encryption_enabled",
      "Description": "Check if CloudFront distributions have Field Level Encryption enabled.",
      "Checks": [
        "cloudfront_distributions_field_level_encryption_enabled"
      ],
      "Attributes": [
        {
          "Section": "cloudfront",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if CloudFront distributions have Field Level Encryption enabled.",
          "RationaleStatement": "Allows you protect specific data throughout system processing so that only certain applications can see it.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudFront/field-level-encryption-enabled.html",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Check if applicable to any sensitive data. This encryption ensures that only applications that need the data\u2014and have the credentials to decrypt it - are able to do so.",
              "Url": "https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/field-level-encryption.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/field-level-encryption.html",
          "ISMS-P Codes": "2.7.1, 2.10.3, 2.10.5"
        }
      ]
    },
    {
      "Id": "cloudfront_distributions_logging_enabled",
      "Description": "Check if CloudFront distributions have logging enabled.",
      "Checks": [
        "cloudfront_distributions_logging_enabled"
      ],
      "Attributes": [
        {
          "Section": "cloudfront",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if CloudFront distributions have logging enabled.",
          "RationaleStatement": "If not enabled monitoring of service use is not possible.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/logging-policies/logging_20#cli-command",
              "NativeIaC": "https://docs.prowler.com/checks/aws/logging-policies/logging_20#cloudformation",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/logging-policies/logging_20#terraform"
            },
            "Recommendation": {
              "Text": "Real-time monitoring can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Enable logging for services with defined log rotation. These logs are useful for Incident Response and forensics investigation among other use cases.",
              "Url": "https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/AccessLogs.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/AccessLogs.html",
          "ISMS-P Codes": "2.9.4, 2.9.5, 2.10.1"
        }
      ]
    },
    {
      "Id": "cloudfront_distributions_using_deprecated_ssl_protocols",
      "Description": "Check if CloudFront distributions are using deprecated SSL protocols.",
      "Checks": [
        "cloudfront_distributions_using_deprecated_ssl_protocols"
      ],
      "Attributes": [
        {
          "Section": "cloudfront",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if CloudFront distributions are using deprecated SSL protocols.",
          "RationaleStatement": "Using insecure ciphers could affect privacy of in transit information.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/networking-policies/networking_33#cli-command",
              "NativeIaC": "",
              "Other": "https://docs.prowler.com/checks/aws/networking-policies/networking_33#aws-cloudfront-console",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Use a Security policy with ciphers that are as strong as possible. Drop legacy and insecure ciphers.",
              "Url": "https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/secure-connections-supported-viewer-protocols-ciphers.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/secure-connections-supported-viewer-protocols-ciphers.html",
          "ISMS-P Codes": "2.7.1, 2.9.7, 2.10.5, 2.10.8"
        }
      ]
    },
    {
      "Id": "cloudfront_distributions_using_waf",
      "Description": "Check if CloudFront distributions are using WAF.",
      "Checks": [
        "cloudfront_distributions_using_waf"
      ],
      "Attributes": [
        {
          "Section": "cloudfront",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if CloudFront distributions are using WAF.",
          "RationaleStatement": "Potential attacks and / or abuse of service, more even for even for internet reachable services.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudFront/cloudfront-integrated-with-waf.html",
              "NativeIaC": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_27#cloudformation",
              "Other": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_27#cloudfront-console",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_27#terraform"
            },
            "Recommendation": {
              "Text": "Use AWS WAF to protect your service from common web exploits. These could affect availability and performance, compromise security, or consume excessive resources.",
              "Url": "https://docs.aws.amazon.com/waf/latest/developerguide/cloudfront-features.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/waf/latest/developerguide/cloudfront-features.html",
          "ISMS-P Codes": "2.10.1, 2.10.3"
        }
      ]
    },
    {
      "Id": "wafv2_webacl_logging_enabled",
      "Description": "Check if AWS WAFv2 WebACL logging is enabled",
      "Checks": [
        "wafv2_webacl_logging_enabled"
      ],
      "Attributes": [
        {
          "Section": "wafv2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if AWS WAFv2 logging is enabled",
          "RationaleStatement": "Enabling AWS WAFv2 logging helps monitor and analyze traffic patterns for enhanced security.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws wafv2 update-web-acl-logging-configuration --scope REGIONAL --web-acl-arn arn:partition:wafv2:region:account-id:webacl/webacl-id --logging-configuration '{\"LogDestinationConfigs\": [\"arn:partition:logs:region:account-id:log-group:log-group-name\"]}'",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/WAF/enable-web-acls-logging.html",
              "Terraform": "https://docs.prowler.com/checks/aws/logging-policies/bc_aws_logging_33#terraform"
            },
            "Recommendation": {
              "Text": "Enable AWS WAFv2 logging for your Web ACLs to monitor and analyze traffic patterns effectively.",
              "Url": "https://docs.aws.amazon.com/waf/latest/developerguide/logging.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/waf/latest/developerguide/logging.html",
          "ISMS-P Codes": "2.6.1, 2.9.4, 2.10.1, 2.11.1"
        }
      ]
    },
    {
      "Id": "opensearch_service_domains_internal_user_database_enabled",
      "Description": "Check if Amazon Elasticsearch/Opensearch Service domains have internal user database enabled",
      "Checks": [
        "opensearch_service_domains_internal_user_database_enabled"
      ],
      "Attributes": [
        {
          "Section": "opensearch",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Amazon Elasticsearch/Opensearch Service domains have internal user database enabled",
          "RationaleStatement": "Internal User Database is convenient for demos, for production environment use Federated authentication.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Remove users from internal user database and uso Cognito instead.",
              "Url": "https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/fgac.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.2, 2.5.3, 2.6.4"
        }
      ]
    },
    {
      "Id": "opensearch_service_domains_audit_logging_enabled",
      "Description": "Check if Amazon Elasticsearch/Opensearch Service domains have audit logging enabled",
      "Checks": [
        "opensearch_service_domains_audit_logging_enabled"
      ],
      "Attributes": [
        {
          "Section": "opensearch",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Amazon Elasticsearch/Opensearch Service domains have audit logging enabled",
          "RationaleStatement": "If logs are not enabled, monitoring of service use and threat analysis is not possible.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Make sure you are logging information about Amazon Elasticsearch Service operations.",
              "Url": "https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/audit-logs.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.9.4, 2.11.3"
        }
      ]
    },
    {
      "Id": "opensearch_service_domains_encryption_at_rest_enabled",
      "Description": "Check if Amazon Elasticsearch/Opensearch Service domains have encryption at-rest enabled",
      "Checks": [
        "opensearch_service_domains_encryption_at_rest_enabled"
      ],
      "Attributes": [
        {
          "Section": "opensearch",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Amazon Elasticsearch/Opensearch Service domains have encryption at-rest enabled",
          "RationaleStatement": "If not enable unauthorized access to your data could risk increases.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Elasticsearch/encryption-at-rest.html",
              "NativeIaC": "https://docs.prowler.com/checks/aws/elasticsearch-policies/elasticsearch_3-enable-encryptionatrest#fix---builtime",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Elasticsearch/encryption-at-rest.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Enable encryption at rest using AWS KMS to store and manage your encryption keys and the Advanced Encryption Standard algorithm with 256-bit keys (AES-256) to perform the encryption.",
              "Url": "https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/encryption-at-rest.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.7.1, 2.7.2"
        }
      ]
    },
    {
      "Id": "opensearch_service_domains_cloudwatch_logging_enabled",
      "Description": "Check if Amazon Elasticsearch/Opensearch Service domains have logging enabled",
      "Checks": [
        "opensearch_service_domains_cloudwatch_logging_enabled"
      ],
      "Attributes": [
        {
          "Section": "opensearch",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Amazon Elasticsearch/Opensearch Service domains have logging enabled",
          "RationaleStatement": "Amazon ES exposes four Elasticsearch/Opensearch logs through Amazon CloudWatch Logs: error logs, search slow logs, index slow logs, and audit logs.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/elasticsearch-policies/elasticsearch_7#cli-command",
              "NativeIaC": "https://docs.prowler.com/checks/aws/elasticsearch-policies/elasticsearch_7#cloudformation",
              "Other": "https://docs.prowler.com/checks/aws/elasticsearch-policies/elasticsearch_7#fix---runtime",
              "Terraform": "https://docs.prowler.com/checks/aws/elasticsearch-policies/elasticsearch_7#fix---buildtime"
            },
            "Recommendation": {
              "Text": "Enable Elasticsearch/Opensearch log. Create use cases for them. Using audit logs check for access denied events.",
              "Url": "https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-createdomain-configure-slow-logs.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.9.4, 2.11.3"
        }
      ]
    },
    {
      "Id": "opensearch_service_domains_use_cognito_authentication_for_kibana",
      "Description": "Check if Amazon Elasticsearch/Opensearch Service domains has either Amazon Cognito or SAML authentication for Kibana enabled",
      "Checks": [
        "opensearch_service_domains_use_cognito_authentication_for_kibana"
      ],
      "Attributes": [
        {
          "Section": "opensearch",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Amazon Elasticsearch/Opensearch Service domains has Amazon Cognito or SAML authentication for Kibana enabled",
          "RationaleStatement": "Not enabling Amazon Cognito or SAML authentication for Kibana in AWS Elasticsearch/OpenSearch Service domains increases the likelihood of unauthorized access to sensitive data, potentially compromising system integrity.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "If you do not configure Amazon Cognito or SAML authentication, you can still protect Kibana using an IP-based access policy and a proxy server or HTTP basic authentication.",
              "Url": "https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-ac.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.3, 2.6.4"
        }
      ]
    },
    {
      "Id": "opensearch_service_domains_https_communications_enforced",
      "Description": "Check if Amazon Elasticsearch/Opensearch Service domains have enforce HTTPS enabled",
      "Checks": [
        "opensearch_service_domains_https_communications_enforced"
      ],
      "Attributes": [
        {
          "Section": "opensearch",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Amazon Elasticsearch/Opensearch Service domains have enforce HTTPS enabled",
          "RationaleStatement": "If not enable unauthorized access to your data could risk increases.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "https://docs.prowler.com/checks/aws/elasticsearch-policies/elasticsearch_6#fix---builtime",
              "Other": "https://docs.prowler.com/checks/aws/elasticsearch-policies/elasticsearch_6#aws-console",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "When creating ES Domains, enable 'Require HTTPS fo all traffic to the domain'",
              "Url": "https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-createupdatedomains.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.4, 2.7.1, 2.10.5"
        }
      ]
    },
    {
      "Id": "opensearch_service_domains_updated_to_the_latest_service_software_version",
      "Description": "Check if Amazon Elasticsearch/Opensearch Service domains have updates available",
      "Checks": [
        "opensearch_service_domains_updated_to_the_latest_service_software_version"
      ],
      "Attributes": [
        {
          "Section": "opensearch",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Amazon Elasticsearch/Opensearch Service domains have updates available",
          "RationaleStatement": "Amazon ES regularly releases system software updates that add features or otherwise improve your domains.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Elasticsearch/version.html",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Elasticsearch/version.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "The Notifications panel in the console is the easiest way to see if an update is available or check the status of an update. You can also receive these notifications through Amazon EventBridge. If you take no action on required updates, Amazon ES still updates your domain service software automatically after a certain timeframe (typically two weeks). In this situation, Amazon ES sends notifications when it starts the update and when the update is complete.",
              "Url": "https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-service-software.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.10.8"
        }
      ]
    },
    {
      "Id": "opensearch_service_domains_not_publicly_accessible",
      "Description": "Check if Amazon Opensearch/Elasticsearch domains are set as Public or if it has open policy access",
      "Checks": [
        "opensearch_service_domains_not_publicly_accessible"
      ],
      "Attributes": [
        {
          "Section": "opensearch",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Amazon Opensearch/Elasticsearch domains are set as Public or if it has open policy access",
          "RationaleStatement": "Publicly accessible services could expose sensitive data to bad actors.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Elasticsearch/elasticsearch-domain-exposed.html",
              "NativeIaC": "",
              "Other": "https://docs.prowler.com/checks/aws/public-policies/public_3#fix---runtime",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Use\u00a0 VPC endpoints for internal services.",
              "Url": "https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-vpc.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.4, 2.6.6"
        }
      ]
    },
    {
      "Id": "opensearch_service_domains_node_to_node_encryption_enabled",
      "Description": "Check if Amazon Elasticsearch/Opensearch Service domains have node-to-node encryption enabled",
      "Checks": [
        "opensearch_service_domains_node_to_node_encryption_enabled"
      ],
      "Attributes": [
        {
          "Section": "opensearch",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Amazon Elasticsearch/Opensearch Service domains have node-to-node encryption enabled",
          "RationaleStatement": "Node-to-node encryption provides an additional layer of security on top of the default features of Amazon ES. This architecture prevents potential attackers from intercepting traffic between Elasticsearch nodes and keeps the cluster secure.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Elasticsearch/node-to-node-encryption.html",
              "NativeIaC": "https://docs.prowler.com/checks/aws/elasticsearch-policies/elasticsearch_5#fix---builtime",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Elasticsearch/node-to-node-encryption.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Node-to-node encryption on new domains requires Elasticsearch 6.0 or later. Enabling the feature on existing domains requires Elasticsearch 6.7 or later. Choose the existing domain in the AWS console, Actions, and Modify encryption.",
              "Url": "https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/ntn.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.7.1, 2.7.2, 2.10.5"
        }
      ]
    },
    {
      "Id": "accessanalyzer_enabled_without_findings",
      "Description": "Check if IAM Access Analyzer is enabled without findings",
      "Checks": [
        "accessanalyzer_enabled_without_findings"
      ],
      "Attributes": [
        {
          "Section": "accessanalyzer",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if IAM Access Analyzer is enabled without findings",
          "RationaleStatement": "AWS IAM Access Analyzer helps you identify the resources in your organization and accounts, such as Amazon S3 buckets or IAM roles, that are shared with an external entity. This lets you identify unintended access to your resources and data, which is a security risk. IAM Access Analyzer uses a form of mathematical analysis called automated reasoning, which applies logic and mathematical inference to determine all possible access paths allowed by a resource policy.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws accessanalyzer create-analyzer --analyzer-name <NAME> --type <ACCOUNT|ORGANIZATION>",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Enable IAM Access Analyzer for all accounts, create analyzer and take action over it is recommendations (IAM Access Analyzer is available at no additional cost).",
              "Url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/what-is-access-analyzer.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/IAM/latest/UserGuide/what-is-access-analyzer.html",
          "ISMS-P Codes": "2.5.2, 2.6.4"
        }
      ]
    },
    {
      "Id": "accessanalyzer_enabled",
      "Description": "Check if IAM Access Analyzer is enabled",
      "Checks": [
        "accessanalyzer_enabled"
      ],
      "Attributes": [
        {
          "Section": "accessanalyzer",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if IAM Access Analyzer is enabled",
          "RationaleStatement": "AWS IAM Access Analyzer helps you identify the resources in your organization and accounts, such as Amazon S3 buckets or IAM roles, that are shared with an external entity. This lets you identify unintended access to your resources and data, which is a security risk. IAM Access Analyzer uses a form of mathematical analysis called automated reasoning, which applies logic and mathematical inference to determine all possible access paths allowed by a resource policy.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws accessanalyzer create-analyzer --analyzer-name <NAME> --type <ACCOUNT|ORGANIZATION>",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Enable IAM Access Analyzer for all accounts, create analyzer and take action over it is recommendations (IAM Access Analyzer is available at no additional cost).",
              "Url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/what-is-access-analyzer.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/IAM/latest/UserGuide/what-is-access-analyzer.html",
          "ISMS-P Codes": "2.5.2, 2.6.4"
        }
      ]
    },
    {
      "Id": "glacier_vaults_policy_public_access",
      "Description": "Check if S3 Glacier vaults have policies which allow access to everyone.",
      "Checks": [
        "glacier_vaults_policy_public_access"
      ],
      "Attributes": [
        {
          "Section": "glacier",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure CodeArtifact internal packages do not allow external public source publishing.",
          "RationaleStatement": "Vaults accessible to everyone could expose sensitive data to bad actors.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/ensure-glacier-vault-access-policy-is-not-public-by-only-allowing-specific-services-or-principals-to-access-it#terraform"
            },
            "Recommendation": {
              "Text": "Ensure vault policy does not have principle as *.",
              "Url": "https://docs.aws.amazon.com/amazonglacier/latest/dev/access-control-overview.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/amazonglacier/latest/dev/access-control-overview.html",
          "ISMS-P Codes": "2.5.2, 2.6.1, 2.6.3"
        }
      ]
    },
    {
      "Id": "lightsail_instance_automated_snapshots",
      "Description": "Check if instances have automated snapshots enabled",
      "Checks": [
        "lightsail_instance_automated_snapshots"
      ],
      "Attributes": [
        {
          "Section": "lightsail",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Amazon Lightsail automatically creates daily snapshots of your instances. These snapshots are used for automatic backups and are stored at no additional cost. It is recommended to enable automatic snapshots for your Lightsail instances.",
          "RationaleStatement": "If automatic snapshots are not enabled, you may lose data in case of accidental deletion or corruption.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "The automatic snapshot is a best practice to protect your data. It is recommended to enable automatic snapshots for your Lightsail instances.",
              "Url": "https://docs.aws.amazon.com/lightsail/latest/userguide/amazon-lightsail-changing-automatic-snapshot-time.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/lightsail/latest/userguide/amazon-lightsail-configuring-automatic-snapshots.html",
          "ISMS-P Codes": "2.1.3, 2.9.3, 2.9.7, 2.12.1, 2.12.2"
        }
      ]
    },
    {
      "Id": "lightsail_instance_public",
      "Description": "Ensure that Lightsail instances are not publicly accessible",
      "Checks": [
        "lightsail_instance_public"
      ],
      "Attributes": [
        {
          "Section": "lightsail",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure that Lightsail instances are not publicly accessible",
          "RationaleStatement": "If an instance is publicly accessible, it can be accessed by anyone on the internet. This can lead to unauthorized access to the instance and its data.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "We recommend that you disable public access to the instance and use a VPN or a bastion host to access the instance securely.",
              "Url": ""
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/lightsail/latest/userguide/understanding-public-ip-and-private-ip-addresses-in-amazon-lightsail.html#ipv4-addresses",
          "ISMS-P Codes": "2.6.1"
        }
      ]
    },
    {
      "Id": "lightsail_database_public",
      "Description": "Check if the database has the public mode.",
      "Checks": [
        "lightsail_database_public"
      ],
      "Attributes": [
        {
          "Section": "lightsail",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "The database is in public mode, which means it is exposed to the internet.",
          "RationaleStatement": "This can lead to unauthorized access to the database.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Change the database to private mode.",
              "Url": ""
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/lightsail/latest/userguide/amazon-lightsail-databases.html",
          "ISMS-P Codes": "2.6.1, 2.6.4, 2.6.6"
        }
      ]
    },
    {
      "Id": "lightsail_static_ip_unused",
      "Description": "Static IP are allocated but not attached to any instance",
      "Checks": [
        "lightsail_static_ip_unused"
      ],
      "Attributes": [
        {
          "Section": "lightsail",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Static IPs that are allocated but not attached to any instance are wasting resources and may pose a security risk if left unused for extended periods.",
          "RationaleStatement": "Unattached static IPs can be potential entry points for unauthorized access or DDoS attacks if not properly secured.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws lightsail release-static-ip --static-ip-name static-ip-name",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Release or attach any unused static IPs to ensure efficient resource utilization and minimize potential security risks.",
              "Url": ""
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/lightsail/latest/userguide/understanding-public-ip-and-private-ip-addresses-in-amazon-lightsail.html",
          "ISMS-P Codes": "2.9.1, 2.11.1"
        }
      ]
    },
    {
      "Id": "neptune_cluster_encrypted",
      "Description": "Check if Neptune Clusters storage is encrypted at rest.",
      "Checks": [
        "neptune_cluster_encrypted"
      ],
      "Attributes": [
        {
          "Section": "neptune",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Neptune Clusters storage is encrypted at rest.",
          "RationaleStatement": "Ensure that the data available on your Amazon Neptune database instances is encrypted in order to meet regulatory requirements and prevent unauthorized users from accessing sensitive information. Encryption provides an additional layer of protection by securing your Neptune databases from unauthorized access to the underlying storage. Neptune is a fast, scalable, highly secure and fully-managed graph database service that makes it easy to build and run applications that work with deeply connected datasets.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/general-policies/general_18/",
              "NativeIaC": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Neptune/encryption-enabled.html",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/general_18/"
            },
            "Recommendation": {
              "Text": "Enable Encryption. Use a CMK where possible. It will provide additional management and privacy benefits.",
              "Url": "https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-1"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-1",
          "ISMS-P Codes": "2.7.1"
        }
      ]
    },
    {
      "Id": "neptune_cluster_backup_retention",
      "Description": "Check for Neptune Clusters Backup Retention Period.",
      "Checks": [
        "neptune_cluster_backup_retention"
      ],
      "Attributes": [
        {
          "Section": "neptune",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Neptune Clusters have backup enabled.",
          "RationaleStatement": "Ensure that your Amazon Neptune graph database clusters have set a minimum backup retention period of 7 days or greater in order to achieve your organization compliance requirements. The retention period represents the number of days to retain automated snapshots.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Neptune/sufficient-backup-retention-period.html#",
              "NativeIaC": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Neptune/sufficient-backup-retention-period.html#",
              "Other": "",
              "Terraform": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Neptune/sufficient-backup-retention-period.html#"
            },
            "Recommendation": {
              "Text": "Enable automated backup for production data. Define a retention period and periodically test backup restoration. A Disaster Recovery process should be in place to govern Data Protection approach.",
              "Url": "https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-5"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-5",
          "ISMS-P Codes": "2.9.3, 2.9.7, 2.12.1, 2.12.2"
        }
      ]
    },
    {
      "Id": "neptune_cluster_iam_authentication_enabled",
      "Description": "Check if Neptune Clusters have IAM authentication enabled.",
      "Checks": [
        "neptune_cluster_iam_authentication_enabled"
      ],
      "Attributes": [
        {
          "Section": "neptune",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Neptune Clusters have IAM authentication enabled.",
          "RationaleStatement": "Ensure that IAM Database Authentication feature is enabled for your Amazon Neptune database clusters in order to make use of AWS Identity and Access Management (IAM) service to manage database access.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Neptune/iam-db-authentication.html#",
              "NativeIaC": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Neptune/iam-db-authentication.html#",
              "Other": "",
              "Terraform": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Neptune/iam-db-authentication.html#"
            },
            "Recommendation": {
              "Text": "Enable IAM authentication for Neptune Clusters.",
              "Url": "https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-7"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-7",
          "ISMS-P Codes": "2.6.4, 2.6.6"
        }
      ]
    },
    {
      "Id": "neptune_cluster_uses_public_subnet",
      "Description": "Ensure Neptune Cluster is not using a public subnet",
      "Checks": [
        "neptune_cluster_uses_public_subnet"
      ],
      "Attributes": [
        {
          "Section": "neptune",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure Neptune Cluster is not using a public subnet",
          "RationaleStatement": "There is a risk of exposing sensitive data if Neptune Cluster uses a public subnet.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "To ensure your Neptune cluster is not using a public subnet, follow the recommended remediation steps based on your preferred method.",
              "Url": "https://docs.aws.amazon.com/neptune/latest/userguide/get-started-vpc.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/neptune/latest/userguide/get-started-vpc.html",
          "ISMS-P Codes": "2.6.1, 2.6.4"
        }
      ]
    },
    {
      "Id": "neptune_cluster_multi_az_enabled",
      "Description": "Check if Neptune Clusters have multi-AZ enabled.",
      "Checks": [
        "neptune_cluster_multi_az_enabled"
      ],
      "Attributes": [
        {
          "Section": "neptune",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Neptune Clusters have multi-AZ enabled.",
          "RationaleStatement": "Ensure that your Amazon Neptune graph database clusters are using Multi-AZ deployment configurations to enhance High Availability (HA) through automatic failover to read replicas in the event of a failure such as an Availability Zone (AZ) outage, an internal hardware or network outage, a software failure or in case of planned system maintenance.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Neptune/multi-az.html#",
              "NativeIaC": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Neptune/multi-az.html#",
              "Other": "",
              "Terraform": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Neptune/multi-az.html#"
            },
            "Recommendation": {
              "Text": "Enable multi-AZ deployment for production Neptune Clusters.",
              "Url": "https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-9"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-9",
          "ISMS-P Codes": "2.9.2, 2.12.1"
        }
      ]
    },
    {
      "Id": "neptune_cluster_deletion_protection_enabled",
      "Description": "Check if Neptune Clusters storage has deletion protection enabled.",
      "Checks": [
        "neptune_cluster_deletion_protection_enabled"
      ],
      "Attributes": [
        {
          "Section": "neptune",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Neptune Clusters storage has deletion protection enabled.",
          "RationaleStatement": "Enabling cluster deletion protection offers an additional layer of protection against accidental database deletion or deletion by an unauthorized user. A Neptune DB cluster can't be deleted while deletion protection is enabled. You must first disable deletion protection before a delete request can succeed.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Enable deletion protection for production Neptune Clusters.",
              "Url": "https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-4"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-4",
          "ISMS-P Codes": "2.9.3, 2.12.1"
        }
      ]
    },
    {
      "Id": "ecr_registry_scan_images_on_push_enabled",
      "Description": "Check if ECR Registry has scan on push enabled",
      "Checks": [
        "ecr_registry_scan_images_on_push_enabled"
      ],
      "Attributes": [
        {
          "Section": "ecr",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if ECR Registry has scan on push enabled",
          "RationaleStatement": "Amazon ECR image scanning helps in identifying software vulnerabilities in your container images. Amazon ECR uses the Common Vulnerabilities and Exposures (CVEs) database from the open-source Clair project and provides a list of scan findings.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws ecr put-registry-scanning-configuration --rules 'scanFrequency=SCAN_ON_PUSH,repositoryFilters=[{filter=string,filterType=WILDCARD}]'",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Enable ECR image scanning and review the scan findings for information about the security of the container images that are being deployed.",
              "Url": "https://docs.aws.amazon.com/AmazonECR/latest/userguide/image-scanning.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.8.5, 2.9.1, 2.10.1, 2.10.9, 2.11.2, 2.11.3"
        }
      ]
    },
    {
      "Id": "ecr_repositories_scan_images_on_push_enabled",
      "Description": "[DEPRECATED] Check if ECR image scan on push is enabled",
      "Checks": [
        "ecr_repositories_scan_images_on_push_enabled"
      ],
      "Attributes": [
        {
          "Section": "ecr",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "[DEPRECATED] Check if ECR image scan on push is enabled",
          "RationaleStatement": "Amazon ECR image scanning helps in identifying software vulnerabilities in your container images. Amazon ECR uses the Common Vulnerabilities and Exposures (CVEs) database from the open-source Clair project and provides a list of scan findings.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws ecr create-repository --repository-name <repo_name> --image-scanning-configuration scanOnPush=true--region <region_name>",
              "NativeIaC": "https://docs.prowler.com/checks/aws/general-policies/general_8#cli-command",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/general_8#fix---buildtime"
            },
            "Recommendation": {
              "Text": "Enable ECR image scanning and review the scan findings for information about the security of the container images that are being deployed.",
              "Url": "https://docs.aws.amazon.com/AmazonECR/latest/userguide/image-scanning.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.10.1, 2.10.9, 2.11.2, 2.11.3"
        }
      ]
    },
    {
      "Id": "ecr_repositories_lifecycle_policy_enabled",
      "Description": "Check if ECR repositories have lifecycle policies enabled",
      "Checks": [
        "ecr_repositories_lifecycle_policy_enabled"
      ],
      "Attributes": [
        {
          "Section": "ecr",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if ECR repositories have lifecycle policies enabled",
          "RationaleStatement": "Amazon ECR repositories run the risk of retaining huge volumes of images, increasing unnecessary cost.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/ECR/lifecycle-policy-in-use.html",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Open the Amazon ECR console. Create an ECR lifecycle policy.",
              "Url": "https://docs.aws.amazon.com/AmazonECR/latest/userguide/LifecyclePolicies.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.9.1, 2.9.3"
        }
      ]
    },
    {
      "Id": "ecr_repositories_not_publicly_accessible",
      "Description": "Ensure there are no ECR repositories set as Public",
      "Checks": [
        "ecr_repositories_not_publicly_accessible"
      ],
      "Attributes": [
        {
          "Section": "ecr",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure there are no ECR repositories set as Public",
          "RationaleStatement": "A repository policy that allows anonymous access may allow anonymous users to perform actions.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "https://docs.prowler.com/checks/aws/public-policies/public_1-ecr-repositories-not-public#cloudformation",
              "Other": "https://docs.prowler.com/checks/aws/public-policies/public_1-ecr-repositories-not-public#aws-console",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Ensure the repository and its contents are not publicly accessible",
              "Url": "https://docs.aws.amazon.com/AmazonECR/latest/public/security_iam_service-with-iam.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.2, 2.6.1, 2.6.6, 2.8.5"
        }
      ]
    },
    {
      "Id": "ecr_repositories_scan_vulnerabilities_in_latest_image",
      "Description": "Check if ECR image scan found vulnerabilities in the newest image version",
      "Checks": [
        "ecr_repositories_scan_vulnerabilities_in_latest_image"
      ],
      "Attributes": [
        {
          "Section": "ecr",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if ECR image scan found vulnerabilities in the newest image version",
          "RationaleStatement": "Amazon ECR image scanning helps in identifying software vulnerabilities in your container images. Amazon ECR uses the Common Vulnerabilities and Exposures (CVEs) database from the open-source Clair project and provides a list of scan findings.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Open the Amazon ECR console. Then look for vulnerabilities and fix them.",
              "Url": "https://docs.aws.amazon.com/AmazonECR/latest/userguide/image-scanning.html#describe-scan-findings"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.8.5, 2.9.1, 2.10.9, 2.11.2, 2.11.3"
        }
      ]
    },
    {
      "Id": "dynamodb_tables_pitr_enabled",
      "Description": "Check if DynamoDB tables point-in-time recovery (PITR) is enabled.",
      "Checks": [
        "dynamodb_tables_pitr_enabled"
      ],
      "Attributes": [
        {
          "Section": "dynamodb",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if DynamoDB tables point-in-time recovery (PITR) is enabled.",
          "RationaleStatement": "If the DynamoDB Table does not have point-in-time recovery enabled, it is vulnerable to accidental write or delete operations.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws dynamodb update-continuous-backups --table-name <table_name> --point-in-time-recovery-specification PointInTimeRecoveryEnabled=true",
              "NativeIaC": "https://docs.prowler.com/checks/aws/general-policies/general_6#cloudformation--serverless",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/general_6#terraform"
            },
            "Recommendation": {
              "Text": "Enable point-in-time recovery, this is not enabled by default.",
              "Url": "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/PointInTimeRecovery_Howitworks.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/PointInTimeRecovery_Howitworks.html",
          "ISMS-P Codes": "2.9.3, 2.12.2"
        }
      ]
    },
    {
      "Id": "dynamodb_accelerator_cluster_encryption_enabled",
      "Description": "Check if DynamoDB DAX Clusters are encrypted at rest.",
      "Checks": [
        "dynamodb_accelerator_cluster_encryption_enabled"
      ],
      "Attributes": [
        {
          "Section": "dynamodb",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if DynamoDB DAX Clusters are encrypted at rest.",
          "RationaleStatement": "Encryption at rest provides an additional layer of data protection by securing your data from unauthorized access to the underlying storage.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws dax create-cluster --cluster-name <cluster_name> --node-type <node_type> --replication-factor <nodes_number> --iam-role-arn <role_arn> --sse-specification Enabled=true",
              "NativeIaC": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_23#cloudformation",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_23#terraform"
            },
            "Recommendation": {
              "Text": "Re-create the cluster to enable encryption at rest if it was not enabled at creation.",
              "Url": "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DAXEncryptionAtRest.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DAXEncryptionAtRest.html",
          "ISMS-P Codes": "2.7.1"
        }
      ]
    },
    {
      "Id": "dynamodb_table_cross_account_access",
      "Description": "DynamoDB tables should not be accessible from other AWS accounts",
      "Checks": [
        "dynamodb_table_cross_account_access"
      ],
      "Attributes": [
        {
          "Section": "dynamodb",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "This check determines if the DynamoDB table is accessible from other AWS accounts.",
          "RationaleStatement": "If the DynamoDB table is accessible from other AWS accounts, it may lead to unauthorized access to the data stored in the table.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws dynamodb delete-resource-policy --resource-arn <resource-arn>",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Ensure that the DynamoDB table is not accessible from other AWS accounts.",
              "Url": "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/rbac-bpa-rbp.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/access-control-resource-based.html",
          "ISMS-P Codes": "2.6.1, 2.6.4"
        }
      ]
    },
    {
      "Id": "dynamodb_tables_kms_cmk_encryption_enabled",
      "Description": "Check if DynamoDB table has encryption at rest enabled using CMK KMS.",
      "Checks": [
        "dynamodb_tables_kms_cmk_encryption_enabled"
      ],
      "Attributes": [
        {
          "Section": "dynamodb",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if DynamoDB table has encryption at rest enabled using CMK KMS.",
          "RationaleStatement": "All user data stored in Amazon DynamoDB is fully encrypted at rest. This functionality helps reduce the operational burden and complexity involved in protecting sensitive data.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/ensure-that-dynamodb-tables-are-encrypted#terraform"
            },
            "Recommendation": {
              "Text": "Specify an encryption key when you create a new table or switch the encryption keys on an existing table by using the AWS Management Console.",
              "Url": "https://docs.aws.amazon.com/amazondynamodbdb/latest/developerguide/EncryptionAtRest.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/amazondynamodbdb/latest/developerguide/EncryptionAtRest.html",
          "ISMS-P Codes": "2.7.1, 2.7.2"
        }
      ]
    },
    {
      "Id": "storagegateway_fileshare_encryption_enabled",
      "Description": "Check if AWS StorageGateway File Shares are encrypted with KMS CMK.",
      "Checks": [
        "storagegateway_fileshare_encryption_enabled"
      ],
      "Attributes": [
        {
          "Section": "storagegateway",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure that Amazon Storage Gateway service is using AWS KMS Customer Master Keys (CMKs) instead of AWS managed-keys (i.e. default keys) for file share data encryption, in order to have a fine-grained control over data-at-rest encryption/decryption process and meet compliance requirements. An AWS Storage Gateway file share is a file system mount point backed by Amazon S3 cloud storage.",
          "RationaleStatement": "This could provide an avenue for unauthorized access to your data by not having fine-grained control over data-at-rest encryption/decryption process and meet compliance requirements.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws storagegateway update-nfs-file-share --region us-east-1 --file-share-arn arn:aws:storagegateway:us-east-1:123456789012:share/share-abcd1234 --kms-encrypted --kms-key arn:aws:kms:us-east-1:123456789012:key/abcdabcd-1234-1234-1234-abcdabcdabcd",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/StorageGateway/file-shares-encrypted-with-cmk.html#",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Ensure that Amazon Storage Gateway service is using AWS KMS Customer Master Keys (CMKs).",
              "Url": "https://docs.aws.amazon.com/filegateway/latest/files3/encrypt-objects-stored-by-file-gateway-in-amazon-s3.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/filegateway/latest/files3/encrypt-objects-stored-by-file-gateway-in-amazon-s3.html",
          "ISMS-P Codes": "2.6.3, 2.7.1"
        }
      ]
    },
    {
      "Id": "ecs_task_definitions_no_environment_secrets",
      "Description": "Check if secrets exists in ECS task definitions environment variables",
      "Checks": [
        "ecs_task_definitions_no_environment_secrets"
      ],
      "Attributes": [
        {
          "Section": "ecs",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if secrets exists in ECS task definitions environment variables. If a secret is detected, the line number shown in the finding matches with the environment variable \"Name\" attribute starting to count at the \"environment\" key from the ECS Task Definition in JSON format.",
          "RationaleStatement": "The use of a hard-coded password increases the possibility of password guessing. If hard-coded passwords are used, it is possible that malicious users gain access through the account in question.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Use Secrets Manager or Parameter Store to securely provide credentials to containers without hardcoding the secrets in code or passing them through environment variables. It is currently not possible to delete task definition revisions which contain plaintext secrets. AWS is looking into implementing this feature in 2023, and it is therefore recommended that all plaintext secrets are rotated at the same time as moving the secrets to Secrets Manager or Parameter Store.",
              "Url": "https://docs.aws.amazon.com/AmazonECS/latest/developerguide/specifying-sensitive-data.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.4, 2.7.2, 2.11.1, 2.11.2"
        }
      ]
    },
    {
      "Id": "directoryservice_directory_log_forwarding_enabled",
      "Description": "Directory Service monitoring with CloudWatch logs.",
      "Checks": [
        "directoryservice_directory_log_forwarding_enabled"
      ],
      "Attributes": [
        {
          "Section": "directoryservice",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Directory Service monitoring with CloudWatch logs.",
          "RationaleStatement": "As a best practice, monitor your organization to ensure that changes are logged. This helps you to ensure that any unexpected change can be investigated and unwanted changes can be rolled back.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "It is recommended that that the export of logs is enabled.",
              "Url": "https://docs.aws.amazon.com/directoryservice/latest/admin-guide/incident-response.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/directoryservice/latest/admin-guide/incident-response.html",
          "ISMS-P Codes": "2.9.4, 2.11.3"
        }
      ]
    },
    {
      "Id": "directoryservice_supported_mfa_radius_enabled",
      "Description": "Ensure Multi-Factor Authentication (MFA) using Radius Server is enabled in DS.",
      "Checks": [
        "directoryservice_supported_mfa_radius_enabled"
      ],
      "Attributes": [
        {
          "Section": "directoryservice",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure Multi-Factor Authentication (MFA) using Radius Server is enabled in DS.",
          "RationaleStatement": "Multi-Factor Authentication (MFA) adds an extra layer of authentication assurance beyond traditional username and password.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Enabling MFA provides increased security to a user name and password as it requires the user to possess a solution that displays a time-sensitive authentication code.",
              "Url": "https://docs.aws.amazon.com/directoryservice/latest/admin-guide/ms_ad_mfa.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/directoryservice/latest/admin-guide/ms_ad_mfa.html",
          "ISMS-P Codes": "2.5.3, 2.5.4"
        }
      ]
    },
    {
      "Id": "directoryservice_directory_monitor_notifications",
      "Description": "Directory Service has SNS Notifications enabled.",
      "Checks": [
        "directoryservice_directory_monitor_notifications"
      ],
      "Attributes": [
        {
          "Section": "directoryservice",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Directory Service has SNS Notifications enabled.",
          "RationaleStatement": "As a best practice, monitor status of Directory Service. This helps to avoid late actions to fix Directory Service issues.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "It is recommended set up SNS messaging to send email or text messages when the status of your directory changes.",
              "Url": "https://docs.aws.amazon.com/directoryservice/latest/admin-guide/ms_ad_enable_notifications.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/directoryservice/latest/admin-guide/ms_ad_enable_notifications.html",
          "ISMS-P Codes": "2.9.4"
        }
      ]
    },
    {
      "Id": "directoryservice_radius_server_security_protocol",
      "Description": "Ensure Radius server in DS is using the recommended security protocol.",
      "Checks": [
        "directoryservice_radius_server_security_protocol"
      ],
      "Attributes": [
        {
          "Section": "directoryservice",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure Radius server in DS is using the recommended security protocol.",
          "RationaleStatement": "As a best practice, you might need to configure the authentication protocol between the Microsoft AD DCs and the RADIUS/MFA server. Supported protocols are PAP, CHAP MS-CHAPv1, and MS-CHAPv2. MS-CHAPv2 is recommended because it provides the strongest security of the three options.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "MS-CHAPv2 provides the strongest security of the options supported, and is therefore recommended.",
              "Url": "https://aws.amazon.com/blogs/security/how-to-enable-multi-factor-authentication-for-amazon-workspaces-and-amazon-quicksight-by-using-microsoft-ad-and-on-premises-credentials/"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://aws.amazon.com/blogs/security/how-to-enable-multi-factor-authentication-for-amazon-workspaces-and-amazon-quicksight-by-using-microsoft-ad-and-on-premises-credentials/",
          "ISMS-P Codes": "2.6.1, 2.7.1"
        }
      ]
    },
    {
      "Id": "directoryservice_directory_snapshots_limit",
      "Description": "Directory Service Manual Snapshots limit reached.",
      "Checks": [
        "directoryservice_directory_snapshots_limit"
      ],
      "Attributes": [
        {
          "Section": "directoryservice",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Directory Service Manual Snapshots limit reached.",
          "RationaleStatement": "A limit reached can bring unwanted results. The maximum number of manual snapshots is a hard limit.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Monitor manual snapshots limit to ensure capacity when you need it.",
              "Url": "https://docs.aws.amazon.com/general/latest/gr/ds_region.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/general/latest/gr/ds_region.html",
          "ISMS-P Codes": "2.9.2, 2.9.7"
        }
      ]
    },
    {
      "Id": "directoryservice_ldap_certificate_expiration",
      "Description": "Directory Service LDAP Certificates expiration.",
      "Checks": [
        "directoryservice_ldap_certificate_expiration"
      ],
      "Attributes": [
        {
          "Section": "directoryservice",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Directory Service Manual Snapshots limit reached.",
          "RationaleStatement": "Expired certificates can impact service availability.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Monitor certificate expiration and take automated action to alarm responsible team for taking care of the replacement or remove.",
              "Url": "https://docs.aws.amazon.com/directoryservice/latest/admin-guide/ms_ad_ldap.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/directoryservice/latest/admin-guide/ms_ad_ldap.html",
          "ISMS-P Codes": "2.7.2, 2.9.1, 2.9.3"
        }
      ]
    },
    {
      "Id": "workspaces_vpc_2private_1public_subnets_nat",
      "Description": "Ensure that the Workspaces VPC are deployed following the best practices using 1 public subnet and 2 private subnets with a NAT Gateway attached",
      "Checks": [
        "workspaces_vpc_2private_1public_subnets_nat"
      ],
      "Attributes": [
        {
          "Section": "workspaces",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure that the Workspaces VPC are deployed following the best practices using 1 public subnet and 2 private subnets with a NAT Gateway attached",
          "RationaleStatement": "Proper network segmentation is a key security best practice. Workspaces VPC should be deployed using 1 public subnet and 2 private subnets with a NAT Gateway attached",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Follow the documentation and deploy Workspaces VPC using 1 public subnet and 2 private subnets with a NAT Gateway attached",
              "Url": "https://docs.aws.amazon.com/workspaces/latest/adminguide/amazon-workspaces-vpc.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/workspaces/latest/adminguide/amazon-workspaces-vpc.html",
          "ISMS-P Codes": "2.6.1, 2.6.6"
        }
      ]
    },
    {
      "Id": "workspaces_volume_encryption_enabled",
      "Description": "Ensure that your Amazon WorkSpaces storage volumes are encrypted in order to meet security and compliance requirements",
      "Checks": [
        "workspaces_volume_encryption_enabled"
      ],
      "Attributes": [
        {
          "Section": "workspaces",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure that your Amazon WorkSpaces storage volumes are encrypted in order to meet security and compliance requirements",
          "RationaleStatement": "If the value listed in the Volume Encryption column is Disabled the selected AWS WorkSpaces instance volumes (root and user volumes) are not encrypted. Therefore your data-at-rest is not protected from unauthorized access and does not meet the compliance requirements regarding data encryption.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "https://docs.prowler.com/checks/aws/general-policies/ensure-that-workspace-root-volumes-are-encrypted#cloudformation",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/WorkSpaces/storage-encryption.html",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/ensure-that-workspace-root-volumes-are-encrypted#terraform"
            },
            "Recommendation": {
              "Text": "WorkSpaces is integrated with the AWS Key Management Service (AWS KMS). This enables you to encrypt storage volumes of WorkSpaces using AWS KMS Key. When you launch a WorkSpace you can encrypt the root volume (for Microsoft Windows - the C drive, for Linux - /) and the user volume (for Windows - the D drive, for Linux - /home). Doing so ensures that the data stored at rest - disk I/O to the volume - and snapshots created from the volumes are all encrypted",
              "Url": "https://docs.aws.amazon.com/workspaces/latest/adminguide/encrypt-workspaces.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/workspaces/latest/adminguide/encrypt-workspaces.html",
          "ISMS-P Codes": "2.7.1"
        }
      ]
    },
    {
      "Id": "elb_logging_enabled",
      "Description": "Check if Elastic Load Balancers have logging enabled.",
      "Checks": [
        "elb_logging_enabled"
      ],
      "Attributes": [
        {
          "Section": "elb",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Elastic Load Balancers have logging enabled.",
          "RationaleStatement": "If logs are not enabled monitoring of service use and threat analysis is not possible.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws elb modify-load-balancer-attributes --load-balancer-name <lb_name> --load-balancer-attributes '{AccessLog:{Enabled:true,EmitInterval:60,S3BucketName:<bucket_name>}}'",
              "NativeIaC": "https://docs.prowler.com/checks/aws/logging-policies/bc_aws_logging_23#cloudformation",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/ELB/elb-access-log.html",
              "Terraform": "https://docs.prowler.com/checks/aws/logging-policies/bc_aws_logging_23#terraform"
            },
            "Recommendation": {
              "Text": "Enable ELB logging, create a log lifecycle and define use cases.",
              "Url": "https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/access-log-collection.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.9.4, 2.9.5, 2.11.3"
        }
      ]
    },
    {
      "Id": "elb_insecure_ssl_ciphers",
      "Description": "Check if Elastic Load Balancers have insecure SSL ciphers.",
      "Checks": [
        "elb_insecure_ssl_ciphers"
      ],
      "Attributes": [
        {
          "Section": "elb",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Elastic Load Balancers have insecure SSL ciphers.",
          "RationaleStatement": "Using insecure ciphers could affect privacy of in transit information.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws elb set-load-balancer-policies-of-listener --load-balancer-name <lb_name> --load-balancer-port 443 --policy-names ELBSecurityPolicy-TLS-1-2-2017-01",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/ELB/elb-security-policy.html",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_43#terraform"
            },
            "Recommendation": {
              "Text": "Use a Security policy with ciphers that are as strong as possible. Drop legacy and insecure ciphers.",
              "Url": "https://docs.aws.amazon.com/elasticloadbalancing/latest/application/create-https-listener.html#describe-ssl-policies"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.7.1, 2.10.3, 2.10.5"
        }
      ]
    },
    {
      "Id": "elb_ssl_listeners",
      "Description": "Check if Elastic Load Balancers have SSL listeners.",
      "Checks": [
        "elb_ssl_listeners"
      ],
      "Attributes": [
        {
          "Section": "elb",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Elastic Load Balancers have SSL listeners.",
          "RationaleStatement": "Clear text communication could affect privacy of information in transit.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws elb create-load-balancer-listeners --load-balancer-name <lb_name> --listeners Protocol=HTTPS, LoadBalancerPort=443, InstanceProtocol=HTTP, InstancePort=80, SSLCertificateId=<certificate_arn>",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/ELB/elb-listener-security.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Scan for Load Balancers with HTTP or TCP listeners and understand the reason for each of them. Check if the listener can be implemented as TLS instead..",
              "Url": "https://docs.aws.amazon.com/elasticloadbalancing/latest/application/create-https-listener.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.7.1"
        }
      ]
    },
    {
      "Id": "elb_internet_facing",
      "Description": "Check for internet facing Elastic Load Balancers.",
      "Checks": [
        "elb_internet_facing"
      ],
      "Attributes": [
        {
          "Section": "elb",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check for internet facing Elastic Load Balancers.",
          "RationaleStatement": "Publicly accessible load balancers could expose sensitive data to bad actors.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/ELB/internet-facing-load-balancers.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Ensure the load balancer should be publicly accessible. If publicly exposed ensure a WAF ACL is implemented.",
              "Url": "https://docs.aws.amazon.com/waf/latest/developerguide/web-acl-associating-aws-resource.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.2, 2.6.1, 2.10.1"
        }
      ]
    },
    {
      "Id": "sqs_queues_not_publicly_accessible",
      "Description": "Check if SQS queues have policy set as Public",
      "Checks": [
        "sqs_queues_not_publicly_accessible"
      ],
      "Attributes": [
        {
          "Section": "sqs",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if SQS queues have policy set as Public",
          "RationaleStatement": "Sensitive information could be disclosed",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/SQS/sqs-queue-exposed.html",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/SQS/sqs-queue-exposed.html",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/ensure-sqs-queue-policy-is-not-public-by-only-allowing-specific-services-or-principals-to-access-it#terraform"
            },
            "Recommendation": {
              "Text": "Review service with overly permissive policies. Adhere to Principle of Least Privilege.",
              "Url": "https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-basic-examples-of-sqs-policies.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-basic-examples-of-sqs-policies.html",
          "ISMS-P Codes": "2.6.1, 2.6.6"
        }
      ]
    },
    {
      "Id": "sqs_queues_server_side_encryption_enabled",
      "Description": "Check if SQS queues have Server Side Encryption enabled",
      "Checks": [
        "sqs_queues_server_side_encryption_enabled"
      ],
      "Attributes": [
        {
          "Section": "sqs",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if SQS queues have Server Side Encryption enabled",
          "RationaleStatement": "If not enabled sensitive information in transit is not protected.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws sqs set-queue-attributes --queue-url <QUEUE_URL> --attributes KmsMasterKeyId=<KEY>",
              "NativeIaC": "https://docs.prowler.com/checks/aws/general-policies/general_16-encrypt-sqs-queue#cloudformation",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/SQS/queue-encrypted-with-kms-customer-master-keys.html",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/general_16-encrypt-sqs-queue#terraform"
            },
            "Recommendation": {
              "Text": "Enable Encryption. Use a CMK where possible. It will provide additional management and privacy benefits",
              "Url": "https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-configure-sse-existing-queue.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-configure-sse-existing-queue.html",
          "ISMS-P Codes": "2.7.1"
        }
      ]
    },
    {
      "Id": "wellarchitected_workload_no_high_or_medium_risks",
      "Description": "Check for medium and high risks identified in workloads defined in the AWS Well-Architected Tool.",
      "Checks": [
        "wellarchitected_workload_no_high_or_medium_risks"
      ],
      "Attributes": [
        {
          "Section": "wellarchitected",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "The Well-Architected Tool uses the AWS Well-Architected Framework to compare your cloud workloads against best practices across five architectural pillars: security, reliability, performance efficiency, operational excellence, and cost optimization",
          "RationaleStatement": "A given workload can have medium and/or high risks that have been identified based on answers provided to the questions in the Well-Architected Tool. These issues are architectural and operational choices that are not aligned with the best practices from the Well-Architected Framework",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/WellArchitected/findings.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "With the AWS Well-Architected Tool tool, you can analyze your workloads using a consistent process, pinpoint any medium or high-risk issues, and identify the next steps that must be taken for improvement",
              "Url": "https://aws.amazon.com/architecture/well-architected/"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://aws.amazon.com/architecture/well-architected/",
          "ISMS-P Codes": "2.1.1, 2.1.2"
        }
      ]
    },
    {
      "Id": "redshift_cluster_audit_logging",
      "Description": "Check if Redshift cluster has audit logging enabled",
      "Checks": [
        "redshift_cluster_audit_logging"
      ],
      "Attributes": [
        {
          "Section": "redshift",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Redshift cluster has audit logging enabled",
          "RationaleStatement": "If logs are not enabled, monitoring of service use and threat analysis is not possible.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Redshift/redshift-cluster-audit-logging-enabled.html",
              "NativeIaC": "https://docs.prowler.com/checks/aws/logging-policies/bc_aws_logging_12#cloudformation",
              "Other": "https://docs.prowler.com/checks/aws/logging-policies/bc_aws_logging_12#aws-console",
              "Terraform": "https://docs.prowler.com/checks/aws/logging-policies/bc_aws_logging_12#terraform"
            },
            "Recommendation": {
              "Text": "Enable logs. Create an S3 lifecycle policy. Define use cases, metrics and automated responses where applicable.",
              "Url": "https://docs.aws.amazon.com/redshift/latest/mgmt/db-auditing.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/redshift/latest/mgmt/db-auditing.html",
          "ISMS-P Codes": "2.9.4, 2.9.5, 2.11.3"
        }
      ]
    },
    {
      "Id": "redshift_cluster_public_access",
      "Description": "Check for Publicly Accessible Redshift Clusters",
      "Checks": [
        "redshift_cluster_public_access"
      ],
      "Attributes": [
        {
          "Section": "redshift",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check for Publicly Accessible Redshift Clusters",
          "RationaleStatement": "Publicly accessible services could expose sensitive data to bad actors.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Redshift/redshift-cluster-publicly-accessible.html",
              "NativeIaC": "https://docs.prowler.com/checks/aws/public-policies/public_9#cloudformation",
              "Other": "https://docs.prowler.com/checks/aws/public-policies/public_9#aws-console",
              "Terraform": "https://docs.prowler.com/checks/aws/public-policies/public_9#terraform"
            },
            "Recommendation": {
              "Text": "List all shared Redshift clusters and make sure there is a business reason for them.",
              "Url": "https://docs.aws.amazon.com/redshift/latest/mgmt/managing-clusters-vpc.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/redshift/latest/mgmt/managing-clusters-vpc.html",
          "ISMS-P Codes": "2.6.1, 2.6.2, 2.6.6"
        }
      ]
    },
    {
      "Id": "redshift_cluster_automatic_upgrades",
      "Description": "Check for Redshift Automatic Version Upgrade",
      "Checks": [
        "redshift_cluster_automatic_upgrades"
      ],
      "Attributes": [
        {
          "Section": "redshift",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check for Redshift Automatic Version Upgrade",
          "RationaleStatement": "Without automatic version upgrade enabled, a critical Redshift Cluster version can become severly out of date",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws redshift modify-cluster --cluster-identifier <cluster_id> --allow-version-upgrade",
              "NativeIaC": "https://docs.prowler.com/checks/aws/public-policies/public_9#cloudformation",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/ensure-that-redshift-clusters-allow-version-upgrade-by-default#terraform"
            },
            "Recommendation": {
              "Text": "Enabled AutomaticVersionUpgrade on Redshift Cluster",
              "Url": "https://docs.aws.amazon.com/redshift/latest/mgmt/managing-cluster-operations.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/redshift/latest/mgmt/managing-cluster-operations.html",
          "ISMS-P Codes": "2.9.1, 2.10.8"
        }
      ]
    },
    {
      "Id": "redshift_cluster_automated_snapshot",
      "Description": "Check if Redshift Clusters have automated snapshots enabled",
      "Checks": [
        "redshift_cluster_automated_snapshot"
      ],
      "Attributes": [
        {
          "Section": "redshift",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Redshift Clusters have automated snapshots enabled",
          "RationaleStatement": "If backup is not enabled, data is vulnerable. Human error or bad actors could erase or modify data.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Enable automated backup for production data. Define a retention period and periodically test backup restoration. A Disaster Recovery process should be in place to govern Data Protection approach",
              "Url": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/AWS_Redshift.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/AWS_Redshift.html",
          "ISMS-P Codes": "2.9.3, 2.9.7, 2.12.1, 2.12.2"
        }
      ]
    },
    {
      "Id": "cloudtrail_insights_exist",
      "Description": "Ensure CloudTrail Insight is enabled",
      "Checks": [
        "cloudtrail_insights_exist"
      ],
      "Attributes": [
        {
          "Section": "cloudtrail",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure CloudTrail Insight is enabled",
          "RationaleStatement": "CloudTrail Insights provides a powerful way to search and analyze CloudTrail log data using pre-built queries and machine learning algorithms. This can help you to identify potential security threats and suspicious activity in near real-time, such as unauthorized access attempts, policy changes, or resource modifications.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Enable CloudTrail Insight",
              "Url": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/logging-insights-events-with-cloudtrail.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.9.4, 2.9.5, 2.11.3"
        }
      ]
    },
    {
      "Id": "cloudtrail_bucket_requires_mfa_delete",
      "Description": "Ensure the S3 bucket CloudTrail bucket requires MFA delete",
      "Checks": [
        "cloudtrail_bucket_requires_mfa_delete"
      ],
      "Attributes": [
        {
          "Section": "cloudtrail",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure the S3 bucket CloudTrail bucket requires MFA",
          "RationaleStatement": "If the S3 bucket CloudTrail bucket does not require MFA, it can be deleted by an attacker.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws s3api put-bucket-versioning --bucket DOC-EXAMPLE-BUCKET1 --versioning-configuration Status=Enabled,MFADelete=Enabled --mfa \"SERIAL 123456\"",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Configure MFA Delete for the S3 bucket CloudTrail bucket",
              "Url": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/MultiFactorAuthenticationDelete.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.9.3, 2.11.1"
        }
      ]
    },
    {
      "Id": "cloudtrail_logs_s3_bucket_access_logging_enabled",
      "Description": "Ensure S3 bucket access logging is enabled on the CloudTrail S3 bucket",
      "Checks": [
        "cloudtrail_logs_s3_bucket_access_logging_enabled"
      ],
      "Attributes": [
        {
          "Section": "cloudtrail",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure S3 bucket access logging is enabled on the CloudTrail S3 bucket",
          "RationaleStatement": "Server access logs can assist you in security and access audits, help you learn about your customer base, and understand your Amazon S3 bill.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "https://docs.prowler.com/checks/aws/logging-policies/logging_6#aws-console",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Ensure that S3 buckets have Logging enabled. CloudTrail data events can be used in place of S3 bucket logging. If that is the case, this finding can be considered a false positive.",
              "Url": "https://docs.aws.amazon.com/AmazonS3/latest/dev/security-best-practices.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.6, 2.6.1, 2.9.4, 2.9.5, 2.10.2"
        }
      ]
    },
    {
      "Id": "cloudtrail_logs_s3_bucket_is_not_publicly_accessible",
      "Description": "Ensure the S3 bucket CloudTrail logs is not publicly accessible",
      "Checks": [
        "cloudtrail_logs_s3_bucket_is_not_publicly_accessible"
      ],
      "Attributes": [
        {
          "Section": "cloudtrail",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure the S3 bucket CloudTrail logs to is not publicly accessible",
          "RationaleStatement": "Allowing public access to CloudTrail log content may aid an adversary in identifying weaknesses in the affected accounts use or configuration.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "https://docs.prowler.com/checks/aws/logging-policies/logging_3#aws-console",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Analyze Bucket policy to validate appropriate permissions. Ensure the AllUsers principal is not granted privileges. Ensure the AuthenticatedUsers principal is not granted privileges.",
              "Url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements_principal.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.2, 2.6.6"
        }
      ]
    },
    {
      "Id": "cloudtrail_multi_region_enabled_logging_management_events",
      "Description": "Ensure CloudTrail logging management events in All Regions",
      "Checks": [
        "cloudtrail_multi_region_enabled_logging_management_events"
      ],
      "Attributes": [
        {
          "Section": "cloudtrail",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure CloudTrail logging management events in All Regions",
          "RationaleStatement": "AWS CloudTrail enables governance, compliance, operational auditing, and risk auditing of your AWS account. To meet FTR requirements, you must have management events enabled for all AWS accounts and in all regions and aggregate these logs into an Amazon Simple Storage Service (Amazon S3) bucket owned by a separate AWS account.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws cloudtrail update-trail --name <trail_name> --is-multi-region-trail",
              "NativeIaC": "",
              "Other": "https://docs.prowler.com/checks/aws/logging-policies/logging_14",
              "Terraform": "https://docs.prowler.com/checks/aws/logging-policies/logging_14#terraform"
            },
            "Recommendation": {
              "Text": "Enable CloudTrail logging management events in All Regions",
              "Url": "https://docs.prowler.com/checks/aws/logging-policies/logging_14"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.prowler.com/checks/aws/logging-policies/logging_14",
          "ISMS-P Codes": "2.5.6, 2.9.4, 2.9.5, 2.10.1, 2.10.2, 2.11.1"
        }
      ]
    },
    {
      "Id": "cloudtrail_s3_dataevents_read_enabled",
      "Description": "Check if S3 buckets have Object-level logging for read events is enabled in CloudTrail.",
      "Checks": [
        "cloudtrail_s3_dataevents_read_enabled"
      ],
      "Attributes": [
        {
          "Section": "cloudtrail",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure that all your AWS CloudTrail trails are configured to log Data events in order to record S3 object-level API operations, such as GetObject, DeleteObject and PutObject, for individual S3 buckets or for all current and future S3 buckets provisioned in your AWS account.",
          "RationaleStatement": "If logs are not enabled, monitoring of service use and threat analysis is not possible.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws cloudtrail put-event-selectors --trail-name <YOUR_TRAIL_NAME_HERE> --event-selectors '[{ 'ReadWriteType': 'ReadOnly', 'IncludeManagementEvents':true, 'DataResources': [{ 'Type': 'AWS::S3::Object', 'Values': ['arn:aws:s3'] }] }]'",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Enable logs. Create an S3 lifecycle policy. Define use cases, metrics and automated responses where applicable.",
              "Url": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/enable-cloudtrail-logging-for-s3.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.6, 2.6.1, 2.9.4, 2.9.5, 2.11.3"
        }
      ]
    },
    {
      "Id": "cloudtrail_log_file_validation_enabled",
      "Description": "Ensure CloudTrail log file validation is enabled",
      "Checks": [
        "cloudtrail_log_file_validation_enabled"
      ],
      "Attributes": [
        {
          "Section": "cloudtrail",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure CloudTrail log file validation is enabled",
          "RationaleStatement": "Enabling log file validation will provide additional integrity checking of CloudTrail logs.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws cloudtrail update-trail --name <trail_name>\u00a0 --enable-log-file-validation",
              "NativeIaC": "https://docs.prowler.com/checks/aws/logging-policies/logging_2#cloudformation",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/logging-policies/logging_2#terraform"
            },
            "Recommendation": {
              "Text": "Ensure LogFileValidationEnabled is set to true for each trail.",
              "Url": "http://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-log-filevalidation-enabling.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.9.1, 2.9.4, 2.10.1"
        }
      ]
    },
    {
      "Id": "cloudtrail_s3_dataevents_write_enabled",
      "Description": "Check if S3 buckets have Object-level logging for write events is enabled in CloudTrail.",
      "Checks": [
        "cloudtrail_s3_dataevents_write_enabled"
      ],
      "Attributes": [
        {
          "Section": "cloudtrail",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure that all your AWS CloudTrail trails are configured to log Data events in order to record S3 object-level API operations, such as GetObject, DeleteObject and PutObject, for individual S3 buckets or for all current and future S3 buckets provisioned in your AWS account.",
          "RationaleStatement": "If logs are not enabled, monitoring of service use and threat analysis is not possible.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws cloudtrail put-event-selectors --trail-name <YOUR_TRAIL_NAME_HERE> --event-selectors '[{ 'ReadWriteType': 'WriteOnly', 'IncludeManagementEvents':true, 'DataResources': [{ 'Type': 'AWS::S3::Object', 'Values': ['arn:aws:s3'] }] }]'",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Enable logs. Create an S3 lifecycle policy. Define use cases, metrics and automated responses where applicable.",
              "Url": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/enable-cloudtrail-logging-for-s3.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.6, 2.9.4, 2.9.5"
        }
      ]
    },
    {
      "Id": "cloudtrail_threat_detection_enumeration",
      "Description": "Ensure there are no potential enumeration threats in CloudTrail",
      "Checks": [
        "cloudtrail_threat_detection_enumeration"
      ],
      "Attributes": [
        {
          "Section": "cloudtrail",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "This check ensures that there are no potential enumeration threats in CloudTrail.",
          "RationaleStatement": "Potential enumeration threats in CloudTrail can lead to unauthorized access to resources.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "To remediate this issue, ensure that there are no potential enumeration threats in CloudTrail.",
              "Url": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-concepts.html#cloudtrail-concepts-logging-data-events"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.2, 2.6.3, 2.11.3"
        }
      ]
    },
    {
      "Id": "cloudtrail_cloudwatch_logging_enabled",
      "Description": "Ensure CloudTrail trails are integrated with CloudWatch Logs",
      "Checks": [
        "cloudtrail_cloudwatch_logging_enabled"
      ],
      "Attributes": [
        {
          "Section": "cloudtrail",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure CloudTrail trails are integrated with CloudWatch Logs",
          "RationaleStatement": "Sending CloudTrail logs to CloudWatch Logs will facilitate real-time and historic activity logging based on user, API, resource, and IP address, and provides opportunity to establish alarms and notifications for anomalous or sensitivity account activity.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws cloudtrail update-trail --name <trail_name> --cloudwatch-logs-log-group- arn <cloudtrail_log_group_arn> --cloudwatch-logs-role-arn <cloudtrail_cloudwatchLogs_role_arn>",
              "NativeIaC": "",
              "Other": "https://docs.prowler.com/checks/aws/logging-policies/logging_4#aws-console",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Validate that the trails in CloudTrail have an arn set in the CloudWatchLogsLogGroupArn property.",
              "Url": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/send-cloudtrail-events-to-cloudwatch-logs.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.9.4, 2.9.5, 2.11.3"
        }
      ]
    },
    {
      "Id": "cloudtrail_kms_encryption_enabled",
      "Description": "Ensure CloudTrail logs are encrypted at rest using KMS CMKs",
      "Checks": [
        "cloudtrail_kms_encryption_enabled"
      ],
      "Attributes": [
        {
          "Section": "cloudtrail",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure CloudTrail logs are encrypted at rest using KMS CMKs",
          "RationaleStatement": "By default, the log files delivered by CloudTrail to your bucket are encrypted by Amazon server-side encryption with Amazon S3-managed encryption keys (SSE-S3). To provide a security layer that is directly manageable, you can instead use server-side encryption with AWS KMS\u2013managed keys (SSE-KMS) for your CloudTrail log files.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws cloudtrail update-trail --name <trail_name> --kms-id <cloudtrail_kms_key> aws kms put-key-policy --key-id <cloudtrail_kms_key> --policy <cloudtrail_kms_key_policy>",
              "NativeIaC": "https://docs.prowler.com/checks/aws/logging-policies/logging_7#fix---buildtime",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "This approach has the following advantages: You can create and manage the CMK encryption keys yourself. You can use a single CMK to encrypt and decrypt log files for multiple accounts across all regions. You have control over who can use your key for encrypting and decrypting CloudTrail log files. You can assign permissions for the key to the users. You have enhanced security.",
              "Url": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/encrypting-cloudtrail-log-files-with-aws-kms.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.7.1, 2.7.2"
        }
      ]
    },
    {
      "Id": "cloudtrail_threat_detection_privilege_escalation",
      "Description": "Ensure there are no potential privilege escalation threats in CloudTrail",
      "Checks": [
        "cloudtrail_threat_detection_privilege_escalation"
      ],
      "Attributes": [
        {
          "Section": "cloudtrail",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "This check ensures that there are no potential privilege escalation threats in CloudTrail.",
          "RationaleStatement": "Potential privilege escalation threats in CloudTrail can lead to unauthorized access to resources.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "To remediate this issue, ensure that there are no potential privilege escalation threats in CloudTrail.",
              "Url": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-concepts.html#cloudtrail-concepts-logging-data-events"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.2, 2.6.3.2, 2.11.3"
        }
      ]
    },
    {
      "Id": "cloudtrail_multi_region_enabled",
      "Description": "Ensure CloudTrail is enabled in all regions",
      "Checks": [
        "cloudtrail_multi_region_enabled"
      ],
      "Attributes": [
        {
          "Section": "cloudtrail",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure CloudTrail is enabled in all regions",
          "RationaleStatement": "AWS CloudTrail is a web service that records AWS API calls for your account and delivers log files to you. The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws cloudtrail create-trail --name <trail_name> --bucket-name <s3_bucket_for_cloudtrail> --is-multi-region-trail aws cloudtrail update-trail --name <trail_name> --is-multi-region-trail ",
              "NativeIaC": "https://docs.prowler.com/checks/aws/logging-policies/logging_1#cloudformation",
              "Other": "https://docs.prowler.com/checks/aws/logging-policies/logging_1#aws-console",
              "Terraform": "https://docs.prowler.com/checks/aws/logging-policies/logging_1#terraform"
            },
            "Recommendation": {
              "Text": "Ensure Logging is set to ON on all regions (even if they are not being used at the moment.",
              "Url": "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrailconcepts.html#cloudtrail-concepts-management-events"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.2, 2.5.6, 2.9.2, 2.9.4, 2.9.5, 2.10.1, 2.10.2, 2.11.1"
        }
      ]
    },
    {
      "Id": "awslambda_function_no_secrets_in_code",
      "Description": "Find secrets in Lambda functions code.",
      "Checks": [
        "awslambda_function_no_secrets_in_code"
      ],
      "Attributes": [
        {
          "Section": "lambda",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Find secrets in Lambda functions code.",
          "RationaleStatement": "The use of a hard-coded password increases the possibility of password guessing.\u00a0 If hard-coded passwords are used, it is possible that malicious users gain access through the account in question.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Use Secrets Manager to securely provide database credentials to Lambda functions and secure the databases as well as use the credentials to connect and query them without hardcoding the secrets in code or passing them through environmental variables.",
              "Url": "https://docs.aws.amazon.com/secretsmanager/latest/userguide/lambda-functions.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/secretsmanager/latest/userguide/lambda-functions.html",
          "ISMS-P Codes": "2.5.4, 2.7.2, 2.11.1, 2.11.2"
        }
      ]
    },
    {
      "Id": "awslambda_function_no_secrets_in_variables",
      "Description": "Find secrets in Lambda functions variables.",
      "Checks": [
        "awslambda_function_no_secrets_in_variables"
      ],
      "Attributes": [
        {
          "Section": "lambda",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Find secrets in Lambda functions variables.",
          "RationaleStatement": "The use of a hard-coded password increases the possibility of password guessing. If hard-coded passwords are used, it is possible that malicious users gain access through the account in question.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/secrets-policies/bc_aws_secrets_3#cli-command",
              "NativeIaC": "https://docs.prowler.com/checks/aws/secrets-policies/bc_aws_secrets_3#cloudformation",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/secrets-policies/bc_aws_secrets_3#terraform"
            },
            "Recommendation": {
              "Text": "Use Secrets Manager to securely provide database credentials to Lambda functions and secure the databases as well as use the credentials to connect and query them without hardcoding the secrets in code or passing them through environmental variables.",
              "Url": "https://docs.aws.amazon.com/secretsmanager/latest/userguide/lambda-functions.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/secretsmanager/latest/userguide/lambda-functions.html",
          "ISMS-P Codes": "2.5.4, 2.7.2, 2.11.1, 2.11.2"
        }
      ]
    },
    {
      "Id": "awslambda_function_invoke_api_operations_cloudtrail_logging_enabled",
      "Description": "Check if Lambda functions invoke API operations are being recorded by CloudTrail.",
      "Checks": [
        "awslambda_function_invoke_api_operations_cloudtrail_logging_enabled"
      ],
      "Attributes": [
        {
          "Section": "lambda",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Lambda functions invoke API operations are being recorded by CloudTrail.",
          "RationaleStatement": "If logs are not enabled, monitoring of service use and threat analysis is not possible.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Make sure you are logging information about Lambda operations. Create a lifecycle and use cases for each trail.",
              "Url": "https://docs.aws.amazon.com/lambda/latest/dg/logging-using-cloudtrail.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/lambda/latest/dg/logging-using-cloudtrail.html",
          "ISMS-P Codes": "2.9.4, 2.9.5"
        }
      ]
    },
    {
      "Id": "awslambda_function_url_public",
      "Description": "Check Public Lambda Function URL.",
      "Checks": [
        "awslambda_function_url_public"
      ],
      "Attributes": [
        {
          "Section": "lambda",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check Public Lambda Function URL.",
          "RationaleStatement": "Publicly accessible services could expose sensitive data to bad actors.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws lambda update-function-url-config --region AWS_REGION --function-name FUNCTION-NAME --auth-type AWS_IAM",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Grant usage permission on a per-resource basis and applying least privilege principle.",
              "Url": "https://docs.aws.amazon.com/secretsmanager/latest/userguide/lambda-functions.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/secretsmanager/latest/userguide/lambda-functions.html",
          "ISMS-P Codes": "2.6.1, 2.6.6"
        }
      ]
    },
    {
      "Id": "awslambda_function_url_cors_policy",
      "Description": "Check Lambda Function URL CORS configuration.",
      "Checks": [
        "awslambda_function_url_cors_policy"
      ],
      "Attributes": [
        {
          "Section": "lambda",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check Lambda Function URL CORS configuration.",
          "RationaleStatement": "Publicly accessible services could expose sensitive data to bad actors.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws lambda update-function-url-config --region AWS_REGION --function-name FUNCTION-NAME --auth-type AWS_IAM --cors 'AllowOrigins=https://www.example.com,AllowMethods=*,ExposeHeaders=keep-alive,MaxAge=3600,AllowCredentials=false'",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Grant usage permission on a per-resource basis and applying least privilege principle.",
              "Url": "https://docs.aws.amazon.com/secretsmanager/latest/userguide/lambda-functions.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/secretsmanager/latest/userguide/lambda-functions.html",
          "ISMS-P Codes": "2.5.2, 2.6.1, 2.6.6"
        }
      ]
    },
    {
      "Id": "awslambda_function_using_supported_runtimes",
      "Description": "Find obsolete Lambda runtimes.",
      "Checks": [
        "awslambda_function_using_supported_runtimes"
      ],
      "Attributes": [
        {
          "Section": "lambda",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Find obsolete Lambda runtimes.",
          "RationaleStatement": "If you have functions running on a runtime that will be deprecated in the next 60 days, Lambda notifies you by email that you should prepare by migrating your function to a supported runtime. In some cases, such as security issues that require a backwards-incompatible update, or software that does not support a long-term support (LTS) schedule, advance notice might not be possible. After a runtime is deprecated, Lambda might retire it completely at any time by disabling invocation. Deprecated runtimes are not eligible for security updates or technical support.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws lambda update-function-configuration --region AWS-REGION --function-name FUNCTION-NAME --runtime 'RUNTIME'",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Test new runtimes as they are made available. Implement them in production as soon as possible.",
              "Url": "https://docs.aws.amazon.com/lambda/latest/dg/runtime-support-policy.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/lambda/latest/dg/runtime-support-policy.html",
          "ISMS-P Codes": "2.9.1, 2.10.8"
        }
      ]
    },
    {
      "Id": "awslambda_function_not_publicly_accessible",
      "Description": "Check if Lambda functions have resource-based policy set as Public.",
      "Checks": [
        "awslambda_function_not_publicly_accessible"
      ],
      "Attributes": [
        {
          "Section": "lambda",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Lambda functions have resource-based policy set as Public.",
          "RationaleStatement": "Publicly accessible services could expose sensitive data to bad actors.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Lambda/function-exposed.html",
              "NativeIaC": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Lambda/function-exposed.html",
              "Other": "",
              "Terraform": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Lambda/function-exposed.html"
            },
            "Recommendation": {
              "Text": "Grant usage permission on a per-resource basis and applying least privilege principle.",
              "Url": "https://docs.aws.amazon.com/lambda/latest/dg/access-control-resource-based.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/lambda/latest/dg/access-control-resource-based.html",
          "ISMS-P Codes": "2.6.1, 2.6.6"
        }
      ]
    },
    {
      "Id": "resourceexplorer2_indexes_found",
      "Description": "Resource Explorer Indexes Found",
      "Checks": [
        "resourceexplorer2_indexes_found"
      ],
      "Attributes": [
        {
          "Section": "resourceexplorer2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Resource Explorer Indexes Found",
          "RationaleStatement": "Not having Resource Explorer indexes can result in increased complexity and overhead in managing your resources, as well as increased risk of security and compliance issues.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Create indexes",
              "Url": "https://docs.aws.amazon.com/resource-explorer/latest/userguide/manage-service-turn-on-region.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.1.1, 2.1.2"
        }
      ]
    },
    {
      "Id": "iam_rotate_access_key_90_days",
      "Description": "Ensure access keys are rotated every 90 days or less",
      "Checks": [
        "iam_rotate_access_key_90_days"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure access keys are rotated every 90 days or less",
          "RationaleStatement": "Access keys consist of an access key ID and secret access key which are used to sign programmatic requests that you make to AWS. AWS users need their own access keys to make programmatic calls to AWS from the AWS Command Line Interface (AWS CLI)- Tools for Windows PowerShell- the AWS SDKs- or direct HTTP calls using the APIs for individual AWS services. It is recommended that all access keys be regularly rotated.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Use the credential report to\u00a0 ensure\u00a0 access_key_X_last_rotated\u00a0 is less than 90 days ago.",
              "Url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_getting-report.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.4, 2.7.2, 2.9.7"
        }
      ]
    },
    {
      "Id": "iam_customer_unattached_policy_no_administrative_privileges",
      "Description": "Ensure IAM policies that allow full \"*:*\" administrative privileges are not created",
      "Checks": [
        "iam_customer_unattached_policy_no_administrative_privileges"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure IAM policies that allow full \"*:*\" administrative privileges are not created, may be eventual consistent if an ephemeral resource is using it",
          "RationaleStatement": "IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended and considered a standard security advice to grant least privilege\u2014that is, granting only the permissions required to perform a task. Determine what users need to do and then craft policies for them that let the users perform only those tasks instead of allowing full administrative privileges. Providing full administrative privileges instead of restricting to the minimum set of permissions that the user is required to do exposes the resources to potentially unwanted actions.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/iam-policies/iam_47#cli-command",
              "NativeIaC": "",
              "Other": "https://docs.prowler.com/checks/aws/iam-policies/iam_47#aws-console",
              "Terraform": "https://docs.prowler.com/checks/aws/iam-policies/iam_47#terraform"
            },
            "Recommendation": {
              "Text": "It is more secure to start with a minimum set of permissions and grant additional permissions as necessary, rather than starting with permissions that are too lenient and then trying to tighten them later. List policies an analyze if permissions are the least possible to conduct business activities.",
              "Url": "http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.5, 2.5.6"
        }
      ]
    },
    {
      "Id": "iam_root_hardware_mfa_enabled",
      "Description": "Ensure only hardware MFA is enabled for the root account",
      "Checks": [
        "iam_root_hardware_mfa_enabled"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure only hardware MFA is enabled for the root account",
          "RationaleStatement": "The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a user name and password. With MFA enabled when a user signs in to an AWS website they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. For Level 2 it is recommended that the root account be protected with only a hardware MFA.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Using IAM console navigate to Dashboard and expand Activate MFA on your root account.",
              "Url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_root-user.html#id_root-user_manage_mfa"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.2, 2.5.3, 2.5.5"
        }
      ]
    },
    {
      "Id": "iam_user_no_setup_initial_access_key",
      "Description": "Do not setup access keys during initial user setup for all IAM users that have a console password",
      "Checks": [
        "iam_user_no_setup_initial_access_key"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Do not setup access keys during initial user setup for all IAM users that have a console password",
          "RationaleStatement": "AWS console defaults the checkbox for creating access keys to enabled. This results in many access keys being generated unnecessarily. In addition to unnecessary credentials, it also generates unnecessary management work in auditing and rotating these keys. Requiring that additional steps be taken by the user after their profile has been created will give a stronger indication of intent that access keys are (a) necessary for their work and (b) once the access key is established on an account that the keys may be in use somewhere in the organization.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "From the IAM console: generate credential report and disable not required keys.",
              "Url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_getting-report.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.2, 2.5.3"
        }
      ]
    },
    {
      "Id": "iam_no_expired_server_certificates_stored",
      "Description": "Ensure that all the expired SSL/TLS certificates stored in AWS IAM are removed.",
      "Checks": [
        "iam_no_expired_server_certificates_stored"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure that all the expired SSL/TLS certificates stored in AWS IAM are removed.",
          "RationaleStatement": "Removing expired SSL/TLS certificates eliminates the risk that an invalid certificate will be deployed accidentally to a resource such as AWS Elastic Load Balancer (ELB), which can damage the credibility of the application/website behind the ELB.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws iam delete-server-certificate --server-certificate-name <CERTIFICATE_NAME",
              "NativeIaC": "",
              "Other": "Removing expired certificates via AWS Management Console is not currently supported.",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Deleting the certificate could have implications for your application if you are using an expired server certificate with Elastic Load Balancing, CloudFront, etc. One has to make configurations at respective services to ensure there is no interruption in application functionality.",
              "Url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_server-certs.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.7.1, 2.7.2"
        }
      ]
    },
    {
      "Id": "iam_root_mfa_enabled",
      "Description": "Ensure MFA is enabled for the root account",
      "Checks": [
        "iam_root_mfa_enabled"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure MFA is enabled for the root account",
          "RationaleStatement": "The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a user name and password. With MFA enabled when a user signs in to an AWS website they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. When virtual MFA is used for root accounts it is recommended that the device used is NOT a personal device but rather a dedicated mobile device (tablet or phone) that is managed to be kept charged and secured independent of any individual personal devices. (non-personal virtual MFA) This lessens the risks of losing access to the MFA due to device loss / trade-in or if the individual owning the device is no longer employed at the company.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Using IAM console navigate to Dashboard and expand Activate MFA on your root account.",
              "Url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_root-user.html#id_root-user_manage_mfa"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.1, 2.5.2, 2.5.3, 2.5.5"
        }
      ]
    },
    {
      "Id": "iam_user_with_temporary_credentials",
      "Description": "Ensure users make use of temporary credentials assuming IAM roles",
      "Checks": [
        "iam_user_with_temporary_credentials"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure users make use of temporary credentials assuming IAM roles",
          "RationaleStatement": "As a best practice, use temporary security credentials (IAM roles) instead of creating long-term credentials like access keys, and don't create AWS account root user access keys.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "As a best practice, use temporary security credentials (IAM roles) instead of creating long-term credentials like access keys, and don't create AWS account root user access keys.",
              "Url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_temp.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_temp.html",
          "ISMS-P Codes": "2.5.2, 2.5.3"
        }
      ]
    },
    {
      "Id": "iam_support_role_created",
      "Description": "Ensure a support role has been created to manage incidents with AWS Support",
      "Checks": [
        "iam_support_role_created"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure a support role has been created to manage incidents with AWS Support",
          "RationaleStatement": "AWS provides a support center that can be used for incident notification and response, as well as technical support and customer services. Create an IAM Role to allow authorized users to manage incidents with AWS Support.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Create an IAM role for managing incidents with AWS.",
              "Url": "https://docs.aws.amazon.com/awssupport/latest/user/using-service-linked-roles-sup.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.2, 2.5.5"
        }
      ]
    },
    {
      "Id": "iam_user_hardware_mfa_enabled",
      "Description": "Check if IAM users have Hardware MFA enabled.",
      "Checks": [
        "iam_user_hardware_mfa_enabled"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if IAM users have Hardware MFA enabled.",
          "RationaleStatement": "Hardware MFA is preferred over virtual MFA.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Enable hardware MFA device for an IAM user from the AWS Management Console, the command line, or the IAM API.",
              "Url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_enable_physical.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.3"
        }
      ]
    },
    {
      "Id": "iam_inline_policy_allows_privilege_escalation",
      "Description": "Ensure no Inline IAM policies allow actions that may lead into Privilege Escalation",
      "Checks": [
        "iam_inline_policy_allows_privilege_escalation"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no Inline IAM policies allow actions that may lead into Privilege Escalation",
          "RationaleStatement": "Users with some IAM permissions are allowed to elevate their privileges up to administrator rights.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Grant usage permission on a per-resource basis and applying least privilege principle.",
              "Url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.2, 2.6.2"
        }
      ]
    },
    {
      "Id": "iam_inline_policy_no_administrative_privileges",
      "Description": "Ensure inline policies that allow full \"*:*\" administrative privileges are not associated to IAM identities",
      "Checks": [
        "iam_inline_policy_no_administrative_privileges"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure inline policies that allow full \"*:*\" administrative privileges are not associated to IAM identities",
          "RationaleStatement": "IAM policies are the means by which privileges are granted to users, groups or roles. It is recommended and considered a standard security advice to grant least privilege\u2014that is, granting only the permissions required to perform a task. Determine what users need to do and then craft policies for them that let the users perform only those tasks instead of allowing full administrative privileges. Providing full administrative privileges instead of restricting to the minimum set of permissions that the user is required to do exposes the resources to potentially unwanted actions.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/iam-policies/iam_47#cli-command",
              "NativeIaC": "",
              "Other": "https://docs.prowler.com/checks/aws/iam-policies/iam_47#aws-console",
              "Terraform": "https://docs.prowler.com/checks/aws/iam-policies/iam_47#terraform"
            },
            "Recommendation": {
              "Text": "It is more secure to start with a minimum set of permissions and grant additional permissions as necessary, rather than starting with permissions that are too lenient and then trying to tighten them later. List policies an analyze if permissions are the least possible to conduct business activities.",
              "Url": "http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.5, 2.5.6, 2.6.2"
        }
      ]
    },
    {
      "Id": "iam_aws_attached_policy_no_administrative_privileges",
      "Description": "Ensure IAM AWS-Managed policies that allow full \"*:*\" administrative privileges are not attached",
      "Checks": [
        "iam_aws_attached_policy_no_administrative_privileges"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure IAM AWS-Managed policies that allow full \"*:*\" administrative privileges are not attached",
          "RationaleStatement": "IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended and considered a standard security advice to grant least privilege\u2014that is, granting only the permissions required to perform a task. Determine what users need to do and then craft policies for them that let the users perform only those tasks instead of allowing full administrative privileges. Providing full administrative privileges instead of restricting to the minimum set of permissions that the user is required to do exposes the resources to potentially unwanted actions.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/iam-policies/iam_47#cli-command",
              "NativeIaC": "",
              "Other": "https://docs.prowler.com/checks/aws/iam-policies/iam_47#aws-console",
              "Terraform": "https://docs.prowler.com/checks/aws/iam-policies/iam_47#terraform"
            },
            "Recommendation": {
              "Text": "It is more secure to start with a minimum set of permissions and grant additional permissions as necessary, rather than starting with permissions that are too lenient and then trying to tighten them later. List policies an analyze if permissions are the least possible to conduct business activities.",
              "Url": "http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.5, 2.5.6, 2.6.2"
        }
      ]
    },
    {
      "Id": "iam_policy_allows_privilege_escalation",
      "Description": "Ensure no Customer Managed IAM policies allow actions that may lead into Privilege Escalation",
      "Checks": [
        "iam_policy_allows_privilege_escalation"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no Customer Managed IAM policies allow actions that may lead into Privilege Escalation",
          "RationaleStatement": "Users with some IAM permissions are allowed to elevate their privileges up to administrator rights.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Grant usage permission on a per-resource basis and applying least privilege principle.",
              "Url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.5, 2.5.6"
        }
      ]
    },
    {
      "Id": "iam_check_saml_providers_sts",
      "Description": "Check if there are SAML Providers then STS can be used",
      "Checks": [
        "iam_check_saml_providers_sts"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if there are SAML Providers then STS can be used",
          "RationaleStatement": "Without SAML provider users with AWS CLI or AWS API access can use IAM static credentials. SAML helps users to assume role by default each time they authenticate.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Enable SAML provider and use temporary credentials. You can use temporary security credentials to make programmatic requests for AWS resources using the AWS CLI or AWS API (using the AWS SDKs ). The temporary credentials provide the same permissions that you have with use long-term security credentials such as IAM user credentials. In case of not having SAML provider capabilities prevent usage of long-lived credentials.",
              "Url": "https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRoleWithSAML.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.3, 2.6.3"
        }
      ]
    },
    {
      "Id": "iam_policy_no_full_access_to_kms",
      "Description": "Ensure IAM policies that allow full \"kms:*\" privileges are not created",
      "Checks": [
        "iam_policy_no_full_access_to_kms"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure IAM policies that allow full \"kms:*\" privileges are not created",
          "RationaleStatement": "KMS is a critical service and IAM policies should follow least privilege model for this service in particular",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "It is more secure to start with a minimum set of permissions and grant additional permissions as necessary, rather than starting with permissions that are too lenient and then trying to tighten them later. List policies an analyze if permissions are the least possible to conduct business activities.",
              "Url": "http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.5, 2.5.6, 2.6.3, 2.7.2"
        }
      ]
    },
    {
      "Id": "iam_password_policy_number",
      "Description": "Ensure IAM password policy require at least one number",
      "Checks": [
        "iam_password_policy_number"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure IAM password policy require at least one number",
          "RationaleStatement": "Password policies are used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one number.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Ensure \"Require at least one number\" is checked under \"Password Policy\".",
              "Url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.4"
        }
      ]
    },
    {
      "Id": "iam_role_cross_service_confused_deputy_prevention",
      "Description": "Ensure IAM Service Roles prevents against a cross-service confused deputy attack",
      "Checks": [
        "iam_role_cross_service_confused_deputy_prevention"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure IAM Service Roles prevents against a cross-service confused deputy attack",
          "RationaleStatement": "Allow attackers to gain unauthorized access to resources",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Use the aws:SourceArn and aws:SourceAccount global condition context keys in trust relationship policies to limit the permissions that a service has to a specific resource",
              "Url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/confused-deputy.html#cross-service-confused-deputy-prevention"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.2, 2.11.1"
        }
      ]
    },
    {
      "Id": "iam_inline_policy_no_full_access_to_cloudtrail",
      "Description": "Ensure IAM inline policies that allow full \"cloudtrail:*\" privileges are not created",
      "Checks": [
        "iam_inline_policy_no_full_access_to_cloudtrail"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure IAM inline policies that allow full \"cloudtrail:*\" privileges are not created",
          "RationaleStatement": "CloudTrail is a critical service and IAM policies should follow least privilege model for this service in particular",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "It is more secure to start with a minimum set of permissions and grant additional permissions as necessary, rather than starting with permissions that are too lenient and then trying to tighten them later. List policies an analyze if permissions are the least possible to conduct business activities.",
              "Url": "http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.6, 2.9.5"
        }
      ]
    },
    {
      "Id": "iam_password_policy_minimum_length_14",
      "Description": "Ensure IAM password policy requires minimum length of 14 or greater",
      "Checks": [
        "iam_password_policy_minimum_length_14"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure IAM password policy requires minimum length of 14 or greater",
          "RationaleStatement": "Password policies are used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require minimum length of 14 or greater.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Ensure \"Minimum password length\" is checked under \"Password Policy\".",
              "Url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.4"
        }
      ]
    },
    {
      "Id": "iam_avoid_root_usage",
      "Description": "Avoid the use of the root accounts",
      "Checks": [
        "iam_avoid_root_usage"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Avoid the use of the root account",
          "RationaleStatement": "The root account has unrestricted access to all resources in the AWS account. It is highly recommended that the use of this account be avoided.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Follow the remediation instructions of the Ensure IAM policies are attached only to groups or roles recommendation.",
              "Url": "http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.5, 2.6.2"
        }
      ]
    },
    {
      "Id": "iam_role_cross_account_readonlyaccess_policy",
      "Description": "Ensure IAM Roles do not have ReadOnlyAccess access for external AWS accounts",
      "Checks": [
        "iam_role_cross_account_readonlyaccess_policy"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure IAM Roles do not have ReadOnlyAccess access for external AWS accounts",
          "RationaleStatement": "The AWS-managed ReadOnlyAccess policy is highly potent and exposes the customer to a significant data leakage threat. It should be granted very conservatively. For granting access to 3rd party vendors, consider using alternative managed policies, such as ViewOnlyAccess or SecurityAudit.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Remove the AWS-managed ReadOnlyAccess policy from all roles that have a trust policy, including third-party cloud accounts, or remove third-party cloud accounts from the trust policy of all roles that need the ReadOnlyAccess policy.",
              "Url": "https://docs.securestate.vmware.com/rule-docs/aws-iam-role-cross-account-readonlyaccess-policy"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_job-functions.html#awsmp_readonlyaccess",
          "ISMS-P Codes": "2.5.2, 2.5.6, 2.6.2"
        }
      ]
    },
    {
      "Id": "iam_password_policy_expires_passwords_within_90_days_or_less",
      "Description": "Ensure IAM password policy expires passwords within 90 days or less",
      "Checks": [
        "iam_password_policy_expires_passwords_within_90_days_or_less"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure IAM password policy expires passwords within 90 days or less",
          "RationaleStatement": "Password policies are used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one uppercase letter.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Ensure Password expiration period (in days): is set to 90 or less.",
              "Url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.4"
        }
      ]
    },
    {
      "Id": "iam_user_two_active_access_key",
      "Description": "Check if IAM users have two active access keys",
      "Checks": [
        "iam_user_two_active_access_key"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if IAM users have two active access keys",
          "RationaleStatement": "Access Keys could be lost or stolen. It creates a critical risk.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Avoid using long lived access keys.",
              "Url": "https://docs.aws.amazon.com/IAM/latest/APIReference/API_ListAccessKeys.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.4, 2.7.2"
        }
      ]
    },
    {
      "Id": "iam_inline_policy_no_full_access_to_kms",
      "Description": "Ensure IAM inline policies that allow full \"kms:*\" privileges are not created",
      "Checks": [
        "iam_inline_policy_no_full_access_to_kms"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure IAM inline policies that allow full \"kms:*\" privileges are not created",
          "RationaleStatement": "KMS is a critical service and IAM policies should follow least privilege model for this service in particular",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "It is more secure to start with a minimum set of permissions and grant additional permissions as necessary, rather than starting with permissions that are too lenient and then trying to tighten them later. List policies an analyze if permissions are the least possible to conduct business activities.",
              "Url": "http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.5, 2.5.6, 2.6.2, 2.7.2"
        }
      ]
    },
    {
      "Id": "iam_password_policy_symbol",
      "Description": "Ensure IAM password policy require at least one symbol",
      "Checks": [
        "iam_password_policy_symbol"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure IAM password policy require at least one symbol",
          "RationaleStatement": "Password policies are used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one non-alphanumeric character.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Ensure \"Require at least one non-alphanumeric character\" is checked under \"Password Policy\".",
              "Url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.4"
        }
      ]
    },
    {
      "Id": "iam_user_accesskey_unused",
      "Description": "Ensure User Access Keys unused are disabled",
      "Checks": [
        "iam_user_accesskey_unused"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure User Access Keys unused are disabled",
          "RationaleStatement": "To increase the security of your AWS account, remove IAM user credentials (that is, passwords and access keys) that are not needed. For example, when users leave your organization or no longer need AWS access.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Find the credentials that they were using and ensure that they are no longer operational. Ideally, you delete credentials if they are no longer needed. You can always recreate them at a later date if the need arises. At the very least, you should change the password or deactivate the access keys so that the former users no longer have access.",
              "Url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_finding-unused.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.2, 2.7.2"
        }
      ]
    },
    {
      "Id": "iam_securityaudit_role_created",
      "Description": "Ensure a Security Audit role has been created to conduct security audits",
      "Checks": [
        "iam_securityaudit_role_created"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure a Security Audit role has been created to conduct security audits",
          "RationaleStatement": "Creating an IAM role with a security audit policy provides a clear separation of duties between the security team and other teams within the organization. This helps to ensure that security-related activities are performed by authorized individuals with the appropriate expertise and access permissions.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Create an IAM role for conduct security audits with AWS.",
              "Url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_job-functions.html#jf_security-auditor"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.9.4, 2.9.5, 2.11.1"
        }
      ]
    },
    {
      "Id": "iam_no_custom_policy_permissive_role_assumption",
      "Description": "Ensure that no custom IAM policies exist which allow permissive role assumption (e.g. sts:AssumeRole on *)",
      "Checks": [
        "iam_no_custom_policy_permissive_role_assumption"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure that no custom IAM policies exist which allow permissive role assumption (e.g. sts:AssumeRole on *)",
          "RationaleStatement": "If not restricted unintended access could happen.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Use the least privilege principle when granting permissions.",
              "Url": "https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRole.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_permissions-to-switch.html#roles-usingrole-createpolicy",
          "ISMS-P Codes": "2.5.2, 2.5.4"
        }
      ]
    },
    {
      "Id": "iam_password_policy_reuse_24",
      "Description": "Ensure IAM password policy prevents password reuse: 24 or greater",
      "Checks": [
        "iam_password_policy_reuse_24"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure IAM password policy prevents password reuse: 24 or greater",
          "RationaleStatement": "Password policies are used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy prevents at least password reuse of 24 or greater.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Ensure \"Number of passwords to remember\" is set to 24.",
              "Url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.4"
        }
      ]
    },
    {
      "Id": "iam_password_policy_lowercase",
      "Description": "Ensure IAM password policy require at least one lowercase letter",
      "Checks": [
        "iam_password_policy_lowercase"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure IAM password policy requires at least one uppercase letter",
          "RationaleStatement": "Password policies are used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one lowercase letter.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Ensure \"Requires at least one lowercase letter\" is checked under \"Password Policy\".",
              "Url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.4"
        }
      ]
    },
    {
      "Id": "iam_no_root_access_key",
      "Description": "Ensure no root account access key exists",
      "Checks": [
        "iam_no_root_access_key"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no root account access key exists",
          "RationaleStatement": "The root account is the most privileged user in an AWS account. AWS Access Keys provide programmatic access to a given AWS account. It is recommended that all access keys associated with the root account be removed. Removing access keys associated with the root account limits vectors by which the account can be compromised. Removing the root access keys encourages the creation and use of role based accounts that are least privileged.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Use the credential report to check the user and ensure the access_key_1_active and access_key_2_active fields are set to FALSE.",
              "Url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_getting-report.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.1, 2.5.2, 2.5.5"
        }
      ]
    },
    {
      "Id": "iam_customer_attached_policy_no_administrative_privileges",
      "Description": "Ensure IAM Customer-Managed policies that allow full \"*:*\" administrative privileges are not attached",
      "Checks": [
        "iam_customer_attached_policy_no_administrative_privileges"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure IAM Customer-Managed policies that allow full \"*:*\" administrative privileges are not attached",
          "RationaleStatement": "IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended and considered a standard security advice to grant least privilege\u2014that is, granting only the permissions required to perform a task. Determine what users need to do and then craft policies for them that let the users perform only those tasks instead of allowing full administrative privileges. Providing full administrative privileges instead of restricting to the minimum set of permissions that the user is required to do exposes the resources to potentially unwanted actions.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/iam-policies/iam_47#cli-command",
              "NativeIaC": "",
              "Other": "https://docs.prowler.com/checks/aws/iam-policies/iam_47#aws-console",
              "Terraform": "https://docs.prowler.com/checks/aws/iam-policies/iam_47#terraform"
            },
            "Recommendation": {
              "Text": "It is more secure to start with a minimum set of permissions and grant additional permissions as necessary, rather than starting with permissions that are too lenient and then trying to tighten them later. List policies an analyze if permissions are the least possible to conduct business activities.",
              "Url": "http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.5, 2.5.6"
        }
      ]
    },
    {
      "Id": "iam_user_console_access_unused",
      "Description": "Ensure unused user console access are disabled",
      "Checks": [
        "iam_user_console_access_unused"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure unused user console access are disabled",
          "RationaleStatement": "To increase the security of your AWS account, remove IAM user credentials (that is, passwords and access keys) that are not needed. For example, when users leave your organization or no longer need AWS access.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Find the credentials that they were using and ensure that they are no longer operational. Ideally, you delete credentials if they are no longer needed. You can always recreate them at a later date if the need arises. At the very least, you should change the password or deactivate the access keys so that the former users no longer have access.",
              "Url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_finding-unused.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.1"
        }
      ]
    },
    {
      "Id": "iam_policy_attached_only_to_group_or_roles",
      "Description": "Ensure IAM policies are attached only to groups or roles",
      "Checks": [
        "iam_policy_attached_only_to_group_or_roles"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure IAM policies are attached only to groups or roles",
          "RationaleStatement": "By default IAM users, groups, and roles have no access to AWS resources. IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended that IAM policies be applied directly to groups and roles but not users. Assigning privileges at the group or role level reduces the complexity of access management as the number of users grow. Reducing access management complexity may in-turn reduce opportunity for a principal to inadvertently receive or retain excessive privileges.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Remove any policy attached directly to the user. Use groups or roles instead.",
              "Url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.1, 2.5.6"
        }
      ]
    },
    {
      "Id": "iam_policy_no_full_access_to_cloudtrail",
      "Description": "Ensure IAM policies that allow full \"cloudtrail:*\" privileges are not created",
      "Checks": [
        "iam_policy_no_full_access_to_cloudtrail"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure IAM policies that allow full \"cloudtrail:*\" privileges are not created",
          "RationaleStatement": "CloudTrail is a critical service and IAM policies should follow least privilege model for this service in particular",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "It is more secure to start with a minimum set of permissions and grant additional permissions as necessary, rather than starting with permissions that are too lenient and then trying to tighten them later. List policies an analyze if permissions are the least possible to conduct business activities.",
              "Url": "http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.6, 2.6.2"
        }
      ]
    },
    {
      "Id": "iam_user_mfa_enabled_console_access",
      "Description": "Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password.",
      "Checks": [
        "iam_user_mfa_enabled_console_access"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password.",
          "RationaleStatement": "Unauthorized access to this critical account if password is not secure or it is disclosed in any way.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Enable MFA for the user's account. MFA is a simple best practice that adds an extra layer of protection on top of your user name and password. Recommended to use hardware keys over virtual MFA.",
              "Url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_enable_virtual.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.1, 2.5.3, 2.5.4, 2.6.1, 2.6.2"
        }
      ]
    },
    {
      "Id": "iam_password_policy_uppercase",
      "Description": "Ensure IAM password policy requires at least one uppercase letter",
      "Checks": [
        "iam_password_policy_uppercase"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure IAM password policy requires at least one uppercase letter",
          "RationaleStatement": "Password policies are used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one uppercase letter.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Ensure \"Requires at least one uppercase letter\" is checked under \"Password Policy\".",
              "Url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.4"
        }
      ]
    },
    {
      "Id": "iam_role_administratoraccess_policy",
      "Description": "Ensure IAM Roles do not have AdministratorAccess policy attached",
      "Checks": [
        "iam_role_administratoraccess_policy"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure IAM Roles do not have AdministratorAccess policy attached",
          "RationaleStatement": "The AWS-managed AdministratorAccess policy grants all actions for all AWS services and for all resources in the account and as such exposes the customer to a significant data leakage threat. It should be granted very conservatively. For granting access to 3rd party vendors, consider using alternative managed policies, such as ViewOnlyAccess or SecurityAudit.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Apply the principle of least privilege. Instead of AdministratorAccess, assign only the permissions necessary for specific roles and tasks. Create custom IAM policies with minimal permissions based on the principle of least privilege.",
              "Url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_job-functions.html#jf_administrator",
          "ISMS-P Codes": "2.5.5, 2.5.6, 2.6.2"
        }
      ]
    },
    {
      "Id": "iam_administrator_access_with_mfa",
      "Description": "Ensure users of groups with AdministratorAccess policy have MFA tokens enabled",
      "Checks": [
        "iam_administrator_access_with_mfa"
      ],
      "Attributes": [
        {
          "Section": "iam",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure users of groups with AdministratorAccess policy have MFA tokens enabled",
          "RationaleStatement": "Policy may allow Anonymous users to perform actions.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Ensure this repository and its contents should be publicly accessible.",
              "Url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_enable_virtual.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.3, 2.5.5"
        }
      ]
    },
    {
      "Id": "networkfirewall_deletion_protection",
      "Description": "Ensure that Deletion Protection safety feature is enabled for your Amazon VPC network firewalls.",
      "Checks": [
        "networkfirewall_deletion_protection"
      ],
      "Attributes": [
        {
          "Section": "network-firewall",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure that Deletion Protection safety feature is enabled for your Amazon VPC network firewalls in order to protect the firewalls from being accidentally deleted. By default, Deletion Protection is disabled for VPC network firewalls.",
          "RationaleStatement": "Without a network firewall, it can be difficult to monitor and control traffic within the VPC. This can make it harder to detect and prevent attacks or unauthorized access to resources.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws network-firewall update-firewall-delete-protection --region <value> --firewall-name <value> --delete-protection",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Ensure that Deletion Protection safety feature is enabled for your Amazon VPC network firewalls.",
              "Url": "https://docs.aws.amazon.com/securityhub/latest/userguide/networkfirewall-controls.html#networkfirewall-9"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/securityhub/latest/userguide/networkfirewall-controls.html#networkfirewall-9",
          "ISMS-P Codes": "2.9.1, 2.10.1, 2.11.1"
        }
      ]
    },
    {
      "Id": "networkfirewall_in_all_vpc",
      "Description": "Ensure all VPCs have Network Firewall enabled",
      "Checks": [
        "networkfirewall_in_all_vpc"
      ],
      "Attributes": [
        {
          "Section": "network-firewall",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure all VPCs have Network Firewall enabled",
          "RationaleStatement": "Without a network firewall, it can be difficult to monitor and control traffic within the VPC. This can make it harder to detect and prevent attacks or unauthorized access to resources.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws network-firewall create-firewall --firewall-name <value> --vpc-id <value>",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/NetworkFirewall/network-firewall-in-use.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Ensure all VPCs have Network Firewall enabled",
              "Url": "https://docs.aws.amazon.com/network-firewall/latest/developerguide/vpc-config.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/network-firewall/latest/developerguide/setting-up.html",
          "ISMS-P Codes": "2.6.1, 2.10.1, 2.11.1"
        }
      ]
    },
    {
      "Id": "eks_cluster_network_policy_enabled",
      "Description": "Ensure Network Policy is Enabled and Set as Appropriate",
      "Checks": [
        "eks_cluster_network_policy_enabled"
      ],
      "Attributes": [
        {
          "Section": "eks",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure that Network Policy is enabled and set as appropriate in Amazon EKS clusters. Network Policy provides pod-level firewalling to restrict traffic between sources, enhancing network security within the cluster.",
          "RationaleStatement": "Without proper Network Policy settings, pods within the cluster may be vulnerable to unauthorized access and communication.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/EKS/security-groups.html",
              "Terraform": "https://docs.prowler.com/checks/aws/kubernetes-policies-1/bc_aws_kubernetes_1#terraform"
            },
            "Recommendation": {
              "Text": "Enable and configure Network Policy to enhance network security within the EKS cluster.",
              "Url": "https://docs.aws.amazon.com/eks/latest/userguide/eks-networking-add-ons.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/eks/latest/userguide/eks-networking-add-ons.html",
          "ISMS-P Codes": "2.6.1, 2.8.1, 2.10.1"
        }
      ]
    },
    {
      "Id": "eks_cluster_kms_cmk_encryption_in_secrets_enabled",
      "Description": "Ensure Kubernetes Secrets are encrypted using Customer Master Keys (CMKs)",
      "Checks": [
        "eks_cluster_kms_cmk_encryption_in_secrets_enabled"
      ],
      "Attributes": [
        {
          "Section": "eks",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure Kubernetes Secrets are encrypted using Customer Master Keys (CMKs)",
          "RationaleStatement": "Implementing envelope encryption is considered a security best practice for applications that store sensitive data and is part of a defense in depth security strategy.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/EKS/enable-envelope-encryption.html",
              "NativeIaC": "https://docs.prowler.com/checks/aws/kubernetes-policies-1/bc_aws_kubernetes_3#fix---builtime",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Setup your own Customer Master Key (CMK) in KMS and link this key by providing the CMK ARN when you create an EKS cluster.",
              "Url": "https://docs.aws.amazon.com/eks/latest/userguide/create-cluster.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.7.1, 2.7.2"
        }
      ]
    },
    {
      "Id": "eks_control_plane_endpoint_access_restricted",
      "Description": "Restrict Access to the EKS Control Plane Endpoint",
      "Checks": [
        "eks_control_plane_endpoint_access_restricted"
      ],
      "Attributes": [
        {
          "Section": "eks",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Restrict Access to the EKS Control Plane Endpoint",
          "RationaleStatement": "By default, this API server endpoint is public to the internet, and access to the API server is secured using a combination of AWS Identity and Access Management (IAM) and native Kubernetes Role Based Access Control (RBAC).",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws eks update-cluster-config --region <region_name> --name <cluster_name> --resources-vpc-config endpointPublicAccess=false,endpointPrivateAccess=true,publicAccessCidrs=[\"123.123.123.123/32\"]",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "You should enable private access to the Kubernetes API server so that all communication between your nodes and the API server stays within your VPC. You can limit the IP addresses that can access your API server from the internet, or completely disable internet access to the API server.",
              "Url": "https://docs.aws.amazon.com/eks/latest/userguide/cluster-endpoint.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.6, 2.10.1"
        }
      ]
    },
    {
      "Id": "eks_cluster_private_nodes_enabled",
      "Description": "Ensure Clusters are created with Private Nodes",
      "Checks": [
        "eks_cluster_private_nodes_enabled"
      ],
      "Attributes": [
        {
          "Section": "eks",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure that clusters are created with private nodes, disabling public IP addresses for cluster nodes. Private nodes have no public IP addresses, restricting access to internal networks and enhancing security.",
          "RationaleStatement": "Without private nodes, cluster nodes may have public IP addresses, increasing the attack surface and exposing them to potential threats from the internet.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws eks update-cluster-config --region region-code --name my-cluster --resources-vpc-config endpointPrivateAccess=true",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Update the cluster configuration to enable private nodes, disabling public IP addresses for cluster nodes.",
              "Url": "https://docs.aws.amazon.com/eks/latest/userguide/cluster-endpoint.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/eks/latest/userguide/private-clusters.html",
          "ISMS-P Codes": "2.6.1, 2.6.6"
        }
      ]
    },
    {
      "Id": "eks_endpoints_not_publicly_accessible",
      "Description": "Ensure EKS Clusters are created with Private Endpoint Enabled and Public Access Disabled",
      "Checks": [
        "eks_endpoints_not_publicly_accessible"
      ],
      "Attributes": [
        {
          "Section": "eks",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure EKS Clusters are created with Private Endpoint Enabled and Public Access Disabled",
          "RationaleStatement": "Publicly accessible services could expose sensitive data to bad actors.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws eks update-cluster-config --region <region_name> --name <cluster_name> --resources-vpc-config endpointPublicAccess=false,endpointPrivateAccess=true,publicAccessCidrs=[\"123.123.123.123/32\"]",
              "NativeIaC": "",
              "Other": "https://github.com/cloudmatos/matos/tree/master/remediations/aws/eks/eks-disable-public-endpoint",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Enable private access to the Kubernetes API server so that all communication between your nodes and the API server stays within your VPC. Disable internet access to the API server.",
              "Url": "https://docs.aws.amazon.com/eks/latest/userguide/infrastructure-security.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.6"
        }
      ]
    },
    {
      "Id": "eks_control_plane_logging_all_types_enabled",
      "Description": "Ensure EKS Control Plane Audit Logging is enabled for all log types",
      "Checks": [
        "eks_control_plane_logging_all_types_enabled"
      ],
      "Attributes": [
        {
          "Section": "eks",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure EKS Control Plane Audit Logging is enabled for all log types",
          "RationaleStatement": "If logs are not enabled, monitoring of service use and threat analysis is not possible.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws eks update-cluster-config --region <region_name> --name <cluster_name> --logging '{\"clusterLogging\":[{\"types\":[\"api\",\"audit\",\"authenticator\",\"controllerManager\",\"scheduler\"],\"enabled\":true}]}'",
              "NativeIaC": "",
              "Other": "https://docs.prowler.com/checks/aws/kubernetes-policies-1/bc_aws_kubernetes_4#aws-console",
              "Terraform": "https://docs.prowler.com/checks/aws/kubernetes-policies-1/bc_aws_kubernetes_4#fix---buildtime"
            },
            "Recommendation": {
              "Text": "Make sure you logging for EKS control plane is enabled.",
              "Url": "https://docs.aws.amazon.com/eks/latest/userguide/logging-monitoring.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.9.4, 2.9.5, 2.11.3"
        }
      ]
    },
    {
      "Id": "apigatewayv2_api_access_logging_enabled",
      "Description": "Ensure API Gateway V2 has Access Logging enabled.",
      "Checks": [
        "apigatewayv2_api_access_logging_enabled"
      ],
      "Attributes": [
        {
          "Section": "apigateway",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure API Gateway V2 has Access Logging enabled.",
          "RationaleStatement": "If no authorizer is enabled anyone can use the service.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "https://docs.prowler.com/checks/aws/logging-policies/bc_aws_logging_30#aws-console",
              "Terraform": "https://docs.prowler.com/checks/aws/logging-policies/bc_aws_logging_30#cloudformation"
            },
            "Recommendation": {
              "Text": "Monitoring is an important part of maintaining the reliability, availability and performance of API Gateway and your AWS solutions. You should collect monitoring data from all of the parts of your AWS solution. CloudTrail provides a record of actions taken by a user, role, or an AWS service in API Gateway. Using the information collected by CloudTrail, you can determine the request that was made to API Gateway, the IP address from which the request was made, who made the request, etc.",
              "Url": "https://docs.aws.amazon.com/apigateway/latest/developerguide/security-monitoring.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.3, 2.9.4, 2.9.5"
        }
      ]
    },
    {
      "Id": "apigatewayv2_api_authorizers_enabled",
      "Description": "Checks if API Gateway V2 has configured authorizers.",
      "Checks": [
        "apigatewayv2_api_authorizers_enabled"
      ],
      "Attributes": [
        {
          "Section": "apigateway",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Checks if API Gateway V2 has configured authorizers.",
          "RationaleStatement": "If no authorizer is enabled anyone can use the service.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Implement Amazon Cognito or a Lambda function to control access to your API",
              "Url": "https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-use-lambda-authorizer.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.3, 2.8.1"
        }
      ]
    },
    {
      "Id": "drs_job_exist",
      "Description": "Ensure DRS is enabled with jobs.",
      "Checks": [
        "drs_job_exist"
      ],
      "Attributes": [
        {
          "Section": "drs",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure DRS is enabled with jobs.",
          "RationaleStatement": "If DRS is not enabled with jobs, then it may not be able to recover from a disaster.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Ensure DRS is enabled with jobs.",
              "Url": "https://docs.aws.amazon.com/drs/latest/userguide/what-is-drs.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/drs/latest/userguide/what-is-drs.html",
          "ISMS-P Codes": "2.9.4, 2.12.1, 2.12.2"
        }
      ]
    },
    {
      "Id": "kafka_cluster_is_public",
      "Description": "Kafka Cluster Exposed to the Public",
      "Checks": [
        "kafka_cluster_is_public"
      ],
      "Attributes": [
        {
          "Section": "kafka",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "The Kafka cluster is publicly accessible, which can expose sensitive data and increase the attack surface.",
          "RationaleStatement": "Exposing the Kafka cluster to the public can lead to unauthorized access, data breaches, and potential security threats.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws kafka update-connectivity --cluster-arn cluster_arn --current-version kafka_version --connectivity-info '{\"PublicAccess\": {\"Type\": \"DISABLED\"}}'",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/MSK/public-access-msk-cluster.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "It is recommended to restrict access to the Kafka cluster to only authorized entities. Enable encryption for data in transit and at rest to protect sensitive information.",
              "Url": "https://docs.aws.amazon.com/msk/latest/developerguide/public-access.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/msk/latest/developerguide/client-access.html",
          "ISMS-P Codes": "2.6.1, 2.6.6, 2.10.5"
        }
      ]
    },
    {
      "Id": "kafka_cluster_mutual_tls_authentication_enabled",
      "Description": "Ensure Mutual TLS Authentication is Enabled for Kafka Cluster",
      "Checks": [
        "kafka_cluster_mutual_tls_authentication_enabled"
      ],
      "Attributes": [
        {
          "Section": "kafka",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Mutual TLS Authentication ensures that both the client and the server are authenticated, providing an additional layer of security for communication within the Kafka cluster.",
          "RationaleStatement": "Without Mutual TLS Authentication, the cluster is vulnerable to man-in-the-middle attacks, and unauthorized clients may be able to access the cluster.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/MSK/enable-mutual-tls-authentication-for-kafka-clients.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "It is recommended to enable Mutual TLS Authentication for your Kafka cluster to ensure secure communication between clients and brokers.",
              "Url": "https://docs.aws.amazon.com/msk/latest/developerguide/msk-update-security.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/msk/latest/developerguide/msk-authentication.html",
          "ISMS-P Codes": "2.6.2, 2.7.1, 2.10.9"
        }
      ]
    },
    {
      "Id": "kafka_cluster_unrestricted_access_disabled",
      "Description": "Ensure Kafka Cluster has unrestricted access disabled",
      "Checks": [
        "kafka_cluster_unrestricted_access_disabled"
      ],
      "Attributes": [
        {
          "Section": "kafka",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Kafka Clusters should not have unrestricted access enabled. Unrestricted access allows anyone to access the Kafka Cluster without any authentication. It is recommended to disable unrestricted access to prevent unauthorized access to the Kafka Cluster.",
          "RationaleStatement": "Unrestricted access to Kafka Clusters can lead to unauthorized access to the cluster and its data. It is recommended to restrict access to Kafka Clusters to only authorized entities.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws kafka update-security --region region_name --cluster-arn cluster_arn --current-version kafka_version_of_cluster --client-authentication 'Unauthenticated={Enabled=false}'",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/MSK/unrestricted-access-to-brokers.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "It is recommended to restrict access to Kafka Clusters to only authorized entities. Ensure that the Kafka Cluster's security settings are properly configured to prevent unauthorized access.",
              "Url": "https://docs.aws.amazon.com/msk/latest/developerguide/security.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/msk/latest/developerguide/msk-configure-security.html",
          "ISMS-P Codes": "2.5.3, 2.6.1, 2.6.2"
        }
      ]
    },
    {
      "Id": "kafka_cluster_enhanced_monitoring_enabled",
      "Description": "Ensure Enhanced Monitoring is Enabled for MSK (Kafka) Brokers",
      "Checks": [
        "kafka_cluster_enhanced_monitoring_enabled"
      ],
      "Attributes": [
        {
          "Section": "kafka",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Enhanced monitoring provides additional visibility into the performance and behavior of MSK (Kafka) brokers. By enabling enhanced monitoring, you can gain insights into potential issues and optimize the performance of your Kafka clusters.",
          "RationaleStatement": "Without enhanced monitoring, you may have limited visibility into the performance and health of your MSK brokers, which could lead to undetected issues and potential performance degradation.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws kafka update-monitoring --region region_cluster --cluster-arn arn_cluster --current-version version_cluster --enhanced-monitoring PER_BROKER",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/MSK/enable-enhanced-monitoring-for-apache-kafka-brokers.html#",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "It is recommended to enable enhanced monitoring for MSK (Kafka) brokers to gain deeper insights into the performance and behavior of your clusters.",
              "Url": "https://docs.aws.amazon.com/msk/latest/developerguide/metrics-details.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/msk/latest/developerguide/monitoring.html",
          "ISMS-P Codes": "2.9.2, 2.9.4"
        }
      ]
    },
    {
      "Id": "kafka_cluster_encryption_at_rest_uses_cmk",
      "Description": "Ensure Kafka Cluster Encryption at Rest Uses Customer Managed Keys (CMK)",
      "Checks": [
        "kafka_cluster_encryption_at_rest_uses_cmk"
      ],
      "Attributes": [
        {
          "Section": "kafka",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Kafka Cluster data stored at rest should be encrypted using Customer Managed Keys (CMK) for enhanced security and control over the encryption process.",
          "RationaleStatement": "Using default AWS-managed encryption keys might not meet certain compliance or regulatory requirements. With CMKs, you have more control over the encryption process and can rotate keys, define access policies, and enable key auditing.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/MSK/msk-encryption-at-rest-with-cmk.html",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_32/#terraform"
            },
            "Recommendation": {
              "Text": "It is recommended to use Customer Managed Keys (CMK) for Kafka Cluster encryption at rest to maintain control and flexibility over the encryption process.",
              "Url": "https://docs.aws.amazon.com/msk/latest/developerguide/msk-working-with-encryption.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/msk/latest/developerguide/msk-encryption.html",
          "ISMS-P Codes": "2.7.1, 2.7.2"
        }
      ]
    },
    {
      "Id": "kafka_cluster_uses_latest_version",
      "Description": "MSK cluster should use the latest version.",
      "Checks": [
        "kafka_cluster_uses_latest_version"
      ],
      "Attributes": [
        {
          "Section": "kafka",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure that your Amazon Managed Streaming for Apache Kafka (MSK) cluster is using the latest version to benefit from the latest security features, bug fixes, and performance improvements.",
          "RationaleStatement": "Running an outdated version of Amazon MSK may expose your cluster to security vulnerabilities, bugs, and performance issues.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws kafka update-cluster-configuration --cluster-arn <arn_cluster> --current-version <current_version> --target-version <latest_version>",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/MSK/enable-apache-kafka-latest-security-features.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "To upgrade your Amazon MSK cluster to the latest version, use the AWS Management Console, AWS CLI, or SDKs to update the cluster configuration. For more information, refer to the official Amazon MSK documentation.",
              "Url": "https://docs.aws.amazon.com/msk/latest/developerguide/version-support.html#version-upgrades"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/lightsail/latest/userguide/amazon-lightsail-databases.html",
          "ISMS-P Codes": "2.10.8"
        }
      ]
    },
    {
      "Id": "kafka_cluster_in_transit_encryption_enabled",
      "Description": "Ensure Kafka Cluster Encryption in Transit is Enabled",
      "Checks": [
        "kafka_cluster_in_transit_encryption_enabled"
      ],
      "Attributes": [
        {
          "Section": "kafka",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Kafka clusters should have encryption in transit enabled to protect data as it travels across the network. This ensures that data is encrypted when transmitted between clients and brokers, preventing unauthorized access or data breaches.",
          "RationaleStatement": "If encryption in transit is not enabled, data transmitted over the network could be vulnerable to eavesdropping or man-in-the-middle attacks.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_32/#cli",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/MSK/encryption-in-transit-for-msk.html",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_32/#terraform"
            },
            "Recommendation": {
              "Text": "It is recommended to enable encryption in transit for Kafka clusters to protect data confidentiality and integrity.",
              "Url": "https://docs.aws.amazon.com/msk/latest/developerguide/msk-working-with-encryption.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/msk/latest/developerguide/msk-encryption.html",
          "ISMS-P Codes": "2.7.1, 2.10.5, 2.10.9"
        }
      ]
    },
    {
      "Id": "dlm_ebs_snapshot_lifecycle_policy_exists",
      "Description": "Ensure EBS Snapshot lifecycle policies are defined.",
      "Checks": [
        "dlm_ebs_snapshot_lifecycle_policy_exists"
      ],
      "Attributes": [
        {
          "Section": "dlm",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure EBS Snapshot lifecycle policies are defined.",
          "RationaleStatement": "With AWS DLM service, you can manage the lifecycle of your EBS volume snapshots. By automating the EBS volume backup management using lifecycle policies, you can protect your EBS data by enforcing a regular backup schedule, retain backups as required by auditors or internal compliance.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws dlm create-lifecycle-policy --region <region> --execution-role-arn <execution-role-arn> --description <description> --state ENABLED --policy-details file://lifecycle-policy-config.json",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/DLM/ebs-snapshot-automation.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "To use Amazon Data Lifecycle Manager (DLM) service to manage the lifecycle of your EBS volume snapshots, you have to tag your AWS EBS volumes and create data lifecycle policies via Amazon DLM.",
              "Url": "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/snapshot-lifecycle.html#dlm-elements"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/snapshot-lifecycle.html#dlm-elements",
          "ISMS-P Codes": "2.1.3, 2.9.3, 2.9.7, 2.12.1, 2.12.2"
        }
      ]
    },
    {
      "Id": "vpc_peering_routing_tables_with_least_privilege",
      "Description": "Ensure routing tables for VPC peering are least access.",
      "Checks": [
        "vpc_peering_routing_tables_with_least_privilege"
      ],
      "Attributes": [
        {
          "Section": "vpc",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure routing tables for VPC peering are least access.",
          "RationaleStatement": "Being highly selective in peering routing tables is a very effective way of minimizing the impact of breach as resources outside of these routes are inaccessible to the peered VPC.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/networking-policies/networking_5#cli-command",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/VPC/vpc-peering-access.html#",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Review routing tables of peered VPCs for whether they route all subnets of each VPC and whether that is necessary to accomplish the intended purposes for peering the VPCs.",
              "Url": "https://docs.aws.amazon.com/vpc/latest/peering/peering-configurations-partial-access.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1"
        }
      ]
    },
    {
      "Id": "vpc_subnet_no_public_ip_by_default",
      "Description": "Ensure VPC subnets do not assign public IP by default",
      "Checks": [
        "vpc_subnet_no_public_ip_by_default"
      ],
      "Attributes": [
        {
          "Section": "vpc",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure VPC subnets do not assign public IP by default",
          "RationaleStatement": "VPC subnet is a part of the VPC having its own rules for traffic. Assigning the Public IP to the subnet automatically (on launch) can accidentally expose the instances within this subnet to internet and should be edited to 'No' post creation of the Subnet.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default#terraform"
            },
            "Recommendation": {
              "Text": "VPC subnets should not allow automatic public IP assignment",
              "Url": "https://docs.aws.amazon.com/config/latest/developerguide/subnet-auto-assign-public-ip-disabled.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/config/latest/developerguide/subnet-auto-assign-public-ip-disabled.html",
          "ISMS-P Codes": "2.6.1, 2.6.6"
        }
      ]
    },
    {
      "Id": "vpc_subnet_different_az",
      "Description": "Ensure all VPC has subnets in more than one availability zone",
      "Checks": [
        "vpc_subnet_different_az"
      ],
      "Attributes": [
        {
          "Section": "vpc",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure all VPC has subnets in more than one availability zone",
          "RationaleStatement": "No rationale provided.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws ec2 create-subnet",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Ensure all VPC has subnets in more than one availability zone",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/configure-subnets.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/vpc/latest/userguide/configure-subnets.html",
          "ISMS-P Codes": "2.9.2, 2.12.1"
        }
      ]
    },
    {
      "Id": "vpc_endpoint_services_allowed_principals_trust_boundaries",
      "Description": "Find trust boundaries in VPC endpoint services allowlisted principles.",
      "Checks": [
        "vpc_endpoint_services_allowed_principals_trust_boundaries"
      ],
      "Attributes": [
        {
          "Section": "vpc",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Find trust boundaries in VPC endpoint services allowlisted principles.",
          "RationaleStatement": "Account VPC could be linked to other accounts.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "https://docs.prowler.com/checks/aws/networking-policies/networking_9#aws-vpc-endpoints-are-exposed",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "In multi Account environments identify untrusted links. Check trust chaining and dependencies between accounts.",
              "Url": "https://docs.aws.amazon.com/vpc/latest/privatelink/vpc-endpoints-access.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.2"
        }
      ]
    },
    {
      "Id": "vpc_endpoint_connections_trust_boundaries",
      "Description": "Find trust boundaries in VPC endpoint connections.",
      "Checks": [
        "vpc_endpoint_connections_trust_boundaries"
      ],
      "Attributes": [
        {
          "Section": "vpc",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Find trust boundaries in VPC endpoint connections.",
          "RationaleStatement": "Account VPC could be linked to other accounts.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "https://docs.prowler.com/checks/aws/networking-policies/networking_9#aws-vpc-endpoints-are-exposed",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "In multi Account environments identify untrusted links. Check trust chaining and dependencies between accounts.",
              "Url": "https://docs.aws.amazon.com/vpc/latest/privatelink/vpc-endpoints-access.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.2"
        }
      ]
    },
    {
      "Id": "vpc_flow_logs_enabled",
      "Description": "Ensure VPC Flow Logging is Enabled in all VPCs.",
      "Checks": [
        "vpc_flow_logs_enabled"
      ],
      "Attributes": [
        {
          "Section": "vpc",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure VPC Flow Logging is Enabled in all VPCs.",
          "RationaleStatement": "VPC Flow Logs provide visibility into network traffic that traverses the VPC and can be used to detect anomalous traffic or insight during security workflows.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "https://docs.prowler.com/checks/aws/logging-policies/logging_9-enable-vpc-flow-logging#aws-console",
              "Terraform": "https://docs.prowler.com/checks/aws/logging-policies/logging_9-enable-vpc-flow-logging#terraform"
            },
            "Recommendation": {
              "Text": "It is recommended that VPC Flow Logs be enabled for packet Rejects for VPCs.",
              "Url": "http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/flow-logs.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.9.4, 2.9.5, 2.11.1"
        }
      ]
    },
    {
      "Id": "vpc_different_regions",
      "Description": "Ensure there are VPCs in more than one region",
      "Checks": [
        "vpc_different_regions"
      ],
      "Attributes": [
        {
          "Section": "vpc",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure there are VPCs in more than one region",
          "RationaleStatement": "No rationale provided.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws ec2 create-vpc",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Ensure there are VPCs in more than one region",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/vpc-example-private-subnets-nat.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_Scenario2.html",
          "ISMS-P Codes": "2.9.2, 2.12.1"
        }
      ]
    },
    {
      "Id": "vpc_subnet_separate_private_public",
      "Description": "Ensure all VPC has public and private subnets defined",
      "Checks": [
        "vpc_subnet_separate_private_public"
      ],
      "Attributes": [
        {
          "Section": "vpc",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure all VPC has public and private subnets defined",
          "RationaleStatement": "No rationale provided.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws ec2 create-subnet",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Ensure all VPC has public and private subnets defined",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_Scenario2.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_Scenario2.html",
          "ISMS-P Codes": "2.6.1"
        }
      ]
    },
    {
      "Id": "codeartifact_packages_external_public_publishing_disabled",
      "Description": "Ensure CodeArtifact internal packages do not allow external public source publishing.",
      "Checks": [
        "codeartifact_packages_external_public_publishing_disabled"
      ],
      "Attributes": [
        {
          "Section": "codeartifact",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure CodeArtifact internal packages do not allow external public source publishing.",
          "RationaleStatement": "Allowing package versions of a package to be added both by direct publishing and ingesting from public repositories makes you vulnerable to a dependency substitution attack.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws codeartifact put-package-origin-configuration --package 'MyPackage' --namespace 'MyNamespace' --domain 'MyDomain' --repository 'MyRepository' --domain-owner 'MyOwnerAccount' --format 'MyFormat' --restrictions 'publish=ALLOW,upstream=BLOCK'",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Configure package origin controls on a package in a repository to limit how versions of that package can be added to the repository.",
              "Url": "https://docs.aws.amazon.com/codeartifact/latest/ug/package-origin-controls.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/codeartifact/latest/ug/package-origin-controls.html",
          "ISMS-P Codes": "2.8.1, 2.8.5"
        }
      ]
    },
    {
      "Id": "guardduty_no_high_severity_findings",
      "Description": "There are High severity GuardDuty findings",
      "Checks": [
        "guardduty_no_high_severity_findings"
      ],
      "Attributes": [
        {
          "Section": "guardduty",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "There are High severity GuardDuty findings",
          "RationaleStatement": "If critical findings are not addressed threats can spread in the environment.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/GuardDuty/findings.html",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/GuardDuty/findings.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Review and remediate critical GuardDuty findings as quickly as possible.",
              "Url": "https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_findings.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_findings.html",
          "ISMS-P Codes": "1.4.2, 2.11.1, 2.11.3"
        }
      ]
    },
    {
      "Id": "guardduty_is_enabled",
      "Description": "Check if GuardDuty is enabled",
      "Checks": [
        "guardduty_is_enabled"
      ],
      "Attributes": [
        {
          "Section": "guardduty",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if GuardDuty is enabled",
          "RationaleStatement": "Amazon GuardDuty is a continuous security monitoring service that analyzes and processes several datasources.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/GuardDuty/guardduty-enabled.html",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/GuardDuty/guardduty-enabled.html",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/ensure-guardduty-is-enabled-to-specific-orgregion#fix---buildtime"
            },
            "Recommendation": {
              "Text": "Enable GuardDuty and analyze its findings.",
              "Url": "https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_settingup.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_settingup.html",
          "ISMS-P Codes": "1.3.1, 2.9.5, 2.10.9, 2.11.1, 2.11.3"
        }
      ]
    },
    {
      "Id": "guardduty_centrally_managed",
      "Description": "GuardDuty is centrally managed",
      "Checks": [
        "guardduty_centrally_managed"
      ],
      "Attributes": [
        {
          "Section": "guardduty",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "GuardDuty is centrally managed",
          "RationaleStatement": "If GuardDuty is not centrally managed, it is not possible to centrally manage the GuardDuty findings, settings, and member accounts.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Configure GuardDuty to be centrally managed",
              "Url": "https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_accounts.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_accounts.html",
          "ISMS-P Codes": "2.9.5, 2.10.1"
        }
      ]
    },
    {
      "Id": "trustedadvisor_premium_support_plan_subscribed",
      "Description": "Check if a Premium support plan is subscribed",
      "Checks": [
        "trustedadvisor_premium_support_plan_subscribed"
      ],
      "Attributes": [
        {
          "Section": "support",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if a Premium support plan is subscribed.",
          "RationaleStatement": "Ensure that the appropriate support level is enabled for the necessary AWS accounts. For example, if an AWS account is being used to host production systems and environments, it is highly recommended that the minimum AWS Support Plan should be Business.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/Support/support-plan.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "It is recommended that you subscribe to the AWS Business Support tier or higher for all of your AWS production accounts. If you don't have premium support, you must have an action plan to handle issues which require help from AWS Support. AWS Support provides a mix of tools and technology, people, and programs designed to proactively help you optimize performance, lower costs, and innovate faster.",
              "Url": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/Support/support-plan.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://aws.amazon.com/premiumsupport/plans/",
          "ISMS-P Codes": "1.3.1, 2.11.1"
        }
      ]
    },
    {
      "Id": "trustedadvisor_errors_and_warnings",
      "Description": "Check Trusted Advisor for errors and warnings.",
      "Checks": [
        "trustedadvisor_errors_and_warnings"
      ],
      "Attributes": [
        {
          "Section": "trustedadvisor",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check Trusted Advisor for errors and warnings.",
          "RationaleStatement": "Improve the security of your application by closing gaps, enabling various AWS security features and examining your permissions.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/TrustedAdvisor/checks.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Review and act upon its recommendations.",
              "Url": "https://aws.amazon.com/premiumsupport/technology/trusted-advisor/best-practice-checklist/"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://aws.amazon.com/premiumsupport/technology/trusted-advisor/best-practice-checklist/",
          "ISMS-P Codes": "2.1.1, 2.9.5, 2.10.2"
        }
      ]
    },
    {
      "Id": "dms_instance_not_public",
      "Description": "Ensure DMS instances are not publicly accessible.",
      "Checks": [
        "dms_instance_not_public"
      ],
      "Attributes": [
        {
          "Section": "dms",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure DMS instances are not publicly accessible.",
          "RationaleStatement": "Ensure that your Amazon Database Migration Service (DMS) are not publicly accessible from the Internet in order to avoid exposing private data and minimize security risks. A DMS replication instance should have a private IP address and the Publicly Accessible feature disabled when both the source and the target databases are in the same network that is connected to the instance's VPC through a VPN, VPC peering connection, or using an AWS Direct Connect dedicated connection.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DMS/publicly-accessible.html#",
              "NativeIaC": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DMS/publicly-accessible.html#",
              "Other": "",
              "Terraform": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DMS/publicly-accessible.html#"
            },
            "Recommendation": {
              "Text": "Restrict DMS Replication instances security groups to only required IPs, or re-create these instances that is only accessible privately.",
              "Url": "https://docs.aws.amazon.com/securityhub/latest/userguide/dms-controls.html#dms-1"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/securityhub/latest/userguide/dms-controls.html#dms-1",
          "ISMS-P Codes": "2.6.1, 2.6.6, 2.10.2"
        }
      ]
    },
    {
      "Id": "dms_instance_minor_version_upgrade_enabled",
      "Description": "Ensure DMS instances have auto minor version upgrade enabled.",
      "Checks": [
        "dms_instance_minor_version_upgrade_enabled"
      ],
      "Attributes": [
        {
          "Section": "dms",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure DMS instances have auto minor version upgrade enabled.",
          "RationaleStatement": "Ensure that your Amazon Database Migration Service (DMS) replication instances have the Auto Minor Version Upgrade feature enabled in order to receive automatically minor engine upgrades.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DMS/auto-minor-version-upgrade.html#",
              "NativeIaC": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DMS/auto-minor-version-upgrade.html#",
              "Other": "",
              "Terraform": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DMS/auto-minor-version-upgrade.html#"
            },
            "Recommendation": {
              "Text": "Enable auto minor version upgrade for all DMS replication instances.",
              "Url": "https://docs.aws.amazon.com/securityhub/latest/userguide/dms-controls.html#dms-6"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/securityhub/latest/userguide/dms-controls.html#dms-6",
          "ISMS-P Codes": "2.9.1, 2.10.8"
        }
      ]
    },
    {
      "Id": "dms_instance_multi_az_enabled",
      "Description": "Ensure DMS instances have multi az enabled.",
      "Checks": [
        "dms_instance_multi_az_enabled"
      ],
      "Attributes": [
        {
          "Section": "dms",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure DMS instances have multi az enabled.",
          "RationaleStatement": "Ensure that your Amazon Database Migration Service (DMS) replication instances are using Multi-AZ deployment configurations to provide High Availability (HA) through automatic failover to standby replicas in the event of a failure such as an Availability Zone (AZ) outage, an internal hardware or network outage, a software failure or in case of a planned maintenance session.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DMS/multi-az.html#",
              "NativeIaC": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DMS/multi-az.html#",
              "Other": "",
              "Terraform": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DMS/multi-az.html#"
            },
            "Recommendation": {
              "Text": "Enable multi az for all DMS replication instances.",
              "Url": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DMS/multi-az.html#"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DMS/multi-az.html#",
          "ISMS-P Codes": "2.9.2, 2.12.1"
        }
      ]
    },
    {
      "Id": "account_maintain_current_contact_details",
      "Description": "Maintain current contact details.",
      "Checks": [
        "account_maintain_current_contact_details"
      ],
      "Attributes": [
        {
          "Section": "account",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Maintain current contact details.",
          "RationaleStatement": "Ensure contact email and telephone details for AWS accounts are current and map to more than one individual in your organization. An AWS account supports a number of contact details, and AWS will use these to contact the account owner if activity judged to be in breach of Acceptable Use Policy. If an AWS account is observed to be behaving in a prohibited or suspicious manner, AWS will attempt to contact the account owner by email and phone using the contact details listed. If this is unsuccessful and the account behavior needs urgent mitigation, proactive measures may be taken, including throttling of traffic between the account exhibiting suspicious behavior and the AWS API endpoints and the Internet. This will result in impaired service to and from the account in question.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "No command available.",
              "NativeIaC": "",
              "Other": "https://docs.prowler.com/checks/aws/iam-policies/iam_18-maintain-contact-details#aws-console",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Using the Billing and Cost Management console complete contact details.",
              "Url": "https://docs.aws.amazon.com/accounts/latest/reference/manage-acct-update-contact.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "1.2.4, 1.3.1, 2.1.1, 2.5.2, 2.11.1"
        }
      ]
    },
    {
      "Id": "account_maintain_different_contact_details_to_security_billing_and_operations",
      "Description": "Maintain different contact details to security, billing and operations.",
      "Checks": [
        "account_maintain_different_contact_details_to_security_billing_and_operations"
      ],
      "Attributes": [
        {
          "Section": "account",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Maintain different contact details to security, billing and operations.",
          "RationaleStatement": "Ensure contact email and telephone details for AWS accounts are current and map to more than one individual in your organization. An AWS account supports a number of contact details, and AWS will use these to contact the account owner if activity judged to be in breach of Acceptable Use Policy. If an AWS account is observed to be behaving in a prohibited or suspicious manner, AWS will attempt to contact the account owner by email and phone using the contact details listed. If this is unsuccessful and the account behavior needs urgent mitigation, proactive measures may be taken, including throttling of traffic between the account exhibiting suspicious behavior and the AWS API endpoints and the Internet. This will result in impaired service to and from the account in question.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "https://docs.prowler.com/checks/aws/iam-policies/iam_18-maintain-contact-details#aws-console",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Using the Billing and Cost Management console complete contact details.",
              "Url": "https://docs.aws.amazon.com/accounts/latest/reference/manage-acct-update-contact.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/accounts/latest/reference/manage-acct-update-contact.html",
          "ISMS-P Codes": "1.2.4, 1.3.1, 2.1.1, 2.5.2, 2.11.1"
        }
      ]
    },
    {
      "Id": "account_security_questions_are_registered_in_the_aws_account",
      "Description": "Ensure security questions are registered in the AWS account.",
      "Checks": [
        "account_security_questions_are_registered_in_the_aws_account"
      ],
      "Attributes": [
        {
          "Section": "account",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure security questions are registered in the AWS account.",
          "RationaleStatement": "The AWS support portal allows account owners to establish security questions that can be used to authenticate individuals calling AWS customer service for support. It is recommended that security questions be established. When creating a new AWS account a default super user is automatically created. This account is referred to as the root account. It is recommended that the use of this account be limited and highly controlled. During events in which the root password is no longer accessible or the MFA token associated with root is lost/destroyed it is possible through authentication using secret questions and associated answers to recover root login access.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "No command available.",
              "NativeIaC": "",
              "Other": "https://docs.prowler.com/checks/aws/iam-policies/iam_15",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Login as root account and from My Account configure Security questions.",
              "Url": "https://docs.aws.amazon.com/accounts/latest/reference/manage-acct-security-challenge.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "1.3.1, 2.1.1, 2.9.5, 2.11.1"
        }
      ]
    },
    {
      "Id": "account_security_contact_information_is_registered",
      "Description": "Ensure security contact information is registered.",
      "Checks": [
        "account_security_contact_information_is_registered"
      ],
      "Attributes": [
        {
          "Section": "account",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure security contact information is registered.",
          "RationaleStatement": "AWS provides customers with the option of specifying the contact information for accounts security team. It is recommended that this information be provided. Specifying security-specific contact information will help ensure that security advisories sent by AWS reach the team in your organization that is best equipped to respond to them.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "No command available.",
              "NativeIaC": "",
              "Other": "https://docs.prowler.com/checks/aws/iam-policies/iam_19#aws-console",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Go to the My Account section and complete alternate contacts.",
              "Url": "https://docs.aws.amazon.com/accounts/latest/reference/manage-acct-update-contact.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "1.3.1, 2.1.1, 2.1.3, 2.11.1"
        }
      ]
    },
    {
      "Id": "autoscaling_group_multiple_az",
      "Description": "EC2 Auto Scaling Group should use multiple Availability Zones",
      "Checks": [
        "autoscaling_group_multiple_az"
      ],
      "Attributes": [
        {
          "Section": "autoscaling",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "EC2 Auto Scaling Group should use multiple Availability Zones",
          "RationaleStatement": "In case of a failure in a single Availability Zone, the Auto Scaling Group will not be able to launch new instances to replace the failed ones.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws autoscaling update-auto-scaling-group",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/AutoScaling/multiple-availability-zones.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Configure multiple Availability Zones for EC2 Auto Scaling Group",
              "Url": "https://docs.aws.amazon.com/autoscaling/ec2/userguide/as-add-availability-zone.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/autoscaling/ec2/userguide/as-add-availability-zone.html",
          "ISMS-P Codes": "2.9.2, 2.12.1"
        }
      ]
    },
    {
      "Id": "autoscaling_find_secrets_ec2_launch_configuration",
      "Description": "Find secrets in EC2 Auto Scaling Launch Configuration",
      "Checks": [
        "autoscaling_find_secrets_ec2_launch_configuration"
      ],
      "Attributes": [
        {
          "Section": "autoscaling",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Find secrets in EC2 Auto Scaling Launch Configuration",
          "RationaleStatement": "The use of a hard-coded password increases the possibility of password guessing.\u00a0 If hard-coded passwords are used, it is possible that malicious users gain access through the account in question.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Do not include sensitive information in user data within the launch configuration, try to use Secrets Manager instead.",
              "Url": "https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.4, 2.7.2, 2.11.1, 2.11.2"
        }
      ]
    },
    {
      "Id": "elbv2_waf_acl_attached",
      "Description": "Check if Application Load Balancer has a WAF ACL attached.",
      "Checks": [
        "elbv2_waf_acl_attached"
      ],
      "Attributes": [
        {
          "Section": "elbv2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Application Load Balancer has a WAF ACL attached.",
          "RationaleStatement": "If not WAF ACL is attached risk of web attacks increases.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Using the AWS Management Console open the AWS WAF console to attach an ACL.",
              "Url": "https://docs.aws.amazon.com/waf/latest/developerguide/web-acl-associating-aws-resource.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.8.1, 2.10.1, 2.10.3, 2.10.9, 2.11.1"
        }
      ]
    },
    {
      "Id": "elbv2_logging_enabled",
      "Description": "Check if Elastic Load Balancers have logging enabled.",
      "Checks": [
        "elbv2_logging_enabled"
      ],
      "Attributes": [
        {
          "Section": "elbv2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Elastic Load Balancers have logging enabled.",
          "RationaleStatement": "If logs are not enabled monitoring of service use and threat analysis is not possible.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws elbv2 modify-load-balancer-attributes --load-balancer-arn <lb_arn> --attributes Key=access_logs.s3.enabled,Value=true Key=access_logs.s3.bucket,Value=<bucket_name> Key=access_logs.s3.prefix,Value=<prefix>",
              "NativeIaC": "https://docs.prowler.com/checks/aws/logging-policies/bc_aws_logging_22#cloudformation",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/ELBv2/access-log.html",
              "Terraform": "https://docs.prowler.com/checks/aws/logging-policies/bc_aws_logging_22#terraform"
            },
            "Recommendation": {
              "Text": "Enable ELB logging, create a log lifecycle and define use cases.",
              "Url": "https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-access-logs.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.9.4, 2.9.5, 2.11.1, 2.11.2"
        }
      ]
    },
    {
      "Id": "elbv2_desync_mitigation_mode",
      "Description": "Check whether the Application Load Balancer is configured with strictest desync mitigation mode, if not check if at least is configured with the drop_invalid_header_fields attribute",
      "Checks": [
        "elbv2_desync_mitigation_mode"
      ],
      "Attributes": [
        {
          "Section": "elbv2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check whether the Application Load Balancer is configured with strictest desync mitigation mode, if not check if at least is configured with the drop_invalid_header_fields attribute",
          "RationaleStatement": "HTTP Desync issues can lead to request smuggling and make your applications vulnerable to request queue or cache poisoning, which could lead to credential hijacking or execution of unauthorized commands.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws elbv2 modify-load-balancer-attributes --load-balancer-arn <alb arn> --attributes Key=routing.http.desync_mitigation_mode,Value=<defensive/strictest>",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Ensure Application Load Balancer is configured with strictest desync mitigation mode or with the drop_invalid_header_fields attribute enabled",
              "Url": "https://aws.amazon.com/about-aws/whats-new/2020/08/application-and-classic-load-balancers-adding-defense-in-depth-with-introduction-of-desync-mitigation-mode/"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/elasticloadbalancing/latest/application/application-load-balancers.html#desync-mitigation-mode",
          "ISMS-P Codes": "2.10.1, 2.10.3, 2.11.1, 2.11.2"
        }
      ]
    },
    {
      "Id": "elbv2_insecure_ssl_ciphers",
      "Description": "Check if Elastic Load Balancers have insecure SSL ciphers.",
      "Checks": [
        "elbv2_insecure_ssl_ciphers"
      ],
      "Attributes": [
        {
          "Section": "elbv2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Elastic Load Balancers have insecure SSL ciphers.",
          "RationaleStatement": "Using insecure ciphers could affect privacy of in transit information.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws elbv2 modify-listener --listener-arn <lb_arn> --ssl-policy ELBSecurityPolicy-TLS13-1-2-Ext2-2021-06",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/ELBv2/security-policy.html",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_43#terraform"
            },
            "Recommendation": {
              "Text": "Use a Security policy with ciphers that are as strong as possible. Drop legacy and insecure ciphers.",
              "Url": "https://docs.aws.amazon.com/elasticloadbalancing/latest/application/create-https-listener.html#describe-ssl-policies"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.7.1, 2.10.5"
        }
      ]
    },
    {
      "Id": "elbv2_internet_facing",
      "Description": "Check for internet facing Elastic Load Balancers.",
      "Checks": [
        "elbv2_internet_facing"
      ],
      "Attributes": [
        {
          "Section": "elbv2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check for internet facing Elastic Load Balancers.",
          "RationaleStatement": "Publicly accessible load balancers could expose sensitive data to bad actors.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/ELBv2/internet-facing-load-balancers.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Ensure the load balancer should be publicly accessible. If publicly exposed ensure a WAF ACL is implemented.",
              "Url": "https://docs.aws.amazon.com/waf/latest/developerguide/web-acl-associating-aws-resource.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.6.2.10.3"
        }
      ]
    },
    {
      "Id": "elbv2_ssl_listeners",
      "Description": "Check if Elastic Load Balancers have SSL listeners.",
      "Checks": [
        "elbv2_ssl_listeners"
      ],
      "Attributes": [
        {
          "Section": "elbv2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Elastic Load Balancers have SSL listeners.",
          "RationaleStatement": "Clear text communication could affect privacy of information in transit.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws elbv2 create-listener --load-balancer-arn <lb_arn> --protocol HTTPS --port 443 --ssl-policy <ssl_policy> --certificates CertificateArn=<certificate_arn>,IsDefault=true",
              "NativeIaC": "",
              "Other": "https://docs.prowler.com/checks/aws/networking-policies/networking_36#aws-ec2-console",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Scan for Load Balancers with HTTP or TCP listeners and understand the reason for each of them. Check if the listener can be implemented as TLS instead.",
              "Url": "https://docs.aws.amazon.com/elasticloadbalancing/latest/application/create-https-listener.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.7.1, 2.10.5"
        }
      ]
    },
    {
      "Id": "elbv2_deletion_protection",
      "Description": "Check if Elastic Load Balancers have deletion protection enabled.",
      "Checks": [
        "elbv2_deletion_protection"
      ],
      "Attributes": [
        {
          "Section": "elbv2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Elastic Load Balancers have deletion protection enabled.",
          "RationaleStatement": "If deletion protection is not enabled, the resource is not protected against deletion.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws elbv2 modify-load-balancer-attributes --load-balancer-arn <lb_arn> --attributes Key=deletion_protection.enabled,Value=true",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/ELBv2/deletion-protection.html",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_networking_62#terraform"
            },
            "Recommendation": {
              "Text": "Enable deletion protection attribute, this is not enabled by default.",
              "Url": "https://docs.aws.amazon.com/elasticloadbalancing/latest/application/application-load-balancers.html#deletion-protection"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.1.1, 2.9.2, 2.10.1, 2.10.3, 2.12.1"
        }
      ]
    },
    {
      "Id": "elbv2_listeners_underneath",
      "Description": "Check if ELBV2 has listeners underneath.",
      "Checks": [
        "elbv2_listeners_underneath"
      ],
      "Attributes": [
        {
          "Section": "elbv2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if ELBV2 has listeners underneath.",
          "RationaleStatement": "The rules that are defined for a listener determine how the load balancer routes requests to its registered targets.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Add listeners to Elastic Load Balancers V2.",
              "Url": "https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.2, 2.6.1, 2.9.2, 2.10.3"
        }
      ]
    },
    {
      "Id": "securityhub_enabled",
      "Description": "Check if Security Hub is enabled and its standard subscriptions.",
      "Checks": [
        "securityhub_enabled"
      ],
      "Attributes": [
        {
          "Section": "securityhub",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Security Hub is enabled and its standard subscriptions.",
          "RationaleStatement": "AWS Security Hub gives you a comprehensive view of your security alerts and security posture across your AWS accounts.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws securityhub enable-security-hub --enable-default-standards",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Security Hub is Regional. When you enable or disable a security standard, it is enabled or disabled only in the current Region or in the Region that you specify.",
              "Url": "https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-enable-disable.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-enable-disable.html",
          "ISMS-P Codes": "2.9.4, 2.9.5, 2.10.1, 2.11.1, 2.11.2, 2.11.3"
        }
      ]
    },
    {
      "Id": "backup_reportplans_exist",
      "Description": "Ensure that there is at least one AWS Backup report plan",
      "Checks": [
        "backup_reportplans_exist"
      ],
      "Attributes": [
        {
          "Section": "backup",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "This check ensures that there is at least one backup report plan in place.",
          "RationaleStatement": "Without a backup report plan, an organization may lack visibility into the success or failure of backup operations.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws backup create-report-plan --report-plan-name <report-plan-name> --report-delivery-channel <value> --report-setting <value>",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Use AWS Backup to create backup report plans that provide visibility into the success or failure of backup operations.",
              "Url": "https://docs.aws.amazon.com/aws-backup/latest/devguide/create-report-plan-console.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/aws-backup/latest/devguide/create-report-plan-console.html",
          "ISMS-P Codes": "2.9.3, 2.9.7, 2.12.1, 2.12.2"
        }
      ]
    },
    {
      "Id": "backup_vaults_exist",
      "Description": "Ensure AWS Backup vaults exist",
      "Checks": [
        "backup_vaults_exist"
      ],
      "Attributes": [
        {
          "Section": "backup",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "This check ensures that AWS Backup vaults exist to provide a secure and durable storage location for backup data.",
          "RationaleStatement": "Without an AWS Backup vault, an organization's critical data may be at risk of being lost in the event of an accidental deletion, system failures, or natural disasters.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws backup create-backup-vault --backup-vault-name <backup_vault_name>",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Use AWS Backup to create backup vaults for your critical data and services.",
              "Url": "https://docs.aws.amazon.com/aws-backup/latest/devguide/vaults.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/aws-backup/latest/devguide/vaults.html",
          "ISMS-P Codes": "2.7.1, 2.9.3"
        }
      ]
    },
    {
      "Id": "backup_vaults_encrypted",
      "Description": "Ensure that AWS Backup vaults are encrypted with AWS KMS",
      "Checks": [
        "backup_vaults_encrypted"
      ],
      "Attributes": [
        {
          "Section": "backup",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "This check ensures that AWS Backup vaults are encrypted with AWS KMS.",
          "RationaleStatement": "Without encryption using AWS KMS, an organization's backup data may be at risk of unauthorized access, which can lead to data breaches and other security incidents.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws backup update-backup-vault --backup-vault-name <backup_vault_name> --encryption-key-arn <kms_key_arn>",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Athena/encrypted-with-cmk.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Use AWS KMS to encrypt your AWS Backup vaults and backup data.",
              "Url": "https://docs.aws.amazon.com/aws-backup/latest/devguide/encryption.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/aws-backup/latest/devguide/encryption.html",
          "ISMS-P Codes": "2.7.1, 2.9.3"
        }
      ]
    },
    {
      "Id": "backup_plans_exist",
      "Description": "Ensure that there is at least one AWS Backup plan",
      "Checks": [
        "backup_plans_exist"
      ],
      "Attributes": [
        {
          "Section": "backup",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "This check ensures that there is at least one backup plan in place.",
          "RationaleStatement": "Without a backup plan, an organization may be at risk of losing important data due to accidental deletion, system failures, or natural disasters. This can result in significant financial and reputational damage for the organization.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws backup create-backup-plan --backup-plan <backup_plan_name> --backup-plan-rule <backup_rule_name>",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Use AWS Backup to create backup plans for your critical data and services.",
              "Url": "https://docs.aws.amazon.com/aws-backup/latest/devguide/about-backup-plans.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/aws-backup/latest/devguide/about-backup-plans.html",
          "ISMS-P Codes": "2.9.3, 2.9.7, 2.12.1, 2.12.2"
        }
      ]
    },
    {
      "Id": "cloudformation_stack_outputs_find_secrets",
      "Description": "Find secrets in CloudFormation outputs",
      "Checks": [
        "cloudformation_stack_outputs_find_secrets"
      ],
      "Attributes": [
        {
          "Section": "cloudformation",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Find secrets in CloudFormation outputs",
          "RationaleStatement": "Secrets hardcoded into CloudFormation outputs can be used by malware and bad actors to gain lateral access to other services.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/secrets-policies/bc_aws_secrets_2#cli-command",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Implement automated detective control to scan accounts for passwords and secrets. Use secrets manager service to store and retrieve passwords and secrets.",
              "Url": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-secretsmanager-secret-generatesecretstring.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/outputs-section-structure.html",
          "ISMS-P Codes": "2.5.4, 2.7.2, 2.9.7"
        }
      ]
    },
    {
      "Id": "cloudformation_stacks_termination_protection_enabled",
      "Description": "Enable termination protection for Cloudformation Stacks",
      "Checks": [
        "cloudformation_stacks_termination_protection_enabled"
      ],
      "Attributes": [
        {
          "Section": "cloudformation",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Enable termination protection for Cloudformation Stacks",
          "RationaleStatement": "Without termination protection enabled, a critical cloudformation stack can be accidently deleted.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws cloudformation update-termination-protection --region <REGION_NAME> --stack-name <STACK_NAME> --enable-termination-protection",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Ensure termination protection is enabled for the cloudformation stacks.",
              "Url": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-protect-stacks.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-protect-stacks.html",
          "ISMS-P Codes": "2.9.1, 2.9.2, 2.11.1"
        }
      ]
    },
    {
      "Id": "elasticache_cluster_uses_public_subnet",
      "Description": "Ensure Elasticache Cluster is not using a public subnet",
      "Checks": [
        "elasticache_cluster_uses_public_subnet"
      ],
      "Attributes": [
        {
          "Section": "elasticache",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure Elasticache Cluster is not using a public subnet",
          "RationaleStatement": "There is a risk of exposing sensitive data if Elasticache Cluster uses a public subnet.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws elasticache modify-cache-cluster --cache-cluster-id my-elasticache-cluster --cache-subnet-group-name my-private-subnet-group",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "To ensure your Elasticache cluster is not using a public subnet, follow the recommended remediation steps based on your preferred method.",
              "Url": "https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/VPCs.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/VPCs.html",
          "ISMS-P Codes": "2.6.2, 2.6.6, 2.10.5"
        }
      ]
    },
    {
      "Id": "elasticache_redis_cluster_backup_enabled",
      "Description": "Ensure Elasticache Redis cache cluster has automatic backups enabled.",
      "Checks": [
        "elasticache_redis_cluster_backup_enabled"
      ],
      "Attributes": [
        {
          "Section": "elasticache",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure Elasticache Redis cache cluster has automatic backups enabled.",
          "RationaleStatement": "Ensure that your Amazon ElastiCache Redis cache clusters have a sufficient backup retention period set in order to fulfill your organization's compliance requirements. The retention period represents the number of days for which Amazon ElastiCache service retains automatic Redis cluster backups before deleting them.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws elasticache modify-replication-group --region <value> --replication-group-id <value> --snapshot-retention-limit <value> --apply-immediately",
              "NativeIaC": "",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/ensure-that-amazon-elasticache-redis-clusters-have-automatic-backup-turned-on/"
            },
            "Recommendation": {
              "Text": "Ensure Elasticache Cluster has automatic backups enabled.",
              "Url": "https://docs.aws.amazon.com/securityhub/latest/userguide/elasticache-controls.html#elasticache-1"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/securityhub/latest/userguide/elasticache-controls.html#elasticache-1",
          "ISMS-P Codes": "2.9.3, 2.9.7, 2.12.1, 2.12.2"
        }
      ]
    },
    {
      "Id": "elasticache_redis_cluster_multi_az_enabled",
      "Description": "Ensure Elasticache Elasticache Redis cache cluster has Multi-AZ enabled.",
      "Checks": [
        "elasticache_redis_cluster_multi_az_enabled"
      ],
      "Attributes": [
        {
          "Section": "elasticache",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure Elasticache Elasticache Redis cache cluster has Multi-AZ enabled.",
          "RationaleStatement": "Ensure that your Amazon ElastiCache Redis cache clusters has Multi-AZ enabled.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws elasticache modify-replication-group --region <value> --replication-group-id <value> --multi-az-enabled --apply-immediately",
              "NativeIaC": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/ElastiCache/elasticache-multi-az.html#",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/ensure-aws-elasticache-redis-cluster-with-multi-az-automatic-failover-feature-set-to-enabled/"
            },
            "Recommendation": {
              "Text": "Ensure Elasticache Elasticache Redis cache cluster has Multi-AZ enabled.",
              "Url": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/ElastiCache/elasticache-multi-az.html#"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/ElastiCache/elasticache-multi-az.html#",
          "ISMS-P Codes": "2.9.2, 2.12.1"
        }
      ]
    },
    {
      "Id": "elasticache_redis_cluster_in_transit_encryption_enabled",
      "Description": "Ensure Elasticache Redis cache clusters have in transit encryption enabled.",
      "Checks": [
        "elasticache_redis_cluster_in_transit_encryption_enabled"
      ],
      "Attributes": [
        {
          "Section": "elasticache",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure Elasticache Redis cache clusters have in transit encryption enabled.",
          "RationaleStatement": "There is a risk of exposing sensitive data if Elasticache Redis cache cluster does not have in transit encryption enabled.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/general-policies/general_10/",
              "NativeIaC": "https://docs.prowler.com/checks/aws/general-policies/general_10/",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/general_10/"
            },
            "Recommendation": {
              "Text": "Ensure your Elasticache Redis cache clusters have in transit encryption enabled.",
              "Url": "https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/in-transit-encryption.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/securityhub/latest/userguide/elasticache-controls.html#elasticache-5",
          "ISMS-P Codes": "2.6.2, 2.7.1"
        }
      ]
    },
    {
      "Id": "elasticache_redis_cluster_rest_encryption_enabled",
      "Description": "Ensure Elasticache Redis cache clusters have at rest encryption enabled.",
      "Checks": [
        "elasticache_redis_cluster_rest_encryption_enabled"
      ],
      "Attributes": [
        {
          "Section": "elasticache",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure Elasticache Redis cache clusters have at rest encryption enabled.",
          "RationaleStatement": "There is a risk of exposing sensitive data if Elasticache Redis cache clusters does not have at rest encryption enabled.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/general-policies/general_9/",
              "NativeIaC": "https://docs.prowler.com/checks/aws/general-policies/general_9/",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/general_9/"
            },
            "Recommendation": {
              "Text": "Ensure your Elasticache Redis cache clusters have at rest encryption enabled.",
              "Url": "https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/at-rest-encryption.html#at-rest-encryption-enable"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/securityhub/latest/userguide/elasticache-controls.html#elasticache-4",
          "ISMS-P Codes": "2.7.1, 2.7.2"
        }
      ]
    },
    {
      "Id": "appstream_fleet_maximum_session_duration",
      "Description": "Ensure user maximum session duration is no longer than 10 hours.",
      "Checks": [
        "appstream_fleet_maximum_session_duration"
      ],
      "Attributes": [
        {
          "Section": "appstream",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure user maximum session duration is no longer than 10 hours.",
          "RationaleStatement": "Having a session duration lasting longer than 10 hours should not be necessary and if running for any malicious reasons provides a greater time for usage than should be allowed.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Change the Maximum session duration is set to 600 minutes or less for the AppStream Fleet.",
              "Url": "https://docs.aws.amazon.com/appstream2/latest/developerguide/set-up-stacks-fleets.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/appstream2/latest/developerguide/set-up-stacks-fleets.html",
          "ISMS-P Codes": "2.5.6, 2.6.1, 2.6.2, 2.8.1, 2.9.2"
        }
      ]
    },
    {
      "Id": "appstream_fleet_default_internet_access_disabled",
      "Description": "Ensure default Internet Access from your Amazon AppStream fleet streaming instances should remain unchecked.",
      "Checks": [
        "appstream_fleet_default_internet_access_disabled"
      ],
      "Attributes": [
        {
          "Section": "appstream",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure default Internet Access from your Amazon AppStream fleet streaming instances should remain unchecked.",
          "RationaleStatement": "Default Internet Access from your fleet streaming instances should be controlled using a NAT gateway in the VPC.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Uncheck the default internet access for the AppStream Fleet.",
              "Url": "https://docs.aws.amazon.com/appstream2/latest/developerguide/set-up-stacks-fleets.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/appstream2/latest/developerguide/set-up-stacks-fleets.html",
          "ISMS-P Codes": "2.5.6, 2.6.1, 2.6.2, 2.6.6, 2.8.1"
        }
      ]
    },
    {
      "Id": "appstream_fleet_session_idle_disconnect_timeout",
      "Description": "Ensure session idle disconnect timeout is set to 10 minutes or less.",
      "Checks": [
        "appstream_fleet_session_idle_disconnect_timeout"
      ],
      "Attributes": [
        {
          "Section": "appstream",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure session idle disconnect timeout is set to 10 minutes or less.",
          "RationaleStatement": "Idle disconnect timeout in minutes is the amount of time that users can be inactive before they are disconnected from their streaming session and the Disconnect timeout in minutes time begins.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Change the session idle timeout to 10 minutes or less for the AppStream Fleet.",
              "Url": "https://docs.aws.amazon.com/appstream2/latest/developerguide/set-up-stacks-fleets.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/appstream2/latest/developerguide/set-up-stacks-fleets.html",
          "ISMS-P Codes": "2.5.6, 2.6.1, 2.6.2, 2.8.1, 2.9.2"
        }
      ]
    },
    {
      "Id": "appstream_fleet_session_disconnect_timeout",
      "Description": "Ensure session disconnect timeout is set to 5 minutes or less.",
      "Checks": [
        "appstream_fleet_session_disconnect_timeout"
      ],
      "Attributes": [
        {
          "Section": "appstream",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure session disconnect timeout is set to 5 minutes or less",
          "RationaleStatement": "Disconnect timeout in minutes, is the amount of of time that a streaming session remains active after users disconnect.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Change the Disconnect timeout to 5 minutes or less for the AppStream Fleet.",
              "Url": "https://docs.aws.amazon.com/appstream2/latest/developerguide/set-up-stacks-fleets.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/appstream2/latest/developerguide/set-up-stacks-fleets.html",
          "ISMS-P Codes": "2.5.6, 2.6.1, 2.6.2, 2.8.1, 2.9.2"
        }
      ]
    },
    {
      "Id": "rds_instance_multi_az",
      "Description": "Check if RDS instances have multi-AZ enabled.",
      "Checks": [
        "rds_instance_multi_az"
      ],
      "Attributes": [
        {
          "Section": "rds",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if RDS instances have multi-AZ enabled.",
          "RationaleStatement": "In case of failure, with a single-AZ deployment configuration, should an availability zone specific database failure occur, Amazon RDS can not automatically fail over to the standby availability zone.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws rds create-db-instance --db-instance-identifier <db_instance_id> --multi-az true",
              "NativeIaC": "https://docs.prowler.com/checks/aws/general-policies/general_73#cloudformation",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/rds-multi-az.html",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/general_73#terraform"
            },
            "Recommendation": {
              "Text": "Enable multi-AZ deployment for production databases.",
              "Url": "https://aws.amazon.com/rds/features/multi-az/"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://aws.amazon.com/rds/features/multi-az/",
          "ISMS-P Codes": "2.9.2, 2.9.3, 2.12.1"
        }
      ]
    },
    {
      "Id": "rds_instance_deprecated_engine_version",
      "Description": "Check if RDS instance is using a supported engine version",
      "Checks": [
        "rds_instance_deprecated_engine_version"
      ],
      "Attributes": [
        {
          "Section": "rds",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if RDS is using a supported engine version for MariaDB, MySQL and PostgreSQL",
          "RationaleStatement": "If not enabled RDS instances may be vulnerable to security issues",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws rds describe-db-engine-versions --engine <my_engine>'",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Ensure all the RDS instances are using a supported engine version",
              "Url": "https://docs.aws.amazon.com/cli/latest/reference/rds/describe-db-engine-versions.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/cli/latest/reference/rds/describe-db-engine-versions.html",
          "ISMS-P Codes": "2.6.4, 2.10.8, 2.11.1"
        }
      ]
    },
    {
      "Id": "rds_instance_storage_encrypted",
      "Description": "Check if RDS instances storage is encrypted.",
      "Checks": [
        "rds_instance_storage_encrypted"
      ],
      "Attributes": [
        {
          "Section": "rds",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if RDS instances storage is encrypted.",
          "RationaleStatement": "If not enabled sensitive information at rest is not protected.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws rds create-db-instance --db-instance-identifier <db_instance_id> --db-instance-class <instance_class> --engine <engine> --storage-encrypted true",
              "NativeIaC": "https://docs.prowler.com/checks/aws/general-policies/general_4#cloudformation",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/rds-encryption-enabled.html",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/general_4#terraform"
            },
            "Recommendation": {
              "Text": "Enable Encryption. Use a CMK where possible. It will provide additional management and privacy benefits.",
              "Url": "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html",
          "ISMS-P Codes": "2.7.1, 2.11.1"
        }
      ]
    },
    {
      "Id": "rds_instance_default_admin",
      "Description": "Ensure that your Amazon RDS instances/clusters are not using the default master username.",
      "Checks": [
        "rds_instance_default_admin"
      ],
      "Attributes": [
        {
          "Section": "rds",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure that your Amazon RDS instances/clusters are not using the default master username.",
          "RationaleStatement": "Since admin is the Amazon's example for the RDS database master username and postgres is the default PostgreSQL master username. Many AWS customers will use this username for their RDS database instances in production. Malicious users can use this information to their advantage and frequently try to use default master username during brute-force attacks.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/rds-master-username.html#",
              "NativeIaC": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/rds-master-username.html#",
              "Other": "",
              "Terraform": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/rds-master-username.html#"
            },
            "Recommendation": {
              "Text": "To change the master username configured for your Amazon RDS database instances/clusters you must re-create them and migrate the existing data.",
              "Url": "https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-25"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-25",
          "ISMS-P Codes": "2.5.1, 2.5.4, 2.5.5, 2.6.4, 2.11.1"
        }
      ]
    },
    {
      "Id": "rds_cluster_backtrack_enabled",
      "Description": "Check if RDS Aurora MySQL Clusters have backtrack enabled.",
      "Checks": [
        "rds_cluster_backtrack_enabled"
      ],
      "Attributes": [
        {
          "Section": "rds",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure that the Backtrack feature is enabled for your Amazon Aurora (with MySQL compatibility) database clusters in order to backtrack your clusters to a specific time, without using backups. Backtrack is an Amazon RDS feature that allows you to specify the amount of time that an Aurora MySQL database cluster needs to retain change records, in order to have a fast way to recover from user errors, such as dropping the wrong table or deleting the wrong row by moving your MySQL database to a prior point in time without the need to restore from a recent backup.",
          "RationaleStatement": "Once the Backtrack feature is enabled, Amazon RDS can quickly 'rewind' your Aurora MySQL database cluster to a point in time that you specify. In contrast to the backup and restore method, with Backtrack you can easily undo a destructive action, such as a DELETE query without a WHERE clause, with minimal downtime, you can rewind your Aurora cluster in just few minutes, and you can repeatedly backtrack a database cluster back and forth in time to help determine when a particular data change occurred.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/backtrack.html#",
              "NativeIaC": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/backtrack.html#",
              "Other": "",
              "Terraform": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/backtrack.html#"
            },
            "Recommendation": {
              "Text": "Backups help you to recover more quickly from a security incident. They also strengthens the resilience of your systems. Aurora backtracking reduces the time to recover a database to a point in time. It does not require a database restore to do so. You cannot enable backtracking on an existing cluster. Instead, you can create a clone that has backtracking enabled.",
              "Url": "https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-14"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-14",
          "ISMS-P Codes": "2.9.2, 2.9.5, 2.11.1"
        }
      ]
    },
    {
      "Id": "rds_instance_enhanced_monitoring_enabled",
      "Description": "Check if RDS instances has enhanced monitoring enabled.",
      "Checks": [
        "rds_instance_enhanced_monitoring_enabled"
      ],
      "Attributes": [
        {
          "Section": "rds",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if RDS instances has enhanced monitoring enabled.",
          "RationaleStatement": "A smaller monitoring interval results in more frequent reporting of OS metrics.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws rds create-db-instance --db-instance-identifier <db_instance_id> --db-instance-class <instance_class> --engine <engine> --storage-encrypted true",
              "NativeIaC": "",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/logging-policies/ensure-that-enhanced-monitoring-is-enabled-for-amazon-rds-instances#terraform"
            },
            "Recommendation": {
              "Text": "To use Enhanced Monitoring, you must create an IAM role, and then enable Enhanced Monitoring.",
              "Url": "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Monitoring.OS.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Monitoring.OS.html",
          "ISMS-P Codes": "2.9.2, 2.9.4, 2.9.5, 2.11.3"
        }
      ]
    },
    {
      "Id": "rds_instance_deletion_protection",
      "Description": "Check if RDS instances have deletion protection enabled.",
      "Checks": [
        "rds_instance_deletion_protection"
      ],
      "Attributes": [
        {
          "Section": "rds",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if RDS instances have deletion protection enabled.",
          "RationaleStatement": "You can only delete instances that do not have deletion protection enabled.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws rds modify-db-instance --db-instance-identifier <db_instance_id> --deletion-protection --apply-immediately",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/instance-deletion-protection.html",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/ensure-that-rds-clusters-and-instances-have-deletion-protection-enabled#terraform"
            },
            "Recommendation": {
              "Text": "Enable deletion protection using the AWS Management Console for production DB instances.",
              "Url": "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_DeleteInstance.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_DeleteInstance.html",
          "ISMS-P Codes": "2.9.1, 2.9.3, 2.12.2"
        }
      ]
    },
    {
      "Id": "rds_snapshots_public_access",
      "Description": "Check if RDS Snapshots and Cluster Snapshots are public.",
      "Checks": [
        "rds_snapshots_public_access"
      ],
      "Attributes": [
        {
          "Section": "rds",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if RDS Snapshots and Cluster Snapshots are public.",
          "RationaleStatement": "Publicly accessible services could expose sensitive data to bad actors. t is recommended that your RDS snapshots should not be public in order to prevent potential leak or misuse of sensitive data or any other kind of security threat. If your RDS snapshot is public, then the data which is backed up in that snapshot is accessible to all other AWS accounts.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws rds modify-db-snapshot-attribute --db-snapshot-identifier <snapshot_id> --attribute-name restore --values-to-remove all",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/public-snapshots.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Use AWS Config to identify any snapshot that is public.",
              "Url": "https://docs.aws.amazon.com/config/latest/developerguide/rds-snapshots-public-prohibited.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/config/latest/developerguide/rds-snapshots-public-prohibited.html",
          "ISMS-P Codes": "2.6.1, 2.6.4, 2.6.6, 2.10.1"
        }
      ]
    },
    {
      "Id": "rds_instance_certificate_expiration",
      "Description": "Ensure that the SSL/TLS certificates configured for your Amazon RDS are not expired.",
      "Checks": [
        "rds_instance_certificate_expiration"
      ],
      "Attributes": [
        {
          "Section": "rds",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "To maintain Amazon RDS database security and avoid interruption of the applications that are using RDS and/or Aurora databases, rotate the required SSL/TLS certificates and update the deprecated Certificate Authority (CA) certificates at the Amazon RDS instance level.",
          "RationaleStatement": "Interruption of application if the certificate expires.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws rds modify-db-instance --region us-east-1 --db-instance-identifier cc-project5-mysql-database --ca-certificate-identifier \"rds-ca-2019\" --apply-immediately",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/rotate-rds-certificates.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "To maintain Amazon RDS database security and avoid interruption of the applications that are using RDS and/or Aurora databases, rotate the required SSL/TLS certificates and update the deprecated Certificate Authority (CA) certificates at the Amazon RDS instance level.",
              "Url": "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/UsingWithRDS.SSL-certificate-rotation.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/UsingWithRDS.SSL-certificate-rotation.html",
          "ISMS-P Codes": "2.7.1, 2.7.2, 2.10.5, 2.10.8"
        }
      ]
    },
    {
      "Id": "rds_instance_no_public_access",
      "Description": "Ensure there are no Public Accessible RDS instances.",
      "Checks": [
        "rds_instance_no_public_access"
      ],
      "Attributes": [
        {
          "Section": "rds",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure there are no Public Accessible RDS instances.",
          "RationaleStatement": "Publicly accessible databases could expose sensitive data to bad actors.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws rds modify-db-instance --db-instance-identifier <db_instance_id> --no-publicly-accessible --apply-immediately",
              "NativeIaC": "https://docs.prowler.com/checks/aws/public-policies/public_2#cloudformation",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/rds-publicly-accessible.html",
              "Terraform": "https://docs.prowler.com/checks/aws/public-policies/public_2#terraform"
            },
            "Recommendation": {
              "Text": "Using an AWS Config rule check for RDS public instances periodically and check there is a business reason for it.",
              "Url": "https://docs.aws.amazon.com/config/latest/developerguide/rds-instance-public-access-check.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/config/latest/developerguide/rds-instance-public-access-check.html",
          "ISMS-P Codes": "2.6.1, 2.6.2, 2.6.4, 2.6.6"
        }
      ]
    },
    {
      "Id": "rds_instance_backup_enabled",
      "Description": "Check if RDS instances have backup enabled.",
      "Checks": [
        "rds_instance_backup_enabled"
      ],
      "Attributes": [
        {
          "Section": "rds",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if RDS instances have backup enabled.",
          "RationaleStatement": "If backup is not enabled, data is vulnerable. Human error or bad actors could erase or modify data.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws rds modify-db-instance --db-instance-identifier <db_instance_id> --backup-retention-period 7 --apply-immediately",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/rds-automated-backups-enabled.html",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/ensure-that-rds-instances-have-backup-policy#terraform"
            },
            "Recommendation": {
              "Text": "Enable automated backup for production data. Define a retention period and periodically test backup restoration. A Disaster Recovery process should be in place to govern Data Protection approach.",
              "Url": "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_WorkingWithAutomatedBackups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_WorkingWithAutomatedBackups.html",
          "ISMS-P Codes": "2.9.3, 2.9.7, 2.12.1, 2.12.2"
        }
      ]
    },
    {
      "Id": "rds_instance_minor_version_upgrade_enabled",
      "Description": "Ensure RDS instances have minor version upgrade enabled.",
      "Checks": [
        "rds_instance_minor_version_upgrade_enabled"
      ],
      "Attributes": [
        {
          "Section": "rds",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure RDS instances have minor version upgrade enabled.",
          "RationaleStatement": "Auto Minor Version Upgrade is a feature that you can enable to have your database automatically upgraded when a new minor database engine version is available. Minor version upgrades often patch security vulnerabilities and fix bugs and therefore should be applied.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws rds modify-db-instance --db-instance-identifier <db_instance_id> --auto-minor-version-upgrade --apply-immediately",
              "NativeIaC": "https://docs.prowler.com/checks/aws/general-policies/ensure-aws-db-instance-gets-all-minor-upgrades-automatically#cloudformation",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/rds-auto-minor-version-upgrade.html",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/ensure-aws-db-instance-gets-all-minor-upgrades-automatically#terraform"
            },
            "Recommendation": {
              "Text": "Enable auto minor version upgrade for all databases and environments.",
              "Url": "https://aws.amazon.com/blogs/database/best-practices-for-upgrading-amazon-rds-to-major-and-minor-versions-of-postgresql/"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://aws.amazon.com/blogs/database/best-practices-for-upgrading-amazon-rds-to-major-and-minor-versions-of-postgresql/",
          "ISMS-P Codes": "2.9.1, 2.10.8"
        }
      ]
    },
    {
      "Id": "rds_snapshots_encrypted",
      "Description": "Check if RDS Snapshots and Cluster Snapshots are encrypted.",
      "Checks": [
        "rds_snapshots_encrypted"
      ],
      "Attributes": [
        {
          "Section": "rds",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if RDS Snapshots and Cluster Snapshots are encrypted.",
          "RationaleStatement": "Ensure that your manual Amazon RDS database snapshots are encrypted in order to achieve compliance for data-at-rest encryption within your organization.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/snapshot-encrypted.html#",
              "NativeIaC": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/snapshot-encrypted.html#",
              "Other": "",
              "Terraform": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/snapshot-encrypted.html#"
            },
            "Recommendation": {
              "Text": "When working with production databases that hold sensitive and critical data, it is strongly recommended to implement encryption at rest and protect your data from attackers or unauthorized personnel. ",
              "Url": "https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-4"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-4",
          "ISMS-P Codes": "2.7.1, 2.7.2"
        }
      ]
    },
    {
      "Id": "rds_instance_event_subscription_security_groups",
      "Description": "Check if RDS Security Group events are subscribed.",
      "Checks": [
        "rds_instance_event_subscription_security_groups"
      ],
      "Attributes": [
        {
          "Section": "rds",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure that Amazon RDS event notification subscriptions are enabled for database security groups events.",
          "RationaleStatement": "Amazon RDS event subscriptions for database security groups are designed to provide incident notification of events that may affect the security, availability, and reliability of the RDS database instances associated with these security groups.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/rds-db-security-groups-events.html#",
              "NativeIaC": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/rds-db-security-groups-events.html#",
              "Other": "",
              "Terraform": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/rds-db-security-groups-events.html#"
            },
            "Recommendation": {
              "Text": "To subscribe to RDS instance event notifications, see Subscribing to Amazon RDS event notification in the Amazon RDS User Guide.",
              "Url": "https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-22"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-22",
          "ISMS-P Codes": "2.6.1, 2.6.4, 2.9.2, 2.10.1, 2.11.1"
        }
      ]
    },
    {
      "Id": "rds_instance_iam_authentication_enabled",
      "Description": "Check if RDS instances/clusters have IAM authentication enabled.",
      "Checks": [
        "rds_instance_iam_authentication_enabled"
      ],
      "Attributes": [
        {
          "Section": "rds",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if RDS instances/clusters have IAM authentication enabled.",
          "RationaleStatement": "Ensure that the IAM Database Authentication feature is enabled for your RDS database instances in order to use the Identity and Access Management (IAM) service to manage database access to your MySQL and PostgreSQL database instances. With this feature enabled, you don't have to use a password when you connect to your MySQL/PostgreSQL database, instead you can use an authentication token. An authentication token is a unique string of characters with a lifetime of 15 minutes that Amazon RDS generates on your request. IAM Database Authentication removes the need of storing user credentials within the database configuration, because authentication is managed externally using Amazon IAM.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/iam-database-authentication.html#",
              "NativeIaC": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/iam-database-authentication.html#",
              "Other": "",
              "Terraform": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/iam-database-authentication.html#"
            },
            "Recommendation": {
              "Text": "Enable IAM authentication for supported RDS instances/clusters.",
              "Url": "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/UsingWithRDS.IAMDBAuth.Enabling.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/UsingWithRDS.IAMDBAuth.Enabling.html",
          "ISMS-P Codes": "2.5.1, 2.5.3, 2.5.6, 2.6.4"
        }
      ]
    },
    {
      "Id": "rds_instance_integration_cloudwatch_logs",
      "Description": "Check if RDS instances is integrated with CloudWatch Logs.",
      "Checks": [
        "rds_instance_integration_cloudwatch_logs"
      ],
      "Attributes": [
        {
          "Section": "rds",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if RDS instances is integrated with CloudWatch Logs.",
          "RationaleStatement": "If logs are not enabled, monitoring of service use and threat analysis is not possible.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws rds modify-db-instance --db-instance-identifier <db_instance_id> --cloudwatch-logs-export-configuration {'EnableLogTypes':['audit',error','general','slowquery']} --apply-immediately",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/log-exports.html",
              "Terraform": "https://docs.prowler.com/checks/aws/iam-policies/ensure-that-respective-logs-of-amazon-relational-database-service-amazon-rds-are-enabled#terraform"
            },
            "Recommendation": {
              "Text": "Use CloudWatch Logs to perform real-time analysis of the log data. Create alarms and view metrics.",
              "Url": "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/publishing_cloudwatchlogs.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/publishing_cloudwatchlogs.html",
          "ISMS-P Codes": "2.9.2, 2.9.4, 2.9.5, 2.11.1, 2.11.3"
        }
      ]
    },
    {
      "Id": "rds_instance_transport_encrypted",
      "Description": "Check if RDS instances client connections are encrypted (Microsoft SQL Server, PostgreSQL, MySQL, MariaDB, Aurora PostgreSQL, and Aurora MySQL).",
      "Checks": [
        "rds_instance_transport_encrypted"
      ],
      "Attributes": [
        {
          "Section": "rds",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "For SQL Server, PostgreSQL and Aurora PostgreSQL databases, if the rds.force_ssl parameter value is set to 0, the Transport Encryption feature is not enabled. For MySQL, Aurora MySQL and MariaDB databases, if the require_secure_transport parameter value is set to OFF, the Transport Encryption feature is not enabled.",
          "RationaleStatement": "If not enabled sensitive information at transit is not protected.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws rds modify-db-parameter-group --region <REGION_NAME> --db-parameter-group-name <PARAMETER_GROUP_NAME> --parameters ParameterName='rds.force_ssl',ParameterValue='1',ApplyMethod='pending-reboot'",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/transport-encryption.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Ensure that instances provisioned with Amazon RDS have Transport Encryption feature enabled in order to meet security and compliance requirements.",
              "Url": "https://aws.amazon.com/premiumsupport/knowledge-center/rds-connect-ssl-connection/"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://aws.amazon.com/premiumsupport/knowledge-center/rds-connect-ssl-connection/",
          "ISMS-P Codes": "2.7.1, 2.10.5"
        }
      ]
    },
    {
      "Id": "apigateway_restapi_public",
      "Description": "Check if API Gateway endpoint is public or private.",
      "Checks": [
        "apigateway_restapi_public"
      ],
      "Attributes": [
        {
          "Section": "apigateway",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if API Gateway endpoint is public or private.",
          "RationaleStatement": "If accessible from internet without restrictions opens up attack / abuse surface for any malicious user.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Verify that any public Api Gateway is protected and audited. Detective controls for common risks should be implemented.",
              "Url": "https://d1.awsstatic.com/whitepapers/api-gateway-security.pdf?svrd_sip6"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.2, 2.6.6, 2.8.1"
        }
      ]
    },
    {
      "Id": "apigateway_restapi_waf_acl_attached",
      "Description": "Check if API Gateway Stage has a WAF ACL attached.",
      "Checks": [
        "apigateway_restapi_waf_acl_attached"
      ],
      "Attributes": [
        {
          "Section": "apigateway",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if API Gateway Stage has a WAF ACL attached.",
          "RationaleStatement": "Potential attacks and / or abuse of service, more even for even for internet reachable services.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Use AWS WAF to protect your API Gateway API from common web exploits, such as SQL injection and cross-site scripting (XSS) attacks. These could affect API availability and performance, compromise security or consume excessive resources.",
              "Url": "https://docs.aws.amazon.com/apigateway/latest/developerguide/security-monitoring.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.2, 2.8.1, 2.10.5, 2.10.3, 2.10.9, 2.11.1"
        }
      ]
    },
    {
      "Id": "apigateway_restapi_logging_enabled",
      "Description": "Check if API Gateway Stage has logging enabled.",
      "Checks": [
        "apigateway_restapi_logging_enabled"
      ],
      "Attributes": [
        {
          "Section": "apigateway",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if API Gateway Stage has logging enabled.",
          "RationaleStatement": "If not enabled, monitoring of service use is not possible. Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/logging-policies/ensure-api-gateway-stage-have-logging-level-defined-as-appropiate#terraform"
            },
            "Recommendation": {
              "Text": "Monitoring is an important part of maintaining the reliability, availability and performance of API Gateway and your AWS solutions. You should collect monitoring data from all of the parts of your AWS solution. CloudTrail provides a record of actions taken by a user, role, or an AWS service in API Gateway. Using the information collected by CloudTrail, you can determine the request that was made to API Gateway, the IP address from which the request was made, who made the request, etc.",
              "Url": "https://docs.aws.amazon.com/apigateway/latest/developerguide/security-monitoring.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.8.1, 2.9.4, 2.9.5"
        }
      ]
    },
    {
      "Id": "apigateway_restapi_client_certificate_enabled",
      "Description": "Check if API Gateway Stage has client certificate enabled to access your backend endpoint.",
      "Checks": [
        "apigateway_restapi_client_certificate_enabled"
      ],
      "Attributes": [
        {
          "Section": "apigateway",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if API Gateway Stage has client certificate enabled to access your backend endpoint.",
          "RationaleStatement": "Possible man in the middle attacks and other similar risks.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Enable client certificate. Mutual TLS is recommended and commonly used for business-to-business (B2B) applications. It is used in standards such as Open Banking. API Gateway now provides integrated mutual TLS authentication at no additional cost.",
              "Url": "https://aws.amazon.com/blogs/compute/introducing-mutual-tls-authentication-for-amazon-api-gateway/"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.2, 2.7.1, 2.8.1"
        }
      ]
    },
    {
      "Id": "apigateway_restapi_authorizers_enabled",
      "Description": "Check if API Gateway has configured authorizers at api or method level.",
      "Checks": [
        "apigateway_restapi_authorizers_enabled"
      ],
      "Attributes": [
        {
          "Section": "apigateway",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if API Gateway has configured authorizers at api or method level.",
          "RationaleStatement": "If no authorizer is enabled anyone can use the service.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "https://docs.prowler.com/checks/aws/public-policies/public_6-api-gateway-authorizer-set#cloudformation",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/public-policies/public_6-api-gateway-authorizer-set#terraform"
            },
            "Recommendation": {
              "Text": "Implement Amazon Cognito or a Lambda function to control access to your API.",
              "Url": "https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-use-lambda-authorizer.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.3, 2.6.1, 2.6.2"
        }
      ]
    },
    {
      "Id": "apigateway_restapi_public_with_authorizer",
      "Description": "Check if API Gateway public endpoint has an authorizer configured.",
      "Checks": [
        "apigateway_restapi_public_with_authorizer"
      ],
      "Attributes": [
        {
          "Section": "apigateway",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if API Gateway public endpoint has an authorizer configured.",
          "RationaleStatement": "If accessible from internet without restrictions opens up attack / abuse surface for any malicious user.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Verify that any public API Gateway is protected and audited. Detective controls for common risks should be implemented.",
              "Url": "https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-api-endpoint-types.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-api-endpoint-types.html",
          "ISMS-P Codes": "2.5.3, 2.6.1, 2.6.2, 2.6.6"
        }
      ]
    },
    {
      "Id": "efs_not_publicly_accessible",
      "Description": "Check if EFS have policies which allow access to any client within the VPC",
      "Checks": [
        "efs_not_publicly_accessible"
      ],
      "Attributes": [
        {
          "Section": "efs",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if EFS have policies which allow access to any client within the VPC",
          "RationaleStatement": "Restricting access to EFS file systems is a security best practice. Allowing access to any client within the VPC can lead to unauthorized access to the file system.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Ensure efs has some policy but it does not have principle as *",
              "Url": "https://docs.aws.amazon.com/efs/latest/ug/access-control-block-public-access.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.3, 2.6.2"
        }
      ]
    },
    {
      "Id": "efs_encryption_at_rest_enabled",
      "Description": "Check if EFS protects sensitive data with encryption at rest",
      "Checks": [
        "efs_encryption_at_rest_enabled"
      ],
      "Attributes": [
        {
          "Section": "efs",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if EFS protects sensitive data with encryption at rest",
          "RationaleStatement": "EFS should be encrypted at rest to prevent exposure of sensitive data to bad actors",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws efs create-file-system --creation-token $(uuidgen) --performance-mode generalPurpose --encrypted --kms-key-id user/customer-managedCMKalias",
              "NativeIaC": "https://docs.prowler.com/checks/aws/general-policies/general_17#cloudformation",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/general_17#terraform"
            },
            "Recommendation": {
              "Text": "Ensure that encryption at rest is enabled for EFS file systems. Encryption at rest can only be enabled during the file system creation.",
              "Url": "https://docs.aws.amazon.com/efs/latest/ug/encryption-at-rest.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.7.1"
        }
      ]
    },
    {
      "Id": "efs_have_backup_enabled",
      "Description": "Check if EFS File systems have backup enabled",
      "Checks": [
        "efs_have_backup_enabled"
      ],
      "Attributes": [
        {
          "Section": "efs",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if EFS File systems have backup enabled",
          "RationaleStatement": "If backup is not enabled, data is vulnerable. Human error or bad actors could erase or modify data.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Enable automated backup for production data. Define a retention period and periodically test backup restoration. A Disaster Recovery process should be in place to govern Data Protection approach.",
              "Url": "https://docs.aws.amazon.com/efs/latest/ug/whatisefs.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.9.3, 2.9.7, 2.12.1, 2.12.2"
        }
      ]
    },
    {
      "Id": "sagemaker_training_jobs_network_isolation_enabled",
      "Description": "Check if Amazon SageMaker Training jobs have network isolation enabled",
      "Checks": [
        "sagemaker_training_jobs_network_isolation_enabled"
      ],
      "Attributes": [
        {
          "Section": "sagemaker",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Amazon SageMaker Training jobs have network isolation enabled",
          "RationaleStatement": "This could provide an avenue for unauthorized access to your data.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Restrict which traffic can access by launching Studio in a Virtual Private Cloud (VPC) of your choosing.",
              "Url": "https://docs.aws.amazon.com/sagemaker/latest/dg/interface-vpc-endpoint.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/sagemaker/latest/dg/interface-vpc-endpoint.html",
          "ISMS-P Codes": "2.6.2, 2.8.1"
        }
      ]
    },
    {
      "Id": "sagemaker_models_vpc_settings_configured",
      "Description": "Check if Amazon SageMaker Models have VPC settings configured",
      "Checks": [
        "sagemaker_models_vpc_settings_configured"
      ],
      "Attributes": [
        {
          "Section": "sagemaker",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Amazon SageMaker Models have VPC settings configured",
          "RationaleStatement": "This could provide an avenue for unauthorized access to your data.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Restrict which traffic can access by launching Studio in a Virtual Private Cloud (VPC) of your choosing.",
              "Url": "https://docs.aws.amazon.com/sagemaker/latest/dg/studio-notebooks-and-internet-access.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/sagemaker/latest/dg/studio-notebooks-and-internet-access.html",
          "ISMS-P Codes": "2.6.2, 2.8.1"
        }
      ]
    },
    {
      "Id": "sagemaker_training_jobs_volume_and_output_encryption_enabled",
      "Description": "Check if Amazon SageMaker Training jobs have volume and output with KMS encryption enabled",
      "Checks": [
        "sagemaker_training_jobs_volume_and_output_encryption_enabled"
      ],
      "Attributes": [
        {
          "Section": "sagemaker",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Amazon SageMaker Training jobs have volume and output with KMS encryption enabled",
          "RationaleStatement": "Data exfiltration could happen if information is not protected. KMS keys provide additional security level to IAM policies.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Specify AWS KMS keys to use for input and output from S3 and EBS.",
              "Url": "https://docs.aws.amazon.com/sagemaker/latest/dg/key-management.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/sagemaker/latest/dg/key-management.html",
          "ISMS-P Codes": "2.7.1, 2.7.2, 2.8.1"
        }
      ]
    },
    {
      "Id": "sagemaker_training_jobs_vpc_settings_configured",
      "Description": "Check if Amazon SageMaker Training job have VPC settings configured.",
      "Checks": [
        "sagemaker_training_jobs_vpc_settings_configured"
      ],
      "Attributes": [
        {
          "Section": "sagemaker",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Amazon SageMaker Training job have VPC settings configured.",
          "RationaleStatement": "This could provide an avenue for unauthorized access to your data.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Restrict which traffic can access by launching Studio in a Virtual Private Cloud (VPC) of your choosing.",
              "Url": "https://docs.aws.amazon.com/sagemaker/latest/dg/interface-vpc-endpoint.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/sagemaker/latest/dg/interface-vpc-endpoint.html",
          "ISMS-P Codes": "2.6.2, 2.8.1"
        }
      ]
    },
    {
      "Id": "sagemaker_notebook_instance_root_access_disabled",
      "Description": "Check if Amazon SageMaker Notebook instances have root access disabled",
      "Checks": [
        "sagemaker_notebook_instance_root_access_disabled"
      ],
      "Attributes": [
        {
          "Section": "sagemaker",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Amazon SageMaker Notebook instances have root access disabled",
          "RationaleStatement": "Users with root access have administrator privileges, users can access and edit all files on a notebook instance with root access enabled",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Set the RootAccess field to Disabled. You can also disable root access for users when you create or update a notebook instance in the Amazon SageMaker console.",
              "Url": "https://docs.aws.amazon.com/sagemaker/latest/dg/nbi-root-access.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/sagemaker/latest/dg/nbi-root-access.html",
          "ISMS-P Codes": "2.5.5, 2.6.2, 2.6.3, 2.8.1"
        }
      ]
    },
    {
      "Id": "sagemaker_training_jobs_intercontainer_encryption_enabled",
      "Description": "Check if Amazon SageMaker Training jobs have intercontainer encryption enabled",
      "Checks": [
        "sagemaker_training_jobs_intercontainer_encryption_enabled"
      ],
      "Attributes": [
        {
          "Section": "sagemaker",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Amazon SageMaker Training jobs have intercontainer encryption enabled",
          "RationaleStatement": "If not restricted unintended access could happen.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Internetwork communications support TLS 1.2 encryption between all components and clients.",
              "Url": "https://docs.aws.amazon.com/sagemaker/latest/dg/interface-vpc-endpoint.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/sagemaker/latest/dg/interface-vpc-endpoint.html",
          "ISMS-P Codes": "2.7.1, 2.8.1"
        }
      ]
    },
    {
      "Id": "sagemaker_models_network_isolation_enabled",
      "Description": "Check if Amazon SageMaker Models have network isolation enabled",
      "Checks": [
        "sagemaker_models_network_isolation_enabled"
      ],
      "Attributes": [
        {
          "Section": "sagemaker",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Amazon SageMaker Models have network isolation enabled",
          "RationaleStatement": "This could provide an avenue for unauthorized access to your data.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Restrict which traffic can access by launching Studio in a Virtual Private Cloud (VPC) of your choosing.",
              "Url": "https://docs.aws.amazon.com/sagemaker/latest/dg/studio-notebooks-and-internet-access.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/sagemaker/latest/dg/studio-notebooks-and-internet-access.html",
          "ISMS-P Codes": "2.6.1, 2.6.2, 2.6.3, 2.8.1"
        }
      ]
    },
    {
      "Id": "sagemaker_notebook_instance_without_direct_internet_access_configured",
      "Description": "Check if Amazon SageMaker Notebook instances have direct internet access",
      "Checks": [
        "sagemaker_notebook_instance_without_direct_internet_access_configured"
      ],
      "Attributes": [
        {
          "Section": "sagemaker",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Amazon SageMaker Notebook instances have direct internet access",
          "RationaleStatement": "This could provide an avenue for unauthorized access to your data.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/SageMaker/notebook-direct-internet-access.html",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/SageMaker/notebook-direct-internet-access.html",
              "Terraform": "https://docs.prowler.com/checks/aws/networking-policies/ensure-that-direct-internet-access-is-disabled-for-an-amazon-sagemaker-notebook-instance#fix---buildtime"
            },
            "Recommendation": {
              "Text": "Restrict which traffic can access by launching Studio in a Virtual Private Cloud (VPC) of your choosing.",
              "Url": "https://docs.aws.amazon.com/sagemaker/latest/dg/interface-vpc-endpoint.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/sagemaker/latest/dg/interface-vpc-endpoint.html",
          "ISMS-P Codes": "2.6.1, 2.6.3, 2.6.6, 2.6.7, 2.8.1"
        }
      ]
    },
    {
      "Id": "sagemaker_notebook_instance_encryption_enabled",
      "Description": "Check if Amazon SageMaker Notebook instances have data encryption enabled",
      "Checks": [
        "sagemaker_notebook_instance_encryption_enabled"
      ],
      "Attributes": [
        {
          "Section": "sagemaker",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Amazon SageMaker Notebook instances have data encryption enabled",
          "RationaleStatement": "Data exfiltration could happen if information is not protected. KMS keys provide additional security level to IAM policies.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/SageMaker/notebook-data-encrypted.html",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/SageMaker/notebook-data-encrypted.html",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_40#fix---buildtime"
            },
            "Recommendation": {
              "Text": "Specify AWS KMS keys to use for input and output from S3 and EBS.",
              "Url": "https://docs.aws.amazon.com/sagemaker/latest/dg/key-management.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/sagemaker/latest/dg/key-management.html",
          "ISMS-P Codes": "2.7.1, 2.7.2, 2.8.1"
        }
      ]
    },
    {
      "Id": "sagemaker_notebook_instance_vpc_settings_configured",
      "Description": "Check if Amazon SageMaker Notebook instances have VPC settings configured",
      "Checks": [
        "sagemaker_notebook_instance_vpc_settings_configured"
      ],
      "Attributes": [
        {
          "Section": "sagemaker",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Amazon SageMaker Notebook instances have VPC settings configured",
          "RationaleStatement": "This could provide an avenue for unauthorized access to your data.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/SageMaker/notebook-instance-in-vpc.html",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/SageMaker/notebook-instance-in-vpc.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Restrict which traffic can access by launching Studio in a Virtual Private Cloud (VPC) of your choosing..",
              "Url": "https://docs.aws.amazon.com/sagemaker/latest/dg/studio-notebooks-and-internet-access.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/sagemaker/latest/dg/studio-notebooks-and-internet-access.html",
          "ISMS-P Codes": "2.6.1, 2.6.3, 2.8.1"
        }
      ]
    },
    {
      "Id": "acm_certificates_expiration_check",
      "Description": "Check if ACM Certificates are about to expire in specific days or less",
      "Checks": [
        "acm_certificates_expiration_check"
      ],
      "Attributes": [
        {
          "Section": "acm",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if ACM Certificates are about to expire in specific days or less",
          "RationaleStatement": "Expired certificates can impact service availability.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Monitor certificate expiration and take automated action to renew, replace or remove. Having shorter TTL for any security artifact is a general recommendation, but requires additional automation in place. If not longer required delete certificate. Use AWS config using the managed rule: acm-certificate-expiration-check.",
              "Url": "https://docs.aws.amazon.com/config/latest/developerguide/acm-certificate-expiration-check.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/config/latest/developerguide/acm-certificate-expiration-check.html",
          "ISMS-P Codes": "2.9.1, 2.10.1"
        }
      ]
    },
    {
      "Id": "acm_certificates_transparency_logs_enabled",
      "Description": "Check if ACM certificates have Certificate Transparency logging enabled",
      "Checks": [
        "acm_certificates_transparency_logs_enabled"
      ],
      "Attributes": [
        {
          "Section": "acm",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if ACM certificates have Certificate Transparency logging enabled",
          "RationaleStatement": "Domain owners can search the log to identify unexpected certificates, whether issued by mistake or malice. Domain owners can also identify Certificate Authorities (CAs) that are improperly issuing certificates.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Make sure you are logging information about Lambda operations. Create a lifecycle and use cases for each trail.",
              "Url": "https://aws.amazon.com/blogs/security/how-to-get-ready-for-certificate-transparency/"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://aws.amazon.com/blogs/security/how-to-get-ready-for-certificate-transparency/",
          "ISMS-P Codes": "2.7.2, 2.10.1, 2.10.3"
        }
      ]
    },
    {
      "Id": "athena_workgroup_enforce_configuration",
      "Description": "Ensure that workgroup configuration is enforced so it cannot be overriden by client-side settings.",
      "Checks": [
        "athena_workgroup_enforce_configuration"
      ],
      "Attributes": [
        {
          "Section": "athena",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure that workgroup configuration is enforced so it cannot be overriden by client-side settings.",
          "RationaleStatement": "If workgroup configuration is not enforced security settings like encryption can be overriden by client-side settings.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws athena update-work-group --region <REGION> --work-group <workgroup_name> --configuration-updates EnforceWorkGroupConfiguration=True",
              "NativeIaC": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_33#cloudformation",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_33#terraform"
            },
            "Recommendation": {
              "Text": "Ensure that workgroup configuration is enforced so it cannot be overriden by client-side settings.",
              "Url": "https://docs.aws.amazon.com/athena/latest/ug/workgroups-settings-override.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/athena/latest/ug/workgroups-settings-override.html",
          "ISMS-P Codes": "2.7.1, 2.9.2"
        }
      ]
    },
    {
      "Id": "athena_workgroup_encryption",
      "Description": "Ensure that encryption at rest is enabled for Amazon Athena query results stored in Amazon S3 in order to secure data and meet compliance requirements for data-at-rest encryption.",
      "Checks": [
        "athena_workgroup_encryption"
      ],
      "Attributes": [
        {
          "Section": "athena",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure that encryption at rest is enabled for Amazon Athena query results stored in Amazon S3 in order to secure data and meet compliance requirements for data-at-rest encryption.",
          "RationaleStatement": "If not enabled sensitive information at rest is not protected.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws athena update-work-group --region <REGION> --work-group <workgroup_name> --configuration-updates ResultConfigurationUpdates={EncryptionConfiguration={EncryptionOption=SSE_S3|SSE_KMS|CSE_KMS}}",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Athena/encryption-enabled.html",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/ensure-that-athena-workgroup-is-encrypted#terraform"
            },
            "Recommendation": {
              "Text": "Enable Encryption. Use a CMK where possible. It will provide additional management and privacy benefits.",
              "Url": "https://docs.aws.amazon.com/athena/latest/ug/encrypting-query-results-stored-in-s3.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/athena/latest/ug/encryption.html",
          "ISMS-P Codes": "2.7.1, 2.8.1"
        }
      ]
    },
    {
      "Id": "route53_public_hosted_zones_cloudwatch_logging_enabled",
      "Description": "Check if Route53 public hosted zones are logging queries to CloudWatch Logs.",
      "Checks": [
        "route53_public_hosted_zones_cloudwatch_logging_enabled"
      ],
      "Attributes": [
        {
          "Section": "route53",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Route53 public hosted zones are logging queries to CloudWatch Logs.",
          "RationaleStatement": "If logs are not enabled, monitoring of service use and threat analysis is not possible.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws route53 create-query-logging-config\u00a0 --hosted-zone-id <zone_id>\u00a0 --cloud-watch-logs-log-group-arn <log_group_arn>",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Route53/enable-query-logging.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Enable CloudWatch logs and define metrics and uses cases for the events recorded.",
              "Url": "https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/monitoring-hosted-zones-with-cloudwatch.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/monitoring-hosted-zones-with-cloudwatch.html",
          "ISMS-P Codes": "2.9.4, 2.9.5, 2.11.1, 2.11.3, 3.1.1"
        }
      ]
    },
    {
      "Id": "route53_domains_transferlock_enabled",
      "Description": "Enable Transfer Lock for a Route53 Domain.",
      "Checks": [
        "route53_domains_transferlock_enabled"
      ],
      "Attributes": [
        {
          "Section": "route53",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Enable Transfer Lock for a Route53 Domain.",
          "RationaleStatement": "Without transfer lock enabled, a domain name could be incorrectly moved to a new registrar.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws route53domains enable-domain-transfer-lock --domain-name DOMAIN",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Ensure transfer lock is enabled.",
              "Url": "https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/domain-lock.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/domain-lock.html",
          "ISMS-P Codes": "2.5.5, 2.9.3"
        }
      ]
    },
    {
      "Id": "route53_domains_privacy_protection_enabled",
      "Description": "Enable Privacy Protection for for a Route53 Domain.",
      "Checks": [
        "route53_domains_privacy_protection_enabled"
      ],
      "Attributes": [
        {
          "Section": "route53",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Enable Privacy Protection for for a Route53 Domain.",
          "RationaleStatement": "Without privacy protection enabled, ones personal information is published to the public WHOIS database.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws route53domains update-domain-contact-privacy --domain-name domain.com --registrant-privacy",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Route53/privacy-protection.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Ensure default Privacy is enabled.",
              "Url": "https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/domain-privacy-protection.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/domain-privacy-protection.html",
          "ISMS-P Codes": "1.2.1, 2.1.3, 3.1.1, 3.1.2, 3.1.3"
        }
      ]
    },
    {
      "Id": "route53_dangling_ip_subdomain_takeover",
      "Description": "Check if Route53 Records contains dangling IPs.",
      "Checks": [
        "route53_dangling_ip_subdomain_takeover"
      ],
      "Attributes": [
        {
          "Section": "route53",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if Route53 Records contains dangling IPs.",
          "RationaleStatement": "When an ephemeral AWS resource such as an Elastic IP (EIP) is released into the Amazon's Elastic IP pool, an attacker may acquire the EIP resource and effectively control the domain/subdomain associated with that EIP in your Route 53 DNS records.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws route53 change-resource-record-sets --hosted-zone-id <resource_id>",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Route53/dangling-dns-records.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Ensure that any dangling DNS records are deleted from your Amazon Route 53 public hosted zones in order to maintain the integrity and authenticity of your domains/subdomains and to protect against domain hijacking attacks.",
              "Url": "https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/resource-record-sets-deleting.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.9.7, 2.11.1"
        }
      ]
    },
    {
      "Id": "ec2_instance_port_ldap_exposed_to_internet",
      "Description": "Ensure no EC2 instances allow ingress from the internet to TCP port 389 or 636 (LDAP).",
      "Checks": [
        "ec2_instance_port_ldap_exposed_to_internet"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no EC2 instances allow ingress from the internet to TCP port 389 or 636 (LDAP).",
          "RationaleStatement": "LDAP is a protocol used for authentication and authorization. Exposing LDAP to the internet can lead to unauthorized access to the LDAP server and the data it contains.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Modify the security group to remove the rule that allows ingress from the internet to TCP port 389 or 636 (LDAP).",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.2, 2.10.1"
        }
      ]
    },
    {
      "Id": "ec2_securitygroup_allow_ingress_from_internet_to_any_port",
      "Description": "Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to any port.",
      "Checks": [
        "ec2_securitygroup_allow_ingress_from_internet_to_any_port"
      ],
      "Attributes": [
        {
          "Section": "securitygroup",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to any port.",
          "RationaleStatement": "If Security groups are not properly configured the attack surface is increased.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.6, 2.10.1"
        }
      ]
    },
    {
      "Id": "ec2_instance_port_kerberos_exposed_to_internet",
      "Description": "Ensure no EC2 instances allow ingress from the internet to TCP port 88, 464, 749 or 750 (Kerberos).",
      "Checks": [
        "ec2_instance_port_kerberos_exposed_to_internet"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no EC2 instances allow ingress from the internet to TCP port 88, 464, 749 or 750 (Kerberos).",
          "RationaleStatement": "Kerberos is a network authentication protocol that uses secret-key cryptography to authenticate clients and servers. It is typically used in environments where users need to authenticate to access network resources. If an EC2 instance allows ingress from the internet to TCP port 88 or 464, it may be vulnerable to unauthorized access.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Modify the security group to remove the rule that allows ingress from the internet to TCP port 88, 464, 749 or 750 (Kerberos).",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.2, 2.10.1"
        }
      ]
    },
    {
      "Id": "ec2_instance_detailed_monitoring_enabled",
      "Description": "Check if EC2 instances have detailed monitoring enabled.",
      "Checks": [
        "ec2_instance_detailed_monitoring_enabled"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if EC2 instances have detailed monitoring enabled.",
          "RationaleStatement": "Enabling detailed monitoring provides enhanced monitoring and granular insights into EC2 instance metrics. Not having detailed monitoring enabled may limit the ability to troubleshoot performance issues effectively.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/EC2/instance-detailed-monitoring.html",
              "NativeIaC": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/EC2/instance-detailed-monitoring.html",
              "Other": "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-cloudwatch-new.html#enable-detailed-monitoring-instance",
              "Terraform": "https://docs.prowler.com/checks/aws/logging-policies/ensure-that-detailed-monitoring-is-enabled-for-ec2-instances#terraform"
            },
            "Recommendation": {
              "Text": "Enable detailed monitoring for EC2 instances to gain better insights into performance metrics.",
              "Url": "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-cloudwatch-new.html#enable-detailed-monitoring-instance"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-cloudwatch-new.html",
          "ISMS-P Codes": "2.9.2, 2.9.4, 2.11.3"
        }
      ]
    },
    {
      "Id": "ec2_securitygroup_from_launch_wizard",
      "Description": "Security Groups created by EC2 Launch Wizard.",
      "Checks": [
        "ec2_securitygroup_from_launch_wizard"
      ],
      "Attributes": [
        {
          "Section": "securitygroup",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Security Groups created by EC2 Launch Wizard.",
          "RationaleStatement": "Security Groups Created on the AWS Console using the EC2 wizard may allow port 22 from 0.0.0.0/0.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/EC2/security-group-prefixed-with-launch-wizard.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Apply Zero Trust approach. Implement a process to scan and remediate security groups created by the EC2 Wizard. Recommended best practices is to use an authorized security group.",
              "Url": "https://docs.aws.amazon.com/eks/latest/userguide/sec-group-reqs.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.6, 2.8.1"
        }
      ]
    },
    {
      "Id": "ec2_securitygroup_not_used",
      "Description": "Ensure there are no Security Groups not being used.",
      "Checks": [
        "ec2_securitygroup_not_used"
      ],
      "Attributes": [
        {
          "Section": "securitygroup",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure there are no Security Groups not being used.",
          "RationaleStatement": "Having clear definition and scope for Security Groups creates a better administration environment.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "List all the security groups and then use the cli to check if they are attached to an instance.",
              "Url": "https://aws.amazon.com/premiumsupport/knowledge-center/ec2-find-security-group-resources/"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.8.1, 2.10.1"
        }
      ]
    },
    {
      "Id": "ec2_elastic_ip_unassigned",
      "Description": "Check if there is any unassigned Elastic IP.",
      "Checks": [
        "ec2_elastic_ip_unassigned"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if there is any unassigned Elastic IP.",
          "RationaleStatement": "Unassigned Elastic IPs may result in extra cost.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws ec2 release-address --public-ip <theIPyoudontneed>",
              "NativeIaC": "https://docs.prowler.com/checks/aws/general-policies/general_19#cloudformation",
              "Other": "https://docs.prowler.com/checks/aws/general-policies/general_19#ec2-console",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/general_19#terraform"
            },
            "Recommendation": {
              "Text": "Ensure Elastic IPs are not unassigned.",
              "Url": "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/elastic-ip-addresses-eip.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.1.3"
        }
      ]
    },
    {
      "Id": "ec2_instance_secrets_user_data",
      "Description": "Find secrets in EC2 User Data.",
      "Checks": [
        "ec2_instance_secrets_user_data"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Find secrets in EC2 User Data.",
          "RationaleStatement": "Secrets hardcoded into instance user data can be used by malware and bad actors to gain lateral access to other services.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/secrets-policies/bc_aws_secrets_1#cli-command",
              "NativeIaC": "https://docs.prowler.com/checks/aws/secrets-policies/bc_aws_secrets_1#cloudformation",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/secrets-policies/bc_aws_secrets_1#terraform"
            },
            "Recommendation": {
              "Text": "Implement automated detective control (e.g. using tools like Prowler) to scan accounts for passwords and secrets. Use secrets manager service to store and retrieve passwords and secrets.",
              "Url": "https://docs.aws.amazon.com/secretsmanager/latest/userguide/tutorials_basic.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.4, 2.7.2"
        }
      ]
    },
    {
      "Id": "ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_cassandra_7199_9160_8888",
      "Description": "Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Cassandra ports 7199 or 9160 or 8888.",
      "Checks": [
        "ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_cassandra_7199_9160_8888"
      ],
      "Attributes": [
        {
          "Section": "securitygroup",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Cassandra ports 7199 or 9160 or 8888.",
          "RationaleStatement": "If Security groups are not properly configured the attack surface is increased.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.2, 2.6.4, 2.10.1"
        }
      ]
    },
    {
      "Id": "ec2_securitygroup_default_restrict_traffic",
      "Description": "Ensure the default security group of every VPC restricts all traffic.",
      "Checks": [
        "ec2_securitygroup_default_restrict_traffic"
      ],
      "Attributes": [
        {
          "Section": "securitygroup",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure the default security group of every VPC restricts all traffic.",
          "RationaleStatement": "Even having a perimeter firewall, having security groups open allows any user or malware with vpc access to scan for well known and sensitive ports and gain access to instance.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "https://docs.prowler.com/checks/aws/networking-policies/networking_4#aws-console",
              "Terraform": "https://docs.prowler.com/checks/aws/networking-policies/networking_4#terraform"
            },
            "Recommendation": {
              "Text": "Apply Zero Trust approach. Implement a process to scan and remediate unrestricted or overly permissive security groups. Recommended best practices is to narrow the definition for the minimum ports required.",
              "Url": "https://docs.aws.amazon.com/eks/latest/userguide/sec-group-reqs.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.2, 2.6.3, 2.10.1, 2.11.1, 2.11.3"
        }
      ]
    },
    {
      "Id": "ec2_instance_port_cifs_exposed_to_internet",
      "Description": "Ensure no EC2 instances allow ingress from the internet to TCP port 139 or 445 (CIFS).",
      "Checks": [
        "ec2_instance_port_cifs_exposed_to_internet"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no EC2 instances allow ingress from the internet to TCP port 139 or 445 (CIFS).",
          "RationaleStatement": "CIFS is a file sharing protocol that is used to access files and printers on remote systems. It is not recommended to expose CIFS to the internet.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Modify the security group to remove the rule that allows ingress from the internet to TCP port 389 or 636 (LDAP).",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.3, 2.6.6"
        }
      ]
    },
    {
      "Id": "ec2_instance_port_kafka_exposed_to_internet",
      "Description": "Ensure no EC2 instances allow ingress from the internet to TCP port 9092 (Kafka).",
      "Checks": [
        "ec2_instance_port_kafka_exposed_to_internet"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no EC2 instances allow ingress from the internet to TCP port 9092 (Kafka).",
          "RationaleStatement": "Kafka is a distributed streaming platform that is used to build real-time data pipelines and streaming applications. Exposing the Kafka port to the internet can lead to unauthorized access to the Kafka cluster, which can result in data leakage, data corruption, and data loss.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Modify the security group associated with the EC2 instance to remove the rule that allows ingress from the internet to TCP port 9092 (Kafka).",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.2, 2.6.6"
        }
      ]
    },
    {
      "Id": "ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_oracle_1521_2483",
      "Description": "Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Oracle ports 1521 or 2483.",
      "Checks": [
        "ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_oracle_1521_2483"
      ],
      "Attributes": [
        {
          "Section": "securitygroup",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Oracle ports 1521 or 2483.",
          "RationaleStatement": "If Security groups are not properly configured the attack surface is increased.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.2, 2.6.4, 2.6.6, 2.10.1"
        }
      ]
    },
    {
      "Id": "ec2_instance_account_imdsv2_enabled",
      "Description": "Ensure Instance Metadata Service Version 2 (IMDSv2) is enforced for EC2 instances at the account level to protect against SSRF vulnerabilities.",
      "Checks": [
        "ec2_instance_account_imdsv2_enabled"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure Instance Metadata Service Version 2 (IMDSv2) is enforced for EC2 instances at the account level to protect against SSRF vulnerabilities.",
          "RationaleStatement": "EC2 instances that use IMDSv1 are vulnerable to SSRF attacks.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws ec2 modify-instance-metadata-defaults --region <region> --http-tokens required --http-put-response-hop-limit 2",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Enable Instance Metadata Service Version 2 (IMDSv2) on the EC2 instances. Apply this configuration at the account level for each AWS Region to set the default instance metadata version.",
              "Url": "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configuring-IMDS-new-instances.html#set-imdsv2-account-defaults"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configuring-IMDS-new-instances.html#set-imdsv2-account-defaults",
          "ISMS-P Codes": "2.10.8, 2.10.2, 2.10.9, 2.11.1"
        }
      ]
    },
    {
      "Id": "ec2_ebs_snapshot_account_block_public_access",
      "Description": "Ensure that public access to EBS snapshots is disabled",
      "Checks": [
        "ec2_ebs_snapshot_account_block_public_access"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "EBS snapshots can be shared with other AWS accounts or made public. By default, EBS snapshots are private and only the AWS account that created the snapshot can access it. If an EBS snapshot is shared with another AWS account or made public, the data in the snapshot can be accessed by the other account or by anyone on the internet. Ensure that public access to EBS snapshots is disabled.",
          "RationaleStatement": "If public access to EBS snapshots is enabled, the data in the snapshot can be accessed by anyone on the internet.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws ec2 enable-snapshot-block-public-access --state block-all-sharing",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Use the following procedures to configure and monitor block public access for snapshots.",
              "Url": "https://docs.aws.amazon.com/ebs/latest/userguide/block-public-access-snapshots-work.html#block-public-access-snapshots-enable"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/ebs/latest/userguide/block-public-access-snapshots-work.html#block-public-access-snapshots-enable",
          "ISMS-P Codes": "2.6.2, 2.6.6, 2.9.3, 2.11.1"
        }
      ]
    },
    {
      "Id": "ec2_instance_port_ssh_exposed_to_internet",
      "Description": "Ensure no EC2 instances allow ingress from the internet to TCP port 3306 (MySQL).",
      "Checks": [
        "ec2_instance_port_ssh_exposed_to_internet"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no EC2 instances allow ingress from the internet to TCP port 3306 (MySQL).",
          "RationaleStatement": "MySQL is a popular open-source relational database management system that is widely used in web applications. Exposing MySQL to the internet can lead to unauthorized access and data exfiltration.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Modify the security group associated with the EC2 instance to remove the rule that allows ingress from the internet to TCP port 3306 (MySQL).",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.2, 2.6.4, 2.6.6"
        }
      ]
    },
    {
      "Id": "ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_kafka_9092",
      "Description": "Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Kafka port 9092.",
      "Checks": [
        "ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_kafka_9092"
      ],
      "Attributes": [
        {
          "Section": "securitygroup",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Kafka port 9092.",
          "RationaleStatement": "If Security groups are not properly configured the attack surface is increased.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.2, 2.6.6, 2.10.1"
        }
      ]
    },
    {
      "Id": "ec2_securitygroup_allow_ingress_from_internet_to_port_mongodb_27017_27018",
      "Description": "Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to MongoDB ports 27017 and 27018.",
      "Checks": [
        "ec2_securitygroup_allow_ingress_from_internet_to_port_mongodb_27017_27018"
      ],
      "Attributes": [
        {
          "Section": "securitygroup",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to MongoDB ports 27017 and 27018.",
          "RationaleStatement": "If Security groups are not properly configured the attack surface is increased.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.2, 2.6.4, 2.6.6, 2.10.1"
        }
      ]
    },
    {
      "Id": "ec2_instance_port_ssh_exposed_to_internet",
      "Description": "Ensure no EC2 instances allow ingress from the internet to TCP port 22 (SSH)",
      "Checks": [
        "ec2_instance_port_ssh_exposed_to_internet"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no EC2 instances allow ingress from the internet to TCP port 22 (SSH).",
          "RationaleStatement": "SSH is a common target for brute force attacks. If an EC2 instance allows ingress from the internet to TCP port 22, it is at risk of being compromised.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Modify the security group associated with the EC2 instance to remove the rule that allows ingress from the internet to TCP port 22.",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.3, 2.6.6"
        }
      ]
    },
    {
      "Id": "ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_postgres_5432",
      "Description": "Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Postgres port 5432.",
      "Checks": [
        "ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_postgres_5432"
      ],
      "Attributes": [
        {
          "Section": "securitygroup",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Postgres port 5432.",
          "RationaleStatement": "If Security groups are not properly configured the attack surface is increased.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.2, 2.6.4, 2.6.6, 2.10.1"
        }
      ]
    },
    {
      "Id": "ec2_elastic_ip_shodan",
      "Description": "Check if any of the Elastic or Public IP are in Shodan (requires Shodan API KEY).",
      "Checks": [
        "ec2_elastic_ip_shodan"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if any of the Elastic or Public IP are in Shodan (requires Shodan API KEY).",
          "RationaleStatement": "Sites like Shodan index exposed systems and further expose them to wider audiences as a quick way to find exploitable systems.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Check Identified IPs, consider changing them to private ones and delete them from Shodan.",
              "Url": "https://www.shodan.io/"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.10.3"
        }
      ]
    },
    {
      "Id": "ec2_instance_port_rdp_exposed_to_internet",
      "Description": "Ensure no EC2 instances allow ingress from the internet to TCP port 3389 (RDP)",
      "Checks": [
        "ec2_instance_port_rdp_exposed_to_internet"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no EC2 instances allow ingress from the internet to TCP port 3389 (RDP).",
          "RationaleStatement": "RDP is a proprietary protocol developed by Microsoft for connecting to Windows systems. Exposing RDP to the internet can allow attackers to brute force the login credentials and gain unauthorized access to the EC2 instance.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Modify the security group associated with the EC2 instance to remove the rule that allows ingress from the internet to TCP port 3389 (RDP).",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.6, 2.10.3"
        }
      ]
    },
    {
      "Id": "ec2_instance_internet_facing_with_instance_profile",
      "Description": "Check for internet facing EC2 instances with Instance Profiles attached.",
      "Checks": [
        "ec2_instance_internet_facing_with_instance_profile"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check for internet facing EC2 instances with Instance Profiles attached.",
          "RationaleStatement": "Exposing an EC2 directly to internet increases the attack surface and therefore the risk of compromise.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Use an ALB and apply WAF ACL.",
              "Url": "https://aws.amazon.com/blogs/aws/aws-web-application-firewall-waf-for-application-load-balancers/"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.10.2, 2.10.3, 2.11.1"
        }
      ]
    },
    {
      "Id": "ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_redis_6379",
      "Description": "Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Redis port 6379.",
      "Checks": [
        "ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_redis_6379"
      ],
      "Attributes": [
        {
          "Section": "securitygroup",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Redis port 6379.",
          "RationaleStatement": "If Security groups are not properly configured the attack surface is increased.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.4, 2.10.1"
        }
      ]
    },
    {
      "Id": "ec2_securitygroup_allow_wide_open_public_ipv4",
      "Description": "Ensure no security groups allow ingress from wide-open non-RFC1918 address.",
      "Checks": [
        "ec2_securitygroup_allow_wide_open_public_ipv4"
      ],
      "Attributes": [
        {
          "Section": "securitygroup",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no security groups allow ingress from wide-open non-RFC1918 address.",
          "RationaleStatement": "If Security groups are not properly configured the attack surface is increased.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.4, 2.10.1"
        }
      ]
    },
    {
      "Id": "ec2_instance_port_cassandra_exposed_to_internet",
      "Description": "Ensure no EC2 instances allow ingress from the internet to Cassandra ports (TCP 7000, 7001, 7199, 9042, 9160).",
      "Checks": [
        "ec2_instance_port_cassandra_exposed_to_internet"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no EC2 instances allow ingress from the internet to Cassandra ports (TCP 7000, 7001, 7199, 9042, 9160).",
          "RationaleStatement": "Cassandra is a distributed database management system designed to handle large amounts of data across many commodity servers, providing high availability with no single point of failure. Exposing Cassandra ports to the internet can lead to unauthorized access to the database, data exfiltration, and data loss.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Modify the security group to remove the rule that allows ingress from the internet to TCP ports 7000, 7001, 7199, 9042 or 9160.",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.4, 2.10.3"
        }
      ]
    },
    {
      "Id": "ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_telnet_23",
      "Description": "Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Telnet port 23.",
      "Checks": [
        "ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_telnet_23"
      ],
      "Attributes": [
        {
          "Section": "securitygroup",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Telnet port 23.",
          "RationaleStatement": "If Security groups are not properly configured the attack surface is increased.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.3, 2.10.1"
        }
      ]
    },
    {
      "Id": "ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_sql_server_1433_1434",
      "Description": "Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Windows SQL Server ports 1433 or 1434.",
      "Checks": [
        "ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_sql_server_1433_1434"
      ],
      "Attributes": [
        {
          "Section": "securitygroup",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Windows SQL Server ports 1433 or 1434.",
          "RationaleStatement": "If Security groups are not properly configured the attack surface is increased.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.4, 2.10.1"
        }
      ]
    },
    {
      "Id": "ec2_instance_managed_by_ssm",
      "Description": "Check if EC2 instances are managed by Systems Manager.",
      "Checks": [
        "ec2_instance_managed_by_ssm"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if EC2 instances are managed by Systems Manager.",
          "RationaleStatement": "AWS Config provides AWS Managed Rules, which are predefined, customizable rules that AWS Config uses to evaluate whether your AWS resource configurations comply with common best practices.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/SSM/ssm-managed-instances.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Verify and apply Systems Manager Prerequisites.",
              "Url": "https://docs.aws.amazon.com/systems-manager/latest/userguide/managed_instances.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.9.1.2.9.2, 2.9.4"
        }
      ]
    },
    {
      "Id": "ec2_instance_port_kafka_exposed_to_internet",
      "Description": "Ensure no EC2 instances allow ingress from the internet to TCP port 11211 (Memcached).",
      "Checks": [
        "ec2_instance_port_kafka_exposed_to_internet"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no EC2 instances allow ingress from the internet to TCP port 11211 (Memcached).",
          "RationaleStatement": "Memcached is an open-source, high-performance, distributed memory object caching system. It is often used to speed up dynamic database-driven websites by caching data and objects in RAM to reduce the number of times an external data source must be read. Memcached is designed to be used in trusted environments and should not be exposed to the internet. If Memcached is exposed to the internet, it can be exploited by attackers to perform distributed denial-of-service (DDoS) attacks, data exfiltration, and other malicious activities.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Modify the security group associated with the EC2 instance to remove the rule that allows ingress from the internet to TCP port 11211 (Memcached).",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.2, 2.6.6"
        }
      ]
    },
    {
      "Id": "ec2_networkacl_allow_ingress_any_port",
      "Description": "Ensure no Network ACLs allow ingress from 0.0.0.0/0 to any port.",
      "Checks": [
        "ec2_networkacl_allow_ingress_any_port"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no Network ACLs allow ingress from 0.0.0.0/0 to any port.",
          "RationaleStatement": "Even having a perimeter firewall, having network acls open allows any user or malware with vpc access to scan for well known and sensitive ports and gain access to instance.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Apply Zero Trust approach. Implement a process to scan and remediate unrestricted or overly permissive network acls. Recommended best practices is to narrow the definition for the minimum ports required.",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.10.1, 2.10.1, 2.10.3"
        }
      ]
    },
    {
      "Id": "ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_mysql_3306",
      "Description": "Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to MySQL port 3306.",
      "Checks": [
        "ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_mysql_3306"
      ],
      "Attributes": [
        {
          "Section": "securitygroup",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to MySQL port 3306.",
          "RationaleStatement": "If Security groups are not properly configured the attack surface is increased.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.4, 2.10.1"
        }
      ]
    },
    {
      "Id": "ec2_ebs_public_snapshot",
      "Description": "Ensure there are no EBS Snapshots set as Public.",
      "Checks": [
        "ec2_ebs_public_snapshot"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure there are no EBS Snapshots set as Public.",
          "RationaleStatement": "When you share a snapshot, you are giving others access to all of the data on the snapshot. Share snapshots only with people with whom you want to share all of your snapshot data.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/public-policies/public_7#cli-command",
              "NativeIaC": "",
              "Other": "https://docs.prowler.com/checks/aws/public-policies/public_7#aws-console",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Ensure the snapshot should be shared.",
              "Url": "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-modifying-snapshot-permissions.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.2, 2.6.6, 2.9.7"
        }
      ]
    },
    {
      "Id": "ec2_ebs_default_encryption",
      "Description": "Check if EBS Default Encryption is activated.",
      "Checks": [
        "ec2_ebs_default_encryption"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if EBS Default Encryption is activated.",
          "RationaleStatement": "If not enabled sensitive information at rest is not protected.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws ec2 enable-ebs-encryption-by-default",
              "NativeIaC": "",
              "Other": "https://docs.prowler.com/checks/aws/general-policies/ensure-ebs-default-encryption-is-enabled#aws-console",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/ensure-ebs-default-encryption-is-enabled#terraform"
            },
            "Recommendation": {
              "Text": "Enable Encryption. Use a CMK where possible. It will provide additional management and privacy benefits.",
              "Url": "https://aws.amazon.com/premiumsupport/knowledge-center/ebs-automatic-encryption/"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.7.1"
        }
      ]
    },
    {
      "Id": "ec2_networkacl_allow_ingress_tcp_port_3389",
      "Description": "Ensure no Network ACLs allow ingress from 0.0.0.0/0 to Microsoft RDP port 3389",
      "Checks": [
        "ec2_networkacl_allow_ingress_tcp_port_3389"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no Network ACLs allow ingress from 0.0.0.0/0 to Microsoft RDP port 3389",
          "RationaleStatement": "Even having a perimeter firewall, having network acls open allows any user or malware with vpc access to scan for well known and sensitive ports and gain access to instance.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "https://docs.prowler.com/checks/aws/networking-policies/ensure-aws-nacl-does-not-allow-ingress-from-00000-to-port-3389#cloudformation",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/networking-policies/ensure-aws-nacl-does-not-allow-ingress-from-00000-to-port-3389#terraform"
            },
            "Recommendation": {
              "Text": "Apply Zero Trust approach. Implement a process to scan and remediate unrestricted or overly permissive network acls. Recommended best practices is to narrow the definition for the minimum ports required.",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.4, 2.10.1"
        }
      ]
    },
    {
      "Id": "ec2_ebs_volume_snapshots_exists",
      "Description": "Check if EBS snapshots exists.",
      "Checks": [
        "ec2_ebs_volume_snapshots_exists"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if EBS snapshots exists.",
          "RationaleStatement": "Ensure that your EBS volumes (available or in-use) have recent snapshots (taken weekly) available for point-in-time recovery for a better, more reliable data backup strategy.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws ec2 --region <REGION> create-snapshot --volume-id <VOLUME-ID>",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/EBS/ebs-volumes-recent-snapshots.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Creating point-in-time EBS snapshots periodically will allow you to handle efficiently your data recovery process in the event of a failure, to save your data before shutting down an EC2 instance, to back up data for geographical expansion and to maintain your disaster recovery stack up to date.",
              "Url": "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSSnapshots.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSSnapshots.html",
          "ISMS-P Codes": "2.1.3, 2.9.3, 2.9.7, 2.12.1, 2.12.2"
        }
      ]
    },
    {
      "Id": "ec2_instance_port_postgresql_exposed_to_internet",
      "Description": "Ensure no EC2 instances allow ingress from the internet to TCP port 5432 (PostgreSQL)",
      "Checks": [
        "ec2_instance_port_postgresql_exposed_to_internet"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no EC2 instances allow ingress from the internet to TCP port 5432 (PostgreSQL).",
          "RationaleStatement": "PostgreSQL is a popular open-source relational database management system. Exposing the PostgreSQL port to the internet can lead to unauthorized access to the database, data exfiltration, and other security risks.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Modify the security group associated with the EC2 instance to remove the rule that allows ingress from the internet to TCP port 5432 (PostgreSQL).",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.2"
        }
      ]
    },
    {
      "Id": "ec2_securitygroup_allow_ingress_from_internet_to_tcp_ftp_port_20_21",
      "Description": "Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to FTP ports 20 or 21.",
      "Checks": [
        "ec2_securitygroup_allow_ingress_from_internet_to_tcp_ftp_port_20_21"
      ],
      "Attributes": [
        {
          "Section": "securitygroup",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to FTP ports 20 or 21.",
          "RationaleStatement": "If Security groups are not properly configured the attack surface is increased.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.10.1"
        }
      ]
    },
    {
      "Id": "ec2_securitygroup_with_many_ingress_egress_rules",
      "Description": "Find security groups with more than 50 ingress or egress rules.",
      "Checks": [
        "ec2_securitygroup_with_many_ingress_egress_rules"
      ],
      "Attributes": [
        {
          "Section": "securitygroup",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Find security groups with more than 50 ingress or egress rules.",
          "RationaleStatement": "If Security groups are not properly configured the attack surface is increased.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.10.1"
        }
      ]
    },
    {
      "Id": "ec2_ebs_snapshots_encrypted",
      "Description": "Check if EBS snapshots are encrypted.",
      "Checks": [
        "ec2_ebs_snapshots_encrypted"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if EBS snapshots are encrypted.",
          "RationaleStatement": "Data encryption at rest prevents data visibility in the event of its unauthorized access or theft.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws ec2 --region <REGION> enable-ebs-encryption-by-default",
              "NativeIaC": "https://docs.prowler.com/checks/aws/general-policies/general_3-encrypt-ebs-volume#cloudformation",
              "Other": "https://docs.prowler.com/checks/aws/general-policies/general_3-encrypt-ebs-volume#aws-console",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/general_3-encrypt-ebs-volume#terraform"
            },
            "Recommendation": {
              "Text": "Encrypt all EBS Snapshot and Enable Encryption by default. You can configure your AWS account to enforce the encryption of the new EBS volumes and snapshot copies that you create. For example, Amazon EBS encrypts the EBS volumes created when you launch an instance and the snapshots that you copy from an unencrypted snapshot.",
              "Url": "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html#encryption-by-default"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.7.1"
        }
      ]
    },
    {
      "Id": "ec2_ami_public",
      "Description": "Ensure there are no EC2 AMIs set as Public.",
      "Checks": [
        "ec2_ami_public"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure there are no EC2 AMIs set as Public.",
          "RationaleStatement": "When your AMIs are publicly accessible, they are available in the Community AMIs where everyone with an AWS account can use them to launch EC2 instances. Your AMIs could contain snapshots of your applications (including their data), therefore exposing your snapshots in this manner is not advised.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/public-policies/public_8#cli-command",
              "NativeIaC": "",
              "Other": "https://docs.prowler.com/checks/aws/public-policies/public_8#aws-console",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "We recommend your EC2 AMIs are not publicly accessible, or generally available in the Community AMIs.",
              "Url": "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/cancel-sharing-an-AMI.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.1.3, 2.6.1, 2.6.6"
        }
      ]
    },
    {
      "Id": "ec2_instance_port_oracle_exposed_to_internet",
      "Description": "Ensure no EC2 instances allow ingress from the internet to TCP port 1521, 2483 or 2484 (Oracle).",
      "Checks": [
        "ec2_instance_port_oracle_exposed_to_internet"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no EC2 instances allow ingress from the internet to TCP port 1521, 2483 or 2484 (Oracle).",
          "RationaleStatement": "Oracle database servers are a high value target for attackers. Allowing internet access to these ports could lead to unauthorized access to the database.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Modify the security group to remove the rule that allows ingress from the internet to TCP port 1521, 2483 or 2484.",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.2, 2.6.4, 2.6.6"
        }
      ]
    },
    {
      "Id": "ec2_instance_older_than_specific_days",
      "Description": "Check EC2 Instances older than specific days.",
      "Checks": [
        "ec2_instance_older_than_specific_days"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check EC2 Instances older than specific days.",
          "RationaleStatement": "Having old instances within your AWS account could increase the risk of having vulnerable software.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/EC2/ec2-instance-too-old.html",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Check if software running in the instance is up to date and patched accordingly. Use AWS Systems Manager to patch instances and view patching compliance information.",
              "Url": "https://docs.aws.amazon.com/systems-manager/latest/userguide/viewing-patch-compliance-results.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.9.2, 2.10.8"
        }
      ]
    },
    {
      "Id": "ec2_launch_template_no_secrets",
      "Description": "Find secrets in EC2 Launch Template",
      "Checks": [
        "ec2_launch_template_no_secrets"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Find secrets in EC2 Launch Template",
          "RationaleStatement": "The use of a hard-coded password increases the possibility of password guessing.\u00a0 If hard-coded passwords are used, it is possible that malicious users gain access through the account in question.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Do not include sensitive information in user data within the launch templates, try to use Secrets Manager instead.",
              "Url": "https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-launch-templates.html",
          "ISMS-P Codes": "2.5.4, 2.7.2, 2.11.1, 2.11.2"
        }
      ]
    },
    {
      "Id": "ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_elasticsearch_kibana_9200_9300_5601",
      "Description": "Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Elasticsearch/Kibana ports.",
      "Checks": [
        "ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_elasticsearch_kibana_9200_9300_5601"
      ],
      "Attributes": [
        {
          "Section": "securitygroup",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Elasticsearch/Kibana ports.",
          "RationaleStatement": "If Security groups are not properly configured the attack surface is increased.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.2, 2.6.4, 2.10.1"
        }
      ]
    },
    {
      "Id": "ec2_instance_imdsv2_enabled",
      "Description": "Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required.",
      "Checks": [
        "ec2_instance_imdsv2_enabled"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required.",
          "RationaleStatement": "Using IMDSv2 will protect from misconfiguration and SSRF vulnerabilities. IMDSv1 will not.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "aws ec2 modify-instance-metadata-options --instance-id <instance-id> --http-tokens required --http-endpoint enabled",
              "NativeIaC": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_31#cloudformation",
              "Other": "https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/EC2/require-imds-v2.html",
              "Terraform": "https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_31#terraform"
            },
            "Recommendation": {
              "Text": "If you don't need IMDS you can turn it off. Using aws-cli you can force the instance to use only IMDSv2.",
              "Url": "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configuring-instance-metadata-service.html#configuring-instance-metadata-options"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.10.1, 2.11.2"
        }
      ]
    },
    {
      "Id": "ec2_ebs_volume_encryption",
      "Description": "Ensure there are no EBS Volumes unencrypted.",
      "Checks": [
        "ec2_ebs_volume_encryption"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure there are no EBS Volumes unencrypted.",
          "RationaleStatement": "Data encryption at rest prevents data visibility in the event of its unauthorized access or theft.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Encrypt all EBS volumes and Enable Encryption by default You can configure your AWS account to enforce the encryption of the new EBS volumes and snapshot copies that you create. For example, Amazon EBS encrypts the EBS volumes created when you launch an instance and the snapshots that you copy from an unencrypted snapshot.",
              "Url": "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.7.1"
        }
      ]
    },
    {
      "Id": "ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_22",
      "Description": "Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to SSH port 22.",
      "Checks": [
        "ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_22"
      ],
      "Attributes": [
        {
          "Section": "securitygroup",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to SSH port 22.",
          "RationaleStatement": "If Security groups are not properly configured the attack surface is increased.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/networking-policies/networking_1-port-security#cli-command",
              "NativeIaC": "https://docs.prowler.com/checks/aws/networking-policies/networking_1-port-security#cloudformation",
              "Other": "https://docs.prowler.com/checks/aws/networking-policies/networking_1-port-security#aws-console",
              "Terraform": "https://docs.prowler.com/checks/aws/networking-policies/networking_1-port-security#terraform"
            },
            "Recommendation": {
              "Text": "Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.6, 2.10.1"
        }
      ]
    },
    {
      "Id": "ec2_instance_port_cassandra_exposed_to_internet",
      "Description": "Ensure no EC2 instances allow ingress from the internet to Elasticsearch and Kibana ports (TCP 9200, 9300, 5601).",
      "Checks": [
        "ec2_instance_port_cassandra_exposed_to_internet"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no EC2 instances allow ingress from the internet to Elasticsearch and Kibana ports (TCP 9200, 9300, 5601).",
          "RationaleStatement": "Elasticsearch and Kibana are commonly used for log and data analysis. Allowing ingress from the internet to these ports can expose sensitive data to unauthorized users.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Modify the security group to remove the rule that allows ingress from the internet to TCP ports 9200, 9300, 5601.",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.2"
        }
      ]
    },
    {
      "Id": "ec2_instance_port_redis_exposed_to_internet",
      "Description": "Ensure no EC2 instances allow ingress from the internet to TCP port 6379 (Redis).",
      "Checks": [
        "ec2_instance_port_redis_exposed_to_internet"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no EC2 instances allow ingress from the internet to TCP port 6379 (Redis).",
          "RationaleStatement": "Redis is an open-source, in-memory data structure store, used as a database, cache, and message broker. Redis is often used to store sensitive data, such as session tokens, user credentials, and other sensitive information. Allowing ingress from the internet to TCP port 6379 (Redis) can expose sensitive data to unauthorized users.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Modify the security group associated with the EC2 instance to remove the rule that allows ingress from the internet to TCP port 6379 (Redis).",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.4"
        }
      ]
    },
    {
      "Id": "ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_3389",
      "Description": "Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to port 3389.",
      "Checks": [
        "ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_3389"
      ],
      "Attributes": [
        {
          "Section": "securitygroup",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to port 3389.",
          "RationaleStatement": "If Security groups are not properly configured the attack surface is increased.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "https://docs.prowler.com/checks/aws/networking-policies/networking_2#cli-command",
              "NativeIaC": "https://docs.prowler.com/checks/aws/networking-policies/networking_2#cloudformation",
              "Other": "https://docs.prowler.com/checks/aws/networking-policies/networking_2#aws-console",
              "Terraform": "https://docs.prowler.com/checks/aws/networking-policies/networking_2#terraform"
            },
            "Recommendation": {
              "Text": "Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.6, 2.10.1"
        }
      ]
    },
    {
      "Id": "ec2_instance_profile_attached",
      "Description": "Ensure IAM instance roles are used for AWS resource access from instances",
      "Checks": [
        "ec2_instance_profile_attached"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure IAM instance roles are used for AWS resource access from instances.",
          "RationaleStatement": "AWS access from within AWS instances can be done by either encoding AWS keys into AWS API calls or by assigning the instance to a role which has an appropriate permissions policy for the required access. AWS IAM roles reduce the risks associated with sharing and rotating credentials that can be used outside of AWS itself. If credentials are compromised, they can be used from outside of the AWS account.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "https://github.com/cloudmatos/matos/tree/master/remediations/aws/ec2/attach_iam_roles_ec2_instances",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Create an IAM instance role if necessary and attach it to the corresponding EC2 instance..",
              "Url": "http://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_switch-role-ec2.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.5.5"
        }
      ]
    },
    {
      "Id": "ec2_instance_port_sqlserver_exposed_to_internet",
      "Description": "Ensure no EC2 instances allow ingress from the internet to TCP port 1433 or 1434 (SQL Server).",
      "Checks": [
        "ec2_instance_port_sqlserver_exposed_to_internet"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no EC2 instances allow ingress from the internet to TCP port 1433 or 1434 (SQL Server).",
          "RationaleStatement": "SQL Server is a database management system that is used to store and retrieve data. If an EC2 instance allows ingress from the internet to TCP port 1433 or 1434, it may be vulnerable to unauthorized access and data exfiltration.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Modify the security group to remove the rule that allows ingress from the internet to TCP port 1433 or 1434 (SQL Server).",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.4"
        }
      ]
    },
    {
      "Id": "ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_memcached_11211",
      "Description": "Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Memcached port 11211.",
      "Checks": [
        "ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_memcached_11211"
      ],
      "Attributes": [
        {
          "Section": "securitygroup",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Memcached port 11211.",
          "RationaleStatement": "If Security groups are not properly configured the attack surface is increased.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.2"
        }
      ]
    },
    {
      "Id": "ec2_instance_port_ftp_exposed_to_internet",
      "Description": "Ensure no EC2 instances allow ingress from the internet to TCP port 20 or 21 (FTP)",
      "Checks": [
        "ec2_instance_port_ftp_exposed_to_internet"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no EC2 instances allow ingress from the internet to TCP port 20 or 21 (FTP).",
          "RationaleStatement": "FTP is an insecure protocol and should not be used. If FTP is required, it should be used over a secure channel such as FTPS or SFTP.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Modify the security group to remove the rule that allows ingress from the internet to TCP port 20 or 21 (FTP).",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.2"
        }
      ]
    },
    {
      "Id": "ec2_instance_public_ip",
      "Description": "Check for EC2 Instances with Public IP.",
      "Checks": [
        "ec2_instance_public_ip"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Check for EC2 Instances with Public IP.",
          "RationaleStatement": "Exposing an EC2 directly to internet increases the attack surface and therefore the risk of compromise.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "https://docs.prowler.com/checks/aws/public-policies/public_12#cloudformation",
              "Other": "https://docs.prowler.com/checks/aws/public-policies/public_12#aws-console",
              "Terraform": "https://docs.prowler.com/checks/aws/public-policies/public_12#terraform"
            },
            "Recommendation": {
              "Text": "Use an ALB and apply WAF ACL.",
              "Url": "https://aws.amazon.com/blogs/aws/aws-web-application-firewall-waf-for-application-load-balancers/"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.6"
        }
      ]
    },
    {
      "Id": "ec2_networkacl_allow_ingress_tcp_port_22",
      "Description": "Ensure no Network ACLs allow ingress from 0.0.0.0/0 to SSH port 22",
      "Checks": [
        "ec2_networkacl_allow_ingress_tcp_port_22"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no Network ACLs allow ingress from 0.0.0.0/0 to SSH port 22",
          "RationaleStatement": "Even having a perimeter firewall, having network acls open allows any user or malware with vpc access to scan for well known and sensitive ports and gain access to instance.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "https://docs.prowler.com/checks/aws/networking-policies/ensure-aws-nacl-does-not-allow-ingress-from-00000-to-port-22#cloudformation",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/networking-policies/ensure-aws-nacl-does-not-allow-ingress-from-00000-to-port-22#terraform"
            },
            "Recommendation": {
              "Text": "Apply Zero Trust approach. Implement a process to scan and remediate unrestricted or overly permissive network acls. Recommended best practices is to narrow the definition for the minimum ports required.",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.3, 2.6.6"
        }
      ]
    },
    {
      "Id": "ec2_instance_port_mongodb_exposed_to_internet",
      "Description": "Ensure no EC2 instances allow ingress from the internet to TCP port 27017 or 27018 (MongoDB)",
      "Checks": [
        "ec2_instance_port_mongodb_exposed_to_internet"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no EC2 instances allow ingress from the internet to TCP port 27017 or 27018 (MongoDB).",
          "RationaleStatement": "MongoDB is a popular NoSQL database that is often used in web applications. If an EC2 instance allows ingress from the internet to TCP port 27017 or 27018, it may be vulnerable to unauthorized access and data exfiltration.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Modify the security group to remove the rule that allows ingress from the internet to TCP port 27017 or 27018 (MongoDB).",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.4"
        }
      ]
    },
    {
      "Id": "ec2_securitygroup_allow_ingress_from_internet_to_all_ports",
      "Description": "Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to all ports.",
      "Checks": [
        "ec2_securitygroup_allow_ingress_from_internet_to_all_ports"
      ],
      "Attributes": [
        {
          "Section": "securitygroup",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to all ports.",
          "RationaleStatement": "If Security groups are not properly configured the attack surface is increased. An attacker could exploit this misconfiguration to gain unauthorized access to resources.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": "https://docs.prowler.com/checks/aws/networking-policies/ensure-aws-security-group-does-not-allow-all-traffic-on-all-ports/"
            },
            "Recommendation": {
              "Text": "Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.10.1"
        }
      ]
    },
    {
      "Id": "ec2_instance_port_telnet_exposed_to_internet",
      "Description": "Ensure no EC2 instances allow ingress from the internet to TCP port 23 (Telnet).",
      "Checks": [
        "ec2_instance_port_telnet_exposed_to_internet"
      ],
      "Attributes": [
        {
          "Section": "ec2",
          "Profile": "Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Ensure no EC2 instances allow ingress from the internet to TCP port 23 (Telnet).",
          "RationaleStatement": "Telnet is an insecure protocol that transmits data in plain text. Exposure of Telnet services to the internet can lead to unauthorized access to the EC2 instance.",
          "ImpactStatement": "",
          "RemediationProcedure": {
            "Code": {
              "CLI": "",
              "NativeIaC": "",
              "Other": "",
              "Terraform": ""
            },
            "Recommendation": {
              "Text": "Modify the security group associated with the EC2 instance to remove the rule that allows ingress from the internet to TCP port 23.",
              "Url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"
            }
          },
          "AuditProcedure": "",
          "AdditionalInformation": "",
          "References": "",
          "ISMS-P Codes": "2.6.1, 2.6.3"
        }
      ]
    }
  ]
}