{
  "Framework": "CCC-Logging",
  "Version": "",
  "Provider": "GCP",
  "Description": "Logging is the process of collecting, storing and analyzing event data generated by your cloud infrastructure. Logs can cover detailed timestamped records of activities in your infrastructure or application layer.",
  "Requirements": [
    {
      "Id": "CCC.Logging.C01.TR01",
      "Description": "When a new cloud account is created, provider-level audit and network flow logging MUST be\nenabled by default and directed to the central sink.",
      "Attributes": [
        {
          "FamilyName": "Data",
          "FamilyDescription": "Controls related to the confidentiality, integrity and availability of log data.\n",
          "Section": "CCC.Logging.C01 Centralized and Comprehensive Log Aggregation",
          "SubSection": "",
          "SubSectionObjective": "Ensure all operational and security logs from across the cloud environment, including\napplications, operating systems, network traffic, and cloud service activity, are captured\nautomatically and streamed to a central, secure log management service.",
          "Applicability": [
            "tlp-clear",
            "tlp-green",
            "tlp-amber",
            "tlp-red"
          ],
          "Recommendation": "",
          "SectionThreatMappings": [
            {
              "ReferenceId": "CCC",
              "Identifiers": [
                "CCC.Logging.TH07"
              ]
            }
          ],
          "SectionGuidelineMappings": [
            {
              "ReferenceId": "NIST-CSF",
              "Identifiers": [
                "PR.PS-04"
              ]
            },
            {
              "ReferenceId": "NIST_800_53",
              "Identifiers": [
                "AU-2",
                "AU-3"
              ]
            }
          ]
        }
      ],
      "Checks": [
        "iam_audit_logs_enabled",
        "compute_subnet_flow_logs_enabled",
        "logging_sink_created"
      ]
    },
    {
      "Id": "CCC.Logging.C01.TR02",
      "Description": "When a new cloud compute resource is deployed, it MUST be configured to forward all relevant\nlogs (e.g., OS, application, service logs) to the central log sink.",
      "Attributes": [
        {
          "FamilyName": "Data",
          "FamilyDescription": "Controls related to the confidentiality, integrity and availability of log data.\n",
          "Section": "CCC.Logging.C01 Centralized and Comprehensive Log Aggregation",
          "SubSection": "",
          "SubSectionObjective": "Ensure all operational and security logs from across the cloud environment, including\napplications, operating systems, network traffic, and cloud service activity, are captured\nautomatically and streamed to a central, secure log management service.",
          "Applicability": [
            "tlp-clear",
            "tlp-green",
            "tlp-amber",
            "tlp-red"
          ],
          "Recommendation": "",
          "SectionThreatMappings": [
            {
              "ReferenceId": "CCC",
              "Identifiers": [
                "CCC.Logging.TH07"
              ]
            }
          ],
          "SectionGuidelineMappings": [
            {
              "ReferenceId": "NIST-CSF",
              "Identifiers": [
                "PR.PS-04"
              ]
            },
            {
              "ReferenceId": "NIST_800_53",
              "Identifiers": [
                "AU-2",
                "AU-3"
              ]
            }
          ]
        }
      ],
      "Checks": [
        "logging_sink_created",
        "cloudstorage_bucket_log_retention_policy_lock",
        "iam_audit_logs_enabled",
        "compute_subnet_flow_logs_enabled",
        "compute_network_dns_logging_enabled",
        "compute_loadbalancer_logging_enabled"
      ]
    },
    {
      "Id": "CCC.Logging.C02.TR01",
      "Description": "When a new log bucket or stream is created, its retention policy MUST be configured\nin accordance with organisation's data retention policy.",
      "Attributes": [
        {
          "FamilyName": "Data",
          "FamilyDescription": "Controls related to the confidentiality, integrity and availability of log data.\n",
          "Section": "CCC.Logging.C02 Enforce Data Retention Policy for Logs",
          "SubSection": "",
          "SubSectionObjective": "Ensure that the retention period configured for logs aligns with the organization's\ndata retention policy.",
          "Applicability": [
            "tlp-clear",
            "tlp-green",
            "tlp-amber",
            "tlp-red"
          ],
          "Recommendation": "",
          "SectionThreatMappings": [
            {
              "ReferenceId": "CCC",
              "Identifiers": [
                "CCC.Logging.TH05"
              ]
            }
          ],
          "SectionGuidelineMappings": [
            {
              "ReferenceId": "NIST-CSF",
              "Identifiers": [
                "GV.PO-01"
              ]
            },
            {
              "ReferenceId": "NIST_800_53",
              "Identifiers": [
                "AU-11"
              ]
            }
          ]
        }
      ],
      "Checks": [
        "cloudstorage_bucket_log_retention_policy_lock"
      ]
    },
    {
      "Id": "CCC.Logging.C02.TR02",
      "Description": "When a query is performed to retrieve log events older than the number of days defined\nin the organisation's data retention policy, it MUST return an empty result.",
      "Attributes": [
        {
          "FamilyName": "Data",
          "FamilyDescription": "Controls related to the confidentiality, integrity and availability of log data.\n",
          "Section": "CCC.Logging.C02 Enforce Data Retention Policy for Logs",
          "SubSection": "",
          "SubSectionObjective": "Ensure that the retention period configured for logs aligns with the organization's\ndata retention policy.",
          "Applicability": [
            "tlp-clear",
            "tlp-green",
            "tlp-amber",
            "tlp-red"
          ],
          "Recommendation": "",
          "SectionThreatMappings": [
            {
              "ReferenceId": "CCC",
              "Identifiers": [
                "CCC.Logging.TH05"
              ]
            }
          ],
          "SectionGuidelineMappings": [
            {
              "ReferenceId": "NIST-CSF",
              "Identifiers": [
                "GV.PO-01"
              ]
            },
            {
              "ReferenceId": "NIST_800_53",
              "Identifiers": [
                "AU-11"
              ]
            }
          ]
        }
      ],
      "Checks": [
        "cloudstorage_bucket_log_retention_policy_lock"
      ]
    },
    {
      "Id": "CCC.AuditLog.C08.TR01",
      "Description": "When an attempt is made to modify or delete data before the object\nlock period expires, then the action MUST be denied.",
      "Attributes": [
        {
          "FamilyName": "Data",
          "FamilyDescription": "Controls related to the confidentiality, integrity and availability of log data.\n",
          "Section": "CCC.Logging.C03 Enable Object Lock On Log Bucket",
          "SubSection": "",
          "SubSectionObjective": "Ensure log immutability by enabling Write Once, Read Many (WORM) protection\nusing object lock on log storage buckets. This prevents logs from being modified\nor deleted during the defined retention period, supporting compliance and forensic\nintegrity.",
          "Applicability": [
            "tlp-red",
            "tlp-amber"
          ],
          "Recommendation": "Configure object lock policy.\n",
          "SectionThreatMappings": [
            {
              "ReferenceId": "CCC",
              "Identifiers": [
                "CCC.TH07"
              ]
            }
          ],
          "SectionGuidelineMappings": [
            {
              "ReferenceId": "NIST-CSF",
              "Identifiers": [
                "PR.PS-04"
              ]
            },
            {
              "ReferenceId": "NIST_800_53",
              "Identifiers": [
                "AU-9",
                "AU-11"
              ]
            }
          ]
        }
      ],
      "Checks": [
        "cloudstorage_bucket_log_retention_policy_lock"
      ]
    },
    {
      "Id": "CCC.AuditLog.C04.TR01",
      "Description": "When restricted fields are accessed by unauthorized users, then those fields MUST remain masked.",
      "Attributes": [
        {
          "FamilyName": "Identity and Access Management",
          "FamilyDescription": "Controls that restrict who can access and modify logs.\n",
          "Section": "CCC.Logging.C04 Restrict Field And Log Type Access",
          "SubSection": "",
          "SubSectionObjective": "Configure access to logs to follow the principle of least privilege in particular where technically\npossible limit the log fields users have access to to prevent accidental exposure to sensitive\ninformation such as PII.",
          "Applicability": [
            "tlp-red",
            "tlp-amber"
          ],
          "Recommendation": "Review field level access controls on log data.\n",
          "SectionThreatMappings": [
            {
              "ReferenceId": "CCC",
              "Identifiers": [
                "CCC.Logging.TH04"
              ]
            }
          ],
          "SectionGuidelineMappings": [
            {
              "ReferenceId": "NIST-CSF",
              "Identifiers": [
                "PR.PS-04"
              ]
            },
            {
              "ReferenceId": "NIST_800_53",
              "Identifiers": [
                "AC-6",
                "AU-9",
                "AC-3",
                "PT-2",
                "PT-3",
                "PT-3"
              ]
            }
          ]
        }
      ],
      "Checks": []
    },
    {
      "Id": "CCC.Logging.C05.TR01",
      "Description": "When a log storage bucket is created, the bucket's access control settings MUST\nexplicitly deny public read and write access.",
      "Attributes": [
        {
          "FamilyName": "Identity and Access Management",
          "FamilyDescription": "Controls that restrict who can access and modify logs.\n",
          "Section": "CCC.Logging.C05 Ensure Log Bucket is Not Publicly Accessible",
          "SubSection": "",
          "SubSectionObjective": "Ensure that log storage buckets are not publicly accessible to prevent unauthorized\naccess to sensitive log data. In addition, logs should be replicated to another cloud\nregion to enhance availability, durability, and support disaster recovery requirements.",
          "Applicability": [
            "tlp-red",
            "tlp-amber",
            "tlp-green"
          ],
          "Recommendation": "Configure bucket policies and access control lists (ACLs) to restrict public access.\nRegularly review bucket permissions to ensure no public access has been inadvertently granted.\n",
          "SectionThreatMappings": [
            {
              "ReferenceId": "CCC",
              "Identifiers": [
                "CCC.TH01"
              ]
            }
          ],
          "SectionGuidelineMappings": [
            {
              "ReferenceId": "NIST-CSF",
              "Identifiers": [
                "PR.AA-05"
              ]
            },
            {
              "ReferenceId": "NIST_800_53",
              "Identifiers": [
                "AC-3",
                "SC-7"
              ]
            }
          ]
        }
      ],
      "Checks": [
        "cloudstorage_bucket_public_access",
        "cloudstorage_bucket_uniform_bucket_level_access",
        "cloudstorage_bucket_log_retention_policy_lock",
        "logging_sink_created"
      ]
    },
    {
      "Id": "CCC.Logging.C05.TR02",
      "Description": "When the URL of a log storage bucket's object is accessed publicly, the action MUST be denied\nby bucket policy.",
      "Attributes": [
        {
          "FamilyName": "Identity and Access Management",
          "FamilyDescription": "Controls that restrict who can access and modify logs.\n",
          "Section": "CCC.Logging.C05 Ensure Log Bucket is Not Publicly Accessible",
          "SubSection": "",
          "SubSectionObjective": "Ensure that log storage buckets are not publicly accessible to prevent unauthorized\naccess to sensitive log data. In addition, logs should be replicated to another cloud\nregion to enhance availability, durability, and support disaster recovery requirements.",
          "Applicability": [
            "tlp-red",
            "tlp-amber",
            "tlp-green"
          ],
          "Recommendation": "Configure bucket policies and access control lists (ACLs) to restrict public access.\nRegularly review bucket permissions to ensure no public access has been inadvertently granted.\n",
          "SectionThreatMappings": [
            {
              "ReferenceId": "CCC",
              "Identifiers": [
                "CCC.TH01"
              ]
            }
          ],
          "SectionGuidelineMappings": [
            {
              "ReferenceId": "NIST-CSF",
              "Identifiers": [
                "PR.AA-05"
              ]
            },
            {
              "ReferenceId": "NIST_800_53",
              "Identifiers": [
                "AC-3",
                "SC-7"
              ]
            }
          ]
        }
      ],
      "Checks": [
        "cloudstorage_bucket_public_access",
        "cloudstorage_bucket_uniform_bucket_level_access"
      ]
    },
    {
      "Id": "CCC.Logging.C06.TR01",
      "Description": "When a single principal executes an anomalously high number of log queries,\nan alert MUST be generated.",
      "Attributes": [
        {
          "FamilyName": "Logging and Monitoring",
          "FamilyDescription": "Controls that collect, alert, and retain logging-related events.\n",
          "Section": "CCC.Logging.C06 Detect and Alert on Potential Log Exfiltration",
          "SubSection": "",
          "SubSectionObjective": "Identify and alert on anomalous data access patterns that may indicate an attempt\nto exfiltrate log data.",
          "Applicability": [
            "tlp-green",
            "tlp-amber",
            "tlp-red"
          ],
          "Recommendation": "",
          "SectionThreatMappings": [
            {
              "ReferenceId": "CCC",
              "Identifiers": [
                "CCC.Logging.TH02"
              ]
            }
          ],
          "SectionGuidelineMappings": [
            {
              "ReferenceId": "NIST-CSF",
              "Identifiers": [
                "DE.CM-03",
                "DE.CM-09"
              ]
            },
            {
              "ReferenceId": "NIST_800_53",
              "Identifiers": [
                "SI-4",
                "CA-7",
                "AU-6"
              ]
            }
          ]
        }
      ],
      "Checks": [
        "logging_log_metric_filter_and_alert_for_audit_configuration_changes_enabled",
        "logging_log_metric_filter_and_alert_for_bucket_permission_changes_enabled",
        "logging_log_metric_filter_and_alert_for_custom_role_changes_enabled",
        "logging_log_metric_filter_and_alert_for_sql_instance_configuration_changes_enabled",
        "logging_log_metric_filter_and_alert_for_vpc_firewall_rule_changes_enabled",
        "logging_log_metric_filter_and_alert_for_vpc_network_changes_enabled",
        "logging_log_metric_filter_and_alert_for_vpc_network_route_changes_enabled",
        "logging_log_metric_filter_and_alert_for_project_ownership_changes_enabled",
        "logging_sink_created"
      ]
    },
    {
      "Id": "CCC.Logging.C07.TR01",
      "Description": "When an audit log event is recorded that corresponds to a modification of the logging service\nconfiguration such as disabling a log trail, deleting a log sink, or altering a log forwarding rule,\nan alert MUST be generated.",
      "Attributes": [
        {
          "FamilyName": "Logging and Monitoring",
          "FamilyDescription": "Controls that collect, alert, and retain logging-related events.\n",
          "Section": "CCC.Logging.C07 Detect and Alert on Log Service Tampering",
          "SubSection": "",
          "SubSectionObjective": "Alert when any component of the critical logging infrastructure is disabled, modified,\nor deleted, indicating a defense evasion attempt.",
          "Applicability": [
            "tlp-clear",
            "tlp-green",
            "tlp-amber",
            "tlp-red"
          ],
          "Recommendation": "",
          "SectionThreatMappings": [
            {
              "ReferenceId": "CCC",
              "Identifiers": [
                "CCC.TH16"
              ]
            }
          ],
          "SectionGuidelineMappings": [
            {
              "ReferenceId": "NIST-CSF",
              "Identifiers": [
                "DE.CM-03",
                "DE.CM-09"
              ]
            },
            {
              "ReferenceId": "NIST_800_53",
              "Identifiers": [
                "SI-4",
                "CA-7",
                "AU-6"
              ]
            }
          ]
        }
      ],
      "Checks": [
        "logging_log_metric_filter_and_alert_for_audit_configuration_changes_enabled",
        "logging_log_metric_filter_and_alert_for_bucket_permission_changes_enabled",
        "logging_log_metric_filter_and_alert_for_custom_role_changes_enabled",
        "logging_log_metric_filter_and_alert_for_sql_instance_configuration_changes_enabled",
        "logging_log_metric_filter_and_alert_for_vpc_firewall_rule_changes_enabled",
        "logging_log_metric_filter_and_alert_for_vpc_network_changes_enabled",
        "logging_log_metric_filter_and_alert_for_vpc_network_route_changes_enabled",
        "logging_log_metric_filter_and_alert_for_project_ownership_changes_enabled"
      ]
    }
  ]
}
