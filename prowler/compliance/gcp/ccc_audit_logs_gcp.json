{
  "Framework": "CCC-Audit-Logs",
  "Version": "",
  "Provider": "GCP",
  "Description": "Provides the ability to transmit system events, application activities, and/or user interactions to a logging service.",
  "Requirements": [
    {
      "Id": "CCC.AuditLog.C01.TR01",
      "Description": "When the signature validation process is performed, then it MUST detect any modification of data.",
      "Attributes": [
        {
          "FamilyName": "Integrity",
          "FamilyDescription": "Controls designed to protected the integrity of Audit Log data.",
          "Section": "CCC.AuditLog.C01 Implement Digital Signatures With Hash Chaining",
          "SubSection": "",
          "SubSectionObjective": "Digital signatures allows for external verification of log data tampering and\nhash chaining allows for deleted log files to be detected.",
          "Applicability": [
            "tlp-red"
          ],
          "Recommendation": "Ensure hash of data is included in digital signature.\n",
          "SectionThreatMappings": [
            {
              "ReferenceId": "CCC",
              "Identifiers": [
                "CCC.TH06",
                "CCC.TH07"
              ]
            }
          ],
          "SectionGuidelineMappings": [
            {
              "ReferenceId": "NIST-CSF",
              "Identifiers": [
                "PR.DS-01"
              ]
            },
            {
              "ReferenceId": "NIST_800_53",
              "Identifiers": [
                "AU-9"
              ]
            }
          ]
        }
      ],
      "Checks": [
        "iam_audit_logs_enabled",
        "cloudstorage_bucket_log_retention_policy_lock",
        "logging_sink_created",
        "logging_log_metric_filter_and_alert_for_audit_configuration_changes_enabled"
      ]
    },
    {
      "Id": "CCC.AuditLog.C01.TR02",
      "Description": "When the signature validation process is performed, then it MUST detect any missing (deleted) log file.",
      "Attributes": [
        {
          "FamilyName": "Integrity",
          "FamilyDescription": "Controls designed to protected the integrity of Audit Log data.",
          "Section": "CCC.AuditLog.C01 Implement Digital Signatures With Hash Chaining",
          "SubSection": "",
          "SubSectionObjective": "Digital signatures allows for external verification of log data tampering and\nhash chaining allows for deleted log files to be detected.",
          "Applicability": [
            "tlp-red"
          ],
          "Recommendation": "Ensure verification process includes a chained hash function.\n",
          "SectionThreatMappings": [
            {
              "ReferenceId": "CCC",
              "Identifiers": [
                "CCC.TH06",
                "CCC.TH07"
              ]
            }
          ],
          "SectionGuidelineMappings": [
            {
              "ReferenceId": "NIST-CSF",
              "Identifiers": [
                "PR.DS-01"
              ]
            },
            {
              "ReferenceId": "NIST_800_53",
              "Identifiers": [
                "AU-9"
              ]
            }
          ]
        }
      ],
      "Checks": [
        "iam_audit_logs_enabled",
        "logging_sink_created",
        "logging_log_metric_filter_and_alert_for_audit_configuration_changes_enabled"
      ]
    },
    {
      "Id": "CCC.AuditLog.C02.TR01",
      "Description": "When a manual action is performed to generate each audit log type,\nthen the corresponding audit log type MUST be generated and recorded.",
      "Attributes": [
        {
          "FamilyName": "Integrity",
          "FamilyDescription": "Controls designed to protected the integrity of Audit Log data.",
          "Section": "CCC.AuditLog.C02 Enable And Validate All Audit Log Types",
          "SubSection": "",
          "SubSectionObjective": "Review audit log configuration and ensure that all audit log types\nare being generated and replicated to configured sinks",
          "Applicability": [
            "tlp-red",
            "tlp-amber"
          ],
          "Recommendation": "Review audit log configuration",
          "SectionThreatMappings": [
            {
              "ReferenceId": "CCC",
              "Identifiers": [
                "CCC.TH06"
              ]
            }
          ],
          "SectionGuidelineMappings": [
            {
              "ReferenceId": "NIST-CSF",
              "Identifiers": [
                "PR.PS-04"
              ]
            },
            {
              "ReferenceId": "NIST_800_53",
              "Identifiers": [
                "AU-2",
                "AU-3",
                "AU-12"
              ]
            }
          ]
        }
      ],
      "Checks": [
        "iam_audit_logs_enabled",
        "logging_sink_created",
        "logging_log_metric_filter_and_alert_for_audit_configuration_changes_enabled",
        "logging_log_metric_filter_and_alert_for_project_ownership_changes_enabled",
        "logging_log_metric_filter_and_alert_for_bucket_permission_changes_enabled",
        "logging_log_metric_filter_and_alert_for_custom_role_changes_enabled",
        "logging_log_metric_filter_and_alert_for_sql_instance_configuration_changes_enabled",
        "logging_log_metric_filter_and_alert_for_vpc_firewall_rule_changes_enabled",
        "logging_log_metric_filter_and_alert_for_vpc_network_changes_enabled",
        "logging_log_metric_filter_and_alert_for_vpc_network_route_changes_enabled"
      ]
    },
    {
      "Id": "CCC.AuditLog.C03.TR01",
      "Description": "When an attempt is made to disable a log source, then an alert MUST be generated.",
      "Attributes": [
        {
          "FamilyName": "Integrity",
          "FamilyDescription": "Controls designed to protected the integrity of Audit Log data.",
          "Section": "CCC.AuditLog.C03 Alert On Audit Log Changes And Access",
          "SubSection": "",
          "SubSectionObjective": "Ensure that specific alerts have been configured to detect changes in\naudit log configuration such as disabling exporting of logs.\nAlerts MUST also be created to detect changes in retention/object lock policies\nfor exported data log sources/buckets.",
          "Applicability": [
            "tlp-red",
            "tlp-amber"
          ],
          "Recommendation": "Ensure alerting is correctly configured\n",
          "SectionThreatMappings": [
            {
              "ReferenceId": "CCC",
              "Identifiers": [
                "CCC.TH07"
              ]
            }
          ],
          "SectionGuidelineMappings": [
            {
              "ReferenceId": "NIST-CSF",
              "Identifiers": [
                "DE.CM-1"
              ]
            },
            {
              "ReferenceId": "NIST_800_53",
              "Identifiers": [
                "AU-5",
                "AU-6"
              ]
            }
          ]
        }
      ],
      "Checks": [
        "logging_log_metric_filter_and_alert_for_audit_configuration_changes_enabled",
        "cloudstorage_bucket_log_retention_policy_lock",
        "logging_sink_created",
        "logging_log_metric_filter_and_alert_for_bucket_permission_changes_enabled",
        "logging_log_metric_filter_and_alert_for_custom_role_changes_enabled",
        "logging_log_metric_filter_and_alert_for_sql_instance_configuration_changes_enabled",
        "logging_log_metric_filter_and_alert_for_vpc_firewall_rule_changes_enabled",
        "logging_log_metric_filter_and_alert_for_vpc_network_changes_enabled",
        "logging_log_metric_filter_and_alert_for_vpc_network_route_changes_enabled",
        "logging_log_metric_filter_and_alert_for_project_ownership_changes_enabled",
        "iam_audit_logs_enabled"
      ]
    },
    {
      "Id": "CCC.AuditLog.C03.TR02",
      "Description": "When an attempt is made to alter the retention or object lock status\nof an external data log source or bucket, then an alert MUST be generated.",
      "Attributes": [
        {
          "FamilyName": "Integrity",
          "FamilyDescription": "Controls designed to protected the integrity of Audit Log data.",
          "Section": "CCC.AuditLog.C03 Alert On Audit Log Changes And Access",
          "SubSection": "",
          "SubSectionObjective": "Ensure that specific alerts have been configured to detect changes in\naudit log configuration such as disabling exporting of logs.\nAlerts MUST also be created to detect changes in retention/object lock policies\nfor exported data log sources/buckets.",
          "Applicability": [
            "tlp-red",
            "tlp-amber"
          ],
          "Recommendation": "Ensure alerting is correctly configured\n",
          "SectionThreatMappings": [
            {
              "ReferenceId": "CCC",
              "Identifiers": [
                "CCC.TH07"
              ]
            }
          ],
          "SectionGuidelineMappings": [
            {
              "ReferenceId": "NIST-CSF",
              "Identifiers": [
                "DE.CM-1"
              ]
            },
            {
              "ReferenceId": "NIST_800_53",
              "Identifiers": [
                "AU-5",
                "AU-6"
              ]
            }
          ]
        }
      ],
      "Checks": [
        "logging_log_metric_filter_and_alert_for_audit_configuration_changes_enabled",
        "cloudstorage_bucket_log_retention_policy_lock",
        "logging_sink_created"
      ]
    },
    {
      "Id": "CCC.AuditLog.C04.TR01",
      "Description": "When audit log buckets are created then verify that server access\nlogging MUST be enabled for the audit log bucket,\nwith logs delivered to a separate, secure logging bucket.",
      "Attributes": [
        {
          "FamilyName": "Integrity",
          "FamilyDescription": "Controls designed to protected the integrity of Audit Log data.",
          "Section": "CCC.AuditLog.C04 Ensure Access Logging Is Enabled on the Audit Log Bucket",
          "SubSection": "",
          "SubSectionObjective": "Ensure that access logging is enabled for the audit log storage bucket to\ncapture all requests made to the bucket, providing an audit trail of data access.",
          "Applicability": [
            "tlp-red",
            "tlp-amber"
          ],
          "Recommendation": "Configure the audit log bucket to enable server access logging.\nEnsure the target logging bucket is configured for appropriate security,\nincluding restricted access and immutability.\n",
          "SectionThreatMappings": [
            {
              "ReferenceId": "CCC",
              "Identifiers": [
                "CCC.TH01",
                "CCC.TH09"
              ]
            }
          ],
          "SectionGuidelineMappings": [
            {
              "ReferenceId": "NIST-CSF",
              "Identifiers": [
                "DE.CM-1"
              ]
            },
            {
              "ReferenceId": "NIST_800_53",
              "Identifiers": [
                "AU-2",
                "AU-3"
              ]
            }
          ]
        }
      ],
      "Checks": [
        "cloudstorage_bucket_log_retention_policy_lock",
        "cloudstorage_bucket_public_access",
        "cloudstorage_bucket_uniform_bucket_level_access",
        "logging_sink_created"
      ]
    },
    {
      "Id": "CCC.AuditLog.C05.TR01",
      "Description": "When audit logs are exported, then audit logs MUST be present in the configured data location.",
      "Attributes": [
        {
          "FamilyName": "Availability",
          "FamilyDescription": "Controls designed to protected the availability of Audit Log data.",
          "Section": "CCC.AuditLog.C05 Export Audit Logs To Bucket",
          "SubSection": "",
          "SubSectionObjective": "Configure audit logs to be sent to a external bucket where they can be globally replicated\nand can be subject to greater access control and data retention polices.",
          "Applicability": [
            "tlp-red",
            "tlp-amber"
          ],
          "Recommendation": "Configure audit log exporting.\n",
          "SectionThreatMappings": [
            {
              "ReferenceId": "CCC",
              "Identifiers": [
                "CCC.TH07"
              ]
            }
          ],
          "SectionGuidelineMappings": [
            {
              "ReferenceId": "NIST-CSF",
              "Identifiers": [
                "PR.PS-04"
              ]
            },
            {
              "ReferenceId": "NIST_800_53",
              "Identifiers": [
                "AU-9",
                "AU-11",
                "AU-4"
              ]
            }
          ]
        }
      ],
      "Checks": [
        "logging_sink_created",
        "iam_audit_logs_enabled",
        "cloudstorage_bucket_log_retention_policy_lock",
        "cloudstorage_bucket_uniform_bucket_level_access",
        "cloudstorage_bucket_public_access"
      ]
    },
    {
      "Id": "CCC.AuditLog.C06.TR01",
      "Description": "When the retention policy is applied, then data MUST\nbe automatically deleted after the configured number of days.",
      "Attributes": [
        {
          "FamilyName": "Availability",
          "FamilyDescription": "Controls designed to protected the availability of Audit Log data.",
          "Section": "CCC.AuditLog.C06 Enforce Retention Policy on Audit Log Bucket",
          "SubSection": "",
          "SubSectionObjective": "Configure a custom retention policy on the designated audit log bucket to ensure that logs are\nretained for the correct number of days as defined by your organization's policy.",
          "Applicability": [
            "tlp-red",
            "tlp-amber",
            "tlp-green"
          ],
          "Recommendation": "Configure the audit log bucket's lifecycle rules or object retention settings to enforce\nthe required data retention period.\n",
          "SectionThreatMappings": [
            {
              "ReferenceId": "CCC",
              "Identifiers": [
                "CCC.TH06",
                "CCC.TH07"
              ]
            }
          ],
          "SectionGuidelineMappings": [
            {
              "ReferenceId": "NIST-CSF",
              "Identifiers": [
                "PR.PS-04"
              ]
            },
            {
              "ReferenceId": "NIST_800_53",
              "Identifiers": [
                "AU-9",
                "AU-11"
              ]
            }
          ]
        }
      ],
      "Checks": [
        "cloudstorage_bucket_log_retention_policy_lock",
        "logging_sink_created"
      ]
    },
    {
      "Id": "CCC.AuditLog.C07.TR01",
      "Description": "When a standard file deletion is attempted on an object within\nthe audit log bucket, then it MUST be prevented unless MFA is provided.",
      "Attributes": [
        {
          "FamilyName": "Availability",
          "FamilyDescription": "Controls designed to protected the availability of Audit Log data.",
          "Section": "CCC.AuditLog.C07 Enforce MFA Delete on Audit Log Bucket",
          "SubSection": "",
          "SubSectionObjective": "Enable Multi-Factor Authentication (MFA) delete on the audit log bucket to\nprovide greater protection against accidental or malicious deletion of audit data.",
          "Applicability": [
            "tlp-red",
            "tlp-amber",
            "tlp-green"
          ],
          "Recommendation": "Enable MFA Delete (or equivalent multi-factor authentication for delete operations)\non the audit log bucket.\n",
          "SectionThreatMappings": [
            {
              "ReferenceId": "CCC",
              "Identifiers": [
                "CCC.TH06",
                "CCC.TH07"
              ]
            }
          ],
          "SectionGuidelineMappings": [
            {
              "ReferenceId": "NIST-CSF",
              "Identifiers": [
                "PR.PS-04"
              ]
            },
            {
              "ReferenceId": "NIST_800_53",
              "Identifiers": [
                "AU-9",
                "AU-11"
              ]
            }
          ]
        }
      ],
      "Checks": [
        "cloudstorage_bucket_log_retention_policy_lock",
        "iam_audit_logs_enabled",
        "logging_sink_created"
      ]
    },
    {
      "Id": "CCC.AuditLog.C08.TR01",
      "Description": "When an attempt is made to delete data before the object\nlock period expires, then the deletion MUST be denied.",
      "Attributes": [
        {
          "FamilyName": "Availability",
          "FamilyDescription": "Controls designed to protected the availability of Audit Log data.",
          "Section": "CCC.AuditLog.C08 Enable Object Lock On Audit Log Bucket",
          "SubSection": "",
          "SubSectionObjective": "Ensure that object log is enabled globally on all objects with the bucket.\nThe lock time MUST be configured to meet your organization, legal and compliance goals.\nDeletion attempts before the lock period MUST be denied.",
          "Applicability": [
            "tlp-red",
            "tlp-amber"
          ],
          "Recommendation": "Configure object lock policy.\n",
          "SectionThreatMappings": [
            {
              "ReferenceId": "CCC",
              "Identifiers": [
                "CCC.TH07"
              ]
            }
          ],
          "SectionGuidelineMappings": [
            {
              "ReferenceId": "NIST-CSF",
              "Identifiers": [
                "PR.PS-04"
              ]
            },
            {
              "ReferenceId": "NIST_800_53",
              "Identifiers": [
                "AU-9",
                "AU-11"
              ]
            }
          ]
        }
      ],
      "Checks": [
        "cloudstorage_bucket_log_retention_policy_lock"
      ]
    },
    {
      "Id": "CCC.AuditLog.C09.TR01",
      "Description": "When restricted fields are accessed by unauthorized users, then those fields MUST remain masked.",
      "Attributes": [
        {
          "FamilyName": "Confidentiality",
          "FamilyDescription": "Controls designed to protected the confidentiality of Audit Log data.",
          "Section": "CCC.AuditLog.C09 Restrict Field And Log Type Access",
          "SubSection": "",
          "SubSectionObjective": "Configure access to audit logs to follow the principle of least privilege in particular where technically\npossible limit the log fields users have access to to prevent accidental exposure to sensitive\ninformation such as PII.",
          "Applicability": [
            "tlp-red",
            "tlp-amber"
          ],
          "Recommendation": "Review field level access controls on audit data.\n",
          "SectionThreatMappings": [
            {
              "ReferenceId": "CCC",
              "Identifiers": [
                "CCC.TH07"
              ]
            }
          ],
          "SectionGuidelineMappings": [
            {
              "ReferenceId": "NIST-CSF",
              "Identifiers": [
                "PR.PS-04"
              ]
            },
            {
              "ReferenceId": "NIST_800_53",
              "Identifiers": [
                "AC-6",
                "AU-9",
                "AC-3",
                "PT-2",
                "PT-3",
                "PT-3"
              ]
            }
          ]
        }
      ],
      "Checks": []
    },
    {
      "Id": "CCC.AuditLog.C10.TR01",
      "Description": "When audit log storage bucket's are created then, bucket's access control settings MUST explicitly deny\npublic read and write access.",
      "Attributes": [
        {
          "FamilyName": "Confidentiality",
          "FamilyDescription": "Controls designed to protected the confidentiality of Audit Log data.",
          "Section": "CCC.AuditLog.C10 Ensure Audit Bucket is Not Publicly Accessible",
          "SubSection": "",
          "SubSectionObjective": "Ensure that audit log storage buckets are not publicly accessible to prevent\nunauthorized exposure of sensitive log data.",
          "Applicability": [
            "tlp-red",
            "tlp-amber",
            "tlp-green"
          ],
          "Recommendation": "Configure bucket policies and access control lists (ACLs) to restrict public access.\nRegularly review bucket permissions to ensure no public access has been inadvertently granted.\n",
          "SectionThreatMappings": [
            {
              "ReferenceId": "CCC",
              "Identifiers": [
                "CCC.TH01"
              ]
            }
          ],
          "SectionGuidelineMappings": [
            {
              "ReferenceId": "NIST-CSF",
              "Identifiers": [
                "PR.AA-05"
              ]
            },
            {
              "ReferenceId": "NIST_800_53",
              "Identifiers": [
                "AC-3",
                "SC-7"
              ]
            }
          ]
        }
      ],
      "Checks": [
        "cloudstorage_bucket_public_access",
        "cloudstorage_bucket_uniform_bucket_level_access",
        "cloudstorage_bucket_log_retention_policy_lock"
      ]
    },
    {
      "Id": "CCC.AuditLog.C10.TR02",
      "Description": "When the URL of a audit log storage bucket's object is accessed publicly then,\nit should be denied by bucket policy.",
      "Attributes": [
        {
          "FamilyName": "Confidentiality",
          "FamilyDescription": "Controls designed to protected the confidentiality of Audit Log data.",
          "Section": "CCC.AuditLog.C10 Ensure Audit Bucket is Not Publicly Accessible",
          "SubSection": "",
          "SubSectionObjective": "Ensure that audit log storage buckets are not publicly accessible to prevent\nunauthorized exposure of sensitive log data.",
          "Applicability": [
            "tlp-red",
            "tlp-amber",
            "tlp-green"
          ],
          "Recommendation": "Configure bucket policies and access control lists (ACLs) to restrict public access.\nRegularly review bucket permissions to ensure no public access has been inadvertently granted.\n",
          "SectionThreatMappings": [
            {
              "ReferenceId": "CCC",
              "Identifiers": [
                "CCC.TH01"
              ]
            }
          ],
          "SectionGuidelineMappings": [
            {
              "ReferenceId": "NIST-CSF",
              "Identifiers": [
                "PR.AA-05"
              ]
            },
            {
              "ReferenceId": "NIST_800_53",
              "Identifiers": [
                "AC-3",
                "SC-7"
              ]
            }
          ]
        }
      ],
      "Checks": [
        "cloudstorage_bucket_public_access",
        "cloudstorage_bucket_uniform_bucket_level_access"
      ]
    }
  ]
}
