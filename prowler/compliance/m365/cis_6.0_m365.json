{
  "Framework": "CIS",
  "Name": "CIS Microsoft 365 Foundations Benchmark v6.0.0",
  "Version": "6.0",
  "Provider": "M365",
  "Description": "The CIS Microsoft 365 Foundations Benchmark provides prescriptive guidance for establishing a secure configuration posture for Microsoft 365 Cloud offerings running on any OS. This guide includes recommendations for Exchange Online, SharePoint Online, OneDrive for Business, Teams, Power BI (Fabric) and Microsoft Entra ID.",
  "Requirements": [
    {
      "Id": "1.1.1",
      "Description": "Administrative accounts are special privileged accounts that could have varying levels of access to data, users, and settings. Regular user accounts should never be utilized for administrative tasks and care should be taken, in the case of a hybrid environment, to keep administrative accounts separate from on-prem accounts. Administrative accounts should not have applications assigned so that they have no access to potentially vulnerable services (EX. email, Teams, SharePoint, etc.) and only access to perform tasks as needed for administrative purposes. Ensure administrative accounts are not On-premises sync enabled.",
      "Checks": [
        "entra_admin_users_cloud_only"
      ],
      "Attributes": [
        {
          "Section": "1 Microsoft 365 admin center",
          "SubSection": "1.1 Users",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Administrative accounts are special privileged accounts that could have varying levels of access to data, users, and settings. Regular user accounts should never be utilized for administrative tasks and care should be taken, in the case of a hybrid environment, to keep administrative accounts separate from on-prem accounts. Administrative accounts should not have applications assigned so that they have no access to potentially vulnerable services (EX. email, Teams, SharePoint, etc.) and only access to perform tasks as needed for administrative purposes. Ensure administrative accounts are not On-premises sync enabled.",
          "RationaleStatement": "In a hybrid environment, having separate accounts will help ensure that in the event of a breach in the cloud, that the breach does not affect the on-prem environment and vice versa.",
          "ImpactStatement": "Administrative users will need to utilize login/logout functionality to switch accounts when performing administrative tasks, which means they will not benefit from SSO. This will require a migration process from the 'daily driver' account to a dedicated admin account. Once the new admin account is created, permission sets should be migrated from the 'daily driver' account to the new admin account. This includes both M365 and Azure RBAC roles. Failure to migrate Azure RBAC roles could prevent an admin from seeing their subscriptions/resources while using their admin account.",
          "RemediationProcedure": "Remediation will require first identifying the privileged accounts that are synced from on-premises and then creating a new cloud-only account for that user. Once a replacement account is established, the hybrid account should have its role reduced to that of a non-privileged user or removed depending on the need.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Identity > Users and select All users. 3. To the right of the search box click the Add filter button. 4. Add the On-premises sync enabled filter with the value set to Yes and click Apply. 5. Verify that no user accounts in administrative roles are present in the filtered list.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/microsoft-365/admin/add-users/add-users?view=o365-worldwide:https://learn.microsoft.com/en-us/microsoft-365/enterprise/protect-your-global-administrator-accounts?view=o365-worldwide:https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/best-practices#9-use-cloud-native-accounts-for-microsoft-entra-roles:https://learn.microsoft.com/en-us/entra/fundamentals/whatis:https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/permissions-reference",
          "DefaultValue": "N/A"
        }
      ]
    },
    {
      "Id": "1.1.2",
      "Description": "Emergency access or 'break glass' accounts are limited for emergency scenarios where normal administrative accounts are unavailable. They are not assigned to a specific user and will have a combination of physical and technical controls to prevent them from being accessed outside a true emergency. Ensure two Emergency Access accounts have been defined.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "1 Microsoft 365 admin center",
          "SubSection": "1.1 Users",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Manual",
          "Description": "Emergency access or 'break glass' accounts are limited for emergency scenarios where normal administrative accounts are unavailable. They are not assigned to a specific user and will have a combination of physical and technical controls to prevent them from being accessed outside a true emergency. Ensure two Emergency Access accounts have been defined.",
          "RationaleStatement": "In various situations, an organization may require the use of a break glass account to gain emergency access. In the event of losing access to administrative functions, an organization may experience a significant loss in its ability to provide support, lose insight into its security posture, and potentially suffer financial losses.",
          "ImpactStatement": "If care is not taken in properly implementing an emergency access account this could weaken security posture. Microsoft recommends excluding at least one of these accounts from all conditional access rules therefore passwords must have sufficient entropy and length to protect against random guesses. FIDO2 security keys may be used instead of a password for secure passwordless solution.",
          "RemediationProcedure": "Step 1 - Create two emergency access accounts. Step 2 - Exclude at least one account from conditional access policies. Step 3 - Ensure the necessary procedures and policies are in place.",
          "AuditProcedure": "Step 1 - Ensure a policy and procedure is in place at the organization. Step 2 - Ensure two emergency access accounts are defined. Step 3 - Ensure at least one account is excluded from all conditional access rules.",
          "AdditionalInformation": "Microsoft has additional instructions regarding using Azure Monitor to capture events in the Log Analytics workspace, and then generate alerts for Emergency Access accounts.",
          "References": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/security-planning#stage-1-critical-items-to-do-right-now:https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/security-emergency-access:https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/admin-units-restricted-management:https://learn.microsoft.com/en-us/entra/identity/authentication/concept-mandatory-multifactor-authentication#accounts",
          "DefaultValue": "Not defined."
        }
      ]
    },
    {
      "Id": "1.1.3",
      "Description": "More than one global administrator should be designated so a single admin can be monitored and to provide redundancy should a single admin leave an organization. Additionally, there should be no more than four global admins set for any tenant. Ideally global administrators will have no licenses assigned to them.",
      "Checks": [
        "admincenter_users_between_two_and_four_global_admins"
      ],
      "Attributes": [
        {
          "Section": "1 Microsoft 365 admin center",
          "SubSection": "1.1 Users",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "More than one global administrator should be designated so a single admin can be monitored and to provide redundancy should a single admin leave an organization. Additionally, there should be no more than four global admins set for any tenant. Ideally global administrators will have no licenses assigned to them.",
          "RationaleStatement": "If there is only one global tenant administrator, he or she can perform malicious activity without the possibility of being discovered by another admin. If there are numerous global tenant administrators, the more likely it is that one of their accounts will be successfully breached by an external attacker.",
          "ImpactStatement": "The potential impact associated with ensuring compliance with this requirement is dependent upon the current number of global administrators configured in the tenant. If there is only one global administrator in a tenant, an additional global administrator will need to be identified and configured. If there are more than four global administrators, a review of role requirements for current global administrators will be required to identify which of the users require global administrator access.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to the Microsoft 365 admin center https://admin.microsoft.com 2. Select Users > Active Users. 3. In the Search field enter the name of the user to be made a Global Administrator. 4. To create a new Global Admin or remove Global Admins follow the appropriate steps.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to the Microsoft 365 admin center https://admin.microsoft.com 2. Select Users > Active Users. 3. Select Filter then select Global Admins. 4. Review the list of Global Admins to confirm there are from two to four such accounts.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/powershell/module/microsoft.graph.identity.directorymanagement/get-mgdirectoryrole?view=graph-powershell-1.0:https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/permissions-reference#all-roles",
          "DefaultValue": ""
        }
      ]
    },
    {
      "Id": "1.1.4",
      "Description": "Administrative accounts are special privileged accounts that could have varying levels of access to data, users, and settings. A license can enable an account to gain access to a variety of different applications, depending on the license assigned. The recommended state is to not license a privileged account or use Microsoft Entra ID P1 or Microsoft Entra ID P2 licenses.",
      "Checks": [
        "admincenter_users_admins_reduced_license_footprint"
      ],
      "Attributes": [
        {
          "Section": "1 Microsoft 365 admin center",
          "SubSection": "1.1 Users",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Administrative accounts are special privileged accounts that could have varying levels of access to data, users, and settings. A license can enable an account to gain access to a variety of different applications, depending on the license assigned. The recommended state is to not license a privileged account or use Microsoft Entra ID P1 or Microsoft Entra ID P2 licenses.",
          "RationaleStatement": "Ensuring administrative accounts do not use licenses with applications assigned to them will reduce the attack surface of high privileged identities in the organization's environment. Granting access to a mailbox or other collaborative tools increases the likelihood that privileged users might interact with these applications, raising the risk of exposure to social engineering attacks or malicious content. These activities should be restricted to an unprivileged 'daily driver' account.",
          "ImpactStatement": "Administrative users will have to switch accounts and utilize login/logout functionality when performing administrative tasks, as well as not benefiting from SSO.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft 365 admin center https://admin.microsoft.com. 2. Click to expand Users select Active users 3. Click Add a user. 4. Fill out the appropriate fields for Name, user, etc. 5. When prompted to assign licenses select as needed Microsoft Entra ID P1 or Microsoft Entra ID P2, then click Next. 6. Under the Option settings screen you may choose from several types of privileged roles. Choose Admin center access followed by the appropriate role then click Next. 7. Select Finish adding.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft 365 admin center https://admin.microsoft.com. 2. Click to expand Users select Active users. 3. Sort by the Licenses column. 4. For each user account in an administrative role verify the account is assigned a license that is not associated with applications i.e. (Microsoft Entra ID P1, Microsoft Entra ID P2).",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/microsoft-365/admin/add-users/add-users?view=o365-worldwide:https://learn.microsoft.com/en-us/microsoft-365/enterprise/protect-your-global-administrator-accounts?view=o365-worldwide:https://learn.microsoft.com/en-us/entra/fundamentals/whatis:https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/permissions-reference",
          "DefaultValue": "N/A"
        }
      ]
    },
    {
      "Id": "1.2.1",
      "Description": "Microsoft 365 Groups is the foundational membership service that drives all teamwork across Microsoft 365. With Microsoft 365 Groups, you can give a group of people access to a collection of shared resources. While there are several different group types this recommendation concerns Microsoft 365 Groups. In the Administration panel, when a group is created, the default privacy value is 'Public'.",
      "Checks": [
        "admincenter_groups_not_public_visibility"
      ],
      "Attributes": [
        {
          "Section": "1 Microsoft 365 admin center",
          "SubSection": "1.2 Teams & groups",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "Microsoft 365 Groups is the foundational membership service that drives all teamwork across Microsoft 365. With Microsoft 365 Groups, you can give a group of people access to a collection of shared resources. While there are several different group types this recommendation concerns Microsoft 365 Groups. In the Administration panel, when a group is created, the default privacy value is 'Public'.",
          "RationaleStatement": "Ensure that only organizationally managed and approved public groups exist. When a group has a 'public' privacy, users may access data related to this group (e.g. SharePoint), through three methods: By using the Azure portal, and adding themselves into the public group; By requesting access to the group from the Group application of the Access Panel; By accessing the SharePoint URL.",
          "ImpactStatement": "If the recommendation is applied, group owners could receive more access requests than usual, especially regarding groups originally meant to be public.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft 365 admin center https://admin.microsoft.com. 2. Click to expand Teams & groups select Active teams & groups. 3. On the Active teams and groups page, select the group's name that is public. 4. On the popup groups name page, Select Settings. 5. Under Privacy, select Private.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft 365 admin center https://admin.microsoft.com. 2. Click to expand Teams & groups select Active teams & groups. 3. On the Active teams and groups page, check that no groups have the status 'Public' in the privacy column.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/entra/identity/users/groups-self-service-management:https://learn.microsoft.com/en-us/microsoft-365/admin/create-groups/compare-groups?view=o365-worldwide",
          "DefaultValue": "Public when created from the Administration portal; private otherwise."
        }
      ]
    },
    {
      "Id": "1.2.2",
      "Description": "Shared mailboxes are used when multiple people need access to the same mailbox, such as a company information or support email address, reception desk, or other function that might be shared by multiple people. Shared mailboxes are created with a corresponding user account using a system generated password that is unknown at the time of creation. The recommended state is Sign in blocked for Shared mailboxes.",
      "Checks": [
        "exchange_shared_mailbox_sign_in_disabled"
      ],
      "Attributes": [
        {
          "Section": "1 Microsoft 365 admin center",
          "SubSection": "1.2 Teams & groups",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Shared mailboxes are used when multiple people need access to the same mailbox, such as a company information or support email address, reception desk, or other function that might be shared by multiple people. Shared mailboxes are created with a corresponding user account using a system generated password that is unknown at the time of creation. The recommended state is Sign in blocked for Shared mailboxes.",
          "RationaleStatement": "The intent of the shared mailbox is the only allow delegated access from other mailboxes. An admin could reset the password, or an attacker could potentially gain access to the shared mailbox allowing the direct sign-in to the shared mailbox and subsequently the sending of email from a sender that does not have a unique identity. To prevent this, block sign-in for the account that is associated with the shared mailbox.",
          "ImpactStatement": "",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft 365 admin center https://admin.microsoft.com/ 2. Click to expand Teams & groups and select Shared mailboxes. 3. Take note of all shared mailboxes. 4. Click to expand Users and select Active users. 5. Select a shared mailbox account to open its properties pane and then select Block sign-in. 6. Check the box for Block this user from signing in. 7. Repeat for any additional shared mailboxes.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft 365 admin center https://admin.microsoft.com/ 2. Click to expand Teams & groups and select Shared mailboxes. 3. Take note of all shared mailboxes. 4. Click to expand Users and select Active users. 5. Select a shared mailbox account to open its properties pane, and review. 6. Ensure the text under the name reads Sign-in blocked. 7. Repeat for any additional shared mailboxes.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/microsoft-365/admin/email/about-shared-mailboxes?view=o365-worldwide:https://learn.microsoft.com/en-us/microsoft-365/admin/email/create-a-shared-mailbox?view=o365-worldwide#block-sign-in-for-the-shared-mailbox-account:https://learn.microsoft.com/en-us/microsoft-365/enterprise/block-user-accounts-with-microsoft-365-powershell?view=o365-worldwide#block-individual-user-accounts",
          "DefaultValue": "AccountEnabled: True"
        }
      ]
    },
    {
      "Id": "1.3.1",
      "Description": "Microsoft cloud-only accounts have a pre-defined password policy that cannot be changed. The only items that can change are the number of days until a password expires and whether passwords expire at all.",
      "Checks": [
        "admincenter_settings_password_never_expire"
      ],
      "Attributes": [
        {
          "Section": "1 Microsoft 365 admin center",
          "SubSection": "1.3 Settings",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Microsoft cloud-only accounts have a pre-defined password policy that cannot be changed. The only items that can change are the number of days until a password expires and whether passwords expire at all.",
          "RationaleStatement": "Organizations such as NIST and Microsoft have updated their password policy recommendations to not arbitrarily require users to change their passwords after a specific amount of time, unless there is evidence that the password is compromised, or the user forgot it. They suggest this even for single factor (Password Only) use cases, with a reasoning that forcing arbitrary password changes on users actually make the passwords less secure.",
          "ImpactStatement": "When setting passwords not to expire it is important to have other controls in place to supplement this setting. See below for related recommendations and user guidance: Ban common passwords; Educate users to not reuse organization passwords anywhere else; Enforce Multi-Factor Authentication registration for all users.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft 365 admin center https://admin.microsoft.com. 2. Click to expand Settings select Org Settings. 3. Click on Security & privacy. 4. Check the Set passwords to never expire (recommended) box. 5. Click Save.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft 365 admin center https://admin.microsoft.com. 2. Click to expand Settings select Org Settings. 3. Click on Security & privacy. 4. Select Password expiration policy ensure that Set passwords to never expire (recommended) has been checked.",
          "AdditionalInformation": "",
          "References": "https://pages.nist.gov/800-63-3/sp800-63b.html:https://www.cisecurity.org/white-papers/cis-password-policy-guide/:https://learn.microsoft.com/en-us/microsoft-365/admin/misc/password-policy-recommendations?view=o365-worldwide",
          "DefaultValue": "If the property is not set, a default value of 90 days will be used"
        }
      ]
    },
    {
      "Id": "1.3.2",
      "Description": "Idle session timeout allows the configuration of a setting which will timeout inactive users after a pre-determined amount of time. When a user reaches the set idle timeout session, they'll get a notification that they're about to be signed out. They have to select to stay signed in or they'll be automatically signed out of all Microsoft 365 web apps. The recommended setting is 3 hours (or less) for unmanaged devices.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "1 Microsoft 365 admin center",
          "SubSection": "1.3 Settings",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "Idle session timeout allows the configuration of a setting which will timeout inactive users after a pre-determined amount of time. When a user reaches the set idle timeout session, they'll get a notification that they're about to be signed out. They have to select to stay signed in or they'll be automatically signed out of all Microsoft 365 web apps. The recommended setting is 3 hours (or less) for unmanaged devices.",
          "RationaleStatement": "Ending idle sessions through an automatic process can help protect sensitive company data and will add another layer of security for end users who work on unmanaged devices that can potentially be accessed by the public. Unauthorized individuals onsite or remotely can take advantage of systems left unattended over time. Automatic timing out of sessions makes this more difficult.",
          "ImpactStatement": "If step 2 in the Audit/Remediation procedure is left out, then there is no issue with this from a security standpoint. However, it will require users on trusted devices to sign in more frequently which could result in credential prompt fatigue.",
          "RemediationProcedure": "Step 1 - Configure Idle session timeout: 1. Navigate to the Microsoft 365 admin center https://admin.microsoft.com/. 2. Click to expand Settings Select Org settings. 3. Click Security & Privacy tab. 4. Select Idle session timeout. 5. Check the box Turn on to set the period of inactivity for users to be signed off of Microsoft 365 web apps 6. Set a maximum value of 3 hours. 7. Click save. Step 2 - Ensure the Conditional Access policy is in place.",
          "AuditProcedure": "Step 1 - Ensure Idle session timeout is configured: 1. Navigate to the Microsoft 365 admin center https://admin.microsoft.com/. 2. Click to expand Settings Select Org settings. 3. Click Security & Privacy tab. 4. Select Idle session timeout. 5. Verify Turn on to set the period of inactivity for users to be signed off of Microsoft 365 web apps is set to 3 hours (or less). Step 2 - Ensure the Conditional Access policy is in place.",
          "AdditionalInformation": "According to Microsoft idle session timeout isn't supported when third party cookies are disabled in the browser. Users won't see any sign-out prompts.",
          "References": "https://learn.microsoft.com/en-us/microsoft-365/admin/manage/idle-session-timeout-web-apps?view=o365-worldwide",
          "DefaultValue": "Not configured. (Idle sessions will not timeout.)"
        }
      ]
    },
    {
      "Id": "1.3.3",
      "Description": "External calendar sharing allows an administrator to enable the ability for users to share calendars with anyone outside of the organization. Outside users will be sent a URL that can be used to view the calendar.",
      "Checks": [
        "admincenter_external_calendar_sharing_disabled"
      ],
      "Attributes": [
        {
          "Section": "1 Microsoft 365 admin center",
          "SubSection": "1.3 Settings",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "External calendar sharing allows an administrator to enable the ability for users to share calendars with anyone outside of the organization. Outside users will be sent a URL that can be used to view the calendar.",
          "RationaleStatement": "Attackers often spend time learning about organizations before launching an attack. Publicly available calendars can help attackers understand organizational relationships and determine when specific users may be more vulnerable to an attack, such as when they are traveling.",
          "ImpactStatement": "This functionality is not widely used. As a result, it is unlikely that implementation of this setting will cause an impact to most users. Users that do utilize this functionality are likely to experience a minor inconvenience when scheduling meetings or synchronizing calendars with people outside the tenant.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft 365 admin center https://admin.microsoft.com. 2. Click to expand Settings select Org settings. 3. In the Services section click Calendar. 4. Uncheck Let your users share their calendars with people outside of your organization who have Office 365 or Exchange. 5. Click Save.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft 365 admin center https://admin.microsoft.com. 2. Click to expand Settings select Org settings. 3. In the Services section click Calendar. 4. Verify Let your users share their calendars with people outside of your organization who have Office 365 or Exchange is unchecked.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/microsoft-365/admin/manage/share-calendars-with-external-users?view=o365-worldwide",
          "DefaultValue": "Enabled (True)"
        }
      ]
    },
    {
      "Id": "1.3.4",
      "Description": "By default, users can install add-ins in their Microsoft Word, Excel, and PowerPoint applications, allowing data access within the application. Do not allow users to install add-ins in Word, Excel, or PowerPoint.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "1 Microsoft 365 admin center",
          "SubSection": "1.3 Settings",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "By default, users can install add-ins in their Microsoft Word, Excel, and PowerPoint applications, allowing data access within the application. Do not allow users to install add-ins in Word, Excel, or PowerPoint.",
          "RationaleStatement": "Attackers commonly use vulnerable and custom-built add-ins to access data in user applications. While allowing users to install add-ins by themselves does allow them to easily acquire useful add-ins that integrate with Microsoft applications, it can represent a risk if not used and monitored carefully. Disable future user's ability to install add-ins in Microsoft Word, Excel, or PowerPoint helps reduce your threat-surface and mitigate this risk.",
          "ImpactStatement": "Implementation of this change will impact both end users and administrators. End users will not be able to install add-ins that they may want to install.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft 365 admin center https://admin.microsoft.com. 2. Click to expand Settings > Org settings. 3. In Services select User owned apps and services. 4. Uncheck Let users access the Office Store and Let users start trials on behalf of your organization. 5. Click Save.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft 365 admin center https://admin.microsoft.com. 2. Click to expand Settings > Org settings. 3. In Services select User owned apps and services. 4. Verify Let users access the Office Store and Let users start trials on behalf of your organization are not checked.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/microsoft-365/admin/manage/manage-addins-in-the-admin-center?view=o365-worldwide#manage-add-in-downloads-by-turning-onoff-the-office-store-across-all-apps-except-outlook",
          "DefaultValue": "Let users access the Office Store is Checked. Let users start trials on behalf of your organization is Checked."
        }
      ]
    },
    {
      "Id": "1.3.5",
      "Description": "Microsoft Forms can be used for phishing attacks by asking personal or sensitive information and collecting the results. Microsoft 365 has built-in protection that will proactively scan for phishing attempt in forms such personal information request.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "1 Microsoft 365 admin center",
          "SubSection": "1.3 Settings",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Microsoft Forms can be used for phishing attacks by asking personal or sensitive information and collecting the results. Microsoft 365 has built-in protection that will proactively scan for phishing attempt in forms such personal information request.",
          "RationaleStatement": "Enabling internal phishing protection for Microsoft Forms will prevent attackers using forms for phishing attacks by asking personal or other sensitive information and URLs.",
          "ImpactStatement": "If potential phishing was detected, the form will be temporarily blocked and cannot be distributed, and response collection will not happen until it is unblocked by the administrator or keywords were removed by the creator.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft 365 admin center https://admin.microsoft.com. 2. Click to expand Settings then select Org settings. 3. Under Services select Microsoft Forms. 4. Click the checkbox labeled Add internal phishing protection under Phishing protection. 5. Click Save.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft 365 admin center https://admin.microsoft.com. 2. Click to expand Settings then select Org settings. 3. Under Services select Microsoft Forms. 4. Ensure the checkbox labeled Add internal phishing protection is checked under Phishing protection.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-US/microsoft-forms/administrator-settings-microsoft-forms:https://learn.microsoft.com/en-US/microsoft-forms/review-unblock-forms-users-detected-blocked-potential-phishing",
          "DefaultValue": "Internal Phishing Protection is enabled."
        }
      ]
    },
    {
      "Id": "1.3.6",
      "Description": "Customer Lockbox is a security feature that provides an additional layer of control and transparency to customer data in Microsoft 365. It offers an approval process for Microsoft support personnel to access organization data and creates an audited trail to meet compliance requirements.",
      "Checks": [
        "admincenter_organization_customer_lockbox_enabled"
      ],
      "Attributes": [
        {
          "Section": "1 Microsoft 365 admin center",
          "SubSection": "1.3 Settings",
          "Profile": "E5 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "Customer Lockbox is a security feature that provides an additional layer of control and transparency to customer data in Microsoft 365. It offers an approval process for Microsoft support personnel to access organization data and creates an audited trail to meet compliance requirements.",
          "RationaleStatement": "Enabling this feature protects organizational data against data spillage and exfiltration.",
          "ImpactStatement": "Administrators will need to grant Microsoft access to the tenant environment prior to a Microsoft engineer accessing the environment for support or troubleshooting.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft 365 admin center https://admin.microsoft.com. 2. Click to expand Settings then select Org settings. 3. Select Security & privacy tab. 4. Click Customer lockbox. 5. Check the box Require approval for all data access requests. 6. Click Save.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft 365 admin center https://admin.microsoft.com. 2. Click to expand Settings then select Org settings. 3. Select Security & privacy tab. 4. Click Customer lockbox. 5. Verify Require approval for all data access requests is checked.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/microsoft-365/compliance/customer-lockbox-requests?view=o365-worldwide",
          "DefaultValue": "Disabled"
        }
      ]
    },
    {
      "Id": "1.3.7",
      "Description": "Third-party storage can be enabled for users in Microsoft 365 allowing them to store and share documents using services like Dropbox, alongside OneDrive for Business and SharePoint team sites. Do not allow users to open files in third-party storage services in Microsoft 365 on the web.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "1 Microsoft 365 admin center",
          "SubSection": "1.3 Settings",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "Third-party storage can be enabled for users in Microsoft 365 allowing them to store and share documents using services like Dropbox, alongside OneDrive for Business and SharePoint team sites. Do not allow users to open files in third-party storage services in Microsoft 365 on the web.",
          "RationaleStatement": "By using external storage services an organization may increase the risk of data breaches and data loss as the data is no longer under their direct control.",
          "ImpactStatement": "Implementing this recommendation will prevent users from opening, saving, or synchronizing files with third-party storage services using Microsoft 365 on the web.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft 365 admin center https://admin.microsoft.com. 2. Click to expand Settings then select Org settings. 3. Under Services select Microsoft 365 on the web. 4. Uncheck Let users open files stored in third-party storage services in Microsoft 365 on the web. 5. Click Save.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft 365 admin center https://admin.microsoft.com. 2. Click to expand Settings then select Org settings. 3. Under Services select Microsoft 365 on the web. 4. Verify Let users open files stored in third-party storage services in Microsoft 365 on the web is not checked.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/microsoft-365/admin/setup/set-up-file-storage-and-sharing?view=o365-worldwide",
          "DefaultValue": "Enabled"
        }
      ]
    },
    {
      "Id": "1.3.8",
      "Description": "Sway is a Microsoft 365 app that can be used to create newsletters, presentations, documents, and more. Ensure Sways cannot be shared with people outside of the organization.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "1 Microsoft 365 admin center",
          "SubSection": "1.3 Settings",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Manual",
          "Description": "Sway is a Microsoft 365 app that can be used to create newsletters, presentations, documents, and more. Ensure Sways cannot be shared with people outside of the organization.",
          "RationaleStatement": "Disabling external sharing of Sway documents helps prevent sensitive information from being inadvertently shared outside the organization. This reduces the risk of data leakage and ensures that organizational content remains within controlled boundaries.",
          "ImpactStatement": "Users will not be able to share Sway presentations with external parties, which may affect collaboration with external stakeholders, clients, or partners who need access to certain presentations.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft 365 admin center https://admin.microsoft.com. 2. Click to expand Settings then select Org settings. 3. Under Services select Sway. 4. Uncheck Let people in your organization share their sways with people outside your organization. 5. Click Save.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft 365 admin center https://admin.microsoft.com. 2. Click to expand Settings then select Org settings. 3. Under Services select Sway. 4. Verify Let people in your organization share their sways with people outside your organization is not checked.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/microsoft-365/admin/manage/sway-admin-settings?view=o365-worldwide",
          "DefaultValue": "Enabled"
        }
      ]
    },
    {
      "Id": "1.3.9",
      "Description": "Microsoft Bookings is an online and mobile app for small businesses who provide services to customers on an appointment basis. Ensure shared bookings pages are restricted to select users.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "1 Microsoft 365 admin center",
          "SubSection": "1.3 Settings",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Microsoft Bookings is an online and mobile app for small businesses who provide services to customers on an appointment basis. Ensure shared bookings pages are restricted to select users.",
          "RationaleStatement": "Restricting the ability to create shared booking pages helps organizations maintain control over who can set up booking pages that may expose employee availability and contact information. This reduces the risk of unauthorized booking pages being created and shared, potentially exposing sensitive scheduling information.",
          "ImpactStatement": "By restricting this setting, only users in selected groups will be able to create shared booking pages. This may require administrative overhead to manage group membership and respond to user requests for access.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft 365 admin center https://admin.microsoft.com. 2. Click to expand Settings then select Org settings. 3. Under Services select Bookings. 4. Under Shared booking pages, select Allow only selected users to create Bookings. 5. Click Save.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft 365 admin center https://admin.microsoft.com. 2. Click to expand Settings then select Org settings. 3. Under Services select Bookings. 4. Verify Allow only selected users to create Bookings is selected under Shared booking pages.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/microsoft-365/bookings/turn-bookings-on-or-off?view=o365-worldwide",
          "DefaultValue": "Allow your organization to use Bookings"
        }
      ]
    },
    {
      "Id": "2.1.1",
      "Description": "Safe Links for Office Applications is a feature in Microsoft 365 that provides URL scanning and rewriting of inbound email messages in mail flow, and time-of-click verification of URLs and links in email messages, other Microsoft 365 applications such as Teams, and other locations such as SharePoint Online. It can help protect organizations from malicious links used in phishing and other attacks.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "2 Microsoft 365 Defender",
          "SubSection": "2.1 Email & collaboration",
          "Profile": "E5 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "Safe Links for Office Applications is a feature in Microsoft 365 that provides URL scanning and rewriting of inbound email messages in mail flow, and time-of-click verification of URLs and links in email messages, other Microsoft 365 applications such as Teams, and other locations such as SharePoint Online. It can help protect organizations from malicious links used in phishing and other attacks.",
          "RationaleStatement": "Safe Links for Office Applications extends phishing protection to documents and emails that contain hyperlinks, even after they have been delivered to a user.",
          "ImpactStatement": "Enabling this feature may impose a slight burden on users with IT providing support for blocking issues.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft 365 Defender https://security.microsoft.com. 2. Click to expand Email & collaboration select Policies & rules. 3. On the Policies & rules page select Threat policies. 4. Under Policies select Safe Links. 5. Click + Create or use an existing policy. 6. Enter a Policy Name and click Next. 7. Select all valid domains or groups and click Next. 8. Ensure the protection settings are enabled. 9. Click Next and finally Submit.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft 365 Defender https://security.microsoft.com. 2. Click to expand Email & collaboration select Policies & rules. 3. On the Policies & rules page select Threat policies. 4. Under Policies select Safe Links. 5. Click on the policy to inspect and verify the settings.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/defender-office-365/safe-links-policies-configure?view=o365-worldwide:https://learn.microsoft.com/en-us/powershell/module/exchange/set-safelinkspolicy?view=exchange-ps:https://learn.microsoft.com/en-us/defender-office-365/preset-security-policies?view=o365-worldwide",
          "DefaultValue": "Safe Links is not enabled by default."
        }
      ]
    },
    {
      "Id": "2.1.2",
      "Description": "The Common Attachment Types Filter lets a user block known and custom malicious file types from being attached to emails.",
      "Checks": [
        "defender_malware_policy_common_attachments_filter_enabled"
      ],
      "Attributes": [
        {
          "Section": "2 Microsoft 365 Defender",
          "SubSection": "2.1 Email & collaboration",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "The Common Attachment Types Filter lets a user block known and custom malicious file types from being attached to emails.",
          "RationaleStatement": "Blocking known malicious file types can help prevent malware-infested files from infecting a host.",
          "ImpactStatement": "Blocking common malicious file types should not cause an impact in modern computing environments.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft 365 Defender https://security.microsoft.com. 2. Click to expand Email & collaboration select Policies & rules. 3. On the Policies & rules page select Threat policies. 4. Under polices select Anti-malware and click on the Default (Default) policy. 5. On the Policy page that appears on the right hand pane scroll to the bottom and click on Edit protection settings, check the Enable the common attachments filter. 6. Click Save.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft 365 Defender https://security.microsoft.com. 2. Click to expand Email & collaboration select Policies & rules. 3. On the Policies & rules page select Threat policies. 4. Under Policies select Anti-malware and click on the Default (Default) policy. 5. On the policy page that appears on the righthand pane, under Protection settings, verify that the Enable the common attachments filter has the value of On.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/powershell/module/exchange/get-malwarefilterpolicy?view=exchange-ps:https://learn.microsoft.com/en-us/defender-office-365/anti-malware-policies-configure?view=o365-worldwide",
          "DefaultValue": "Always on"
        }
      ]
    },
    {
      "Id": "2.1.3",
      "Description": "Exchange Online Protection (EOP) is Microsoft's cloud-based filtering service that protects organizations against spam, malware, and other email threats. EOP uses flexible anti-malware policies for malware protection settings. These policies can be set to notify Admins of malicious activity.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "2 Microsoft 365 Defender",
          "SubSection": "2.1 Email & collaboration",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Exchange Online Protection (EOP) is Microsoft's cloud-based filtering service that protects organizations against spam, malware, and other email threats. EOP uses flexible anti-malware policies for malware protection settings. These policies can be set to notify Admins of malicious activity.",
          "RationaleStatement": "This setting alerts administrators that an internal user sent a message that contained malware. This may indicate an account or machine compromise that would need to be investigated.",
          "ImpactStatement": "Notification of account with potential issues should not have an impact on the user.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft 365 Defender https://security.microsoft.com. 2. Click to expand E-mail & Collaboration select Policies & rules. 3. On the Policies & rules page select Threat policies. 4. Under Policies select Anti-malware. 5. Click on the Default (Default) policy. 6. Click on Edit protection settings and change the settings for Notify an admin about undelivered messages from internal senders to On and enter the email address of the administrator who should be notified under Administrator email address. 7. Click Save.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft 365 Defender https://security.microsoft.com. 2. Click to expand E-mail & Collaboration select Policies & rules. 3. On the Policies & rules page select Threat policies. 4. Under Policies select Anti-malware. 5. Click on the Default (Default) policy. 6. Ensure the setting Notify an admin about undelivered messages from internal senders is set to On and that there is at least one email address under Administrator email address.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/defender-office-365/anti-malware-protection-about:https://learn.microsoft.com/en-us/defender-office-365/anti-malware-policies-configure",
          "DefaultValue": "EnableInternalSenderAdminNotifications: False, InternalSenderAdminAddress: null"
        }
      ]
    },
    {
      "Id": "2.1.4",
      "Description": "The Safe Attachments policy helps protect users from malware in email attachments by scanning attachments for viruses, malware, and other malicious content. When an email attachment is received by a user, Safe Attachments will scan the attachment in a secure environment and provide a verdict on whether the attachment is safe or not.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "2 Microsoft 365 Defender",
          "SubSection": "2.1 Email & collaboration",
          "Profile": "E5 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "The Safe Attachments policy helps protect users from malware in email attachments by scanning attachments for viruses, malware, and other malicious content. When an email attachment is received by a user, Safe Attachments will scan the attachment in a secure environment and provide a verdict on whether the attachment is safe or not.",
          "RationaleStatement": "Enabling Safe Attachments policy helps protect against malware threats in email attachments by analyzing suspicious attachments in a secure, cloud-based environment before they are delivered to the user's inbox. This provides an additional layer of security and can prevent new or unseen types of malware from infiltrating the organization's network.",
          "ImpactStatement": "Delivery of email with attachments may be delayed while scanning is occurring.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft 365 Defender https://security.microsoft.com. 2. Click to expand E-mail & Collaboration select Policies & rules. 3. On the Policies & rules page select Threat policies. 4. Under Policies select Safe Attachments. 5. Click + Create. 6. Create a Policy Name and Description, and then click Next. 7. Select all valid domains and click Next. 8. Select Block. 9. Quarantine policy is AdminOnlyAccessPolicy. 10. Leave Enable redirect unchecked. 11. Click Next and finally Submit.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft 365 Defender https://security.microsoft.com. 2. Click to expand E-mail & Collaboration select Policies & rules. 3. On the Policies & rules page select Threat policies. 4. Under Policies select Safe Attachments. 5. Inspect the highest priority policy. 6. Ensure Users and domains and Included recipient domains are in scope for the organization. 7. Ensure Safe Attachments detection response is set to Block. 8. Ensure the Quarantine Policy is set to AdminOnlyAccessPolicy. 9. Ensure the policy is not disabled.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/defender-office-365/safe-attachments-about:https://learn.microsoft.com/en-us/defender-office-365/safe-attachments-policies-configure",
          "DefaultValue": "Identity: Built-In Protection Policy, Enable: True, Action: Block, QuarantineTag: AdminOnlyAccessPolicy, Priority: lowest"
        }
      ]
    },
    {
      "Id": "2.1.5",
      "Description": "Safe Attachments for SharePoint, OneDrive, and Microsoft Teams scans these services for malicious files.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "2 Microsoft 365 Defender",
          "SubSection": "2.1 Email & collaboration",
          "Profile": "E5 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "Safe Attachments for SharePoint, OneDrive, and Microsoft Teams scans these services for malicious files.",
          "RationaleStatement": "Safe Attachments for SharePoint, OneDrive, and Microsoft Teams protect organizations from inadvertently sharing malicious files. When a malicious file is detected that file is blocked so that no one can open, copy, move, or share it until further actions are taken by the organization's security team.",
          "ImpactStatement": "Impact associated with Safe Attachments is minimal, and equivalent to impact associated with anti-virus scanners in an environment.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft 365 Defender https://security.microsoft.com. 2. Under Email & collaboration select Policies & rules. 3. Select Threat policies then Safe Attachments. 4. Click on Global settings. 5. Click to Enable Turn on Defender for Office 365 for SharePoint, OneDrive, and Microsoft Teams. 6. Click to Enable Turn on Safe Documents for Office clients. 7. Click to Disable Allow people to click through Protected View even if Safe Documents identified the file as malicious. 8. Click Save.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft 365 Defender https://security.microsoft.com. 2. Under Email & collaboration select Policies & rules. 3. Select Threat policies then Safe Attachments. 4. Click on Global settings. 5. Ensure the toggle is Enabled to Turn on Defender for Office 365 for SharePoint, OneDrive, and Microsoft Teams. 6. Ensure the toggle is Enabled to Turn on Safe Documents for Office clients. 7. Ensure the toggle is Deselected/Disabled to Allow people to click through Protected View even if Safe Documents identified the file as malicious.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/defender-office-365/safe-attachments-for-spo-odfb-teams-about",
          "DefaultValue": "EnableATPForSPOTeamsODB: False, EnableSafeDocs: False, AllowSafeDocsOpen: False"
        }
      ]
    },
    {
      "Id": "2.1.6",
      "Description": "In Microsoft 365 organizations with mailboxes in Exchange Online or standalone Exchange Online Protection (EOP) organizations without Exchange Online mailboxes, email messages are automatically protected against spam (junk email) by EOP. Configure Exchange Online Spam Policies to copy emails and notify someone when a sender in the organization has been blocked for sending spam emails.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "2 Microsoft 365 Defender",
          "SubSection": "2.1 Email & collaboration",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "In Microsoft 365 organizations with mailboxes in Exchange Online or standalone Exchange Online Protection (EOP) organizations without Exchange Online mailboxes, email messages are automatically protected against spam (junk email) by EOP. Configure Exchange Online Spam Policies to copy emails and notify someone when a sender in the organization has been blocked for sending spam emails.",
          "RationaleStatement": "A blocked account is a good indication that the account in question has been breached, and an attacker is using it to send spam emails to other people.",
          "ImpactStatement": "Notification of users that have been blocked should not cause an impact to the user.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft 365 Defender https://security.microsoft.com. 2. Click to expand Email & collaboration select Policies & rules > Threat policies. 3. Under Policies select Anti-spam. 4. Click on the Anti-spam outbound policy (default). 5. Select Edit protection settings then under Notifications. 6. Check Send a copy of suspicious outbound messages or message that exceed these limits to these users and groups then enter the desired email addresses. 7. Check Notify these users and groups if a sender is blocked due to sending outbound spam then enter the desired email addresses. 8. Click Save.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft 365 Defender https://security.microsoft.com. 2. Click to expand Email & collaboration select Policies & rules > Threat policies. 3. Under Policies select Anti-spam. 4. Click on the Anti-spam outbound policy (default). 5. Verify that Send a copy of suspicious outbound messages or message that exceed these limits to these users and groups is set to On, ensure the email address is correct. 6. Verify that Notify these users and groups if a sender is blocked due to sending outbound spam is set to On, ensure the email address is correct.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/defender-office-365/outbound-spam-protection-about",
          "DefaultValue": "BccSuspiciousOutboundAdditionalRecipients: {}, BccSuspiciousOutboundMail: False, NotifyOutboundSpamRecipients: {}, NotifyOutboundSpam: False"
        }
      ]
    },
    {
      "Id": "2.1.7",
      "Description": "By default, Office 365 includes built-in features that help protect users from phishing attacks. Set up anti-phishing polices to increase this protection, for example by refining settings to better detect and prevent impersonation and spoofing attacks. The default policy applies to all users within the organization and is a single view to fine-tune anti-phishing protection. Custom policies can be created and configured for specific users, groups or domains within the organization and will take precedence over the default policy for the scoped users.",
      "Checks": [
        "defender_antiphishing_policy_configured"
      ],
      "Attributes": [
        {
          "Section": "2 Microsoft 365 Defender",
          "SubSection": "2.1 Email & collaboration",
          "Profile": "E5 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "By default, Office 365 includes built-in features that help protect users from phishing attacks. Set up anti-phishing polices to increase this protection, for example by refining settings to better detect and prevent impersonation and spoofing attacks. The default policy applies to all users within the organization and is a single view to fine-tune anti-phishing protection. Custom policies can be created and configured for specific users, groups or domains within the organization and will take precedence over the default policy for the scoped users.",
          "RationaleStatement": "Protects users from phishing attacks (like impersonation and spoofing) and uses safety tips to warn users about potentially harmful messages.",
          "ImpactStatement": "Mailboxes that are used for support systems such as helpdesk and billing systems send mail to internal users and are often not suitable candidates for impersonation protection. Care should be taken to ensure that these systems are excluded from Impersonation Protection.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft 365 Defender https://security.microsoft.com. 2. Click to expand Email & collaboration select Policies & rules. 3. Select Threat policies. 4. Under Policies select Anti-phishing and click Create. 5. Name the policy and configure Users, groups, and domains to include a majority of the organization. 6. Set Phishing email threshold to 3 - More Aggressive. 7. Check Enable users to protect and add up to 350 users. 8. Check Enable domains to protect and check Include domains I own. 9. Enable mailbox intelligence, spoof intelligence, and impersonation protection. 10. Under Actions set all detection responses to Quarantine the message. 11. Enable all safety tips. 12. Click Next and finally Submit.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft 365 Defender https://security.microsoft.com. 2. Click to expand Email & collaboration select Policies & rules. 3. Select Threat policies. 4. Under Policies select Anti-phishing. 5. Ensure an AntiPhish policy exists that is On and meets the criteria: Phishing email threshold at least 3, User and domain impersonation protection enabled, Mailbox intelligence enabled, Actions set to Quarantine the message, Safety tips enabled, Honor DMARC record policy enabled.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/defender-office-365/anti-phishing-protection-about:https://learn.microsoft.com/en-us/defender-office-365/anti-phishing-policies-eop-configure",
          "DefaultValue": "Anti-phishing policies exist by default but may not have all recommended settings enabled."
        }
      ]
    },
    {
      "Id": "2.1.8",
      "Description": "For each domain that is configured in Exchange, a corresponding Sender Policy Framework (SPF) record should be created.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "2 Microsoft 365 Defender",
          "SubSection": "2.1 Email & collaboration",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "For each domain that is configured in Exchange, a corresponding Sender Policy Framework (SPF) record should be created.",
          "RationaleStatement": "SPF records allow Exchange Online Protection and other mail systems to know where messages from domains are allowed to originate. This information can be used by that system to determine how to treat the message based on if it is being spoofed or is valid.",
          "ImpactStatement": "There should be minimal impact of setting up SPF records however, organizations should ensure proper SPF record setup as email could be flagged as spam if SPF is not setup appropriately.",
          "RemediationProcedure": "To remediate using a DNS Provider: 1. If all email in your domain is sent from and received by Exchange Online, add the following TXT record for each Accepted Domain: v=spf1 include:spf.protection.outlook.com -all. 2. If there are other systems that send email in the environment, refer to Microsoft documentation for the proper SPF configuration.",
          "AuditProcedure": "To audit using PowerShell: 1. Open a command prompt. 2. Type the following command in PowerShell: Resolve-DnsName [domain1.com] txt | fl. 3. Ensure that a value exists and that it includes v=spf1 include:spf.protection.outlook.com. This designates Exchange Online as a designated sender.",
          "AdditionalInformation": "Resolve-DnsName is not available on older versions of Windows prior to Windows 8 and Server 2012.",
          "References": "https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/email-authentication-spf-configure?view=o365-worldwide",
          "DefaultValue": "SPF records are not configured by default."
        }
      ]
    },
    {
      "Id": "2.1.9",
      "Description": "DKIM is one of the trio of Authentication methods (SPF, DKIM and DMARC) that help prevent attackers from sending messages that look like they come from your domain. DKIM lets an organization add a digital signature to outbound email messages in the message header. When DKIM is configured, the organization authorizes its domain to associate, or sign, its name to an email message using cryptographic authentication.",
      "Checks": [
        "defender_domain_dkim_enabled"
      ],
      "Attributes": [
        {
          "Section": "2 Microsoft 365 Defender",
          "SubSection": "2.1 Email & collaboration",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "DKIM is one of the trio of Authentication methods (SPF, DKIM and DMARC) that help prevent attackers from sending messages that look like they come from your domain. DKIM lets an organization add a digital signature to outbound email messages in the message header. When DKIM is configured, the organization authorizes its domain to associate, or sign, its name to an email message using cryptographic authentication.",
          "RationaleStatement": "By enabling DKIM with Office 365, messages that are sent from Exchange Online will be cryptographically signed. This will allow the receiving email system to validate that the messages were generated by a server that the organization authorized and not being spoofed.",
          "ImpactStatement": "There should be no impact of setting up DKIM however, organizations should ensure appropriate setup to ensure continuous mail-flow.",
          "RemediationProcedure": "To remediate using a DNS Provider: 1. For each accepted domain in Exchange Online, two DNS entries are required. 2. After the DNS records are created, enable DKIM signing in Defender. 3. Navigate to Microsoft 365 Defender https://security.microsoft.com/. 4. Expand Email & collaboration > Policies & rules > Threat policies. 5. Under Rules section click Email authentication settings. 6. Select DKIM. 7. Click on each domain and click Enable next to Sign messages for this domain with DKIM signature.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft 365 Defender https://security.microsoft.com/. 2. Expand Email & collaboration > Policies & rules > Threat policies. 3. Under Rules section click Email authentication settings. 4. Select DKIM. 5. Click on each domain and confirm that Sign messages for this domain with DKIM signatures is Enabled and Status reads Signing DKIM signatures for this domain.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/email-authentication-dkim-configure?view=o365-worldwide",
          "DefaultValue": "DKIM is not enabled by default."
        }
      ]
    },
    {
      "Id": "2.1.10",
      "Description": "DMARC, or Domain-based Message Authentication, Reporting, and Conformance, assists recipient mail systems in determining the appropriate action to take when messages from a domain fail to meet SPF or DKIM authentication criteria.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "2 Microsoft 365 Defender",
          "SubSection": "2.1 Email & collaboration",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "DMARC, or Domain-based Message Authentication, Reporting, and Conformance, assists recipient mail systems in determining the appropriate action to take when messages from a domain fail to meet SPF or DKIM authentication criteria.",
          "RationaleStatement": "DMARC strengthens the trustworthiness of messages sent from an organization's domain to destination email systems. By integrating DMARC with SPF (Sender Policy Framework) and DKIM (DomainKeys Identified Mail), organizations can significantly enhance their defenses against email spoofing and phishing attempts. Leaving a DMARC policy set to p=none can result in failed action when a spear phishing email fails DMARC but passes SPF and DKIM checks. Having DMARC fully configured is a critical part in preventing business email compromise.",
          "ImpactStatement": "There should be no impact of setting up DMARC however, organizations should ensure appropriate setup to ensure continuous mail-flow.",
          "RemediationProcedure": "To remediate using a DNS Provider: 1. For each Exchange Online Accepted Domain, add the following record to DNS: Record: _dmarc.domain1.com, Type: TXT, Value: v=DMARC1; p=none; rua=mailto:<rua-report@example.com>; ruf=mailto:<ruf-report@example.com>. 2. This will create a basic DMARC policy. 3. After monitoring, implement a policy of p=reject OR p=quarantine and pct=100.",
          "AuditProcedure": "To audit using PowerShell: 1. Open a command prompt. 2. For each of the Accepted Domains in Exchange Online run the following in PowerShell: Resolve-DnsName _dmarc.[domain1.com] txt. 3. Ensure that the record exists and has at minimum the following flags defined: v=DMARC1; (p=quarantine OR p=reject), pct=100, rua=mailto:<reporting email address> and ruf=mailto:<reporting email address>. 4. Ensure the Microsoft MOERA domain is also configured.",
          "AdditionalInformation": "The remediation portion involves a multi-staged approach over a period of time.",
          "References": "https://learn.microsoft.com/en-us/defender-office-365/email-authentication-dmarc-configure?view=o365-worldwide:https://learn.microsoft.com/en-us/defender-office-365/step-by-step-guides/how-to-enable-dmarc-reporting-for-microsoft-online-email-routing-address-moera-and-parked-domains?view=o365-worldwide",
          "DefaultValue": "DMARC records are not configured by default."
        }
      ]
    },
    {
      "Id": "2.1.11",
      "Description": "The Common Attachment Types Filter lets a user block known and custom malicious file types from being attached to emails. The policy provided by Microsoft covers 53 extensions, and an additional custom list of extensions can be defined. The list of 184 extensions provided in this recommendation is comprehensive but not exhaustive.",
      "Checks": [
        "defender_malware_policy_comprehensive_attachments_filter_applied"
      ],
      "Attributes": [
        {
          "Section": "2 Microsoft 365 Defender",
          "SubSection": "2.1 Email & collaboration",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "The Common Attachment Types Filter lets a user block known and custom malicious file types from being attached to emails. The policy provided by Microsoft covers 53 extensions, and an additional custom list of extensions can be defined. The list of 184 extensions provided in this recommendation is comprehensive but not exhaustive.",
          "RationaleStatement": "Blocking known malicious file types can help prevent malware-infested files from infecting a host or performing other malicious attacks such as phishing and data extraction. Defining a comprehensive list of attachments can help protect against additional unknown and known threats. Many legacy file formats, binary files and compressed files have been used as delivery mechanisms for malicious software.",
          "ImpactStatement": "For file types that are business necessary users will need to use other organizationally approved methods to transfer blocked extension types between business partners.",
          "RemediationProcedure": "To Remediate using PowerShell: 1. Connect to Exchange Online using Connect-ExchangeOnline. 2. Run the script provided to create an attachment policy and associated rule with 184 extensions. 3. When prepared enable the rule either through the UI or PowerShell.",
          "AuditProcedure": "For this control, a Level 2 comprehensive attachment policy is defined as one that includes at least 120 extensions. To pass, organizations must demonstrate at least a 90% adoption rate of the extension list referenced in the audit script, with allowances for justified exceptions.",
          "AdditionalInformation": "Organizations should evaluate any extensions missing from the report to determine if they are valid exceptions.",
          "References": "https://learn.microsoft.com/en-us/powershell/module/exchange/get-malwarefilterpolicy?view=exchange-ps:https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/anti-malware-policies-configure?view=o365-worldwide:https://learn.microsoft.com/en-us/office/compatibility/office-file-format-reference",
          "DefaultValue": "53 extensions are blocked by default."
        }
      ]
    },
    {
      "Id": "2.1.12",
      "Description": "In Microsoft 365 organizations with Exchange Online mailboxes or standalone Exchange Online Protection (EOP) organizations without Exchange Online mailboxes, connection filtering and the default connection filter policy identify good or bad source email servers by IP addresses. The key components of the default connection filter policy are IP Allow List, IP Block List and Safe list. The recommended state is IP Allow List empty or undefined.",
      "Checks": [
        "defender_antispam_connection_filter_policy_empty_ip_allowlist"
      ],
      "Attributes": [
        {
          "Section": "2 Microsoft 365 Defender",
          "SubSection": "2.1 Email & collaboration",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "In Microsoft 365 organizations with Exchange Online mailboxes or standalone Exchange Online Protection (EOP) organizations without Exchange Online mailboxes, connection filtering and the default connection filter policy identify good or bad source email servers by IP addresses. The key components of the default connection filter policy are IP Allow List, IP Block List and Safe list. The recommended state is IP Allow List empty or undefined.",
          "RationaleStatement": "Without additional verification like mail flow rules, email from sources in the IP Allow List skips spam filtering and sender authentication (SPF, DKIM, DMARC) checks. This method creates a high risk of attackers successfully delivering email to the Inbox that would otherwise be filtered. Messages that are determined to be malware or high confidence phishing are filtered.",
          "ImpactStatement": "This is the default behavior. IP Allow lists may reduce false positives, however, this benefit is outweighed by the importance of a policy which scans all messages regardless of the origin. This supports the principle of zero trust.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft 365 Defender https://security.microsoft.com. 2. Click to expand Email & collaboration select Policies & rules > Threat policies. 3. Under Policies select Anti-spam. 4. Click on the Connection filter policy (Default). 5. Click Edit connection filter policy. 6. Remove any IP entries from Always allow messages from the following IP addresses or address range. 7. Click Save.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft 365 Defender https://security.microsoft.com. 2. Click to expand Email & collaboration select Policies & rules > Threat policies. 3. Under Policies select Anti-spam. 4. Click on the Connection filter policy (Default). 5. Ensure IP Allow list contains no entries.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/defender-office-365/connection-filter-policies-configure:https://learn.microsoft.com/en-us/defender-office-365/create-safe-sender-lists-in-office-365#use-the-ip-allow-list:https://learn.microsoft.com/en-us/defender-office-365/how-policies-and-protections-are-combined#user-and-tenant-settings-conflict",
          "DefaultValue": "IPAllowList: {}"
        }
      ]
    },
    {
      "Id": "2.1.13",
      "Description": "In Microsoft 365 organizations with Exchange Online mailboxes or standalone Exchange Online Protection (EOP) organizations without Exchange Online mailboxes, connection filtering and the default connection filter policy identify good or bad source email servers by IP addresses. The key components of the default connection filter policy are IP Allow List, IP Block List and Safe list. The safe list is a pre-configured allow list that is dynamically updated by Microsoft. The recommended safe list state is: Off or False.",
      "Checks": [
        "defender_antispam_connection_filter_policy_safe_list_off"
      ],
      "Attributes": [
        {
          "Section": "2 Microsoft 365 Defender",
          "SubSection": "2.1 Email & collaboration",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "In Microsoft 365 organizations with Exchange Online mailboxes or standalone Exchange Online Protection (EOP) organizations without Exchange Online mailboxes, connection filtering and the default connection filter policy identify good or bad source email servers by IP addresses. The key components of the default connection filter policy are IP Allow List, IP Block List and Safe list. The safe list is a pre-configured allow list that is dynamically updated by Microsoft. The recommended safe list state is: Off or False.",
          "RationaleStatement": "Without additional verification like mail flow rules, email from sources in the IP Allow List skips spam filtering and sender authentication (SPF, DKIM, DMARC) checks. This method creates a high risk of attackers successfully delivering email to the Inbox that would otherwise be filtered. The safe list is managed dynamically by Microsoft, and administrators do not have visibility into which senders are included.",
          "ImpactStatement": "This is the default behavior. IP Allow lists may reduce false positives, however, this benefit is outweighed by the importance of a policy which scans all messages regardless of the origin. This supports the principle of zero trust.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft 365 Defender https://security.microsoft.com. 2. Click to expand Email & collaboration select Policies & rules > Threat policies. 3. Under Policies select Anti-spam. 4. Click on the Connection filter policy (Default). 5. Click Edit connection filter policy. 6. Uncheck Turn on safe list. 7. Click Save.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft 365 Defender https://security.microsoft.com. 2. Click to expand Email & collaboration select Policies & rules > Threat policies. 3. Under Policies select Anti-spam. 4. Click on the Connection filter policy (Default). 5. Ensure Safe list is Off.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/defender-office-365/connection-filter-policies-configure:https://learn.microsoft.com/en-us/defender-office-365/create-safe-sender-lists-in-office-365#use-the-ip-allow-list:https://learn.microsoft.com/en-us/defender-office-365/how-policies-and-protections-are-combined#user-and-tenant-settings-conflict",
          "DefaultValue": "EnableSafeList: False"
        }
      ]
    },
    {
      "Id": "2.1.14",
      "Description": "Anti-spam protection is a feature of Exchange Online that utilizes policies to help to reduce the amount of junk email, bulk and phishing emails a mailbox receives. These policies contain lists to allow or block specific senders or domains. The recommended state is: Do not define any Allowed domains.",
      "Checks": [
        "defender_antispam_policy_inbound_no_allowed_domains"
      ],
      "Attributes": [
        {
          "Section": "2 Microsoft 365 Defender",
          "SubSection": "2.1 Email & collaboration",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Anti-spam protection is a feature of Exchange Online that utilizes policies to help to reduce the amount of junk email, bulk and phishing emails a mailbox receives. These policies contain lists to allow or block specific senders or domains. The recommended state is: Do not define any Allowed domains.",
          "RationaleStatement": "Messages from entries in the allowed senders list or the allowed domains list bypass most email protection (except malware and high confidence phishing) and email authentication checks (SPF, DKIM and DMARC). Entries in the allowed senders list or the allowed domains list create a high risk of attackers successfully delivering email to the Inbox that would otherwise be filtered. The risk is increased even more when allowing common domain names as these can be easily spoofed by attackers.",
          "ImpactStatement": "This is the default behavior. Allowed domains may reduce false positives, however, this benefit is outweighed by the importance of having a policy which scans all messages regardless of the origin. This supports the principle of zero trust.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft 365 Defender https://security.microsoft.com. 2. Click to expand Email & collaboration select Policies & rules > Threat policies. 3. Under Policies select Anti-spam. 4. Open each out of compliance inbound anti-spam policy by clicking on it. 5. Click Edit allowed and blocked senders and domains. 6. Select Allow domains. 7. Delete each domain from the domains list. 8. Click Done > Save. 9. Repeat as needed.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft 365 Defender https://security.microsoft.com. 2. Click to expand Email & collaboration select Policies & rules > Threat policies. 3. Under Policies select Anti-spam. 4. Inspect each inbound anti-spam policy. 5. Ensure that Allowed domains does not contain any domain names. 6. Repeat as needed for any additional inbound anti-spam policy.",
          "AdditionalInformation": "Microsoft specifies in its documentation that allowed domains should be used for testing purposes only.",
          "References": "https://learn.microsoft.com/en-us/defender-office-365/anti-spam-protection-about#allow-and-block-lists-in-anti-spam-policies",
          "DefaultValue": "AllowedSenderDomains: {}"
        }
      ]
    },
    {
      "Id": "2.1.15",
      "Description": "The default outbound anti-spam policy in Microsoft Defender automatically applies to all users and is designed to detect and limit suspicious email-sending behavior. The policy enforces limits based on both volume and spam detection. The recommended state is: External: 500, Internal: 1000, Daily: 1000, Action: Restrict the user from sending mail.",
      "Checks": [
        "defender_antispam_outbound_policy_configured",
        "defender_antispam_outbound_policy_forwarding_disabled"
      ],
      "Attributes": [
        {
          "Section": "2 Microsoft 365 Defender",
          "SubSection": "2.1 Email & collaboration",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "The default outbound anti-spam policy in Microsoft Defender automatically applies to all users and is designed to detect and limit suspicious email-sending behavior. The policy enforces limits based on both volume and spam detection. The recommended state is: External: 500, Internal: 1000, Daily: 1000, Action: Restrict the user from sending mail.",
          "RationaleStatement": "Message limit settings help lessen the impact of a Business Email Compromise (BEC) by automatically restricting accounts that send unusually high volumes of email. This containment prevents compromised accounts from launching large-scale attacks and helps ensure the organization's email remains trusted and deliverable.",
          "ImpactStatement": "Enforcing message limits may result in legitimate users being temporarily blocked from sending email if their bulk messaging activity resembles spam or exceeds volume thresholds. This can disrupt business operations, delay communication, and require administrative effort to investigate and restore access.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft 365 Defender https://security.microsoft.com. 2. Click to expand Email & collaboration select Policies & rules > Threat policies. 3. Under Policies select Anti-spam and click to open Anti-spam outbound policy (Default). 4. Select Edit protection settings. 5. Set External: 500, Internal: 1000, Daily: 1000, Action: Restrict the user from sending mail. 6. Ensure Notify these users and groups if a sender is blocked contains a monitored mailbox.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft 365 Defender https://security.microsoft.com. 2. Click to expand Email & collaboration select Policies & rules > Threat policies. 3. Under Policies select Anti-spam and click to open Anti-spam outbound policy (Default). 4. Ensure the following settings are to the recommended level or more restrictive: External: 500, Internal: 1000, Daily: 1000, Action: Restrict the user from sending mail. 5. Ensure a monitored mailbox is configured.",
          "AdditionalInformation": "Microsoft's Recommended Strict values represent a more restrictive and also compliant configuration: 400, 800, and 800.",
          "References": "https://learn.microsoft.com/en-us/defender-office-365/outbound-spam-protection-about:https://learn.microsoft.com/en-us/defender-office-365/recommended-settings-for-eop-and-office365#outbound-spam-policy-settings:https://learn.microsoft.com/en-us/office365/servicedescriptions/exchange-online-service-description/exchange-online-limits#sending-limits-1",
          "DefaultValue": "RecipientLimitExternalPerHour: 0, RecipientLimitInternalPerHour: 0, RecipientLimitPerDay: 0, ActionWhenThresholdReached: BlockUserForToday"
        }
      ]
    },
    {
      "Id": "2.2.1",
      "Description": "Organizations should monitor sign-in and audit log activity from the emergency accounts and trigger notifications to other administrators. When you monitor the activity for emergency access accounts, you can verify these accounts are only used for testing or actual emergencies. This recommendation uses Defender for Cloud Apps Policies to alert on emergency access account activity. The recommended state is to monitor Activity type Log on on break-glass or emergency access accounts.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "2 Microsoft 365 Defender",
          "SubSection": "2.2 Cloud apps",
          "Profile": "E5 Level 1",
          "AssessmentStatus": "Manual",
          "Description": "Organizations should monitor sign-in and audit log activity from the emergency accounts and trigger notifications to other administrators. When you monitor the activity for emergency access accounts, you can verify these accounts are only used for testing or actual emergencies. This recommendation uses Defender for Cloud Apps Policies to alert on emergency access account activity. The recommended state is to monitor Activity type Log on on break-glass or emergency access accounts.",
          "RationaleStatement": "Emergency access accounts should be used in very few scenarios, for example, the last Global Administrator has left the organization and the account is inaccessible. All activity on an emergency access account should be reviewed at the time of the event to ensure the sign on is legitimate and authorized.",
          "ImpactStatement": "There is no real world impact to monitoring these accounts beyond allocating staff. The frequency of emergency account sign on should be so low that any activity raises a red flag that is treated with the highest priority.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft 365 Defender https://security.microsoft.com. 2. Under the Cloud Apps section select Policies -> Policy management. 3. Click on All policies and then Create policy -> Activity policy. 4. Give the policy a name and set: Policy severity to High severity, Category to Privileged accounts, Act on Single activity. 5. Click Select a filter -> Activity type equals Log on. 6. Click Add a filter -> User Name equals <Emergency access account> as Any role. 7. Ensure all emergency access accounts are added. 8. Select an alert method such as Send alert as email.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft 365 Defender https://security.microsoft.com. 2. Under the Cloud Apps section select Policies -> Policy management. 3. Locate a privileged accounts policy that meets the criteria: Policy severity is High severity, Category is Privileged accounts, Act on Single activity is selected, Filter includes Activity type equals Log on and User Name equals emergency access accounts, Alerting is configured. 4. Repeat for any additional emergency access accounts.",
          "AdditionalInformation": "Multiple accounts can be monitored by a single policy or by separate policies. Emergency access account activity can be monitored in various ways.",
          "References": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/security-emergency-access#monitor-sign-in-and-audit-logs:https://learn.microsoft.com/en-us/defender-cloud-apps/control-cloud-apps-with-policies",
          "DefaultValue": "A policy to monitor emergency access accounts does not exist by default."
        }
      ]
    },
    {
      "Id": "2.4.1",
      "Description": "Identify priority accounts to utilize Microsoft 365's advanced custom security features. This is an essential tool to bolster protection for users who are frequently targeted due to their critical positions, such as executives, leaders, managers, or others who have access to sensitive, confidential, financial, or high-priority information.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "2 Microsoft 365 Defender",
          "SubSection": "2.4 System",
          "Profile": "E5 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Identify priority accounts to utilize Microsoft 365's advanced custom security features. This is an essential tool to bolster protection for users who are frequently targeted due to their critical positions, such as executives, leaders, managers, or others who have access to sensitive, confidential, financial, or high-priority information.",
          "RationaleStatement": "Enabling priority account protection for users in Microsoft 365 is necessary to enhance security for accounts with access to sensitive data and high privileges, such as CEOs, CISOs, CFOs, and IT admins. These priority accounts are often targeted by spear phishing or whaling attacks and require stronger protection to prevent account compromise.",
          "ImpactStatement": "No significant negative impact. Priority account protection enhances security monitoring and alerting for designated accounts.",
          "RemediationProcedure": "To remediate using the UI: Step 1: Enable Priority account protection: 1. Navigate to Microsoft 365 Defender https://security.microsoft.com/. 2. Click to expand System select Settings. 3. Select E-mail & Collaboration > Priority account protection. 4. Ensure Priority account protection is set to On. Step 2: Tag priority accounts: Select User tags, add members to PRIORITY ACCOUNT tag. Step 3: Configure E-mail alerts for Priority Accounts: Create alert policies for Detected malware and Phishing email detected activities targeting Priority accounts.",
          "AuditProcedure": "To audit using the UI: Step 1: Verify Priority account protection is enabled in Settings > E-mail & collaboration > Priority account protection. Step 2: Verify priority accounts are identified and tagged. Step 3: Ensure alert policies are configured for malware and phishing detection targeting priority accounts with High severity.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/microsoft-365/admin/setup/priority-accounts:https://learn.microsoft.com/en-us/defender-office-365/priority-accounts-security-recommendations",
          "DefaultValue": "By default, priority accounts are undefined."
        }
      ]
    },
    {
      "Id": "2.4.2",
      "Description": "Preset security policies have been established by Microsoft, utilizing observations and experiences within datacenters to strike a balance between the exclusion of malicious content from users and limiting unwarranted disruptions. Strict protection has the most aggressive protection of the 3 presets.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "2 Microsoft 365 Defender",
          "SubSection": "2.4 System",
          "Profile": "E5 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Preset security policies have been established by Microsoft, utilizing observations and experiences within datacenters to strike a balance between the exclusion of malicious content from users and limiting unwarranted disruptions. Strict protection has the most aggressive protection of the 3 presets.",
          "RationaleStatement": "Enabling priority account protection for users in Microsoft 365 is necessary to enhance security for accounts with access to sensitive data and high privileges. The implementation of stringent, pre-defined policies may result in instances of false positive, however, the benefit of requiring the end-user to preview junk email before accessing their inbox outweighs the potential risk of mistakenly perceiving a malicious email as safe.",
          "ImpactStatement": "Strict policies are more likely to cause false positives in anti-spam, phishing, impersonation, spoofing and intelligence responses.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft 365 Defender https://security.microsoft.com/. 2. Select to expand E-mail & collaboration. 3. Select Policies & rules > Threat policies > Preset security policies. 4. Click to Manage protection settings for Strict protection preset. 5. For Apply Exchange Online Protection select at minimum Specific recipients and include the Accounts/Groups identified as Priority Accounts. 6. For Apply Defender for Office 365 Protection select at minimum Specific recipients. 7. For Impersonation protection add valid e-mails. 8. For Protected custom domains add the organization's domain name. 9. Click Next and finally Confirm.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft 365 Defender https://security.microsoft.com/. 2. Select to expand E-mail & collaboration. 3. Select Policies & rules > Threat policies. 4. From here visit each section: Anti-phishing, Anti-spam, Anti-malware, Safe Attachments, Safe Links. 5. Ensure in each there is a policy named Strict Preset Security Policy which includes the organization's priority Accounts/Groups.",
          "AdditionalInformation": "The preset security polices cannot target Priority account TAGS currently, groups should be used instead.",
          "References": "https://learn.microsoft.com/en-us/defender-office-365/preset-security-policies?view=o365-worldwide:https://learn.microsoft.com/en-us/defender-office-365/priority-accounts-security-recommendations:https://learn.microsoft.com/en-us/defender-office-365/recommended-settings-for-eop-and-office365?view=o365-worldwide",
          "DefaultValue": "By default, presets are not applied to any users or groups."
        }
      ]
    },
    {
      "Id": "2.4.3",
      "Description": "Microsoft Defender for Cloud Apps is a Cloud Access Security Broker (CASB). It provides visibility into suspicious activity in Microsoft 365, enabling investigation into potential security issues and facilitating the implementation of remediation measures if necessary.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "2 Microsoft 365 Defender",
          "SubSection": "2.4 System",
          "Profile": "E5 Level 2",
          "AssessmentStatus": "Manual",
          "Description": "Microsoft Defender for Cloud Apps is a Cloud Access Security Broker (CASB). It provides visibility into suspicious activity in Microsoft 365, enabling investigation into potential security issues and facilitating the implementation of remediation measures if necessary.",
          "RationaleStatement": "Security teams can receive notifications of triggered alerts for atypical or suspicious activities, see how the organization's data in Microsoft 365 is accessed and used, suspend user accounts exhibiting suspicious activity, and require users to log back in to Microsoft 365 apps after an alert has been triggered.",
          "ImpactStatement": "Additional configuration and monitoring overhead. May require additional licensing for full functionality.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft 365 Defender https://security.microsoft.com/. 2. Click to expand System select Settings > Cloud apps. 3. Scroll to Information Protection and select Files. 4. Check Enable file monitoring. 5. Scroll up to Cloud Discovery and select Microsoft Defender for Endpoint. 6. Check Enforce app access, configure a Notification URL and Save. Configure App Connectors: Scroll to Connected apps and select App connectors, connect Microsoft 365 and Microsoft Azure applications.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft 365 Defender https://security.microsoft.com/. 2. Click to expand System select Settings > Cloud apps. 3. Scroll to Connected apps and select App connectors. 4. Ensure that Microsoft 365 and Microsoft Azure both show in the list as Connected. 5. Go to Cloud Discovery > Microsoft Defender for Endpoint and check if the integration is enabled. 6. Go to Information Protection > Files and verify Enable file monitoring is checked.",
          "AdditionalInformation": "Defender for Endpoint requires a Defender for Endpoint license. Some risk detection methods provided by Entra Identity Protection also require Microsoft Defender for Cloud Apps.",
          "References": "https://learn.microsoft.com/en-us/defender-cloud-apps/protect-office365#connect-microsoft-365-to-microsoft-defender-for-cloud-apps:https://learn.microsoft.com/en-us/defender-cloud-apps/protect-azure#connect-azure-to-microsoft-defender-for-cloud-apps:https://learn.microsoft.com/en-us/defender-cloud-apps/best-practices:https://learn.microsoft.com/en-us/defender-cloud-apps/get-started:https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks",
          "DefaultValue": "Disabled"
        }
      ]
    },
    {
      "Id": "2.4.4",
      "Description": "Zero-hour auto purge (ZAP) is a protection feature that retroactively detects and neutralizes malware and high confidence phishing. When ZAP for Teams protection blocks a message, the message is blocked for everyone in the chat. The initial block happens right after delivery, but ZAP occurs up to 48 hours after delivery.",
      "Checks": [
        "defender_zap_for_teams_enabled"
      ],
      "Attributes": [
        {
          "Section": "2 Microsoft 365 Defender",
          "SubSection": "2.4 System",
          "Profile": "E5 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Zero-hour auto purge (ZAP) is a protection feature that retroactively detects and neutralizes malware and high confidence phishing. When ZAP for Teams protection blocks a message, the message is blocked for everyone in the chat. The initial block happens right after delivery, but ZAP occurs up to 48 hours after delivery.",
          "RationaleStatement": "ZAP is intended to protect users that have received zero-day malware messages or content that is weaponized after being delivered to users. It does this by continually monitoring spam and malware signatures taking automated retroactive action on messages that have already been delivered.",
          "ImpactStatement": "As with any anti-malware or anti-phishing product, false positives may occur.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Defender https://security.microsoft.com/. 2. Click to expand System select Settings > Email & collaboration > Microsoft Teams protection. 3. Set Zero-hour auto purge (ZAP) to On (Default).",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Defender https://security.microsoft.com/. 2. Click to expand System select Settings > Email & collaboration > Microsoft Teams protection. 3. Ensure Zero-hour auto purge (ZAP) is set to On (Default). 4. Under Exclude these participants review the list of exclusions and ensure they are justified and within tolerance for the organization.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/defender-office-365/zero-hour-auto-purge?view=o365-worldwide#zero-hour-auto-purge-zap-in-microsoft-teams:https://learn.microsoft.com/en-us/defender-office-365/mdo-support-teams-about?view=o365-worldwide",
          "DefaultValue": "On (Default)"
        }
      ]
    },
    {
      "Id": "3.1.1",
      "Description": "When audit log search is enabled in the Microsoft Purview compliance portal, user and admin activity within the organization is recorded in the audit log and retained for 180 days by default.",
      "Checks": [
        "purview_audit_log_search_enabled"
      ],
      "Attributes": [
        {
          "Section": "3 Microsoft Purview",
          "SubSection": "3.1 Audit",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "When audit log search is enabled in the Microsoft Purview compliance portal, user and admin activity within the organization is recorded in the audit log and retained for 180 days by default.",
          "RationaleStatement": "Enabling audit log search in the Microsoft Purview compliance portal can help organizations improve their security posture, meet regulatory compliance requirements, respond to security incidents, and gain valuable operational insights.",
          "ImpactStatement": "No significant impact. Enabling audit logging is a security best practice.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Purview https://purview.microsoft.com/. 2. Select Solutions and then Audit to open the audit search. 3. Click blue bar Start recording user and admin activity. 4. Click Yes on the dialog box to confirm.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Purview https://purview.microsoft.com/. 2. Select Solutions and then Audit to open the audit search. 3. Choose a date and time frame in the past 30 days. 4. Verify search capabilities work and results are displayed.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/purview/audit-log-enable-disable?view=o365-worldwide:https://learn.microsoft.com/en-us/powershell/module/exchange/set-adminauditlogconfig?view=exchange-ps",
          "DefaultValue": "180 days retention"
        }
      ]
    },
    {
      "Id": "3.2.1",
      "Description": "Data Loss Prevention (DLP) policies allow Exchange Online and SharePoint Online content to be scanned for specific types of data like social security numbers, credit card numbers, or passwords.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "3 Microsoft Purview",
          "SubSection": "3.2 Data loss protection",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Data Loss Prevention (DLP) policies allow Exchange Online and SharePoint Online content to be scanned for specific types of data like social security numbers, credit card numbers, or passwords.",
          "RationaleStatement": "Enabling DLP policies alerts users and administrators that specific types of data should not be exposed, helping to protect the data from accidental exposure.",
          "ImpactStatement": "Enabling a Teams DLP policy will allow sensitive data in Exchange Online and SharePoint Online to be detected or blocked. Always ensure to follow appropriate procedures during testing and implementation of DLP policies based on organizational standards.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Purview https://purview.microsoft.com/. 2. Click Solutions > Data loss prevention then Policies. 3. Click Create policy. 4. Create a policy that is specific to the types of data the organization wishes to protect.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Purview https://purview.microsoft.com/. 2. Click Solutions > Data loss prevention and then Policies. 3. Verify that the organization is using policies applicable to the types data that is in their interest to protect. 4. Verify the policies are On.",
          "AdditionalInformation": "The types of policies an organization should implement to protect information are specific to their industry.",
          "References": "https://learn.microsoft.com/en-us/purview/dlp-learn-about-dlp?view=o365-worldwide",
          "DefaultValue": "DLP policies are not configured by default."
        }
      ]
    },
    {
      "Id": "3.2.2",
      "Description": "The default Teams Data Loss Prevention (DLP) policy rule in Microsoft 365 is a preconfigured rule that is automatically applied to all Teams conversations and channels. The default rule helps prevent accidental sharing of sensitive information by detecting and blocking certain types of content.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "3 Microsoft Purview",
          "SubSection": "3.2 Data loss protection",
          "Profile": "E5 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "The default Teams Data Loss Prevention (DLP) policy rule in Microsoft 365 is a preconfigured rule that is automatically applied to all Teams conversations and channels. The default rule helps prevent accidental sharing of sensitive information by detecting and blocking certain types of content.",
          "RationaleStatement": "Enabling the default Teams DLP policy rule in Microsoft 365 helps protect an organization's sensitive information by preventing accidental sharing or leakage Credit Card information in Teams conversations and channels.",
          "ImpactStatement": "End-users may be prevented from sharing certain types of content, which may require them to adjust their behavior or seek permission from administrators to share specific content.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Purview compliance portal https://purview.microsoft.com/. 2. Under Solutions select Data loss prevention then Policies. 3. Click Policies tab. 4. Check Default policy for Teams then click Edit policy. 5. At the Choose locations to apply the policy page, turn the status toggle to On for Teams chat and channel messages location. 6. On Policy mode page, select Turn it on right away and click Next. 7. Review and submit.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Purview compliance portal https://purview.microsoft.com/. 2. Under Solutions select Data loss prevention then Policies. 3. Locate the Default policy for Teams. 4. Verify the Status is On. 5. Verify Locations include Teams chat and channel messages - All accounts.",
          "AdditionalInformation": "Some tenants may not have a default policy for teams as Microsoft started creating these by default at a particular point in time.",
          "References": "https://learn.microsoft.com/en-us/purview/dlp-teams-default-policy:https://learn.microsoft.com/en-us/powershell/module/exchange/connect-ippssession?view=exchange-ps",
          "DefaultValue": "Enabled (On)"
        }
      ]
    },
    {
      "Id": "3.3.1",
      "Description": "Sensitivity labels enable organizations to classify and label content across Microsoft 365 based on its sensitivity and business impact. These labels can be applied manually by users or automatically based on the content. When applied, labels can automatically encrypt content, provide Confidential watermarks, restrict access, and offer various data protection features.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "3 Microsoft Purview",
          "SubSection": "3.3 Information Protection",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Sensitivity labels enable organizations to classify and label content across Microsoft 365 based on its sensitivity and business impact. These labels can be applied manually by users or automatically based on the content. When applied, labels can automatically encrypt content, provide Confidential watermarks, restrict access, and offer various data protection features.",
          "RationaleStatement": "Consistent usage of sensitivity labels can help reduce the risk of data loss or exposure and enable more effective incident response if a breach does occur. They can also help organizations comply with regulatory requirements and provide visibility and control over sensitive information.",
          "ImpactStatement": "Encryption configurations in the individual labels may impact users' ability to access site documents and information. Careful consideration of the individual sensitivity label configurations should be exercised prior to applying an auto labeling policy.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Purview compliance portal https://purview.microsoft.com/. 2. Select Information protection > Sensitivity labels. 3. Click Create a label to create a label. 4. Click Publish labels and select any newly created labels to publish according to the organization's information protection needs.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Purview compliance portal https://purview.microsoft.com/. 2. Select Information protection > Policies > Label publishing policies. 3. Ensure that a Label policy exists and is published according to the organization's information protection needs.",
          "AdditionalInformation": "These policies are specific to the information protection needs of each organization.",
          "References": "https://learn.microsoft.com/en-us/purview/sensitivity-labels:https://learn.microsoft.com/en-us/purview/create-sensitivity-labels",
          "DefaultValue": "The Global sensitivity label policy exists by default."
        }
      ]
    },
    {
      "Id": "4.1",
      "Description": "Compliance policies are sets of rules and conditions that are used to evaluate the configuration of managed devices. These policies can help secure organizational data and resources from devices that don't meet those configuration requirements. The recommended state is Mark devices with no compliance policy assigned as Not compliant.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "4 Microsoft Intune admin center",
          "SubSection": "",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "Compliance policies are sets of rules and conditions that are used to evaluate the configuration of managed devices. These policies can help secure organizational data and resources from devices that don't meet those configuration requirements. The recommended state is Mark devices with no compliance policy assigned as Not compliant.",
          "RationaleStatement": "Implementing this setting is a first step in adopting compliance policies for devices. When used in together with Conditional Access policies the attack surface can be reduced by forcing an action to be taken for non-compliant devices.",
          "ImpactStatement": "Any devices without a compliance policy will be marked not compliant. Care should be taken to first deploy any new compliance policies with a Conditional Access policy that is in the Report-only state.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Intune admin center https://intune.microsoft.com/. 2. Select Devices and then under Manage devices click Compliance. 3. Click Compliance settings. 4. Set Mark devices with no compliance policy assigned as to Not compliant.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Intune admin center https://intune.microsoft.com/. 2. Select Devices and then under Manage devices click Compliance. 3. Click Compliance settings. 4. Ensure Mark devices with no compliance policy assigned as is set to Not compliant.",
          "AdditionalInformation": "This section does not focus on which compliance policies to use, only that an organization should adopt and enforce them to their needs.",
          "References": "https://learn.microsoft.com/en-us/mem/intune/protect/device-compliance-get-started",
          "DefaultValue": "UI: Compliant, Graph: secureByDefault = false"
        }
      ]
    },
    {
      "Id": "4.2",
      "Description": "Device enrollment restrictions let you restrict devices from enrolling in Intune based on certain device attributes such as device limit, device platform, OS Version, manufacturer or device ownership. The recommended state is to Block personally owned devices from enrollment.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "4 Microsoft Intune admin center",
          "SubSection": "",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "Device enrollment restrictions let you restrict devices from enrolling in Intune based on certain device attributes such as device limit, device platform, OS Version, manufacturer or device ownership. The recommended state is to Block personally owned devices from enrollment.",
          "RationaleStatement": "Restricting the enrollment of personally owned devices prevents attackers who have bypassed other controls from registering a new device to gain an additional foothold, further hiding or obscuring their activities.",
          "ImpactStatement": "Per platform personally owned device enrollment impacts are listed. Windows, macOS, iOS/iPadOS, and Android devices have specific requirements for corporate enrollment. It is important to test the changes to the defaults prior to moving into production.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Intune admin center https://intune.microsoft.com/. 2. Select Devices and then under Device onboarding click Enrollment. 3. Under Enrollment options select Device platform restriction. 4. For the Default priority policy, click All Users and select Properties. 5. Click Edit to change Platform settings. 6. In the Personally owned column set each platform to Block.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Intune admin center https://intune.microsoft.com/. 2. Select Devices and then under Device onboarding click Enrollment. 3. Under Enrollment options select Device platform restriction. 4. Inspect the policies listed under Device type restrictions. 5. Ensure all platforms are set to Block in the Personally owned column.",
          "AdditionalInformation": "Blocking platforms that are not used in the organization is a more restrictive best practice.",
          "References": "https://learn.microsoft.com/en-us/mem/intune/enrollment/enrollment-restrictions-set",
          "DefaultValue": "Allow"
        }
      ]
    },
    {
      "Id": "5.1.2.1",
      "Description": "Legacy per-user Multi-Factor Authentication (MFA) can be configured to require individual users to provide multiple authentication factors. It was introduced in earlier versions of Office 365, prior to the more comprehensive implementation of Conditional Access (CA). The recommended state is to disable per-user MFA on all accounts.",
      "Checks": [
        "entra_users_mfa_enabled"
      ],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.1.2 Users",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Legacy per-user Multi-Factor Authentication (MFA) can be configured to require individual users to provide multiple authentication factors. It was introduced in earlier versions of Office 365, prior to the more comprehensive implementation of Conditional Access (CA). The recommended state is to disable per-user MFA on all accounts.",
          "RationaleStatement": "Both security defaults and conditional access with security defaults turned off are not compatible with per-user multi-factor authentication (MFA), which can lead to undesirable user authentication states. The CIS Microsoft 365 Benchmark explicitly employs Conditional Access for MFA as an enhancement over security defaults and as a replacement for the outdated per-user MFA.",
          "ImpactStatement": "Accounts using per-user MFA will need to be migrated to use CA. Prior to disabling per-user MFA the organization must be prepared to implement conditional access MFA to avoid security gaps.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Users select All users. 3. Click on Per-user MFA on the top row. 4. Click the empty box next to Display Name to select all accounts. 5. On the far right under quick steps click Disable.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Users select All users. 3. Click on Per-user MFA on the top row. 4. Ensure under the column Multi-factor Auth Status that each account is set to Disabled.",
          "AdditionalInformation": "Microsoft has documentation on migrating from per-user MFA Convert users from per-user MFA to Conditional Access based MFA.",
          "References": "https://learn.microsoft.com/en-us/entra/identity/authentication/howto-mfa-userstates#convert-users-from-per-user-mfa-to-conditional-access:https://learn.microsoft.com/en-us/microsoft-365/admin/security-and-compliance/set-up-multi-factor-authentication?view=o365-worldwide",
          "DefaultValue": "Disabled"
        }
      ]
    },
    {
      "Id": "5.1.2.2",
      "Description": "App registration allows users to register custom-developed applications for use within the directory. Third-party integrated applications connection to services should be disabled unless there is a very clear value and robust security controls are in place.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.1.2 Users",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "App registration allows users to register custom-developed applications for use within the directory. Third-party integrated applications connection to services should be disabled unless there is a very clear value and robust security controls are in place.",
          "RationaleStatement": "While there are legitimate uses, attackers can grant access from breached accounts to third party applications to exfiltrate data from your tenancy without having to maintain the breached account.",
          "ImpactStatement": "The implementation of this change will impact both end users and administrators. End users will not be able to integrate third-party applications that they may wish to use.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Users select Users settings. 3. Set Users can register applications to No. 4. Click Save.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Users select Users settings. 3. Verify Users can register applications is set to No.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/entra/identity-platform/how-applications-are-added",
          "DefaultValue": "Yes (Users can register applications.)"
        }
      ]
    },
    {
      "Id": "5.1.2.3",
      "Description": "Non-privileged users can create tenants in the Microsoft Entra ID and Microsoft Entra administration portal under Manage tenant. The recommended state is Restrict non-admin users from creating tenants set to Yes.",
      "Checks": [
        "entra_policy_ensure_default_user_cannot_create_tenants"
      ],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.1.2 Users",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Non-privileged users can create tenants in the Microsoft Entra ID and Microsoft Entra administration portal under Manage tenant. The recommended state is Restrict non-admin users from creating tenants set to Yes.",
          "RationaleStatement": "Restricting tenant creation prevents unauthorized or uncontrolled deployment of resources and ensures that the organization retains control over its infrastructure. User generation of shadow IT could lead to multiple, disjointed environments that can make it difficult for IT to manage and secure the organization's data.",
          "ImpactStatement": "Non-admin users will need to contact I.T. if they have a valid reason to create a tenant.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Users > User settings. 3. Set Restrict non-admin users from creating tenants to Yes then Save.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Users > User settings. 3. Ensure Restrict non-admin users from creating tenants is set to Yes.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/entra/fundamentals/users-default-permissions#restrict-member-users-default-permissions",
          "DefaultValue": "No - Non-administrators can create tenants."
        }
      ]
    },
    {
      "Id": "5.1.2.4",
      "Description": "Restrict non-privileged users from signing into the Microsoft Entra admin center. This recommendation only affects access to the web portal. It does not prevent privileged users from using other methods such as Rest API or PowerShell to obtain information.",
      "Checks": [
        "entra_admin_portals_access_restriction"
      ],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.1.2 Users",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Manual",
          "Description": "Restrict non-privileged users from signing into the Microsoft Entra admin center. This recommendation only affects access to the web portal. It does not prevent privileged users from using other methods such as Rest API or PowerShell to obtain information.",
          "RationaleStatement": "The Microsoft Entra admin center contains sensitive data and permission settings, which are still enforced based on the user's role. However, an end user may inadvertently change properties or account settings that could result in increased administrative overhead. Additionally, a compromised end user account could be used by a malicious attacker as a means to gather additional information and escalate an attack.",
          "ImpactStatement": "In the event there are resources a user owns that need to be changed in the Entra Admin center, then an administrator would need to make those changes.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Users > User settings. 3. Set Restrict access to Microsoft Entra admin center to Yes then Save.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Users > User settings. 3. Verify under the Administration center section that Restrict access to Microsoft Entra admin center is set to Yes.",
          "AdditionalInformation": "Users will still be able to sign into Microsoft Entra admin center but will be unable to see directory information.",
          "References": "https://learn.microsoft.com/en-us/entra/fundamentals/users-default-permissions#restrict-member-users-default-permissions",
          "DefaultValue": "No - Non-administrators can access the Microsoft Entra admin center."
        }
      ]
    },
    {
      "Id": "5.1.2.5",
      "Description": "The option for the user to Stay signed in, or the Keep me signed in option, will prompt a user after a successful login. When the user selects this option, a persistent refresh token is created. The refresh token lasts for 90 days by default and does not prompt for sign-in or multifactor.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.1.2 Users",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Manual",
          "Description": "The option for the user to Stay signed in, or the Keep me signed in option, will prompt a user after a successful login. When the user selects this option, a persistent refresh token is created. The refresh token lasts for 90 days by default and does not prompt for sign-in or multifactor.",
          "RationaleStatement": "Allowing users to select this option presents risk, especially if the user signs into their account on a publicly accessible computer/web browser. In this case it would be trivial for an unauthorized person to gain access to any associated cloud data from that account.",
          "ImpactStatement": "Once this setting is hidden users will no longer be prompted upon sign-in with the message Stay signed in?. This may mean users will be forced to sign in more frequently. Some features of SharePoint Online and Office 2010 have a dependency on users remaining signed in.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Users > User settings. 3. Set Show keep user signed in to No. 4. Click Save.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Users > User settings. 3. Ensure Show keep user signed in is highlighted No.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/entra/identity/authentication/concepts-azure-multi-factor-authentication-prompts-session-lifetime:https://learn.microsoft.com/en-us/entra/fundamentals/how-to-manage-stay-signed-in-prompt",
          "DefaultValue": "Users may select stay signed in"
        }
      ]
    },
    {
      "Id": "5.1.2.6",
      "Description": "LinkedIn account connections allow users to connect their Microsoft work or school account with LinkedIn. After a user connects their accounts, information and highlights from LinkedIn are available in some Microsoft apps and services.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.1.2 Users",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Manual",
          "Description": "LinkedIn account connections allow users to connect their Microsoft work or school account with LinkedIn. After a user connects their accounts, information and highlights from LinkedIn are available in some Microsoft apps and services.",
          "RationaleStatement": "Disabling LinkedIn integration prevents potential phishing attacks and risk scenarios where an external party could accidentally disclose sensitive information.",
          "ImpactStatement": "Users will not be able to sync contacts or use LinkedIn integration.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Users select User settings. 3. Under LinkedIn account connections select No. 4. Click Save.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Users select User settings. 3. Under LinkedIn account connections ensure No is highlighted.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/entra/identity/users/linkedin-integration:https://learn.microsoft.com/en-us/entra/identity/users/linkedin-user-consent",
          "DefaultValue": "LinkedIn integration is enabled by default."
        }
      ]
    },
    {
      "Id": "5.1.3.1",
      "Description": "A dynamic group is a dynamic configuration of security group membership for Microsoft Entra ID. Administrators can set rules to populate groups that are created in Entra ID based on user attributes. The recommended state is to create a dynamic group that includes guest accounts.",
      "Checks": [
        "entra_dynamic_group_for_guests_created"
      ],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.1.3 Groups",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "A dynamic group is a dynamic configuration of security group membership for Microsoft Entra ID. Administrators can set rules to populate groups that are created in Entra ID based on user attributes. The recommended state is to create a dynamic group that includes guest accounts.",
          "RationaleStatement": "Dynamic groups allow for an automated method to assign group membership. Guest user accounts will be automatically added to this group and through this existing conditional access rules, access controls and other security measures will ensure that new guest accounts are restricted in the same manner as existing guest accounts.",
          "ImpactStatement": "No significant negative impact. This improves visibility and management of guest accounts.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Groups select All groups. 3. Select New group and assign the following values: Group type: Security, Membership type: Dynamic User. 4. Select Add dynamic query. 5. Above the Rule syntax text box, select Edit. 6. Place the following expression in the box: (user.userType -eq \"Guest\"). 7. Select OK and Save.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Groups select All groups. 3. On the right of the search field click Add filter. 4. Set Filter to Membership type and Value to Dynamic then apply. 5. Identify a dynamic group and select it. 6. Under manage, select Dynamic membership rules and ensure the rule syntax contains (user.userType -eq \"Guest\").",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/entra/identity/users/groups-create-rule:https://learn.microsoft.com/en-us/entra/identity/users/groups-dynamic-membership:https://learn.microsoft.com/en-us/entra/external-id/use-dynamic-groups",
          "DefaultValue": "Undefined"
        }
      ]
    },
    {
      "Id": "5.1.3.2",
      "Description": "This setting allows users in the organization to create new security groups and add members to these groups in the Azure portal, API, or PowerShell. The recommended state is Users can create security groups in Azure portals, API or PowerShell set to No.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.1.3 Groups",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "This setting allows users in the organization to create new security groups and add members to these groups in the Azure portal, API, or PowerShell. The recommended state is Users can create security groups in Azure portals, API or PowerShell set to No.",
          "RationaleStatement": "Allowing end users to create security groups without oversight can lead to uncontrolled group sprawl, increasing the risk of inappropriate access to sensitive data. A compromised non-privileged user could create deceptively named security groups that an administrator might mistakenly assign elevated privileges to.",
          "ImpactStatement": "Restrictions may introduce some operational friction, particularly in fast-paced or decentralized environments where teams rely on self-service capabilities for collaboration and access management.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Groups select General. 3. Set Users can create security groups in Azure portals, API or PowerShell to No.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Groups select General. 3. Ensure Users can create security groups in Azure portals, API or PowerShell is set to No.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/entra/identity/users/groups-self-service-management:https://learn.microsoft.com/en-us/graph/api/authorizationpolicy-get?view=graph-rest-1.0",
          "DefaultValue": "AllowedToCreateSecurityGroups: True"
        }
      ]
    },
    {
      "Id": "5.1.4.1",
      "Description": "This setting enables you to select the users who can register their devices as Microsoft Entra joined devices. The recommended state is Selected or None.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.1.4 Devices",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "This setting enables you to select the users who can register their devices as Microsoft Entra joined devices. The recommended state is Selected or None.",
          "RationaleStatement": "If a threat actor compromises a standard user account, they can enroll a rogue device under that user's identity. This device may inherit MDM policies and appear compliant, giving attackers persistent access to cloud resources without triggering MFA.",
          "ImpactStatement": "Restricting the setting requires IT teams to assign enrollment permissions to specific staff, such as helpdesk or provisioning personnel, which may impact user-driven Autopilot scenarios and increase administrative overhead.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Devices select Device settings. 3. Set Users may join devices to Microsoft Entra to Selected (and add members) or None.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Devices select Device settings. 3. Ensure Users may join devices to Microsoft Entra is set to Selected or None.",
          "AdditionalInformation": "This setting is applicable only to Microsoft Entra join on Windows 10 or newer.",
          "References": "https://learn.microsoft.com/en-us/entra/identity/devices/manage-device-identities#configure-device-settings",
          "DefaultValue": "All"
        }
      ]
    },
    {
      "Id": "5.1.4.2",
      "Description": "This setting defines the maximum number of Microsoft Entra joined or registered devices that a user can have in Microsoft Entra ID. Once this limit is reached, no additional devices can be added until existing ones are removed. The recommended state is 20 or less.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.1.4 Devices",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "This setting defines the maximum number of Microsoft Entra joined or registered devices that a user can have in Microsoft Entra ID. Once this limit is reached, no additional devices can be added until existing ones are removed. The recommended state is 20 or less.",
          "RationaleStatement": "Microsoft incident response teams have observed threat actors enrolling their own devices to establish persistence after a non-privileged user has been compromised. High device quotas can exacerbate this risk by enabling attackers to register multiple devices that appear legitimate.",
          "ImpactStatement": "IT staff who need to enroll more than 20 devices on behalf of the organization must be assigned the role of Device Enrollment Manager in the Intune admin center.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Devices select Device settings. 3. Set Maximum number of devices per user to 20 (Recommended) or less.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Devices select Device settings. 3. Ensure Maximum number of devices per user is set to 20 (Recommended) or less.",
          "AdditionalInformation": "Do not delete accounts assigned as a Device enrollment manager if any devices were enrolled using the account.",
          "References": "https://learn.microsoft.com/en-us/entra/identity/devices/manage-device-identities#configure-device-settings:https://learn.microsoft.com/en-us/intune/intune-service/enrollment/device-enrollment-manager-enroll",
          "DefaultValue": "50"
        }
      ]
    },
    {
      "Id": "5.1.4.3",
      "Description": "This setting controls whether the Global Administrator role is automatically added to the local administrators group on a device during the Microsoft Entra join process. The recommended state is No.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.1.4 Devices",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "This setting controls whether the Global Administrator role is automatically added to the local administrators group on a device during the Microsoft Entra join process. The recommended state is No.",
          "RationaleStatement": "System administrators may be inclined to use over-privileged accounts for convenience when managing devices. Enforcing this control helps discourage that behavior by requiring administrative actions to be performed using accounts specifically designated for local administration.",
          "ImpactStatement": "Restricting the default behavior and requiring manual assignment to least privilege roles introduces minor administrative overhead.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Devices select Device settings. 3. Set Global administrator role is added as local administrator on the device during Microsoft Entra join (Preview) to No.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Devices select Device settings. 3. Ensure Global administrator role is added as local administrator on the device during Microsoft Entra join (Preview) is set to No.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/entra/identity/devices/manage-device-identities#configure-device-settings:https://learn.microsoft.com/en-us/entra/identity/devices/assign-local-admin",
          "DefaultValue": "Yes"
        }
      ]
    },
    {
      "Id": "5.1.4.4",
      "Description": "This setting determines if the Microsoft Entra user registering their device as Microsoft Entra join be added to the local administrators group. The recommended state is Selected or None.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.1.4 Devices",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "This setting determines if the Microsoft Entra user registering their device as Microsoft Entra join be added to the local administrators group. The recommended state is Selected or None.",
          "RationaleStatement": "To uphold the principle of least privilege, the assignment of local administrator rights during Microsoft Entra join should be centrally managed using appropriate built-in roles through Intune.",
          "ImpactStatement": "Restricting the default behavior and requiring manual assignment to built-in roles introduces minor administrative overhead.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Devices select Device settings. 3. Set Registering user is added as local administrator on the device during Microsoft Entra join (Preview) to Selected (and add members) or None.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Devices select Device settings. 3. Ensure Registering user is added as local administrator on the device during Microsoft Entra join (Preview) is set to Selected or None.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/entra/identity/devices/manage-device-identities#configure-device-settings:https://learn.microsoft.com/en-us/entra/identity/devices/assign-local-admin",
          "DefaultValue": "All"
        }
      ]
    },
    {
      "Id": "5.1.4.5",
      "Description": "Local Administrator Password Solution (LAPS) is the management of local account passwords on Windows devices. LAPS provides a solution to securely manage and retrieve the built-in local admin password. The recommended state is Yes.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.1.4 Devices",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Local Administrator Password Solution (LAPS) is the management of local account passwords on Windows devices. LAPS provides a solution to securely manage and retrieve the built-in local admin password. The recommended state is Yes.",
          "RationaleStatement": "Managing local Administrator passwords across multiple systems can be challenging. LAPS reduces the security risk when administrators configure the same password on all workstations.",
          "ImpactStatement": "Enabling LAPS requires some additional operational overhead. Although unlikely, if a password is rotated and not retrieved before the device becomes unreachable, administrators may be locked out.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Devices select Device settings. 3. Set Enable Microsoft Entra Local Administrator Password Solution (LAPS) to Yes.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Devices select Device settings. 3. Ensure Enable Microsoft Entra Local Administrator Password Solution (LAPS) is set to Yes.",
          "AdditionalInformation": "Enabling LAPS at the tenant level does not automatically enforce password rotation for built-in Administrator accounts.",
          "References": "https://learn.microsoft.com/en-us/entra/identity/devices/manage-device-identities#configure-device-settings:https://learn.microsoft.com/en-us/entra/identity/devices/howto-manage-local-admin-passwords",
          "DefaultValue": "No"
        }
      ]
    },
    {
      "Id": "5.1.4.6",
      "Description": "This setting determines if users can self-service recover their BitLocker key(s). The recommended state is No.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.1.4 Devices",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "This setting determines if users can self-service recover their BitLocker key(s). The recommended state is No.",
          "RationaleStatement": "Restricting users from recovering BitLocker keys helps prevent unauthorized access to encrypted drives. If a user's account is compromised, an attacker could potentially recover BitLocker keys and access sensitive data.",
          "ImpactStatement": "Users will need to contact IT support to recover BitLocker keys, which may increase support overhead.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Devices select Device settings. 3. Set Restrict users from recovering the BitLocker key(s) for their owned devices to Yes.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Devices select Device settings. 3. Ensure Restrict users from recovering the BitLocker key(s) for their owned devices is set to Yes.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/entra/identity/devices/manage-device-identities#configure-device-settings",
          "DefaultValue": "No"
        }
      ]
    },
    {
      "Id": "5.1.5.1",
      "Description": "User consent to apps accessing company data on their behalf allows users to grant permissions to applications without administrator involvement. The recommended state is Do not allow user consent.",
      "Checks": [
        "entra_policy_restricts_user_consent_for_apps"
      ],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.1.5 Applications",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "User consent to apps accessing company data on their behalf allows users to grant permissions to applications without administrator involvement. The recommended state is Do not allow user consent.",
          "RationaleStatement": "Attackers commonly use custom applications to trick users into granting access to company data. Disabling user consent and establishing an admin consent workflow can reduce this risk.",
          "ImpactStatement": "Users will need to request administrator approval before they can use applications that require access to company data.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Applications > Enterprise applications > Consent and permissions. 3. Set User consent for applications to Do not allow user consent. 4. Click Save.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Applications > Enterprise applications > Consent and permissions. 3. Ensure User consent for applications is set to Do not allow user consent.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/entra/identity/enterprise-apps/configure-user-consent",
          "DefaultValue": "Allow user consent for apps from verified publishers"
        }
      ]
    },
    {
      "Id": "5.1.5.2",
      "Description": "The admin consent workflow gives users a way to request access to applications that require admin consent. The recommended state is Enable the admin consent workflow.",
      "Checks": [
        "entra_admin_consent_workflow_enabled"
      ],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.1.5 Applications",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "The admin consent workflow gives users a way to request access to applications that require admin consent. The recommended state is Enable the admin consent workflow.",
          "RationaleStatement": "The admin consent workflow provides a secure method for users to request access to applications that require permissions. This ensures that administrators can review and approve requests before users gain access.",
          "ImpactStatement": "Administrators will need to review and approve consent requests, which may increase administrative overhead.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Applications > Enterprise applications > Consent and permissions > Admin consent settings. 3. Set Users can request admin consent to apps they are unable to consent to to Yes. 4. Configure reviewers and notification settings. 5. Click Save.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Applications > Enterprise applications > Consent and permissions > Admin consent settings. 3. Ensure Users can request admin consent to apps they are unable to consent to is set to Yes.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/entra/identity/enterprise-apps/configure-admin-consent-workflow",
          "DefaultValue": "No"
        }
      ]
    },
    {
      "Id": "5.1.6.1",
      "Description": "External collaboration settings allow you to specify which domains users can invite for B2B collaboration. The recommended state is to send collaboration invitations to allowed domains only.",
      "Checks": [
        "entra_thirdparty_integrated_apps_not_allowed"
      ],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.1.6 External Identities",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "External collaboration settings allow you to specify which domains users can invite for B2B collaboration. The recommended state is to send collaboration invitations to allowed domains only.",
          "RationaleStatement": "Restricting invitations to allowed domains helps prevent unauthorized access to your organization's resources. This reduces the risk of data exposure to untrusted external parties.",
          "ImpactStatement": "Users will only be able to invite guests from specified domains, which may limit collaboration with partners from unapproved domains.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > External Identities > External collaboration settings. 3. Under Collaboration restrictions, select Allow invitations only to the specified domains. 4. Add the allowed domains. 5. Click Save.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > External Identities > External collaboration settings. 3. Ensure Allow invitations only to the specified domains is selected under Collaboration restrictions.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/entra/external-id/allow-deny-list",
          "DefaultValue": "Allow invitations to be sent to any domain"
        }
      ]
    },
    {
      "Id": "5.1.6.2",
      "Description": "Guest user access restrictions determine the level of access that guest users have in your directory. The recommended state is Guest user access is restricted to properties and memberships of their own directory objects.",
      "Checks": [
        "entra_policy_guest_users_access_restrictions"
      ],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.1.6 External Identities",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Guest user access restrictions determine the level of access that guest users have in your directory. The recommended state is Guest user access is restricted to properties and memberships of their own directory objects.",
          "RationaleStatement": "Restricting guest user access helps prevent unauthorized enumeration of directory information. This reduces the risk of reconnaissance attacks by external users.",
          "ImpactStatement": "Guest users will have limited visibility into directory objects, which may affect collaboration scenarios that require directory lookups.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > External Identities > External collaboration settings. 3. Under Guest user access, select Guest user access is restricted to properties and memberships of their own directory objects. 4. Click Save.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > External Identities > External collaboration settings. 3. Ensure Guest user access is restricted to properties and memberships of their own directory objects is selected.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/entra/fundamentals/users-default-permissions#restrict-member-users-default-permissions",
          "DefaultValue": "Guest users have the same access as members"
        }
      ]
    },
    {
      "Id": "5.1.6.3",
      "Description": "Guest invite settings determine who can invite external users to collaborate. The recommended state is to limit invitations to the Guest Inviter role.",
      "Checks": [
        "entra_policy_guest_invite_only_for_admin_roles"
      ],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.1.6 External Identities",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "Guest invite settings determine who can invite external users to collaborate. The recommended state is to limit invitations to the Guest Inviter role.",
          "RationaleStatement": "Restricting guest invitations to specific roles helps maintain control over who can add external users to your organization. This reduces the risk of unauthorized guest accounts being created.",
          "ImpactStatement": "Only users with the Guest Inviter role will be able to invite external users, which may require role assignment changes for collaboration scenarios.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > External Identities > External collaboration settings. 3. Under Guest invite settings, select Only users assigned to specific admin roles can invite guest users. 4. Click Save.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > External Identities > External collaboration settings. 3. Ensure Only users assigned to specific admin roles can invite guest users is selected.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/entra/external-id/external-collaboration-settings-configure",
          "DefaultValue": "Anyone in the organization can invite guest users"
        }
      ]
    },
    {
      "Id": "5.1.8.1",
      "Description": "Password hash sync is enabled for hybrid deployments to ensure that on-premises password changes are synchronized to Microsoft Entra ID. The recommended state is to enable password hash sync.",
      "Checks": [
        "entra_password_hash_sync_enabled"
      ],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.1.8 Hybrid management",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Manual",
          "Description": "Password hash sync is enabled for hybrid deployments to ensure that on-premises password changes are synchronized to Microsoft Entra ID. The recommended state is to enable password hash sync.",
          "RationaleStatement": "Password hash synchronization is one of the sign-in methods used for hybrid identity. It provides a backup authentication method if federation services become unavailable and enables leaked credential detection through Entra ID Protection.",
          "ImpactStatement": "Enabling password hash sync requires configuration of Microsoft Entra Connect and may have implications for compliance in regulated industries.",
          "RemediationProcedure": "To remediate: 1. Open Microsoft Entra Connect on your synchronization server. 2. Select Configure and then Change user sign-in. 3. Enable Password Hash Synchronization. 4. Complete the wizard.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Hybrid management > Microsoft Entra Connect. 3. Verify that Password Hash Sync is enabled.",
          "AdditionalInformation": "This recommendation applies only to hybrid environments.",
          "References": "https://learn.microsoft.com/en-us/entra/identity/hybrid/connect/whatis-phs",
          "DefaultValue": "Disabled"
        }
      ]
    },
    {
      "Id": "5.2.2.1",
      "Description": "Multifactor authentication is a process that requires an additional form of identification during the sign-in process, such as a code from a mobile device or a fingerprint scan, to enhance security. Ensure users in administrator roles have MFA capabilities enabled.",
      "Checks": [
        "entra_admin_users_mfa_enabled"
      ],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.2.2 Risk-based Conditional Access",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Multifactor authentication is a process that requires an additional form of identification during the sign-in process, such as a code from a mobile device or a fingerprint scan, to enhance security. Ensure users in administrator roles have MFA capabilities enabled.",
          "RationaleStatement": "Multifactor authentication requires an individual to present a minimum of two separate forms of authentication before access is granted. Multifactor authentication provides additional assurance that the individual attempting to gain access is who they claim to be. With multifactor authentication, an attacker would need to compromise at least two different authentication mechanisms, increasing the difficulty of compromise and thus reducing the risk.",
          "ImpactStatement": "Implementation of multifactor authentication for all users in administrative roles will necessitate a change to user routine. All users in administrative roles will be required to enroll in multifactor authentication using phone, SMS, or an authentication application. After enrollment, use of multifactor authentication will be required for future access to the environment.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to the Microsoft Entra admin center https://entra.microsoft.com. 2. Click expand ID Protection > Risk-based Conditional Access. 3. Click New policy. Under Users include Select users and groups and check Directory roles. At a minimum, include the directory roles: Application administrator, Authentication administrator, Billing administrator, Cloud application administrator, Conditional Access administrator, Exchange administrator, Global administrator, Global reader, Helpdesk administrator, Password administrator, Privileged authentication administrator, Privileged role administrator, Security administrator, SharePoint administrator, User administrator. Under Target resources include All resources (formerly 'All cloud apps') and do not create any exclusions. Under Grant select Grant Access and check either Require multifactor authentication or Require authentication strength. Click Select at the bottom of the pane. 4. Under Enable policy set it to Report-only until the organization is ready to enable it. 5. Click Create.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to the Microsoft Entra admin center https://entra.microsoft.com. 2. Click expand ID Protection > Risk-based Conditional Access. 3. Ensure that a policy exists with the following criteria and is set to On: Under Users verify Directory roles specific to administrators are included. Ensure that only documented user exclusions exist and that they are reviewed annually. Under Target resources verify All resources (formerly 'All cloud apps') is selected with no exclusions. Under Grant verify Grant Access is on and either Require multifactor authentication or Require authentication strength is checked. 4. Ensure Enable policy is set to On.",
          "AdditionalInformation": "Break-glass accounts should be excluded from all Conditional Access policies.",
          "References": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-policy-admin-mfa",
          "DefaultValue": "MFA is not enabled by default for administrator roles"
        }
      ]
    },
    {
      "Id": "5.2.2.2",
      "Description": "Enable multifactor authentication for all users in the Microsoft 365 tenant. Users will be prompted to authenticate with a second factor upon logging in to Microsoft 365 services.",
      "Checks": [
        "entra_users_mfa_enabled"
      ],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.2.2 Risk-based Conditional Access",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Enable multifactor authentication for all users in the Microsoft 365 tenant. Users will be prompted to authenticate with a second factor upon logging in to Microsoft 365 services.",
          "RationaleStatement": "Multifactor authentication requires an individual to present a minimum of two separate forms of authentication before access is granted. Multifactor authentication provides additional assurance that the individual attempting to gain access is who they claim to be. With multifactor authentication, an attacker would need to compromise at least two different authentication mechanisms, increasing the difficulty of compromise and thus reducing the risk.",
          "ImpactStatement": "Implementation of multifactor authentication for all users will necessitate a change to user routine. All users will be required to enroll in multifactor authentication using phone, SMS, or an authentication application. After enrollment, use of multifactor authentication will be required for future authentication to the environment. External identities that attempt to access documents that utilize Purview Information Protection (Sensitivity Labels) will find their access disrupted. In order to mitigate this create an exclusion for Microsoft Rights Management Services ID: 00000012-0000-0000-c000-000000000000.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to the Microsoft Entra admin center https://entra.microsoft.com. 2. Click expand Protection > Conditional Access select Policies. 3. Click New policy. Under Users include All users. Under Target resources include All resources (formerly 'All cloud apps') and do not create any exclusions. Under Grant select Grant Access and check either Require multifactor authentication or Require authentication strength. Click Select at the bottom of the pane. 4. Under Enable policy set it to Report-only until the organization is ready to enable it. 5. Click Create.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to the Microsoft Entra admin center https://entra.microsoft.com. 2. Click expand ID Protection > Risk-based Conditional Access. 3. Ensure that a policy exists with the following criteria and is set to On: Under Users verify All users is included. Ensure that only documented user exclusions exist and that they are reviewed annually. Under Target resources verify All resources (formerly 'All cloud apps') is selected with no exclusions. Under Grant verify Grant Access and either Require multifactor authentication or Require authentication strength is checked. 4. Ensure Enable policy is set to On.",
          "AdditionalInformation": "Break-glass accounts should be excluded from all Conditional Access policies. Organizations that struggle to enforce MFA globally due to budget constraints or regulations can use FIDO2 security keys as an alternative.",
          "References": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-policy-all-users-mfa",
          "DefaultValue": "MFA is not enabled by default for all users"
        }
      ]
    },
    {
      "Id": "5.2.2.3",
      "Description": "Entra ID supports the most widely used authentication and authorization protocols including legacy authentication. This authentication pattern includes basic authentication, a widely used industry-standard method for collecting username and password information. Enable Conditional Access policies to block legacy authentication.",
      "Checks": [
        "entra_legacy_authentication_blocked"
      ],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.2.2 Risk-based Conditional Access",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Entra ID supports the most widely used authentication and authorization protocols including legacy authentication. This authentication pattern includes basic authentication, a widely used industry-standard method for collecting username and password information. Enable Conditional Access policies to block legacy authentication.",
          "RationaleStatement": "Legacy authentication protocols do not support multi-factor authentication. These protocols are often used by attackers because of this deficiency. Blocking legacy authentication makes it harder for attackers to gain access.",
          "ImpactStatement": "Enabling this setting will prevent users from connecting with older versions of Office, ActiveSync or using protocols like IMAP, POP or SMTP and may require upgrades to older versions of Office, and use of mobile mail clients that support modern authentication. This will also cause multifunction devices such as printers from using scan to e-mail function if they are using a legacy authentication method.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to the Microsoft Entra admin center https://entra.microsoft.com. 2. Click expand ID Protection > Risk-based Conditional Access. 3. Create a new policy by selecting New policy. Under Users include All users. Under Target resources include All resources (formerly 'All cloud apps'). Under Conditions select Client apps and check the boxes for Exchange ActiveSync clients and Other clients. Under Grant select Block Access. Click Select. 4. Set the policy On and click Create.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to the Microsoft Entra admin center https://entra.microsoft.com. 2. Click expand ID Protection > Risk-based Conditional Access. 3. Ensure that a policy exists with the following criteria and is set to On: Under Users verify All users is included. Ensure that only documented user exclusions exist and that they are reviewed annually. Under Target resources verify All resources (formerly 'All cloud apps') is selected. Ensure that only documented resource exclusions exist and that they are reviewed annually. Under Conditions select Client apps then verify Exchange ActiveSync clients and Other clients is checked. Under Grant verify Block access is selected. 4. Ensure Enable policy is set to On.",
          "AdditionalInformation": "Break-glass accounts should be excluded from all Conditional Access policies. Basic authentication is now disabled in all tenants as of January 2023.",
          "References": "https://learn.microsoft.com/en-us/exchange/clients-and-mobile-in-exchange-online/disable-basic-authentication-in-exchange-online",
          "DefaultValue": "Basic authentication is disabled by default as of January 2023"
        }
      ]
    },
    {
      "Id": "5.2.2.4",
      "Description": "In complex deployments, organizations might have a need to restrict authentication sessions. Conditional Access policies allow for the targeting of specific user accounts. Ensure Sign-in frequency is enabled and browser sessions are not persistent for Administrative users.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.2.2 Risk-based Conditional Access",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "In complex deployments, organizations might have a need to restrict authentication sessions. Conditional Access policies allow for the targeting of specific user accounts. Ensure Sign-in frequency is enabled and browser sessions are not persistent for Administrative users.",
          "RationaleStatement": "Forcing a time out for MFA will help ensure that sessions are not kept alive for an indefinite period of time, ensuring that browser sessions are not persistent will help in prevention of drive-by attacks in web browsers, this also prevents creation and saving of session cookies leaving nothing for an attacker to take.",
          "ImpactStatement": "Users with Administrative roles will be prompted at the frequency set for MFA.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click expand ID Protection > Risk-based Conditional Access. 3. Click New policy. Under Users include Select users and groups and check Directory roles. At a minimum, include the directory roles: Application administrator, Authentication administrator, Billing administrator, Cloud application administrator, Conditional Access administrator, Exchange administrator, Global administrator, Global reader, Helpdesk administrator, Password administrator, Privileged authentication administrator, Privileged role administrator, Security administrator, SharePoint administrator, User administrator. Under Target resources include All resources (formerly 'All cloud apps'). Under Grant select Grant Access and check Require multifactor authentication. Under Session select Sign-in frequency select Periodic reauthentication and set it to 4 hours (or less). Check Persistent browser session then select Never persistent in the drop-down menu. 4. Under Enable policy set it to Report-only until the organization is ready to enable it.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click expand ID Protection > Risk-based Conditional Access. 3. Ensure that a policy exists with the following criteria and is set to On: Under Users verify Directory roles specific to administrators are included. Ensure that only documented user exclusions exist and that they are reviewed annually. Under Target resources verify All resources (formerly 'All cloud apps') is selected. Ensure that only documented resource exclusions exist and that they are reviewed annually. Under Session verify Sign-in frequency is checked and set to Periodic reauthentication. Verify the timeframe is set to the time determined by the organization. Ensure Periodic reauthentication does not exceed 4 hours (or less). Verify Persistent browser session is set to Never persistent. 4. Ensure Enable policy is set to On.",
          "AdditionalInformation": "Break-glass accounts should be excluded from all Conditional Access policies.",
          "References": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-session-lifetime",
          "DefaultValue": "The default configuration for user sign-in frequency is a rolling window of 90 days"
        }
      ]
    },
    {
      "Id": "5.2.2.5",
      "Description": "Authentication strength is a Conditional Access control that allows administrators to specify which combination of authentication methods can be used to access a resource. Ensure administrator roles are using a CA policy with Phishing-resistant MFA strength.",
      "Checks": [
        "entra_admin_users_phishing_resistant_mfa_enabled"
      ],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.2.2 Risk-based Conditional Access",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "Authentication strength is a Conditional Access control that allows administrators to specify which combination of authentication methods can be used to access a resource. Ensure administrator roles are using a CA policy with Phishing-resistant MFA strength.",
          "RationaleStatement": "Sophisticated attacks targeting MFA are more prevalent as the use of it becomes more widespread. These 3 methods (FIDO2 Security Key, Windows Hello for Business, Certificate-based authentication) are considered phishing-resistant as they remove passwords from the login workflow. It also ensures that public/private key exchange can only happen between the devices and a registered provider which prevents login to fake or phishing websites.",
          "ImpactStatement": "If administrators aren't pre-registered for a strong authentication method prior to a conditional access policy being created, then a condition could occur where a user can't register for strong authentication because they don't meet the conditional access policy requirements and therefore are prevented from signing in. Additionally, Internet Explorer based credential prompts in PowerShell do not support prompting for a security key.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to the Microsoft Entra admin center https://entra.microsoft.com. 2. Click expand ID Protection > Risk-based Conditional Access. 3. Click New policy. Under Users include Select users and groups and check Directory roles. At a minimum, include the directory roles: Application administrator, Authentication administrator, Billing administrator, Cloud application administrator, Conditional Access administrator, Exchange administrator, Global administrator, Global reader, Helpdesk administrator, Password administrator, Privileged authentication administrator, Privileged role administrator, Security administrator, SharePoint administrator, User administrator. Under Target resources include All resources (formerly 'All cloud apps') and do not create any exclusions. Under Grant select Grant Access and check Require authentication strength and set Phishing-resistant MFA in the dropdown box. Click Select. 4. Under Enable policy set it to Report-only until the organization is ready to enable it. 5. Click Create.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to the Microsoft Entra admin center https://entra.microsoft.com. 2. Click expand ID Protection > Risk-based Conditional Access. 3. Ensure that a policy exists with the following criteria and is set to On: Under Users verify Directory roles specific to administrators are included. Ensure that only documented user exclusions exist and that they are reviewed annually. Directory Roles should include at minimum the roles listed in the remediation section. Under Target resources verify All resources (formerly 'All cloud apps') is selected with no exclusions. Under Grant verify Grant Access is selected and Require authentication strength is checked with Phishing-resistant MFA set as the value. 4. Ensure Enable policy is set to On.",
          "AdditionalInformation": "Break-glass accounts should be excluded from all Conditional Access policies. Ensure administrators are pre-registered with strong authentication before enforcing the policy.",
          "References": "https://learn.microsoft.com/en-us/entra/identity/authentication/concept-authentication-strengths",
          "DefaultValue": "MFA strength is not enforced by default"
        }
      ]
    },
    {
      "Id": "5.2.2.6",
      "Description": "Microsoft Entra ID Protection user risk policies detect the probability that a user account has been compromised. Enable Identity Protection user risk policies.",
      "Checks": [
        "entra_identity_protection_user_risk_enabled"
      ],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.2.2 Risk-based Conditional Access",
          "Profile": "E5 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Microsoft Entra ID Protection user risk policies detect the probability that a user account has been compromised. Enable Identity Protection user risk policies.",
          "RationaleStatement": "With the user risk policy turned on, Entra ID protection detects the probability that a user account has been compromised. Administrators can configure a user risk conditional access policy to automatically respond to a specific user risk level.",
          "ImpactStatement": "Upon policy activation, account access will be either blocked or the user will be required to use multi-factor authentication (MFA) and change their password. Users without registered MFA will be denied access, necessitating an admin to recover the account. To avoid inconvenience, it is advised to configure the MFA registration policy for all users under the User Risk policy. Additionally, users identified in the Risky Users section will be affected by this policy.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to the Microsoft Entra admin center https://entra.microsoft.com. 2. Click expand ID Protection > Risk-based Conditional Access. 3. Create a new policy by selecting New policy. 4. Set the following conditions within the policy: Under Users choose All users. Under Target resources choose All resources (formerly 'All cloud apps'). Under Conditions choose User risk then Yes and select the user risk level High. Under Grant select Grant access then check Require multifactor authentication or Require authentication strength. Finally check Require password change. Under Session set Sign-in frequency to Every time. Click Select. 5. Under Enable policy set it to Report-only until the organization is ready to enable it. 6. Click Create or Save.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to the Microsoft Entra admin center https://entra.microsoft.com. 2. Click expand ID Protection > Risk-based Conditional Access. 3. Ensure that a policy exists with the following criteria and is set to On: Under Users verify All users is included. Ensure that only documented user exclusions exist and that they are reviewed annually. Under Target resources verify All resources (formerly 'All cloud apps') is selected. Under Conditions verify User risk is set to High. Under Grant verify Grant access is selected and either Require multifactor authentication or Require authentication strength are checked. Then verify Require password change is checked. Under Session ensure Sign-in frequency is set to Every time. 4. Ensure Enable policy is set to On.",
          "AdditionalInformation": "Break-glass accounts should be excluded from all Conditional Access policies.",
          "References": "https://learn.microsoft.com/en-us/entra/id-protection/howto-identity-protection-risk-feedback",
          "DefaultValue": "User risk policy is not enabled by default"
        }
      ]
    },
    {
      "Id": "5.2.2.7",
      "Description": "Microsoft Entra ID Protection sign-in risk detects risks in real-time and offline. A risky sign-in is an indicator for a sign-in attempt that might not have been performed by the legitimate owner of a user account. Enable Identity Protection sign-in risk policies.",
      "Checks": [
        "entra_identity_protection_sign_in_risk_enabled"
      ],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.2.2 Risk-based Conditional Access",
          "Profile": "E5 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Microsoft Entra ID Protection sign-in risk detects risks in real-time and offline. A risky sign-in is an indicator for a sign-in attempt that might not have been performed by the legitimate owner of a user account. Enable Identity Protection sign-in risk policies.",
          "RationaleStatement": "Turning on the sign-in risk policy ensures that suspicious sign-ins are challenged for multi-factor authentication.",
          "ImpactStatement": "When the policy triggers, the user will need MFA to access the account. In the case of a user who hasn't registered MFA on their account, they would be blocked from accessing their account. It is therefore recommended that the MFA registration policy be configured for all users who are a part of the Sign-in Risk policy.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to the Microsoft Entra admin center https://entra.microsoft.com. 2. Click expand ID Protection > Risk-based Conditional Access. 3. Create a new policy by selecting New policy. 4. Set the following conditions within the policy: Under Users choose All users. Under Target resources choose All resources (formerly 'All cloud apps'). Under Conditions choose Sign-in risk then Yes and check the risk level boxes High and Medium. Under Grant click Grant access then select Require multifactor authentication. Under Session select Sign-in Frequency and set to Every time. Click Select. 5. Under Enable policy set it to Report-only until the organization is ready to enable it. 6. Click Create.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to the Microsoft Entra admin center https://entra.microsoft.com. 2. Click expand ID Protection > Risk-based Conditional Access. 3. Ensure that a policy exists with the following criteria and is set to On: Under Users verify All users is included. Ensure that only documented user exclusions exist and that they are reviewed annually. Under Target resources verify All resources (formerly 'All cloud apps') is selected. Under Conditions verify Sign-in risk is set to Yes ensuring High and Medium are selected. Under Grant verify grant Grant access is selected and Require multifactor authentication checked. Under Session verify Sign-in Frequency is set to Every time. 4. Ensure Enable policy is set to On.",
          "AdditionalInformation": "Break-glass accounts should be excluded from all Conditional Access policies.",
          "References": "https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks",
          "DefaultValue": "Sign-in risk policy is not enabled by default"
        }
      ]
    },
    {
      "Id": "5.2.2.8",
      "Description": "Microsoft Entra ID Protection sign-in risk detects risks in real-time and offline. A risky sign-in is an indicator for a sign-in attempt that might not have been performed by the legitimate owner of a user account. Ensure 'sign-in risk' is blocked for medium and high risk.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.2.2 Risk-based Conditional Access",
          "Profile": "E5 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "Microsoft Entra ID Protection sign-in risk detects risks in real-time and offline. A risky sign-in is an indicator for a sign-in attempt that might not have been performed by the legitimate owner of a user account. Ensure 'sign-in risk' is blocked for medium and high risk.",
          "RationaleStatement": "Sign-in risk is determined at the time of sign-in and includes criteria across both real-time and offline detections for risk. Blocking sign-in to accounts that have risk can prevent undesired access from potentially compromised devices or unauthorized users.",
          "ImpactStatement": "Sign-in risk is heavily dependent on detecting risk based on atypical behaviors. Due to this it is important to run this policy in a report-only mode to better understand how the organization's environment and user activity may influence sign-in risk before turning the policy on. Once it's understood what actions may trigger a medium or high sign-in risk event I.T. can then work to create an environment to reduce false positives.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to the Microsoft Entra admin center https://entra.microsoft.com. 2. Click expand ID Protection > Risk-based Conditional Access. 3. Create a new policy by selecting New policy. 4. Set the following conditions within the policy: Under Users include All users. Under Target resources include All resources (formerly 'All cloud apps') and do not set any exclusions. Under Conditions choose Sign-in risk values of High and Medium and click Done. Under Grant choose Block access and click Select. 5. Under Enable policy set it to Report-only until the organization is ready to enable it. 6. Click Create.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to the Microsoft Entra admin center https://entra.microsoft.com. 2. Click expand ID Protection > Risk-based Conditional Access. 3. Ensure that a policy exists with the following criteria and is set to On: Under Users verify All users is included. Ensure that only documented user exclusions exist and that they are reviewed annually. Under Target resources verify All resources (formerly 'All cloud apps') is selected with no exclusions. Under Conditions verify Sign-in risk values of High and Medium are selected. Under Grant verify Block access is selected. 4. Ensure Enable policy is set to On.",
          "AdditionalInformation": "Break-glass accounts should be excluded from all Conditional Access policies.",
          "References": "https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks#risk-detections-mapped-to-riskeventtype",
          "DefaultValue": "Sign-in risk blocking is not enabled by default"
        }
      ]
    },
    {
      "Id": "5.2.2.9",
      "Description": "Conditional Access (CA) can be configured to enforce access based on the device's compliance status or whether it is Entra hybrid joined. Ensure a managed device is required for authentication.",
      "Checks": [
        "entra_managed_device_required_for_authentication"
      ],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.2.2 Risk-based Conditional Access",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Conditional Access (CA) can be configured to enforce access based on the device's compliance status or whether it is Entra hybrid joined. Ensure a managed device is required for authentication.",
          "RationaleStatement": "Managed devices are considered more secure because they often have additional configuration hardening enforced through centralized management such as Intune or Group Policy. These devices are also typically equipped with MDR/EDR, managed patching and alerting systems. As a result, they provide a safer environment for users to authenticate and operate from. This policy also ensures that attackers must first gain access to a compliant or trusted device before authentication is permitted, reducing the risk posed by compromised account credentials.",
          "ImpactStatement": "Unmanaged devices will not be permitted as a valid authenticator. As a result this may require the organization to mature their device enrollment and management. The following devices can be considered managed: Entra hybrid joined from Active Directory, Entra joined and enrolled in Intune with compliance policies, Entra registered and enrolled in Intune with compliance policies. If Guest or external users are collaborating with the organization, they must either be excluded or onboarded with a compliant device to authenticate.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to the Microsoft Entra admin center https://entra.microsoft.com. 2. Click expand ID Protection > Risk-based Conditional Access. 3. Create a new policy by selecting New policy. Under Users include All users. Under Target resources include All resources (formerly 'All cloud apps'). Under Grant select Grant access. Select only the checkboxes Require device to be marked as compliant and Require Microsoft Entra hybrid joined device. Choose Require one of the selected controls and click Select at the bottom. 4. Under Enable policy set it to Report-only until the organization is ready to enable it. 5. Click Create.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to the Microsoft Entra admin center https://entra.microsoft.com. 2. Click expand ID Protection > Risk-based Conditional Access. 3. Ensure that a policy exists with the following criteria and is set to On: Under Users verify All users is included. Ensure that only documented user exclusions exist and that they are reviewed annually. Under Target resources verify All resources (formerly 'All cloud apps') is selected. Ensure that only documented resource exclusions exist and that they are reviewed annually. Under Grant verify that only Require device to be marked as compliant and Require Microsoft Entra hybrid joined device are checked. Under Grant verify Require one of the selected controls is selected. 4. Ensure Enable policy is set to On.",
          "AdditionalInformation": "Break-glass accounts should be excluded from all Conditional Access policies. Guest user accounts, if collaborating with the organization, should be considered when testing this policy.",
          "References": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-grant#require-device-to-be-marked-as-compliant",
          "DefaultValue": "Managed device requirement is not enforced by default"
        }
      ]
    },
    {
      "Id": "5.2.2.10",
      "Description": "Conditional Access (CA) can be configured to enforce access based on the device's compliance status or whether it is Entra hybrid joined. Ensure a managed device is required to register security information.",
      "Checks": [
        "entra_managed_device_required_for_mfa_registration"
      ],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.2.2 Risk-based Conditional Access",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Conditional Access (CA) can be configured to enforce access based on the device's compliance status or whether it is Entra hybrid joined. Ensure a managed device is required to register security information.",
          "RationaleStatement": "Requiring registration on a managed device significantly reduces the risk of bad actors using stolen credentials to register security information. Accounts that are created but never registered with an MFA method are particularly vulnerable to this type of attack. Enforcing this requirement will both reduce the attack surface for fake registrations and ensure that legitimate users register using trusted devices which typically have additional security measures in place already.",
          "ImpactStatement": "The organization will be required to have a mature device management process. New devices provided to users will need to be pre-enrolled in Intune, auto-enrolled or be Entra hybrid joined. Otherwise, the user will be unable to complete registration, requiring additional resources from I.T. This could be more disruptive in remote worker environments where the MDM maturity is low.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to the Microsoft Entra admin center https://entra.microsoft.com. 2. Click expand ID Protection > Risk-based Conditional Access. 3. Create a new policy by selecting New policy. Under Users include All users. Under Target resources select User actions and check Register security information. Under Grant select Grant access. Check only Require multifactor authentication and Require Microsoft Entra hybrid joined device. Choose Require one of the selected controls and click Select at the bottom. 4. Under Enable policy set it to Report-only until the organization is ready to enable it. 5. Click Create.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to the Microsoft Entra admin center https://entra.microsoft.com. 2. Click expand ID Protection > Risk-based Conditional Access. 3. Ensure that a policy exists with the following criteria and is set to On: Under Users verify All users is included. Ensure that only documented user exclusions exist and that they are reviewed annually. Under Target resources verify User actions is selected with Register security information checked. Under Grant verify that only Require device to be marked as compliant and Require Microsoft Entra hybrid joined device are checked. Under Grant verify Require one of the selected controls is selected. 4. Ensure Enable policy is set to On.",
          "AdditionalInformation": "Break-glass accounts should be excluded from all Conditional Access policies.",
          "References": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-cloud-apps#user-actions",
          "DefaultValue": "Managed device requirement for MFA registration is not enforced by default"
        }
      ]
    },
    {
      "Id": "5.2.2.11",
      "Description": "Sign-in frequency defines the time period before a user is asked to sign in again when attempting to access a resource. Ensure sign-in frequency for Intune Enrollment is set to 'Every time'.",
      "Checks": [
        "entra_admin_users_sign_in_frequency_enabled"
      ],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.2.2 Risk-based Conditional Access",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Sign-in frequency defines the time period before a user is asked to sign in again when attempting to access a resource. Ensure sign-in frequency for Intune Enrollment is set to 'Every time'.",
          "RationaleStatement": "Intune Enrollment is considered a sensitive action and should be safeguarded. An attack path exists that allows for a bypass of device compliance Conditional Access rule. This could allow compromised credentials to be used through a newly registered device enrolled in Intune, enabling persistence and privilege escalation. Setting sign-in frequency to every time limits the timespan an attacker could use fresh credentials to enroll a new device to Intune.",
          "ImpactStatement": "New users enrolling into Intune through an automated process may need to sign-in again if the enrollment process goes on for too long.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to the Microsoft Entra admin center https://entra.microsoft.com. 2. Click expand ID Protection > Risk-based Conditional Access. 3. Create a new policy by selecting New policy. Under Users include All users. Under Target resources select Resources (formerly cloud apps), choose Select resources and add Microsoft Intune Enrollment to the list. Under Grant select Grant access. Check either Require multifactor authentication or Require authentication strength. Under Session check Sign-in frequency and select Every time. 4. Under Enable policy set it to Report-only until the organization is ready to enable it. 5. Click Create.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to the Microsoft Entra admin center https://entra.microsoft.com. 2. Click expand ID Protection > Risk-based Conditional Access. 3. Ensure that a policy exists with the following criteria and is set to On: Under Users verify All users is included. Ensure that only documented user exclusions exist and that they are reviewed annually. Under Target resources verify Resources (formerly cloud apps) includes Microsoft Intune Enrollment. Under Grant verify Require multifactor authentication or Require authentication strength is checked. Under Session verify Sign-in frequency is set to Every time. 4. Ensure Enable policy is set to On.",
          "AdditionalInformation": "Break-glass accounts should be excluded from all Conditional Access policies. If the Microsoft Intune Enrollment cloud app isn't available then it must be created. To add the app for new tenants, a Microsoft Entra administrator must create a service principal object, with app ID d4ebce55-015a-49b5-a083-c84d1797ae8c, in PowerShell or Microsoft Graph.",
          "References": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-session-lifetime#require-reauthentication-every-time",
          "DefaultValue": "Sign-in frequency defaults to 90 days"
        }
      ]
    },
    {
      "Id": "5.2.2.12",
      "Description": "The Microsoft identity platform supports the device authorization grant, which allows users to sign in to input-constrained devices such as a smart TV, IoT device, or a printer. Ensure the device code sign-in flow is blocked.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.2.2 Risk-based Conditional Access",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "The Microsoft identity platform supports the device authorization grant, which allows users to sign in to input-constrained devices such as a smart TV, IoT device, or a printer. Ensure the device code sign-in flow is blocked.",
          "RationaleStatement": "Since August 2024, Microsoft has observed threat actors, such as Storm-2372, employing 'device code phishing' attacks. These attacks deceive users into logging into productivity applications, capturing authentication tokens to gain further access to compromised accounts. To mitigate this specific attack, block authentication code flows and permit only those from devices within trusted environments, identified by specific IP addresses.",
          "ImpactStatement": "Some administrative overhead will be required for stricter management of these devices. Since exclusions do not violate compliance, this feature can still be utilized effectively within a controlled environment.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to the Microsoft Entra admin center https://entra.microsoft.com. 2. Click expand ID Protection > Risk-based Conditional Access. 3. Create a new policy by selecting New policy. Under Users include All users. Under Target resources include All resources (formerly 'All cloud apps'). Under Conditions select Authentication flows and check Device code flow. Under Grant select Block access. Click Select. 4. Under Enable policy set it to Report-only until the organization is ready to enable it. 5. Click Create.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to the Microsoft Entra admin center https://entra.microsoft.com. 2. Click expand ID Protection > Risk-based Conditional Access. 3. Ensure that a policy exists with the following criteria and is set to On: Under Users verify All users is included. Ensure that only documented user exclusions exist and that they are reviewed annually. Under Target resources verify All resources (formerly 'All cloud apps') is selected. Ensure that only documented resource exclusions exist and that they are reviewed annually. Under Conditions select Authentication flows and verify Device code flow is checked. Under Grant verify Block access is selected. 4. Ensure Enable policy is set to On.",
          "AdditionalInformation": "Break-glass accounts should be excluded from all Conditional Access policies.",
          "References": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-authentication-flows",
          "DefaultValue": "Device code flow is not blocked by default"
        }
      ]
    },
    {
      "Id": "5.2.3.1",
      "Description": "Microsoft provides supporting settings to enhance the configuration of the Microsoft Authenticator application. These settings provide users with additional information and context when they receive MFA passwordless and push requests. Ensure Microsoft Authenticator is configured to protect against MFA fatigue.",
      "Checks": [
        "entra_intune_enrollment_sign_in_frequency_every_time"
      ],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.2.3 Authentication Methods",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Microsoft provides supporting settings to enhance the configuration of the Microsoft Authenticator application. These settings provide users with additional information and context when they receive MFA passwordless and push requests. Ensure Microsoft Authenticator is configured to protect against MFA fatigue.",
          "RationaleStatement": "As the use of strong authentication has become more widespread, attackers have started to exploit the tendency of users to experience 'MFA fatigue.' This occurs when users are repeatedly asked to provide additional forms of identification, leading them to eventually approve requests without fully verifying the source. To counteract this, number matching can be employed to ensure the security of the authentication process. With this method, users are prompted to confirm a number displayed on their original device and enter it into the device being used for MFA.",
          "ImpactStatement": "Additional interaction will be required by end users using number matching as opposed to simply pressing 'Approve' for login attempts.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to the Microsoft Entra admin center https://entra.microsoft.com. 2. Click to expand Entra ID > Authentication methods select Policies. 3. Select Microsoft Authenticator. 4. Under Enable and Target ensure the setting is set to Enable. 5. Select Configure. 6. Set the following Microsoft Authenticator settings: Require number matching for push notifications Status is set to Enabled, Target All users. Show application name in push and passwordless notifications is set to Enabled, Target All users. Show geographic location in push and passwordless notifications is set to Enabled, Target All users.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to the Microsoft Entra admin center https://entra.microsoft.com. 2. Click to expand Entra ID > Authentication methods select Policies. 3. Under Method select Microsoft Authenticator. 4. Under Enable and Target verify the setting is set to Enable. 5. In the Include tab ensure All users is selected. 6. In the Exclude tab ensure only valid groups are present (i.e. Break Glass accounts). 7. Select Configure. 8. Verify the following Microsoft Authenticator settings: Require number matching for push notifications Status is set to Enabled, Target All users. Show application name in push and passwordless notifications is set to Enabled, Target All users. Show geographic location in push and passwordless notifications is set to Enabled, Target All users.",
          "AdditionalInformation": "On February 27, 2023 Microsoft started enforcing number matching tenant-wide for all users using Microsoft Authenticator.",
          "References": "https://learn.microsoft.com/en-us/entra/identity/authentication/how-to-mfa-number-match",
          "DefaultValue": "Microsoft-managed"
        }
      ]
    },
    {
      "Id": "5.2.3.2",
      "Description": "With Entra Password Protection, default global banned password lists are automatically applied to all users in an Entra ID tenant. To support business and security needs, custom banned password lists can be defined. Ensure custom banned passwords lists are used.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.2.3 Authentication Methods",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "With Entra Password Protection, default global banned password lists are automatically applied to all users in an Entra ID tenant. To support business and security needs, custom banned password lists can be defined. Ensure custom banned passwords lists are used.",
          "RationaleStatement": "Creating a new password can be difficult regardless of one's technical background. It is common to look around one's environment for suggestions when building a password, however, this may include picking words specific to the organization as inspiration for a password. An adversary may employ what is called a 'mangler' to create permutations of these specific words in an attempt to crack passwords or hashes making it easier to reach their goal.",
          "ImpactStatement": "If a custom banned password list includes too many common dictionary words, or short words that are part of compound words, then perfectly secure passwords may be blocked. The organization should consider a balance between security and usability when creating a list.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Authentication methods. 3. Select Password protection. 4. Set Enforce custom list to Yes. 5. In Custom banned password list create a list using suggestions such as: Brand names, Product names, Locations such as company headquarters, Company-specific internal terms, Abbreviations that have specific company meaning. 6. Click Save.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Authentication methods. 3. Select Password protection. 4. Verify Enforce custom list is set to Yes. 5. Verify Custom banned password list contains entries specific to the organization or matches a pre-determined list.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/entra/identity/authentication/concept-password-ban-bad#custom-banned-password-list",
          "DefaultValue": "Enforce custom list is disabled by default"
        }
      ]
    },
    {
      "Id": "5.2.3.3",
      "Description": "Microsoft Entra Password Protection provides a global and custom banned password list. A password change request fails if there's a match in these banned password list. To protect on-premises Active Directory Domain Services (AD DS) environment, install and configure Entra Password Protection.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.2.3 Authentication Methods",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Microsoft Entra Password Protection provides a global and custom banned password list. A password change request fails if there's a match in these banned password list. To protect on-premises Active Directory Domain Services (AD DS) environment, install and configure Entra Password Protection.",
          "RationaleStatement": "This feature protects an organization by prohibiting the use of weak or leaked passwords. In addition, organizations can create custom banned password lists to prevent their users from using easily guessed passwords that are specific to their industry. Deploying this feature to Active Directory will strengthen the passwords that are used in the environment.",
          "ImpactStatement": "The potential impact associated with implementation of this setting is dependent upon the existing password policies in place in the environment. For environments that have strong password policies in place, the impact will be minimal. For organizations that do not have strong password policies in place, implementation of Microsoft Entra Password Protection may require users to change passwords and adhere to more stringent requirements than they have been accustomed to.",
          "RemediationProcedure": "To remediate: Download and install the Azure AD Password Proxies and DC Agents from https://www.microsoft.com/download/details.aspx?id=57071. Then: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Protection select Authentication methods. 3. Select Password protection and set Enable password protection on Windows Server Active Directory to Yes and Mode to Enforced.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Authentication methods. 3. Select Password protection and ensure that Enable password protection on Windows Server Active Directory is set to Yes and that Mode is set to Enforced.",
          "AdditionalInformation": "This recommendation applies to Hybrid deployments only and will have no impact unless working with on-premises Active Directory.",
          "References": "https://learn.microsoft.com/en-us/entra/identity/authentication/howto-password-ban-bad-on-premises-operations",
          "DefaultValue": "Enable - Yes, Mode - Audit"
        }
      ]
    },
    {
      "Id": "5.2.3.4",
      "Description": "Microsoft defines Multifactor authentication capable as being registered and enabled for a strong authentication method. The method must also be allowed by the authentication methods policy. Ensure all member users are MFA capable.",
      "Checks": [
        "entra_users_mfa_capable"
      ],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.2.3 Authentication Methods",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Microsoft defines Multifactor authentication capable as being registered and enabled for a strong authentication method. The method must also be allowed by the authentication methods policy. Ensure all member users are MFA capable.",
          "RationaleStatement": "Multifactor authentication requires an individual to present a minimum of two separate forms of authentication before access is granted. Users who are not MFA Capable have never registered a strong authentication method for multifactor authentication that is within policy and may not be using MFA. This could be a result of having never signed in, exclusion from a Conditional Access (CA) policy requiring MFA, or a CA policy does not exist. Reviewing this list of users will help identify possible lapses in policy or procedure.",
          "ImpactStatement": "When using the UI audit method guest users will appear in the report and unless the organization is applying MFA rules to guests then they will need to be manually filtered. Accounts that provide on-premises directory synchronization also appear in these reports.",
          "RemediationProcedure": "Remediation steps will depend on the status of the personnel in question or configuration of Conditional Access policies. Administrators should review each user identified on a case-by-case basis. For users who have never signed on, employment status should be reviewed and appropriate action taken. For Conditional Access policy applicability: Ensure a CA policy is in place requiring all users to use MFA. Ensure the user is not excluded from the CA MFA policy. Ensure the policy's state is set to On. Use What if to determine applicable CA policies.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Authentication methods. 3. Select User registration details. 4. Set the filter option Multifactor authentication capable to Not Capable. 5. Review the non-guest users in this list. 6. Excluding any exceptions users found in this report may require remediation.",
          "AdditionalInformation": "The CA rule must be in place for a successful deployment of Multifactor Authentication. This policy is outlined in the conditional access section 5.2.2. Possible exceptions include on-premises synchronization accounts.",
          "References": "https://learn.microsoft.com/en-us/entra/identity/authentication/howto-authentication-methods-activity",
          "DefaultValue": "Users are not MFA capable by default until they register"
        }
      ]
    },
    {
      "Id": "5.2.3.5",
      "Description": "Authentication methods support a wide variety of scenarios for signing in to Microsoft 365 resources. Some of these methods are inherently more secure than others. Ensure weak authentication methods (SMS and Voice Call) are disabled.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.2.3 Authentication Methods",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Authentication methods support a wide variety of scenarios for signing in to Microsoft 365 resources. Some of these methods are inherently more secure than others. Ensure weak authentication methods (SMS and Voice Call) are disabled.",
          "RationaleStatement": "Traditional MFA methods such as SMS codes, email-based OTPs, and push notifications are becoming less effective against today's attackers. Sophisticated phishing campaigns have demonstrated that second factors can be intercepted or spoofed. Attackers now exploit social engineering, man-in-the-middle tactics, and user fatigue (e.g., MFA bombing) to bypass these mechanisms. The SMS and Voice call methods are vulnerable to SIM swapping which could allow an attacker to gain access to your Microsoft 365 account.",
          "ImpactStatement": "There may be increased administrative overhead in adopting more secure authentication methods depending on the maturity of the organization.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Authentication methods. 3. Select Policies. 4. Inspect each method that is out of compliance and remediate: Click on the method to open it. Change the Enable toggle to the off position. Click Save.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Authentication methods. 3. Select Policies. 4. Verify that the following methods in the Enabled column are set to No: Method: SMS, Method: Voice call.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/entra/identity/authentication/concept-authentication-methods-manage",
          "DefaultValue": "SMS: Disabled, Voice Call: Disabled"
        }
      ]
    },
    {
      "Id": "5.2.3.6",
      "Description": "System-preferred multifactor authentication (MFA) prompts users to sign in by using the most secure method they registered. Ensure system-preferred multifactor authentication is enabled.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.2.3 Authentication Methods",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "System-preferred multifactor authentication (MFA) prompts users to sign in by using the most secure method they registered. Ensure system-preferred multifactor authentication is enabled.",
          "RationaleStatement": "Regardless of the authentication method enabled by an administrator or set as preferred by the user, the system will dynamically select the most secure option available at the time of authentication. This approach acts as an additional safeguard to prevent the use of weaker methods, such as voice calls, SMS, and email OTPs, which may have been inadvertently left enabled due to misconfiguration or lack of configuration hardening. Enforcing the default behavior also ensures the feature is not disabled.",
          "ImpactStatement": "The Microsoft managed value of system-preferred MFA is Enabled and as such enforces the default behavior. No additional impact is expected.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Authentication methods. 3. Select Settings. 4. Set the System-preferred multifactor authentication State to Enabled and include All users. 5. Any users exclusions should be documented and reviewed annually.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Authentication methods. 3. Select Settings. 4. Verify the System-preferred multifactor authentication State is set to Enabled and All users are included. 5. Ensure that only documented exclusions exist and that they are reviewed annually.",
          "AdditionalInformation": "Due to known issues with certificate-based authentication (CBA) and system-preferred MFA, Microsoft moved CBA to the bottom of the list. It is still considered a strong authentication method.",
          "References": "https://learn.microsoft.com/en-us/entra/identity/authentication/concept-system-preferred-multifactor-authentication",
          "DefaultValue": "Microsoft Managed (Enabled)"
        }
      ]
    },
    {
      "Id": "5.2.3.7",
      "Description": "The email one-time passcode feature is a way to authenticate B2B collaboration users when they can't be authenticated through other means. Ensure the email OTP authentication method is disabled.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.2.3 Authentication Methods",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "The email one-time passcode feature is a way to authenticate B2B collaboration users when they can't be authenticated through other means. Ensure the email OTP authentication method is disabled.",
          "RationaleStatement": "Traditional MFA methods such as SMS codes, email-based OTPs, and push notifications are becoming less effective against today's attackers. Sophisticated phishing campaigns have demonstrated that second factors can be intercepted or spoofed. Attackers now exploit social engineering, man-in-the-middle tactics, and user fatigue (e.g., MFA bombing) to bypass these mechanisms.",
          "ImpactStatement": "Disabling Email OTP will prevent one-time pass codes from being sent to unverified guest users accessing Microsoft 365 resources on the tenant. They will be required to use a personal Microsoft account, a managed Microsoft Entra account, be part of a federation or be configured as a guest in the host tenant's Microsoft Entra ID.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Authentication methods. 3. Select Policies. 4. Click on Email OTP. 5. Change the Enable toggle to the off position. 6. Click Save.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Authentication methods. 3. Select Policies. 4. Verify that Email OTP is set to No in the Enabled column.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/entra/external-id/one-time-passcode",
          "DefaultValue": "Email OTP: Enabled"
        }
      ]
    },
    {
      "Id": "5.2.4.1",
      "Description": "Enabling self-service password reset allows users to reset their own passwords in Entra ID. When users sign in to Microsoft 365, they will be prompted to enter additional contact information that will help them reset their password in the future. Ensure 'Self service password reset enabled' is set to 'All'.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.2.4 Password reset",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Manual",
          "Description": "Enabling self-service password reset allows users to reset their own passwords in Entra ID. When users sign in to Microsoft 365, they will be prompted to enter additional contact information that will help them reset their password in the future. Ensure 'Self service password reset enabled' is set to 'All'.",
          "RationaleStatement": "Enabling Self-Service Password Reset (SSPR) significantly reduces helpdesk interactions, streamlining support operations and improving user experience. Traditional methods involving temporary passwords pose notable security risksthey are often weak, predictable, and susceptible to interception. This creates a window of opportunity for threat actors to compromise accounts before users can update their credentials. SSPR minimizes credential exposure and strengthens overall identity protection.",
          "ImpactStatement": "Users will be required to provide additional contact information to enroll in self-service password reset. Additionally, minor user education may be required for users that are used to calling a help desk for assistance with password resets. This is unavailable if using Entra Connect / Sync in a hybrid environment.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Password reset select Properties. 3. Set Self service password reset enabled to All.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Entra ID > Password reset select Properties. 3. Ensure Self service password reset enabled is set to All.",
          "AdditionalInformation": "Effective Oct. 1st, 2022, Microsoft will begin to enable combined registration for all users in Entra ID tenants created before August 15th, 2020. Tenants created after this date are enabled with combined registration by default.",
          "References": "https://learn.microsoft.com/en-us/entra/identity/authentication/tutorial-enable-sspr",
          "DefaultValue": "Self service password reset is not enabled by default"
        }
      ]
    },
    {
      "Id": "5.3.1",
      "Description": "Microsoft Entra Privileged Identity Management can be used to audit roles, allow just in time activation of roles and allow for periodic role attestation. Organizations should remove permanent members from privileged Office 365 roles and instead make them eligible, through a JIT activation workflow. Ensure 'Privileged Identity Management' is used to manage roles.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.3 ID Governance",
          "Profile": "E5 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "Microsoft Entra Privileged Identity Management can be used to audit roles, allow just in time activation of roles and allow for periodic role attestation. Organizations should remove permanent members from privileged Office 365 roles and instead make them eligible, through a JIT activation workflow. Ensure 'Privileged Identity Management' is used to manage roles.",
          "RationaleStatement": "Organizations want to minimize the number of people who have access to secure information or resources, because that reduces the chance of a malicious actor getting that access, or an authorized user inadvertently impacting a sensitive resource. However, users still need to carry out privileged operations in Entra ID. Organizations can give users just-in-time (JIT) privileged access to roles. There is a need for oversight for what those users are doing with their administrator privileges. PIM helps to mitigate the risk of excessive, unnecessary, or misused access rights.",
          "ImpactStatement": "The implementation of Just in Time privileged access is likely to necessitate changes to administrator routine. Administrators will only be granted access to administrative roles when required. When administrators request role activation, they will need to document the reason for requiring role access, anticipated time required to have the access, and to reauthenticate to enable role access.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Identity Governance select Privileged Identity Management. 3. Under Manage select Microsoft Entra Roles. 4. Under Manage select Roles. 5. Inspect the sensitive roles. For each of the members that have an ASSIGNMENT TYPE of Permanent, click on the ... and choose Make eligible.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Identity Governance select Privileged Identity Management. 3. Under Manage select Microsoft Entra Roles. 4. Under Manage select Roles. 5. Inspect at a minimum the following sensitive roles to ensure the members are Eligible and not Permanent: Application Administrator, Authentication Administrator, Billing Administrator, Cloud Application Administrator, Conditional Access Administrator, Exchange Administrator, Global Administrator, Global Reader, Helpdesk Administrator, Password Administrator, Privileged Authentication Administrator, Privileged Role Administrator, Security Administrator, SharePoint Administrator, User Administrator.",
          "AdditionalInformation": "If all global admins become eligible then there will be no global admin to receive notifications, by default. Alerts are sent to TenantAdmins, including Global Administrators, by default. To ensure proper receipt, configure alerts to be sent to security or operations staff with valid email addresses or a security operations center.",
          "References": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-configure",
          "DefaultValue": "PIM is not configured by default"
        }
      ]
    },
    {
      "Id": "5.3.2",
      "Description": "Access reviews enable administrators to establish an efficient automated process for reviewing group memberships, access to enterprise applications, and role assignments. These reviews can be scheduled to recur regularly. Ensure 'Access reviews' for Guest Users are configured to be performed no less frequently than monthly.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.3 ID Governance",
          "Profile": "E5 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Access reviews enable administrators to establish an efficient automated process for reviewing group memberships, access to enterprise applications, and role assignments. These reviews can be scheduled to recur regularly. Ensure 'Access reviews' for Guest Users are configured to be performed no less frequently than monthly.",
          "RationaleStatement": "Access to groups and applications for guests can change over time. If a guest user's access to a particular folder goes unnoticed, they may unintentionally gain access to sensitive data if a member adds new files or data to the folder or application. Access reviews can help reduce the risks associated with outdated assignments by requiring a member of the organization to conduct the reviews. Furthermore, these reviews can enable a fail-closed mechanism to remove access to the subject if the reviewer does not respond to the review.",
          "ImpactStatement": "Access reviews that are ignored may cause guest users to lose access to resources temporarily.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Identity Governance and select Access reviews. 3. Click New access review. 4. Select what to review choose Teams + Groups. 5. Review Scope set to All Microsoft 365 groups with guest users, do not exclude groups. 6. Scope set to Guest users only then click Next: Reviews. 7. Select reviewers an appropriate user that is NOT the guest user themselves. 8. Duration (in days) at most 3. 9. Review recurrence is Monthly or more frequent. 10. End is set to Never, then click Next: Settings. 11. Check Auto apply results to resource. 12. Set If reviewers don't respond to Remove access. 13. Check the following: Justification required, E-mail notifications, Reminders. 14. Click Next: Review + Create and finally click Create.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Identity Governance and select Access reviews. 3. Inspect the access reviews, and ensure an access review is created with the following criteria: Overview: Scope is set to Guest users only and status is Active. Reviewers: Ensure appropriate reviewer(s) are designated. Settings > General: Mail notifications and Reminders are set to Enable. Reviewers: Require reason on approval is set to Enable. Scheduling: Frequency is Monthly or more frequent. When completed: Auto apply results to resource is set to Enable. When completed: If reviewers don't respond is set to Remove access.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/entra/id-governance/access-reviews-overview",
          "DefaultValue": "By default access reviews are not configured"
        }
      ]
    },
    {
      "Id": "5.3.3",
      "Description": "Access reviews enable administrators to establish an efficient automated process for reviewing group memberships, access to enterprise applications, and role assignments. Ensure 'Access reviews' for privileged roles are configured to be done monthly or more frequently.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.3 ID Governance",
          "Profile": "E5 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Access reviews enable administrators to establish an efficient automated process for reviewing group memberships, access to enterprise applications, and role assignments. Ensure 'Access reviews' for privileged roles are configured to be done monthly or more frequently.",
          "RationaleStatement": "Regular review of critical high privileged roles in Entra ID will help identify role drift, or potential malicious activity. This will enable the practice and application of 'separation of duties' where even non-privileged users like security auditors can be assigned to review assigned roles in an organization. Furthermore, if configured these reviews can enable a fail-closed mechanism to remove access to the subject if the reviewer does not respond to the review.",
          "ImpactStatement": "In order to avoid disruption reviewers who have the authority to revoke roles should be trusted individuals who understand the significance of access reviews. Additionally, the principle of separation of duties should be applied to ensure that no administrator is responsible for reviewing their own access levels. If the reviews are configured to automatically revoke highly privileged roles like the Global Administrator role, then this could result in removing all Global Administrators from the organization.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Identity Governance and select Privileged Identity Management. 3. Select Microsoft Entra Roles under Manage. 4. Select Access reviews and click New access review. Provide a name and description. Set Frequency to Monthly or more frequently. Set Duration (in days) to at most 14. Set End to Never. Set Users scope to All users and groups. In Role select these roles: Global Administrator, Exchange Administrator, SharePoint Administrator, Teams Administrator, Security Administrator. Set Assignment type to All active and eligible assignments. Set Reviewers member(s) responsible for this type of review, other than self. 5. Upon completion settings: Set Auto apply results to resource to Enable. Set If reviewers don't respond to No change. 6. Advanced settings: Set Show recommendations to Enable. Set Require reason on approval to Enable. Set Mail notifications to Enable. Set Reminders to Enable. 7. Click Start to save the review.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Identity Governance and select Privileged Identity Management. 3. Select Microsoft Entra Roles under Manage. 4. Select Access reviews. 5. Ensure there are access reviews configured for each high privileged roles and each meets the criteria: Scope - Everyone, Status - Active, Mail notifications - Enable, Reminders - Enable, Require reason on approval - Enable, Frequency - Monthly or more frequently, Duration (in days) - 14 at most, Auto apply results to resource - Enable, If reviewers don't respond - No change.",
          "AdditionalInformation": "Care should be taken when configuring the If reviewers don't respond setting for Global Administrator reviews, if misconfigured break-glass accounts could automatically have roles revoked.",
          "References": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-create-roles-and-resource-roles-review",
          "DefaultValue": "By default access reviews are not configured"
        }
      ]
    },
    {
      "Id": "5.3.4",
      "Description": "Microsoft Entra Privileged Identity Management can be used to audit roles, allow just in time activation of roles and allow for periodic role attestation. Requiring approval before activation allows one of the selected approvers to first review and then approve the activation prior to PIM granted the role. Ensure approval is required for Global Administrator role activation.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.3 ID Governance",
          "Profile": "E5 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Microsoft Entra Privileged Identity Management can be used to audit roles, allow just in time activation of roles and allow for periodic role attestation. Requiring approval before activation allows one of the selected approvers to first review and then approve the activation prior to PIM granted the role. Ensure approval is required for Global Administrator role activation.",
          "RationaleStatement": "Requiring approval for Global Administrator role activation enhances visibility and accountability every time this highly privileged role is used. This process reduces the risk of an attacker elevating a compromised account to the highest privilege level, as any activation must first be reviewed and approved by a trusted party.",
          "ImpactStatement": "Approvers do not need to be assigned the same role or be members of the same group. It's important to have at least two approvers and an emergency access (break-glass) account to prevent a scenario where no Global Administrators are available.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Identity Governance select Privileged Identity Management. 3. Under Manage select Microsoft Entra Roles. 4. Under Manage select Roles. 5. Select Global Administrator in the list. 6. Select Role settings and click Edit. 7. Check the Require approval to activate box. 8. Add at least two approvers. 9. Click Update.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Identity Governance select Privileged Identity Management. 3. Under Manage select Microsoft Entra Roles. 4. Under Manage select Roles. 5. Select Global Administrator in the list. 6. Select Role settings. 7. Verify Require approval to activate is set to Yes. 8. Verify there are at least two approvers in the list.",
          "AdditionalInformation": "This only acts as protection for eligible users that are activating a role. Directly assigning a role does require an approval workflow so therefore it is important to implement and use PIM correctly.",
          "References": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-configure",
          "DefaultValue": "Require approval to activate: No"
        }
      ]
    },
    {
      "Id": "5.3.5",
      "Description": "Microsoft Entra Privileged Identity Management can be used to audit roles, allow just in time activation of roles and allow for periodic role attestation. Requiring approval before activation allows one of the selected approvers to first review and then approve the activation prior to PIM granted the role. Ensure approval is required for Privileged Role Administrator activation.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "5 Microsoft Entra admin center",
          "SubSection": "5.3 ID Governance",
          "Profile": "E5 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Microsoft Entra Privileged Identity Management can be used to audit roles, allow just in time activation of roles and allow for periodic role attestation. Requiring approval before activation allows one of the selected approvers to first review and then approve the activation prior to PIM granted the role. Ensure approval is required for Privileged Role Administrator activation.",
          "RationaleStatement": "Requiring approval for Privileged Role Administrator role activation enhances visibility and accountability every time this highly privileged role is used. This process reduces the risk of an attacker elevating a compromised account to the highest privilege level, as any activation must first be reviewed and approved by a trusted party. The Privileged Role Administrator can manage role assignments in Microsoft Entra ID, as well as within Microsoft Entra Privileged Identity Management. They can create and manage groups that can be assigned to Microsoft Entra roles. Additionally, this role allows management of all aspects of Privileged Identity Management and administrative units.",
          "ImpactStatement": "Approvers do not need to be assigned the same role or be members of the same group. It's important to have at least two approvers and an emergency access (break-glass) account to prevent a scenario where no Privileged Role Administrators are available.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Identity Governance select Privileged Identity Management. 3. Under Manage select Microsoft Entra Roles. 4. Under Manage select Roles. 5. Select Privileged Role Administrator in the list. 6. Select Role settings and click Edit. 7. Check the Require approval to activate box. 8. Add at least two approvers. 9. Click Update.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. 2. Click to expand Identity Governance select Privileged Identity Management. 3. Under Manage select Microsoft Entra Roles. 4. Under Manage select Roles. 5. Select Privileged Role Administrator in the list. 6. Select Role settings. 7. Verify Require approval to activate is set to Yes. 8. Verify there are at least two approvers in the list.",
          "AdditionalInformation": "This only acts as protection for eligible users that are activating a role. Directly assigning a role does require an approval workflow so therefore it is important to implement and use PIM correctly.",
          "References": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-configure",
          "DefaultValue": "Require approval to activate: No"
        }
      ]
    },
    {
      "Id": "6.1.1",
      "Description": "The value False indicates that mailbox auditing on by default is turned on for the organization. Mailbox auditing on by default in the organization overrides the mailbox auditing settings on individual mailboxes. Ensure 'AuditDisabled' organizationally is set to 'False'.",
      "Checks": [
        "exchange_organization_mailbox_auditing_enabled"
      ],
      "Attributes": [
        {
          "Section": "6 Exchange admin center",
          "SubSection": "6.1 Audit",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "The value False indicates that mailbox auditing on by default is turned on for the organization. Mailbox auditing on by default in the organization overrides the mailbox auditing settings on individual mailboxes. Ensure 'AuditDisabled' organizationally is set to 'False'.",
          "RationaleStatement": "Enforcing the default ensures auditing was not turned off intentionally or accidentally. Auditing mailbox actions will allow forensics and IR teams to trace various malicious activities that can generate TTPs caused by inbox access and tampering.",
          "ImpactStatement": "None - this is the default behavior as of 2019.",
          "RemediationProcedure": "To remediate using PowerShell: 1. Connect to Exchange Online using Connect-ExchangeOnline. 2. Run the following PowerShell command: Set-OrganizationConfig -AuditDisabled $false",
          "AuditProcedure": "To audit using PowerShell: 1. Connect to Exchange Online using Connect-ExchangeOnline. 2. Run the following PowerShell command: Get-OrganizationConfig | Format-List AuditDisabled. 3. Ensure AuditDisabled is set to False.",
          "AdditionalInformation": "Without advanced auditing (E5 function) the logs are limited to 90 days.",
          "References": "https://learn.microsoft.com/en-us/purview/audit-mailboxes?view=o365-worldwide",
          "DefaultValue": "False"
        }
      ]
    },
    {
      "Id": "6.1.2",
      "Description": "Mailbox audit logging is turned on by default in all organizations. This means that certain actions performed by mailbox owners, delegates, and admins are automatically logged. Ensure mailbox audit actions are configured with additional actions beyond defaults.",
      "Checks": [
        "exchange_user_mailbox_auditing_enabled"
      ],
      "Attributes": [
        {
          "Section": "6 Exchange admin center",
          "SubSection": "6.1 Audit",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Mailbox audit logging is turned on by default in all organizations. This means that certain actions performed by mailbox owners, delegates, and admins are automatically logged. Ensure mailbox audit actions are configured with additional actions beyond defaults.",
          "RationaleStatement": "Whether it is for regulatory compliance or for tracking unauthorized configuration changes in Microsoft 365, enabling mailbox auditing and ensuring the proper mailbox actions are accounted for allows for Microsoft 365 teams to run security operations, forensics or general investigations on mailbox activities.",
          "ImpactStatement": "Adding additional audit action types and increasing the AuditLogAgeLimit from 90 to 180 days will have a limited impact on mailbox storage. Mailbox audit log records are stored in a subfolder (named Audits) in the Recoverable Items folder in each user's mailbox.",
          "RemediationProcedure": "To remediate using PowerShell: 1. Connect to Exchange Online using Connect-ExchangeOnline. 2. For each UserMailbox ensure AuditEnabled is True and include additional audit actions: Admin actions: Copy, FolderBind and Move. Delegate actions: FolderBind and Move. Owner actions: Create, MailboxLogin and Move. Set AuditLogAgeLimit to 180 days.",
          "AuditProcedure": "To audit using PowerShell: 1. Connect to Exchange Online using Connect-ExchangeOnline. 2. Inspect each UserMailbox and ensure AuditEnabled is True and the following audit actions are included in addition to default actions of each sign-in type: Admin actions: Copy, FolderBind and Move. Delegate actions: FolderBind and Move. Owner actions: Create, MailboxLogin and Move.",
          "AdditionalInformation": "Audit (Standard) licensing allows for up to 180 days log retention as of October 2023. Mailboxes with Audit (Premium) licenses, which is included with E5, can retain audit logs beyond 180 days.",
          "References": "https://learn.microsoft.com/en-us/purview/audit-mailboxes?view=o365-worldwide",
          "DefaultValue": "AuditEnabled: True for all mailboxes except Resource Mailboxes, Public Folder Mailboxes, and DiscoverySearch Mailbox"
        }
      ]
    },
    {
      "Id": "6.1.3",
      "Description": "When configuring a user or computer account to bypass mailbox audit logging, the system will not record any access, or actions performed by the said user or computer account on any mailbox. Ensure 'AuditBypassEnabled' is not enabled on mailboxes.",
      "Checks": [
        "exchange_mailbox_audit_bypass_disabled"
      ],
      "Attributes": [
        {
          "Section": "6 Exchange admin center",
          "SubSection": "6.1 Audit",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "When configuring a user or computer account to bypass mailbox audit logging, the system will not record any access, or actions performed by the said user or computer account on any mailbox. Ensure 'AuditBypassEnabled' is not enabled on mailboxes.",
          "RationaleStatement": "If a mailbox audit bypass association is added for an account, the account can access any mailbox in the organization to which it has been assigned access permissions, without generating any mailbox audit logging entries for such access or recording any actions taken, such as message deletions. Enabling this parameter, whether intentionally or unintentionally, could allow insiders or malicious actors to conceal their activity on specific mailboxes.",
          "ImpactStatement": "None - this is the default behavior.",
          "RemediationProcedure": "To remediate using PowerShell: 1. Connect to Exchange Online using Connect-ExchangeOnline. 2. Run the following to disable AuditBypass for mailboxes which currently have it enabled: Get-MailboxAuditBypassAssociation -ResultSize unlimited | Where-Object { $_.AuditBypassEnabled -eq $true } | ForEach-Object { Set-MailboxAuditBypassAssociation -Identity $_.Name -AuditBypassEnabled $false }",
          "AuditProcedure": "To audit using PowerShell: 1. Connect to Exchange Online using Connect-ExchangeOnline. 2. Run the following PowerShell command: Get-MailboxAuditBypassAssociation -ResultSize unlimited | Where-Object {$_.AuditBypassEnabled -eq $true} | Select-Object Name,AuditBypassEnabled. 3. If nothing is returned, then there are no accounts with Audit Bypass enabled.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/powershell/module/exchange/get-mailboxauditbypassassociation",
          "DefaultValue": "AuditBypassEnabled: False"
        }
      ]
    },
    {
      "Id": "6.2.1",
      "Description": "Exchange Online offers several methods of managing the flow of email messages including Remote domain, Transport Rules, and Anti-spam outbound policies. Ensure all forms of mail forwarding are blocked and/or disabled.",
      "Checks": [
        "exchange_transport_rules_mail_forwarding_disabled"
      ],
      "Attributes": [
        {
          "Section": "6 Exchange admin center",
          "SubSection": "6.2 Mail flow",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Exchange Online offers several methods of managing the flow of email messages including Remote domain, Transport Rules, and Anti-spam outbound policies. Ensure all forms of mail forwarding are blocked and/or disabled.",
          "RationaleStatement": "Attackers often create these rules to exfiltrate data from your tenancy, this could be accomplished via access to an end-user account or otherwise. An insider could also use one of these methods as a secondary channel to exfiltrate sensitive data.",
          "ImpactStatement": "Care should be taken before implementation to ensure there is no business need for case-by-case auto-forwarding. Disabling auto-forwarding to remote domains will affect all users in an organization. Any exclusions should be implemented based on organizational policy.",
          "RemediationProcedure": "STEP 1: Transport rules - Remove any transport rules that redirect email to external domains. STEP 2: Anti-spam outbound policy - Navigate to Microsoft 365 Defender https://security.microsoft.com/. Expand E-mail & collaboration then select Policies & rules. Select Threat policies > Anti-spam. For Anti-spam outbound policy (default) and any custom policies, set Automatic forwarding to Off - Forwarding is disabled.",
          "AuditProcedure": "STEP 1: Transport rules - Review transport rules and verify that none of them forward or redirect e-mail to external domains. Run: Get-TransportRule | Where-Object {$_.RedirectMessageTo -ne $null} | ft Name,RedirectMessageTo. STEP 2: Anti-spam outbound policy - Navigate to Microsoft 365 Defender. Inspect Anti-spam outbound policy (default) and ensure Automatic forwarding is set to Off - Forwarding is disabled.",
          "AdditionalInformation": "Any exclusions should be implemented based on organizational policy.",
          "References": "https://learn.microsoft.com/en-us/defender-office-365/outbound-spam-policies-external-email-forwarding",
          "DefaultValue": "AutoForwardingMode varies by policy"
        }
      ]
    },
    {
      "Id": "6.2.2",
      "Description": "Mail flow rules (transport rules) in Exchange Online are used to identify and take action on messages that flow through the organization. Ensure mail transport rules do not whitelist specific domains.",
      "Checks": [
        "exchange_transport_rules_whitelist_disabled"
      ],
      "Attributes": [
        {
          "Section": "6 Exchange admin center",
          "SubSection": "6.2 Mail flow",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Mail flow rules (transport rules) in Exchange Online are used to identify and take action on messages that flow through the organization. Ensure mail transport rules do not whitelist specific domains.",
          "RationaleStatement": "Whitelisting domains in transport rules bypasses regular malware and phishing scanning, which can enable an attacker to launch attacks against your users from a safe haven domain.",
          "ImpactStatement": "Care should be taken before implementation to ensure there is no business need for case-by-case whitelisting. Removing all whitelisted domains could affect incoming mail flow to an organization although modern systems sending legitimate mail should have no issue with this.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Exchange admin center https://admin.exchange.microsoft.com. 2. Click to expand Mail Flow and then select Rules. 3. For each rule that sets the spam confidence level to -1 for a specific domain, select the rule and click Delete.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Exchange admin center https://admin.exchange.microsoft.com. 2. Click to expand Mail Flow and then select Rules. 3. Review each rule and ensure that a single rule does not contain both: Under Apply this rule if: Sender's address domain portion belongs to any of these domains AND Under Do the following: Set the spam confidence level (SCL) to '-1'.",
          "AdditionalInformation": "Setting the spam confidence level to -1 indicates the message is from a trusted sender, so the message bypasses spam filtering. If an organization identifies a business need for an exception, the domain should only be whitelisted if inbound emails from that domain originate from a specific IP address.",
          "References": "https://learn.microsoft.com/en-us/exchange/security-and-compliance/mail-flow-rules/mail-flow-rules",
          "DefaultValue": "No transport rules with whitelisted domains by default"
        }
      ]
    },
    {
      "Id": "6.2.3",
      "Description": "External callouts provide a native experience to identify emails from senders outside the organization. This is achieved by presenting a new tag on emails called 'External'. Ensure email from external senders is identified.",
      "Checks": [
        "exchange_external_email_tagging_enabled"
      ],
      "Attributes": [
        {
          "Section": "6 Exchange admin center",
          "SubSection": "6.2 Mail flow",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "External callouts provide a native experience to identify emails from senders outside the organization. This is achieved by presenting a new tag on emails called 'External'. Ensure email from external senders is identified.",
          "RationaleStatement": "Tagging emails from external senders helps to inform end users about the origin of the email. This can allow them to proceed with more caution and make informed decisions when it comes to identifying spam or phishing emails.",
          "ImpactStatement": "Mail flow rules using external tagging must be disabled, along with third-party mail filtering tools that offer similar features, to avoid duplicate [External] tags. External tags can consume additional screen space on systems with limited real estate. After enabling this feature via PowerShell, it may take 24-48 hours for users to see the External sender tag.",
          "RemediationProcedure": "To remediate using PowerShell: 1. Connect to Exchange online using Connect-ExchangeOnline. 2. Run the following PowerShell command: Set-ExternalInOutlook -Enabled $true",
          "AuditProcedure": "To audit using PowerShell: 1. Connect to Exchange online using Connect-ExchangeOnline. 2. Run the following PowerShell command: Get-ExternalInOutlook. 3. For each identity verify Enabled is set to True and the AllowList only contains email addresses the organization has permitted to bypass external tagging.",
          "AdditionalInformation": "Existing emails in a user's inbox from external senders are not tagged retroactively. Third-party tools that provide similar functionality will also meet compliance requirements.",
          "References": "https://learn.microsoft.com/en-us/powershell/module/exchange/set-externalinoutlook",
          "DefaultValue": "Disabled (False)"
        }
      ]
    },
    {
      "Id": "6.3.1",
      "Description": "Specify the administrators and users who can install and manage add-ins for Outlook in Exchange Online. By default, users can install add-ins in their Microsoft Outlook Desktop client. Ensure users installing Outlook add-ins is not allowed.",
      "Checks": [
        "exchange_roles_assignment_policy_addins_disabled"
      ],
      "Attributes": [
        {
          "Section": "6 Exchange admin center",
          "SubSection": "6.3 Roles",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "Specify the administrators and users who can install and manage add-ins for Outlook in Exchange Online. By default, users can install add-ins in their Microsoft Outlook Desktop client. Ensure users installing Outlook add-ins is not allowed.",
          "RationaleStatement": "Attackers exploit vulnerable or custom add-ins to access user data. Disabling user-installed add-ins in Microsoft Outlook reduces this threat surface.",
          "ImpactStatement": "Implementing this change will impact both end users and administrators. End users will be unable to integrate third-party applications they desire, and administrators may receive requests to grant permission for necessary third-party apps.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Exchange admin center https://admin.exchange.microsoft.com. 2. Click to expand Roles select User roles. 3. Select Default Role Assignment Policy. 4. In the properties pane on the right click on Manage permissions. 5. Under Other roles uncheck My Custom Apps, My Marketplace Apps and My ReadWriteMailbox Apps. 6. Click Save changes.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Exchange admin center https://admin.exchange.microsoft.com. 2. Click to expand Roles select User roles. 3. Select Default Role Assignment Policy. 4. In the properties pane on the right click on Manage permissions. 5. Under Other roles verify My Custom Apps, My Marketplace Apps and My ReadWriteMailbox Apps are unchecked.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/exchange/clients-and-mobile-in-exchange-online/add-ins-for-outlook/specify-who-can-install-and-manage-addins",
          "DefaultValue": "My Custom Apps, My Marketplace Apps, and My ReadWriteMailbox Apps are checked"
        }
      ]
    },
    {
      "Id": "6.5.1",
      "Description": "Modern authentication in Microsoft 365 enables authentication features like multifactor authentication (MFA) using smart cards, certificate-based authentication (CBA), and third-party SAML identity providers. Ensure modern authentication for Exchange Online is enabled.",
      "Checks": [
        "exchange_organization_modern_authentication_enabled"
      ],
      "Attributes": [
        {
          "Section": "6 Exchange admin center",
          "SubSection": "6.5 Settings",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Modern authentication in Microsoft 365 enables authentication features like multifactor authentication (MFA) using smart cards, certificate-based authentication (CBA), and third-party SAML identity providers. Ensure modern authentication for Exchange Online is enabled.",
          "RationaleStatement": "Strong authentication controls, such as the use of multifactor authentication, may be circumvented if basic authentication is used by Exchange Online email clients such as Outlook 2016 and Outlook 2013. Enabling modern authentication for Exchange Online ensures strong authentication mechanisms are used when establishing sessions between email clients and Exchange Online.",
          "ImpactStatement": "Users of older email clients, such as Outlook 2013 and Outlook 2016, will no longer be able to authenticate to Exchange using Basic Authentication, which will necessitate migration to modern authentication practices.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft 365 admin center https://admin.microsoft.com. 2. Click to expand Settings select Org Settings. 3. Select Modern authentication. 4. Check Turn on modern authentication for Outlook 2013 for Windows and later (recommended) to enable modern authentication.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft 365 admin center https://admin.microsoft.com. 2. Click to expand Settings select Org Settings. 3. Select Modern authentication. 4. Verify Turn on modern authentication for Outlook 2013 for Windows and later (recommended) is checked.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/exchange/clients-and-mobile-in-exchange-online/enable-or-disable-modern-authentication-in-exchange-online",
          "DefaultValue": "True"
        }
      ]
    },
    {
      "Id": "6.5.2",
      "Description": "MailTips are informative messages displayed to users while they're composing a message. While a new message is open and being composed, Exchange analyzes the message (including recipients). If a potential problem is detected, the user is notified with a MailTip prior to sending the message. Ensure MailTips are enabled for end users.",
      "Checks": [
        "exchange_organization_mailtips_enabled"
      ],
      "Attributes": [
        {
          "Section": "6 Exchange admin center",
          "SubSection": "6.5 Settings",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "MailTips are informative messages displayed to users while they're composing a message. While a new message is open and being composed, Exchange analyzes the message (including recipients). If a potential problem is detected, the user is notified with a MailTip prior to sending the message. Ensure MailTips are enabled for end users.",
          "RationaleStatement": "Setting up MailTips gives a visual aid to users when they send emails to large groups of recipients or send emails to recipients not within the tenant.",
          "ImpactStatement": "Not applicable.",
          "RemediationProcedure": "To remediate using PowerShell: 1. Connect to Exchange Online using Connect-ExchangeOnline. 2. Run the following PowerShell command: Set-OrganizationConfig -MailTipsAllTipsEnabled $true -MailTipsExternalRecipientsTipsEnabled $true -MailTipsGroupMetricsEnabled $true -MailTipsLargeAudienceThreshold 25",
          "AuditProcedure": "To audit using PowerShell: 1. Connect to Exchange Online using Connect-ExchangeOnline. 2. Run the following PowerShell command: Get-OrganizationConfig | fl MailTips*. 3. Verify the values for MailTipsAllTipsEnabled, MailTipsExternalRecipientsTipsEnabled, and MailTipsGroupMetricsEnabled are set to True and MailTipsLargeAudienceThreshold is set to an acceptable value; 25 is the default value.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/exchange/clients-and-mobile-in-exchange-online/mailtips/mailtips",
          "DefaultValue": "MailTipsAllTipsEnabled: True, MailTipsExternalRecipientsTipsEnabled: False, MailTipsGroupMetricsEnabled: True, MailTipsLargeAudienceThreshold: 25"
        }
      ]
    },
    {
      "Id": "6.5.3",
      "Description": "This setting allows users to open certain external files while working in Outlook on the web. If allowed, keep in mind that Microsoft doesn't control the use terms or privacy policies of those third-party services. Ensure additional storage providers are restricted in Outlook on the web.",
      "Checks": [
        "exchange_mailbox_policy_additional_storage_restricted"
      ],
      "Attributes": [
        {
          "Section": "6 Exchange admin center",
          "SubSection": "6.5 Settings",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "This setting allows users to open certain external files while working in Outlook on the web. If allowed, keep in mind that Microsoft doesn't control the use terms or privacy policies of those third-party services. Ensure additional storage providers are restricted in Outlook on the web.",
          "RationaleStatement": "By default, additional storage providers are allowed in Office on the Web (such as Box, Dropbox, Facebook, Google Drive, OneDrive Personal, etc.). This could lead to information leakage and additional risk of infection from organizational non-trusted storage providers. Restricting this will inherently reduce risk as it will narrow opportunities for infection and data leakage.",
          "ImpactStatement": "The impact associated with this change is highly dependent upon current practices in the tenant. If users do not use other storage providers, then minimal impact is likely. However, if users do regularly utilize providers outside of the tenant this will affect their ability to continue to do so.",
          "RemediationProcedure": "To remediate using PowerShell: 1. Connect to Exchange Online using Connect-ExchangeOnline. 2. Run the following PowerShell command: Set-OwaMailboxPolicy -Identity OwaMailboxPolicy-Default -AdditionalStorageProvidersAvailable $false",
          "AuditProcedure": "To audit using PowerShell: 1. Connect to Exchange Online using Connect-ExchangeOnline. 2. Run the following PowerShell command to audit the default OWA policy: Get-OwaMailboxPolicy -Identity OwaMailboxPolicy-Default | fl AdditionalStorageProvidersAvailable. 3. Verify that AdditionalStorageProvidersAvailable is False.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/powershell/module/exchange/set-owamailboxpolicy",
          "DefaultValue": "AdditionalStorageProvidersAvailable: True"
        }
      ]
    },
    {
      "Id": "6.5.4",
      "Description": "This setting enables or disables authenticated client SMTP submission (SMTP AUTH) at an organization level in Exchange Online. Ensure SMTP AUTH is disabled.",
      "Checks": [
        "exchange_transport_config_smtp_auth_disabled"
      ],
      "Attributes": [
        {
          "Section": "6 Exchange admin center",
          "SubSection": "6.5 Settings",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "This setting enables or disables authenticated client SMTP submission (SMTP AUTH) at an organization level in Exchange Online. Ensure SMTP AUTH is disabled.",
          "RationaleStatement": "SMTP AUTH is a legacy protocol. Disabling it at the organization level supports the principle of least functionality and serves to further back additional controls that block legacy protocols, such as in Conditional Access. Virtually all modern email clients that connect to Exchange Online mailboxes in Microsoft 365 can do so without using SMTP AUTH.",
          "ImpactStatement": "This enforces the default behavior, so no impact is expected unless the organization is using it globally. A per-mailbox setting exists that overrides the tenant-wide setting, allowing an individual mailbox SMTP AUTH capability for special cases.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Exchange admin center https://admin.exchange.microsoft.com. 2. Select Settings > Mail flow. 3. Check Turn off SMTP AUTH protocol for your organization to disable the protocol.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Exchange admin center https://admin.exchange.microsoft.com. 2. Select Settings > Mail flow. 3. Ensure Turn off SMTP AUTH protocol for your organization is checked.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/exchange/clients-and-mobile-in-exchange-online/authenticated-client-smtp-submission",
          "DefaultValue": "SmtpClientAuthenticationDisabled: True"
        }
      ]
    },
    {
      "Id": "6.5.5",
      "Description": "Direct Send is a method used to send emails directly to an Exchange Online customer's hosted mailboxes from on-premises devices, applications, or third-party cloud services. This method does not require any form of authentication. Ensure Direct Send submissions are rejected.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "6 Exchange admin center",
          "SubSection": "6.5 Settings",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "Direct Send is a method used to send emails directly to an Exchange Online customer's hosted mailboxes from on-premises devices, applications, or third-party cloud services. This method does not require any form of authentication. Ensure Direct Send submissions are rejected.",
          "RationaleStatement": "Direct Send allows devices and applications to transmit unauthenticated email directly to Exchange Online. While this method may support legacy systems such as printers or scanners, it introduces significant security risks: Unauthenticated Email Delivery, Phishing and Spoofing Risks, and Lack of Visibility and Control. Threat research has shown that attackers are actively exploiting Direct Send to impersonate internal accounts and distribute malicious content without needing to compromise any credentials.",
          "ImpactStatement": "Microsoft has identified some known issues with disabling Direct Send including forwarding scenarios and Azure Communication Services (ACS) traffic. Care should be taken before implementation.",
          "RemediationProcedure": "To remediate using PowerShell: 1. Connect to Exchange Online using Connect-ExchangeOnline. 2. Run the following PowerShell command: Set-OrganizationConfig -RejectDirectSend $true",
          "AuditProcedure": "To audit using PowerShell: 1. Connect to Exchange Online using Connect-ExchangeOnline. 2. Run the following PowerShell command: Get-OrganizationConfig | fl RejectDirectSend. 3. Verify that the value returned for RejectDirectSend is True.",
          "AdditionalInformation": "",
          "References": "https://techcommunity.microsoft.com/blog/exchange/introducing-more-control-over-direct-send-in-exchange-online/4408790",
          "DefaultValue": "RejectDirectSend: False"
        }
      ]
    },
    {
      "Id": "7.2.1",
      "Description": "Modern authentication in Microsoft 365 enables authentication features like multifactor authentication (MFA) using smart cards, certificate-based authentication (CBA), and third-party SAML identity providers. Ensure modern authentication for SharePoint applications is required.",
      "Checks": [
        "sharepoint_modern_authentication_required"
      ],
      "Attributes": [
        {
          "Section": "7 SharePoint admin center",
          "SubSection": "7.2 Policies",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Modern authentication in Microsoft 365 enables authentication features like multifactor authentication (MFA) using smart cards, certificate-based authentication (CBA), and third-party SAML identity providers. Ensure modern authentication for SharePoint applications is required.",
          "RationaleStatement": "Strong authentication controls, such as the use of multifactor authentication, may be circumvented if basic authentication is used by SharePoint applications. Requiring modern authentication for SharePoint applications ensures strong authentication mechanisms are used when establishing sessions between these applications, SharePoint, and connecting users.",
          "ImpactStatement": "Implementation of modern authentication for SharePoint will require users to authenticate to SharePoint using modern authentication. This may cause a minor impact to typical user behavior. This may also prevent third-party apps from accessing SharePoint Online resources and will block apps using the SharePointOnlineCredentials class.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to SharePoint admin center https://admin.microsoft.com/sharepoint. 2. Click to expand Policies select Access control. 3. Select Apps that don't use modern authentication. 4. Select the radio button for Block access. 5. Click Save.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to SharePoint admin center https://admin.microsoft.com/sharepoint. 2. Click to expand Policies select Access control. 3. Select Apps that don't use modern authentication and ensure that it is set to Block access.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/powershell/module/sharepoint-online/set-spotenant",
          "DefaultValue": "True (Apps that don't use modern authentication are allowed)"
        }
      ]
    },
    {
      "Id": "7.2.2",
      "Description": "Entra ID B2B provides authentication and management of guests. Authentication happens via one-time passcode when they don't already have a work or school account or a Microsoft account. Ensure SharePoint and OneDrive integration with Azure AD B2B is enabled.",
      "Checks": [
        "sharepoint_guest_sharing_restricted"
      ],
      "Attributes": [
        {
          "Section": "7 SharePoint admin center",
          "SubSection": "7.2 Policies",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "Entra ID B2B provides authentication and management of guests. Authentication happens via one-time passcode when they don't already have a work or school account or a Microsoft account. Ensure SharePoint and OneDrive integration with Azure AD B2B is enabled.",
          "RationaleStatement": "External users assigned guest accounts will be subject to Entra ID access policies, such as multi-factor authentication. This provides a way to manage guest identities and control access to SharePoint and OneDrive resources. Without this integration, files can be shared without account registration, making it more challenging to audit and manage who has access to the organization's data.",
          "ImpactStatement": "B2B collaboration is used with other Entra services so should not be new or unusual. Microsoft also has made the experience seamless when turning on integration on SharePoint sites that already have active files shared with guest users.",
          "RemediationProcedure": "To remediate using PowerShell: 1. Connect to SharePoint Online using Connect-SPOService. 2. Run the following command: Set-SPOTenant -EnableAzureADB2BIntegration $true",
          "AuditProcedure": "To audit using PowerShell: 1. Connect to SharePoint Online using Connect-SPOService. 2. Run the following command: Get-SPOTenant | ft EnableAzureADB2BIntegration. 3. Ensure the returned value is True.",
          "AdditionalInformation": "Global Reader role currently can't access SharePoint using PowerShell.",
          "References": "https://learn.microsoft.com/en-us/sharepoint/sharepoint-azureb2b-integration",
          "DefaultValue": "False"
        }
      ]
    },
    {
      "Id": "7.2.3",
      "Description": "The external sharing settings govern sharing for the organization overall. Each site has its own sharing setting that can be set independently, though it must be at the same or more restrictive setting as the organization. Ensure external content sharing is restricted.",
      "Checks": [
        "sharepoint_external_sharing_managed"
      ],
      "Attributes": [
        {
          "Section": "7 SharePoint admin center",
          "SubSection": "7.2 Policies",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "The external sharing settings govern sharing for the organization overall. Each site has its own sharing setting that can be set independently, though it must be at the same or more restrictive setting as the organization. Ensure external content sharing is restricted to New and existing guests or less permissive.",
          "RationaleStatement": "Forcing guest authentication on the organization's tenant enables the implementation of controls and oversight over external file sharing. When a guest is registered with the organization, they now have an identity which can be accounted for. This identity can also have other restrictions applied to it through group membership and conditional access rules.",
          "ImpactStatement": "When using B2B integration, Entra ID external collaboration settings, such as guest invite settings and collaboration restrictions apply.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to SharePoint admin center https://admin.microsoft.com/sharepoint. 2. Click to expand Policies > Sharing. 3. Locate the External sharing section. 4. Under SharePoint, move the slider bar to New and existing guests or a less permissive level. OneDrive will also be moved to the same level and can never be more permissive than SharePoint.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to SharePoint admin center https://admin.microsoft.com/sharepoint. 2. Click to expand Policies > Sharing. 3. Locate the External sharing section. 4. Under SharePoint, ensure the slider bar is set to New and existing guests or a less permissive level.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/sharepoint/turn-external-sharing-on-or-off",
          "DefaultValue": "Anyone (ExternalUserAndGuestSharing)"
        }
      ]
    },
    {
      "Id": "7.2.4",
      "Description": "This setting governs the global permissiveness of OneDrive content sharing in the organization. OneDrive content sharing can be restricted independent of SharePoint but can never be more permissive than the level established with SharePoint. Ensure OneDrive content sharing is restricted.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "7 SharePoint admin center",
          "SubSection": "7.2 Policies",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "This setting governs the global permissiveness of OneDrive content sharing in the organization. OneDrive content sharing can be restricted independent of SharePoint but can never be more permissive than the level established with SharePoint. Ensure OneDrive content sharing is restricted to Only people in your organization.",
          "RationaleStatement": "OneDrive, designed for end-user cloud storage, inherently provides less oversight and control compared to SharePoint, which often involves additional content overseers or site administrators. This autonomy can lead to potential risks such as inadvertent sharing of privileged information by end users. Restricting external OneDrive sharing will require users to transfer content to SharePoint folders first which have those tighter controls.",
          "ImpactStatement": "Users will be required to take additional steps to share OneDrive content or use other official channels.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to SharePoint admin center https://admin.microsoft.com/sharepoint. 2. Click to expand Policies > Sharing. 3. Locate the External sharing section. 4. Under OneDrive, set the slider bar to Only people in your organization.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to SharePoint admin center https://admin.microsoft.com/sharepoint. 2. Click to expand Policies > Sharing. 3. Locate the External sharing section. 4. Under OneDrive, ensure the slider bar is set to Only people in your organization.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/powershell/module/sharepoint-online/set-spotenant#-onedrivesharingcapability",
          "DefaultValue": "Anyone (ExternalUserAndGuestSharing)"
        }
      ]
    },
    {
      "Id": "7.2.5",
      "Description": "SharePoint gives users the ability to share files, folders, and site collections. Internal users can share with external collaborators, and with the right permissions could share to other external parties. Ensure that SharePoint guest users cannot share items they don't own.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "7 SharePoint admin center",
          "SubSection": "7.2 Policies",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "SharePoint gives users the ability to share files, folders, and site collections. Internal users can share with external collaborators, and with the right permissions could share to other external parties. Ensure that SharePoint guest users cannot share items they don't own.",
          "RationaleStatement": "Sharing and collaboration are key; however, file, folder, or site collection owners should have the authority over what external users get shared with to prevent unauthorized disclosures of information.",
          "ImpactStatement": "The impact associated with this change is highly dependent upon current practices. If users do not regularly share with external parties, then minimal impact is likely. However, if users do regularly share with guests/externally, minimum impacts could occur as those external users will be unable to 're-share' content.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to SharePoint admin center https://admin.microsoft.com/sharepoint. 2. Click to expand Policies then select Sharing. 3. Expand More external sharing settings, uncheck Allow guests to share items they don't own. 4. Click Save.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to SharePoint admin center https://admin.microsoft.com/sharepoint. 2. Click to expand Policies then select Sharing. 3. Expand More external sharing settings, verify that Allow guests to share items they don't own is unchecked.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/sharepoint/turn-external-sharing-on-or-off",
          "DefaultValue": "Checked (False)"
        }
      ]
    },
    {
      "Id": "7.2.6",
      "Description": "The external sharing features of SharePoint and OneDrive let users in the organization share content with people outside the organization. Ensure SharePoint external sharing is restricted by limiting external sharing by domain to allow only specific domains.",
      "Checks": [
        "sharepoint_external_sharing_restricted"
      ],
      "Attributes": [
        {
          "Section": "7 SharePoint admin center",
          "SubSection": "7.2 Policies",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "The external sharing features of SharePoint and OneDrive let users in the organization share content with people outside the organization. Ensure SharePoint external sharing is restricted by limiting external sharing by domain to allow only specific domains.",
          "RationaleStatement": "Attackers will often attempt to expose sensitive information to external entities through sharing, and restricting the domains that users can share documents with will reduce that surface area.",
          "ImpactStatement": "Enabling this feature will prevent users from sharing documents with domains outside of the organization unless allowed.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to SharePoint admin center https://admin.microsoft.com/sharepoint. 2. Expand Policies then click Sharing. 3. Expand More external sharing settings and check Limit external sharing by domain. 4. Select Add domains to add a list of approved domains. 5. Click Save at the bottom of the page.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to SharePoint admin center https://admin.microsoft.com/sharepoint. 2. Expand Policies then click Sharing. 3. Expand More external sharing settings and confirm that Limit external sharing by domain is checked. 4. Click on Add domains and verify the sub setting Allow only specific domains is selected and with an approved list domains.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/sharepoint/turn-external-sharing-on-or-off#more-external-sharing-settings",
          "DefaultValue": "Limit external sharing by domain is unchecked, SharingDomainRestrictionMode: None"
        }
      ]
    },
    {
      "Id": "7.2.7",
      "Description": "This setting sets the default link type that a user will see when sharing content in OneDrive or SharePoint. It does not restrict or exclude any other options. Ensure link sharing is restricted in SharePoint and OneDrive.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "7 SharePoint admin center",
          "SubSection": "7.2 Policies",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "This setting sets the default link type that a user will see when sharing content in OneDrive or SharePoint. It does not restrict or exclude any other options. Ensure link sharing is restricted to Specific people (only the people the user specifies) or Only people in your organization (more restrictive).",
          "RationaleStatement": "By defaulting to specific people, the user will first need to consider whether or not the content being shared should be accessible by the entire organization versus select individuals. This aids in reinforcing the concept of least privilege.",
          "ImpactStatement": "Not applicable.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to SharePoint admin center https://admin.microsoft.com/sharepoint. 2. Click to expand Policies > Sharing. 3. Scroll to File and folder links. 4. Set Choose the type of link that's selected by default when users share files and folders in SharePoint and OneDrive to Specific people (only the people the user specifies) or Only people in your organization.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to SharePoint admin center https://admin.microsoft.com/sharepoint. 2. Click to expand Policies > Sharing. 3. Scroll to File and folder links. 4. Ensure that the setting Choose the type of link that's selected by default when users share files and folders in SharePoint and OneDrive is set to Specific people (only the people the user specifies) or Only people in your organization (more restrictive).",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/powershell/module/sharepoint-online/set-spotenant",
          "DefaultValue": "Only people in your organization (Internal)"
        }
      ]
    },
    {
      "Id": "7.2.8",
      "Description": "External sharing of content can be restricted to specific security groups. This setting is global, applies to sharing in both SharePoint and OneDrive and cannot be set at the site level in SharePoint. Ensure external sharing is restricted by security group.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "7 SharePoint admin center",
          "SubSection": "7.2 Policies",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Manual",
          "Description": "External sharing of content can be restricted to specific security groups. This setting is global, applies to sharing in both SharePoint and OneDrive and cannot be set at the site level in SharePoint. Ensure external sharing is restricted by security group.",
          "RationaleStatement": "Organizations wishing to create tighter security controls for external sharing can set this to enforce role-based access control by using security groups already defined in Microsoft Entra ID.",
          "ImpactStatement": "OneDrive will also be governed by this and there is no granular control at the SharePoint site level.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to SharePoint admin center https://admin.microsoft.com/sharepoint. 2. Click to expand Policies > Sharing. 3. Scroll to and expand More external sharing settings. 4. Check Allow only users in specific security groups to share externally. 5. Define Manage security groups in accordance with company procedure.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to SharePoint admin center https://admin.microsoft.com/sharepoint. 2. Click to expand Policies > Sharing. 3. Scroll to and expand More external sharing settings. 4. Verify Allow only users in specific security groups to share externally is checked. 5. Verify Manage security groups is defined and in accordance with company procedure.",
          "AdditionalInformation": "Users in these security groups must be allowed to invite guests in the guest invite settings in Microsoft Entra. Identity > External Identities > External collaboration settings.",
          "References": "https://learn.microsoft.com/en-us/sharepoint/manage-security-groups",
          "DefaultValue": "Unchecked/Undefined"
        }
      ]
    },
    {
      "Id": "7.2.9",
      "Description": "This policy setting configures the expiration time for each guest that is invited to the SharePoint site or with whom users share individual files and folders with. Ensure guest access to a site or OneDrive will expire automatically after 30 days or less.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "7 SharePoint admin center",
          "SubSection": "7.2 Policies",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "This policy setting configures the expiration time for each guest that is invited to the SharePoint site or with whom users share individual files and folders with. Ensure guest access to a site or OneDrive will expire automatically after 30 days or less.",
          "RationaleStatement": "This setting ensures that guests who no longer need access to the site or link no longer have access after a set period of time. Allowing guest access for an indefinite amount of time could lead to loss of data confidentiality and oversight.",
          "ImpactStatement": "Site collection administrators will have to renew access to guests who still need access after 30 days. They will receive an e-mail notification once per week about guest access that is about to expire. The guest expiration policy only applies to guests who use sharing links or guests who have direct permissions to a SharePoint site after the guest policy is enabled.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to SharePoint admin center https://admin.microsoft.com/sharepoint. 2. Click to expand Policies > Sharing. 3. Scroll to and expand More external sharing settings. 4. Set Guest access to a site or OneDrive will expire automatically after this many days to 30.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to SharePoint admin center https://admin.microsoft.com/sharepoint. 2. Click to expand Policies > Sharing. 3. Scroll to and expand More external sharing settings. 4. Ensure Guest access to a site or OneDrive will expire automatically after this many days is checked and set to 30 or less.",
          "AdditionalInformation": "Guest membership applies at the Microsoft 365 group level. Guests who have permission to view a SharePoint site or use a sharing link may also have access to a Microsoft Teams team or security group.",
          "References": "https://learn.microsoft.com/en-us/sharepoint/turn-external-sharing-on-or-off#change-the-organization-level-external-sharing-setting",
          "DefaultValue": "ExternalUserExpirationRequired: False, ExternalUserExpireInDays: 60 days"
        }
      ]
    },
    {
      "Id": "7.2.10",
      "Description": "This setting configures if guests who use a verification code to access the site or links are required to reauthenticate after a set number of days. Ensure reauthentication with verification code is restricted to 15 days or less.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "7 SharePoint admin center",
          "SubSection": "7.2 Policies",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "This setting configures if guests who use a verification code to access the site or links are required to reauthenticate after a set number of days. Ensure reauthentication with verification code is restricted to 15 days or less.",
          "RationaleStatement": "By increasing the frequency of times guests need to reauthenticate this ensures guest user access to data is not prolonged beyond an acceptable amount of time.",
          "ImpactStatement": "Guests who use Microsoft 365 in their organization can sign in using their work or school account to access the site or document. After the one-time passcode for verification has been entered for the first time, guests will authenticate with their work or school account and have a guest account created in the host's organization.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to SharePoint admin center https://admin.microsoft.com/sharepoint. 2. Click to expand Policies > Sharing. 3. Scroll to and expand More external sharing settings. 4. Set People who use a verification code must reauthenticate after this many days to 15 or less.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to SharePoint admin center https://admin.microsoft.com/sharepoint. 2. Click to expand Policies > Sharing. 3. Scroll to and expand More external sharing settings. 4. Ensure People who use a verification code must reauthenticate after this many days is set to 15 or less.",
          "AdditionalInformation": "If OneDrive and SharePoint integration with Entra ID B2B is enabled as per the CIS Benchmark the one-time-passcode experience will be replaced.",
          "References": "https://learn.microsoft.com/en-us/sharepoint/turn-external-sharing-on-or-off#change-the-organization-level-external-sharing-setting",
          "DefaultValue": "EmailAttestationRequired: False, EmailAttestationReAuthDays: 30"
        }
      ]
    },
    {
      "Id": "7.2.11",
      "Description": "This setting configures the permission that is selected by default for sharing link from a SharePoint site. Ensure the SharePoint default sharing link permission is set to View.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "7 SharePoint admin center",
          "SubSection": "7.2 Policies",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "This setting configures the permission that is selected by default for sharing link from a SharePoint site. Ensure the SharePoint default sharing link permission is set to View.",
          "RationaleStatement": "Setting the view permission as the default ensures that users must deliberately select the edit permission when sharing a link. This approach reduces the risk of unintentionally granting edit privileges to a resource that only requires read access, supporting the principle of least privilege.",
          "ImpactStatement": "Not applicable.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to SharePoint admin center https://admin.microsoft.com/sharepoint. 2. Click to expand Policies > Sharing. 3. Scroll to File and folder links. 4. Set Choose the permission that's selected by default for sharing links to View.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to SharePoint admin center https://admin.microsoft.com/sharepoint. 2. Click to expand Policies > Sharing. 3. Scroll to File and folder links. 4. Ensure Choose the permission that's selected by default for sharing links is set to View.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/sharepoint/turn-external-sharing-on-or-off#file-and-folder-links",
          "DefaultValue": "DefaultLinkPermission: Edit"
        }
      ]
    },
    {
      "Id": "7.3.1",
      "Description": "By default, SharePoint online allows files that Defender for Office 365 has detected as infected to be downloaded. Ensure Office 365 SharePoint infected files are disallowed for download.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "7 SharePoint admin center",
          "SubSection": "7.3 Settings",
          "Profile": "E5 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "By default, SharePoint online allows files that Defender for Office 365 has detected as infected to be downloaded. Ensure Office 365 SharePoint infected files are disallowed for download.",
          "RationaleStatement": "Defender for Office 365 for SharePoint, OneDrive, and Microsoft Teams protects your organization from inadvertently sharing malicious files. When an infected file is detected that file is blocked so that no one can open, copy, move, or share it until further actions are taken by the organization's security team.",
          "ImpactStatement": "The only potential impact associated with implementation of this setting is potential inconvenience associated with the small percentage of false positive detections that may occur.",
          "RemediationProcedure": "To remediate using PowerShell: 1. Connect to SharePoint Online using Connect-SPOService -Url https://tenant-admin.sharepoint.com, replacing 'tenant' with the appropriate value. 2. Run the following PowerShell command to set the recommended value: Set-SPOTenant -DisallowInfectedFileDownload $true",
          "AuditProcedure": "To audit using PowerShell: 1. Connect to SharePoint Online using Connect-SPOService -Url https://tenant-admin.sharepoint.com, replacing 'tenant' with the appropriate value. 2. Run the following PowerShell command: Get-SPOTenant | Select-Object DisallowInfectedFileDownload. 3. Ensure the value for DisallowInfectedFileDownload is set to True.",
          "AdditionalInformation": "According to Microsoft, SharePoint cannot be accessed through PowerShell by users with the Global Reader role.",
          "References": "https://learn.microsoft.com/en-us/defender-office-365/safe-attachments-for-spo-odfb-teams-configure",
          "DefaultValue": "False"
        }
      ]
    },
    {
      "Id": "7.3.2",
      "Description": "Microsoft OneDrive allows users to sign in their cloud tenant account and begin syncing select folders or the entire contents of OneDrive to a local computer. By default, this includes any computer with OneDrive already installed. Ensure OneDrive sync is restricted for unmanaged devices.",
      "Checks": [
        "sharepoint_onedrive_sync_restricted_unmanaged_devices"
      ],
      "Attributes": [
        {
          "Section": "7 SharePoint admin center",
          "SubSection": "7.3 Settings",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "Microsoft OneDrive allows users to sign in their cloud tenant account and begin syncing select folders or the entire contents of OneDrive to a local computer. By default, this includes any computer with OneDrive already installed. Ensure OneDrive sync is restricted for unmanaged devices by allowing syncing only on computers joined to specific domains.",
          "RationaleStatement": "Unmanaged devices pose a risk, since their security cannot be verified through existing security policies, brokers or endpoint protection. Allowing users to sync data to these devices takes that data out of the control of the organization. This increases the risk of the data either being intentionally or accidentally leaked.",
          "ImpactStatement": "Enabling this feature will prevent users from using the OneDrive for Business Sync client on devices that are not joined to the domains that were defined.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to SharePoint admin center https://admin.microsoft.com/sharepoint. 2. Click Settings followed by OneDrive - Sync. 3. Check the Allow syncing only on computers joined to specific domains. 4. Use the Get-ADDomain PowerShell command on the on-premises server to obtain the GUID for each on-premises domain. 5. Click Save.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to SharePoint admin center https://admin.microsoft.com/sharepoint. 2. Click Settings followed by OneDrive - Sync. 3. Verify that Allow syncing only on computers joined to specific domains is checked. 4. Verify that the Active Directory domain GUIDS are listed in the box.",
          "AdditionalInformation": "This setting is only applicable to Active Directory domains when operating in a hybrid configuration. It does not apply to Entra domains. If there are devices which are only Entra ID joined, consider using a Conditional Access Policy instead.",
          "References": "https://learn.microsoft.com/en-us/sharepoint/allow-syncing-only-on-specific-domains",
          "DefaultValue": "TenantRestrictionEnabled: False, AllowedDomainList: {}"
        }
      ]
    },
    {
      "Id": "8.1.1",
      "Description": "Microsoft Teams enables collaboration via file sharing. This file sharing is conducted within Teams, using SharePoint Online, by default; however, third-party cloud services are allowed as well. Ensure external file sharing in Teams is enabled for only approved cloud storage services.",
      "Checks": [
        "teams_external_file_sharing_restricted"
      ],
      "Attributes": [
        {
          "Section": "8 Microsoft Teams admin center",
          "SubSection": "8.1 Teams",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "Microsoft Teams enables collaboration via file sharing. This file sharing is conducted within Teams, using SharePoint Online, by default; however, third-party cloud services are allowed as well. Ensure external file sharing in Teams is enabled for only approved cloud storage services.",
          "RationaleStatement": "Ensuring that only authorized cloud storage providers are accessible from Teams will help to dissuade the use of non-approved storage providers.",
          "ImpactStatement": "The impact associated with this change is highly dependent upon current practices in the tenant. If users do not use other storage providers, then minimal impact is likely. However, if users do regularly utilize providers outside of the tenant this will affect their ability to continue to do so.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com. 2. Select Settings & policies > Global (Org-wide default) settings. 3. Click Teams to open the Teams settings section. 4. Under files set storages providers to Off unless they have first been authorized by the organization. To remediate using PowerShell: 1. Connect to Teams PowerShell using Connect-MicrosoftTeams. 2. Run the following PowerShell command to disable external providers that are not authorized: $Params = @{ Identity = 'Global'; AllowGoogleDrive = $false; AllowShareFile = $false; AllowBox = $false; AllowDropBox = $false; AllowEgnyte = $false }; Set-CsTeamsClientConfiguration @Params",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com. 2. Select Settings & policies > Global (Org-wide default) settings. 3. Click Teams to open the Teams settings section. 4. Under files verify that only organizationally authorized cloud storage options are set to On and all others Off. To audit using PowerShell: 1. Connect to Teams PowerShell using Connect-MicrosoftTeams. 2. Run the following to verify the recommended state: $Params = @('AllowDropbox', 'AllowBox', 'AllowGoogleDrive', 'AllowShareFile', 'AllowEgnyte'); Get-CsTeamsClientConfiguration -Identity Global | fl $Params. 3. Verify that only authorized providers are set to True and all others False.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/microsoftteams/teams-powershell-managing-teams",
          "DefaultValue": "AllowDropBox: True, AllowBox: True, AllowGoogleDrive: True, AllowShareFile: True, AllowEgnyte: True"
        }
      ]
    },
    {
      "Id": "8.1.2",
      "Description": "This setting controls whether Teams channels are allowed to receive emails sent to their unique email addresses. When enabled, emails sent to a channel's address will be delivered and appear in the channel's conversation thread; when disabled, the channel will reject incoming emails, preventing them from being posted. Ensure users can't send emails to a channel email address.",
      "Checks": [
        "teams_email_sending_to_channel_disabled"
      ],
      "Attributes": [
        {
          "Section": "8 Microsoft Teams admin center",
          "SubSection": "8.1 Teams",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "This setting controls whether Teams channels are allowed to receive emails sent to their unique email addresses. When enabled, emails sent to a channel's address will be delivered and appear in the channel's conversation thread; when disabled, the channel will reject incoming emails, preventing them from being posted. The recommended state is Off.",
          "RationaleStatement": "Channel email addresses are not under the tenant's domain and organizations do not have control over the security settings for this email address. An attacker could email channels directly if they discover the channel email address.",
          "ImpactStatement": "Depending on the organization's adoption, disabling this may disrupt workflows that rely on email-to-channel communication, particularly in environments where email is used to bridge external systems or vendors into Teams. This could include reduced visibility of important updates or alerts that were previously routed into Teams channels via email.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com. 2. Select Settings & policies > Global (Org-wide default) settings. 3. Click Teams to open the Teams settings section. 4. Under email integration set Users can send emails to a channel email address to Off. To remediate using PowerShell: 1. Connect to Teams PowerShell using Connect-MicrosoftTeams. 2. Run the following command to set the recommended state: Set-CsTeamsClientConfiguration -Identity Global -AllowEmailIntoChannel $false",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com. 2. Select Settings & policies > Global (Org-wide default) settings. 3. Click Teams to open the Teams settings section. 4. Under email integration verify that Users can send emails to a channel email address is Off. To audit using PowerShell: 1. Connect to Teams PowerShell using Connect-MicrosoftTeams. 2. Run the following command to verify the recommended state: Get-CsTeamsClientConfiguration -Identity Global | fl AllowEmailIntoChannel. 3. Ensure the returned value is False.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/step-by-step-guides/reducing-attack-surface-in-microsoft-teams?view=o365-worldwide#restricting-channel-email-messages-to-approved-domains",
          "DefaultValue": "On (True)"
        }
      ]
    },
    {
      "Id": "8.2.1",
      "Description": "This policy controls whether external domains are allowed, blocked or permitted based on an allowlist or denylist. When external domains are allowed, users in your organization can chat, add users to meetings, and use audio video conferencing with users in external organizations. Ensure external domains are restricted in the Teams admin center.",
      "Checks": [
        "teams_external_domains_restricted"
      ],
      "Attributes": [
        {
          "Section": "8 Microsoft Teams admin center",
          "SubSection": "8.2 Users",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "This policy controls whether external domains are allowed, blocked or permitted based on an allowlist or denylist. When external domains are allowed, users in your organization can chat, add users to meetings, and use audio video conferencing with users in external organizations. The recommended state is Allow only specific external domains or Block all external domains.",
          "RationaleStatement": "Allowlisting external domains that an organization is collaborating with allows for stringent controls over who an organization's users are allowed to make contact with. Some real-world attacks and exploits delivered via Teams over external access channels include: DarkGate malware, Social engineering / Phishing attacks by 'Midnight Blizzard', GIFShell, Username enumeration.",
          "ImpactStatement": "The impact in terms of the type of collaboration users are allowed to participate in and the I.T. resources expended to manage an allowlist will increase. If a user attempts to join the inviting organization's meeting they will be prevented from joining unless they were created as a guest in EntraID or their domain was added to the allowed external domains list.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com/. 2. Click to expand Users select External access. 3. Select the Policies tab. 4. Click on the Global (Org-wide default) policy. 5. Set Teams and Skype for Business users in external organizations to Off. 6. Click Save. To remediate using PowerShell: 1. Connect to Teams PowerShell using Connect-MicrosoftTeams. 2. Run the following command to configure the Global (Org-wide default) policy: Set-CsExternalAccessPolicy -Identity Global -EnableFederationAccess $false",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com/. 2. Click to expand Users select External access. 3. Select the Policies tab. 4. Click on the Global (Org-wide default) policy. 5. Ensure Teams and Skype for Business users in external organizations is set to Off. To audit using PowerShell: 1. Connect to Teams PowerShell using Connect-MicrosoftTeams. 2. Run the following command: Get-CsExternalAccessPolicy -Identity Global. 3. Ensure EnableFederationAccess is False.",
          "AdditionalInformation": "The organization settings take precedence over the policy settings. The audit is considered satisfied if the organizational setting is configured as prescribed, regardless of whether the Global default policy value is True or False.",
          "References": "https://learn.microsoft.com/en-us/microsoftteams/trusted-organizations-external-meetings-chat?tabs=organization-settings",
          "DefaultValue": "EnableFederationAccess: True"
        }
      ]
    },
    {
      "Id": "8.2.2",
      "Description": "This policy setting controls chats and meetings with external unmanaged Teams users (those not managed by an organization, such as Microsoft Teams (free)). Ensure communication with unmanaged Teams users is disabled.",
      "Checks": [
        "teams_unmanaged_communication_disabled"
      ],
      "Attributes": [
        {
          "Section": "8 Microsoft Teams admin center",
          "SubSection": "8.2 Users",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "This policy setting controls chats and meetings with external unmanaged Teams users (those not managed by an organization, such as Microsoft Teams (free)). The recommended state is: People in my organization can communicate with unmanaged Teams accounts set to Off.",
          "RationaleStatement": "Allowing users to communicate with unmanaged Teams users presents a potential security threat as little effort is required by threat actors to gain access to a trial or free Microsoft Teams account. Some real-world attacks and exploits delivered via Teams over external access channels include: DarkGate malware, Social engineering / Phishing attacks by 'Midnight Blizzard', GIFShell, Username enumeration.",
          "ImpactStatement": "Users will be unable to communicate with Teams users who are not managed by an organization. Organizations may choose create additional policies for specific groups needing to communicating with unmanaged external users.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com/. 2. Click to expand Users select External access. 3. Select the Policies tab. 4. Click on the Global (Org-wide default) policy. 5. Set People in my organization can communicate with unmanaged Teams accounts to Off. 6. Click Save. To remediate using PowerShell: 1. Connect to Teams PowerShell using Connect-MicrosoftTeams. 2. Run the following command: Set-CsExternalAccessPolicy -Identity Global -EnableTeamsConsumerAccess $false",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com/. 2. Click to expand Users select External access. 3. Select the Policies tab. 4. Click on the Global (Org-wide default) policy. 5. Ensure People in my organization can communicate with unmanaged Teams accounts is set to Off. To audit using PowerShell: 1. Connect to Teams PowerShell using Connect-MicrosoftTeams. 2. Run the following command: Get-CsExternalAccessPolicy -Identity Global. Ensure EnableTeamsConsumerAccess is set to False.",
          "AdditionalInformation": "The settings that govern chats and meetings with external unmanaged Teams users aren't available in GCC, GCC High, or DOD deployments, or in private cloud environments.",
          "References": "https://learn.microsoft.com/en-us/microsoftteams/trusted-organizations-external-meetings-chat?tabs=organization-settings",
          "DefaultValue": "EnableTeamsConsumerAccess: True"
        }
      ]
    },
    {
      "Id": "8.2.3",
      "Description": "This setting prevents external users who are not managed by an organization from initiating contact with users in the protected organization. Ensure external Teams users cannot initiate conversations.",
      "Checks": [
        "teams_external_users_cannot_start_conversations"
      ],
      "Attributes": [
        {
          "Section": "8 Microsoft Teams admin center",
          "SubSection": "8.2 Users",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "This setting prevents external users who are not managed by an organization from initiating contact with users in the protected organization. The recommended state is to uncheck External users with Teams accounts not managed by an organization can contact users in my organization.",
          "RationaleStatement": "Allowing users to communicate with unmanaged Teams users presents a potential security threat as little effort is required by threat actors to gain access to a trial or free Microsoft Teams account. Some real-world attacks and exploits delivered via Teams over external access channels include: DarkGate malware, Social engineering / Phishing attacks by 'Midnight Blizzard', GIFShell, Username enumeration.",
          "ImpactStatement": "The impact of disabling this is very low. Organizations may choose to create additional policies for specific groups that need to communicate with unmanaged external users.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com/. 2. Click to expand Users select External access. 3. Select the Policies tab. 4. Click on the Global (Org-wide default) policy. 5. Locate the parent setting People in my organization can communicate with unmanaged Teams accounts. 6. Uncheck External users with Teams accounts not managed by an organization can contact users in my organization. 7. Click Save. To remediate using PowerShell: 1. Connect to Teams PowerShell using Connect-MicrosoftTeams. 2. Run the following command: Set-CsExternalAccessPolicy -Identity Global -EnableTeamsConsumerInbound $false",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com/. 2. Click to expand Users select External access. 3. Select the Policies tab. 4. Click on the Global (Org-wide default) policy. 5. Ensure External users with Teams accounts not managed by an organization can contact users in my organization is not checked (false). To audit using PowerShell: 1. Connect to Teams PowerShell using Connect-MicrosoftTeams. 2. Run the following command: Get-CsExternalAccessPolicy -Identity Global. Ensure EnableTeamsConsumerInbound is False.",
          "AdditionalInformation": "Chats and meetings with external unmanaged Teams users isn't available in GCC, GCC High, or DOD deployments, or in private cloud environments.",
          "References": "https://learn.microsoft.com/en-us/microsoftteams/trusted-organizations-external-meetings-chat?tabs=organization-settings",
          "DefaultValue": "EnableTeamsConsumerInbound: True"
        }
      ]
    },
    {
      "Id": "8.2.4",
      "Description": "This setting controls the organization's external access with Teams 'trial-only' tenants. These are tenants that don't have any purchased seats. Ensure the organization cannot communicate with accounts in trial Teams tenants.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "8 Microsoft Teams admin center",
          "SubSection": "8.2 Users",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "This setting controls the organization's external access with Teams 'trial-only' tenants. These are tenants that don't have any purchased seats. When set to Blocked, users from these trial-only tenants aren't able to search and contact your users via chats, Teams calls, and meetings (using the users' authenticated identities) and your users aren't able to reach users in these trial-only tenants. The recommended state for People in my organization can communicate with accounts in trial Teams tenant is Off.",
          "RationaleStatement": "Microsoft introduced this setting as Off by default on July 29, 2029 in order to block attack vectors being exploited by threat actors who have abused trial tenants. Enforcing the default ensures the setting is not reenabled for any reason. Allowing users to communicate with unmanaged Teams users presents a potential security threat as little effort is required by threat actors to gain access to a trial or free Microsoft Teams account.",
          "ImpactStatement": "There is minimal to no legitimate business need for users to communicate with accounts in trial tenants. For temporary or testing scenarios, alternative communication methods are readily available that do not require enabling this setting.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com/. 2. Click to expand Users select External access. 3. Select the Organization settings tab. 4. Set People in my organization can communicate with accounts in trial Teams tenant to Off. To remediate using PowerShell: 1. Connect to Teams PowerShell using Connect-MicrosoftTeams. 2. Run the following command: Set-CsTenantFederationConfiguration -ExternalAccessWithTrialTenants 'Blocked'",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com/. 2. Click to expand Users select External access. 3. Select the Organization settings tab. 4. Ensure People in my organization can communicate with accounts in trial Teams tenant is set to Off. To audit using PowerShell: 1. Connect to Teams PowerShell using Connect-MicrosoftTeams. 2. Run the following command: Get-CsTenantFederationConfiguration. Ensure ExternalAccessWithTrialTenants is set to Blocked.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/microsoftteams/trusted-organizations-external-meetings-chat?tabs=organization-settings#block-federation-with-teams-trial-only-tenants",
          "DefaultValue": "Off or Blocked"
        }
      ]
    },
    {
      "Id": "8.4.1",
      "Description": "This policy setting controls which class of apps are available for users to install. Ensure app permission policies are configured to restrict third-party and custom apps.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "8 Microsoft Teams admin center",
          "SubSection": "8.4 Teams apps",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Manual",
          "Description": "This policy setting controls which class of apps are available for users to install.",
          "RationaleStatement": "Allowing users to install third-party or unverified apps poses a potential risk of introducing malicious software to the environment.",
          "ImpactStatement": "Users will only be able to install approved classes of apps.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com. 2. Click to expand Teams apps select Manage apps. 3. In the upper right click Actions > Org-wide app settings. 4. For Microsoft apps set Let users install and use available apps by default to On or less permissive. 5. For Third-party apps set Let users install and use available apps by default to Off. 6. For Custom apps set Let users install and use available apps by default to Off. 7. For Custom apps set Let users interact with custom apps in preview to Off.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com. 2. Click to expand Teams apps select Manage apps. 3. In the upper right click Actions > Org-wide app settings. 4. For Microsoft apps verify that Let users install and use available apps by default is On or less permissive. 5. For Third-party apps verify Let users install and use available apps by default is Off. 6. For Custom apps verify Let users install and use available apps by default is Off. 7. For Custom apps verify Let users interact with custom apps in preview is Off.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/microsoftteams/app-centric-management",
          "DefaultValue": "Microsoft apps: On, Third-party apps: On, Custom apps: On"
        }
      ]
    },
    {
      "Id": "8.5.1",
      "Description": "Anonymous users are users whose identity can't be verified. They may be logged in to an organization without a mutual trust relationship or they may not have an account (guest or user). Ensure anonymous users can't join a meeting.",
      "Checks": [
        "teams_meeting_anonymous_user_join_disabled"
      ],
      "Attributes": [
        {
          "Section": "8 Microsoft Teams admin center",
          "SubSection": "8.5 Meetings",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "Anonymous users are users whose identity can't be verified. They may be logged in to an organization without a mutual trust relationship or they may not have an account (guest or user). Anonymous participants appear with '(Unverified)' appended to their name in meetings. The recommended state is Anonymous users can join a meeting unverified set to Off.",
          "RationaleStatement": "For meetings that could contain sensitive information, it is best to allow the meeting organizer to vet anyone not directly sent an invite before admitting them to the meeting. This will also prevent the anonymous user from using the meeting link to have meetings at unscheduled times.",
          "ImpactStatement": "Individuals who were not sent or forwarded a meeting invite will not be able to join the meeting automatically.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com. 2. Select Settings & policies > Global (Org-wide default) settings. 3. Select Meetings to open the meeting settings section. 4. Under meeting join & lobby set Anonymous users can join a meeting unverified to Off. To remediate using PowerShell: 1. Connect to Teams PowerShell using Connect-MicrosoftTeams. 2. Run the following command to set the recommended state: Set-CsTeamsMeetingPolicy -Identity Global -AllowAnonymousUsersToJoinMeeting $false",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com. 2. Select Settings & policies > Global (Org-wide default) settings. 3. Select Meetings to open the meeting settings section. 4. Under meeting join & lobby verify that Anonymous users can join a meeting unverified is set to Off. To audit using PowerShell: 1. Connect to Teams PowerShell using Connect-MicrosoftTeams. 2. Run the following command to verify the recommended state: Get-CsTeamsMeetingPolicy -Identity Global | fl AllowAnonymousUsersToJoinMeeting. 3. Ensure the returned value is False.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/defender-office-365/step-by-step-guides/reducing-attack-surface-in-microsoft-teams?view=o365-worldwide#configure-meeting-settings",
          "DefaultValue": "On (True)"
        }
      ]
    },
    {
      "Id": "8.5.2",
      "Description": "This policy setting controls if an anonymous participant can start a Microsoft Teams meeting without someone in attendance. Anonymous users and dial-in callers must wait in the lobby until the meeting is started by someone in the organization or an external user from a trusted organization. Ensure anonymous users and dial-in callers can't start a meeting.",
      "Checks": [
        "teams_meeting_anonymous_user_start_disabled"
      ],
      "Attributes": [
        {
          "Section": "8 Microsoft Teams admin center",
          "SubSection": "8.5 Meetings",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "This policy setting controls if an anonymous participant can start a Microsoft Teams meeting without someone in attendance. Anonymous users and dial-in callers must wait in the lobby until the meeting is started by someone in the organization or an external user from a trusted organization.",
          "RationaleStatement": "Not allowing anonymous participants to automatically join a meeting reduces the risk of meeting spamming.",
          "ImpactStatement": "Anonymous participants will not be able to start a Microsoft Teams meeting.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com. 2. Select Settings & policies > Global (Org-wide default) settings. 3. Select Meetings to open the meeting settings section. 4. Under meeting join & lobby set Anonymous users and dial-in callers can start a meeting to Off. To remediate using PowerShell: 1. Connect to Teams PowerShell using Connect-MicrosoftTeams. 2. Run the following command to set the recommended state: Set-CsTeamsMeetingPolicy -Identity Global -AllowAnonymousUsersToStartMeeting $false",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com. 2. Select Settings & policies > Global (Org-wide default) settings. 3. Select Meetings to open the meeting settings section. 4. Under meeting join & lobby verify that Anonymous users and dial-in callers can start a meeting is set to Off. To audit using PowerShell: 1. Connect to Teams PowerShell using Connect-MicrosoftTeams. 2. Run the following command to verify the recommended state: Get-CsTeamsMeetingPolicy -Identity Global | fl AllowAnonymousUsersToStartMeeting. 3. Ensure the returned value is False.",
          "AdditionalInformation": "This setting only applies when Who can bypass the lobby is set to Everyone. If the anonymous users can join a meeting organization-level setting or meeting policy is Off, this setting only applies to dial-in callers.",
          "References": "https://learn.microsoft.com/en-us/microsoftteams/anonymous-users-in-meetings",
          "DefaultValue": "Off (False)"
        }
      ]
    },
    {
      "Id": "8.5.3",
      "Description": "This policy setting controls who can join a meeting directly and who must wait in the lobby until they're admitted by an organizer, co-organizer, or presenter of the meeting. Ensure only people in my org can bypass the lobby.",
      "Checks": [
        "teams_meeting_external_lobby_bypass_disabled"
      ],
      "Attributes": [
        {
          "Section": "8 Microsoft Teams admin center",
          "SubSection": "8.5 Meetings",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "This policy setting controls who can join a meeting directly and who must wait in the lobby until they're admitted by an organizer, co-organizer, or presenter of the meeting. The recommended state is People who were invited or more restrictive.",
          "RationaleStatement": "For meetings that could contain sensitive information, it is best to allow the meeting organizer to vet anyone not directly sent an invite before admitting them to the meeting. This will also prevent the anonymous user from using the meeting link to have meetings at unscheduled times.",
          "ImpactStatement": "Individuals who are not part of the organization will have to wait in the lobby until they're admitted by an organizer, co-organizer, or presenter of the meeting. Any individual who dials into the meeting regardless of status will also have to wait in the lobby. This includes internal users who are considered unauthenticated when dialing in.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com. 2. Select Settings & policies > Global (Org-wide default) settings. 3. Select Meetings to open the meeting settings section. 4. Under meeting join & lobby set Who can bypass the lobby to People who were invited or a more restrictive value: People in my org, Only organizers and co-organizers. To remediate using PowerShell: 1. Connect to Teams PowerShell using Connect-MicrosoftTeams. 2. Run the following command to set the recommended state: Set-CsTeamsMeetingPolicy -Identity Global -AutoAdmittedUsers 'InvitedUsers'",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com. 2. Select Settings & policies > Global (Org-wide default) settings. 3. Select Meetings to open the meeting settings section. 4. Under meeting join & lobby verify Who can bypass the lobby is set to People who were invited or a more restrictive value: People in my org, Only organizers and co-organizers. To audit using PowerShell: 1. Connect to Teams PowerShell using Connect-MicrosoftTeams. 2. Run the following command to verify the recommended state: Get-CsTeamsMeetingPolicy -Identity Global | fl AutoAdmittedUsers. 3. Ensure the returned value is InvitedUsers or more restrictive: EveryoneInCompanyExcludingGuests, OrganizerOnly.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/microsoftteams/who-can-bypass-meeting-lobby#overview-of-lobby-settings-and-policies",
          "DefaultValue": "People in my org and guests (EveryoneInCompany)"
        }
      ]
    },
    {
      "Id": "8.5.4",
      "Description": "This policy setting controls if users who dial in by phone can join the meeting directly or must wait in the lobby. Admittance to the meeting from the lobby is authorized by the meeting organizer, co-organizer, or presenter of the meeting. Ensure users dialing in can't bypass the lobby.",
      "Checks": [
        "teams_meeting_dial_in_lobby_bypass_disabled"
      ],
      "Attributes": [
        {
          "Section": "8 Microsoft Teams admin center",
          "SubSection": "8.5 Meetings",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "This policy setting controls if users who dial in by phone can join the meeting directly or must wait in the lobby. Admittance to the meeting from the lobby is authorized by the meeting organizer, co-organizer, or presenter of the meeting.",
          "RationaleStatement": "For meetings that could contain sensitive information, it is best to allow the meeting organizer to vet anyone not directly from the organization.",
          "ImpactStatement": "Individuals who are dialing in to the meeting must wait in the lobby until a meeting organizer, co-organizer, or presenter admits them.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com. 2. Select Settings & policies > Global (Org-wide default) settings. 3. Select Meetings to open the meeting settings section. 4. Under meeting join & lobby set People dialing in can bypass the lobby to Off. To remediate using PowerShell: 1. Connect to Teams PowerShell using Connect-MicrosoftTeams. 2. Run the following command to set the recommended state: Set-CsTeamsMeetingPolicy -Identity Global -AllowPSTNUsersToBypassLobby $false",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com. 2. Select Settings & policies > Global (Org-wide default) settings. 3. Select Meetings to open the meeting settings section. 4. Under meeting join & lobby verify that People dialing in can bypass the lobby is set to Off. To audit using PowerShell: 1. Connect to Teams PowerShell using Connect-MicrosoftTeams. 2. Run the following command to verify the recommended state: Get-CsTeamsMeetingPolicy -Identity Global | fl AllowPSTNUsersToBypassLobby. 3. Ensure the value is False.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/microsoftteams/who-can-bypass-meeting-lobby#overview-of-lobby-settings-and-policies",
          "DefaultValue": "Off (False)"
        }
      ]
    },
    {
      "Id": "8.5.5",
      "Description": "This policy setting controls who has access to read and write chat messages during a meeting. Ensure meeting chat does not allow anonymous users.",
      "Checks": [
        "teams_meeting_chat_anonymous_users_disabled"
      ],
      "Attributes": [
        {
          "Section": "8 Microsoft Teams admin center",
          "SubSection": "8.5 Meetings",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "This policy setting controls who has access to read and write chat messages during a meeting.",
          "RationaleStatement": "Ensuring that only authorized individuals can read and write chat messages during a meeting reduces the risk that a malicious user can inadvertently show content that is not appropriate or view sensitive information.",
          "ImpactStatement": "Only authorized individuals will be able to read and write chat messages during a meeting.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com. 2. Select Settings & policies > Global (Org-wide default) settings. 3. Select Meetings to open the meeting settings section. 4. Under meeting engagement set Meeting chat to On for everyone but anonymous users. To remediate using PowerShell: 1. Connect to Teams PowerShell using Connect-MicrosoftTeams. 2. Run the following command to set the minimum recommended state: Set-CsTeamsMeetingPolicy -Identity Global -MeetingChatEnabledType 'EnabledExceptAnonymous'",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com. 2. Select Settings & policies > Global (Org-wide default) settings. 3. Select Meetings to open the meeting settings section. 4. Under meeting engagement verify that Meeting chat is set to On for everyone but anonymous users or a more restrictive value: In-meeting only except anonymous or Off. To audit using PowerShell: 1. Connect to Teams PowerShell using Connect-MicrosoftTeams. 2. Run the following command to verify the recommended state: Get-CsTeamsMeetingPolicy -Identity Global | fl MeetingChatEnabledType. 3. Ensure the returned value is EnabledExceptAnonymous or a more restrictive value EnabledInMeetingOnlyForAllExceptAnonymous or Disabled.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/powershell/module/skype/set-csteamsmeetingpolicy?view=skype-ps#-meetingchatenabledtype",
          "DefaultValue": "On for everyone (Enabled)"
        }
      ]
    },
    {
      "Id": "8.5.6",
      "Description": "This policy setting controls who can present in a Teams meeting. Ensure only organizers and co-organizers can present.",
      "Checks": [
        "teams_meeting_presenters_restricted"
      ],
      "Attributes": [
        {
          "Section": "8 Microsoft Teams admin center",
          "SubSection": "8.5 Meetings",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "This policy setting controls who can present in a Teams meeting. Note: Organizers and co-organizers can change this setting when the meeting is set up.",
          "RationaleStatement": "Ensuring that only authorized individuals are able to present reduces the risk that a malicious user can inadvertently show content that is not appropriate.",
          "ImpactStatement": "Only organizers and co-organizers will be able to present without being granted permission.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com. 2. Select Settings & policies > Global (Org-wide default) settings. 3. Select Meetings to open the meeting settings section. 4. Under content sharing set Who can present to Only organizers and co-organizers. To remediate using PowerShell: 1. Connect to Teams PowerShell using Connect-MicrosoftTeams. 2. Run the following command to set the recommended state: Set-CsTeamsMeetingPolicy -Identity Global -DesignatedPresenterRoleMode 'OrganizerOnlyUserOverride'",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com. 2. Select Settings & policies > Global (Org-wide default) settings. 3. Select Meetings to open the meeting settings section. 4. Under content sharing verify Who can present is set to Only organizers and co-organizers. To audit using PowerShell: 1. Connect to Teams PowerShell using Connect-MicrosoftTeams. 2. Run the following command to verify the recommended state: Get-CsTeamsMeetingPolicy -Identity Global | fl DesignatedPresenterRoleMode. 3. Ensure the returned value is OrganizerOnlyUserOverride.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-US/microsoftteams/meeting-who-present-request-control",
          "DefaultValue": "Everyone (EveryoneUserOverride)"
        }
      ]
    },
    {
      "Id": "8.5.7",
      "Description": "This policy setting allows control of who can present in meetings and who can request control of the presentation while a meeting is underway. Ensure external participants can't give or request control.",
      "Checks": [
        "teams_meeting_external_control_disabled"
      ],
      "Attributes": [
        {
          "Section": "8 Microsoft Teams admin center",
          "SubSection": "8.5 Meetings",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "This policy setting allows control of who can present in meetings and who can request control of the presentation while a meeting is underway.",
          "RationaleStatement": "Ensuring that only authorized individuals and not external participants are able to present and request control reduces the risk that a malicious user can inadvertently show content that is not appropriate. External participants are categorized as follows: external users, guests, and anonymous users.",
          "ImpactStatement": "External participants will not be able to present or request control during the meeting. Warning: This setting also affects webinars.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com. 2. Select Settings & policies > Global (Org-wide default) settings. 3. Select Meetings to open the meeting settings section. 4. Under content sharing set External participants can give or request control to Off. To remediate using PowerShell: 1. Connect to Teams PowerShell using Connect-MicrosoftTeams. 2. Run the following command to set the recommended state: Set-CsTeamsMeetingPolicy -Identity Global -AllowExternalParticipantGiveRequestControl $false",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com. 2. Select Settings & policies > Global (Org-wide default) settings. 3. Select Meetings to open the meeting settings section. 4. Under content sharing verify that External participants can give or request control is Off. To audit using PowerShell: 1. Connect to Teams PowerShell using Connect-MicrosoftTeams. 2. Run the following command to verify the recommended state: Get-CsTeamsMeetingPolicy -Identity Global | fl AllowExternalParticipantGiveRequestControl. 3. Ensure the returned value is False.",
          "AdditionalInformation": "At this time, to give and take control of shared content during a meeting, both parties must be using the Teams desktop client. Control isn't supported when either party is running Teams in a browser.",
          "References": "https://learn.microsoft.com/en-us/microsoftteams/meeting-who-present-request-control",
          "DefaultValue": "Off (False)"
        }
      ]
    },
    {
      "Id": "8.5.8",
      "Description": "This meeting policy setting controls whether users can read or write messages in external meeting chats with untrusted organizations. If an external organization is on the list of trusted organizations this setting will be ignored. Ensure external meeting chat is off.",
      "Checks": [
        "teams_meeting_external_chat_disabled"
      ],
      "Attributes": [
        {
          "Section": "8 Microsoft Teams admin center",
          "SubSection": "8.5 Meetings",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "This meeting policy setting controls whether users can read or write messages in external meeting chats with untrusted organizations. If an external organization is on the list of trusted organizations this setting will be ignored.",
          "RationaleStatement": "Restricting access to chat in meetings hosted by external organizations limits the opportunity for an exploit like GIFShell or DarkGate malware from being delivered to users.",
          "ImpactStatement": "When joining external meetings users will be unable to read or write chat messages in Teams meetings with organizations that they don't have a trust relationship with. This will completely remove the chat functionality in meetings. From an I.T. perspective both the upkeep of adding new organizations to the trusted list and the decision-making process behind whether to trust or not trust an external partner will increase time expenditure.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com. 2. Select Settings & policies > Global (Org-wide default) settings. 3. Select Meetings to open the meeting settings section. 4. Under meeting engagement set External meeting chat to Off. To remediate using PowerShell: 1. Connect to Teams PowerShell using Connect-MicrosoftTeams. 2. Run the following command to set the recommended state: Set-CsTeamsMeetingPolicy -Identity Global -AllowExternalNonTrustedMeetingChat $false",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com. 2. Select Settings & policies > Global (Org-wide default) settings. 3. Select Meetings to open the meeting settings section. 4. Under meeting engagement verify that External meeting chat is set to Off. To audit using PowerShell: 1. Connect to Teams PowerShell using Connect-MicrosoftTeams. 2. Run the following command to verify the recommended state: Get-CsTeamsMeetingPolicy -Identity Global | fl AllowExternalNonTrustedMeetingChat. 3. Ensure the returned value is False.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/microsoftteams/settings-policies-reference#meeting-engagement",
          "DefaultValue": "On (True)"
        }
      ]
    },
    {
      "Id": "8.5.9",
      "Description": "This setting controls the ability for a user to initiate a recording of a meeting in progress. Ensure meeting recording is off by default.",
      "Checks": [
        "teams_meeting_recording_disabled"
      ],
      "Attributes": [
        {
          "Section": "8 Microsoft Teams admin center",
          "SubSection": "8.5 Meetings",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Automated",
          "Description": "This setting controls the ability for a user to initiate a recording of a meeting in progress. The recommended state is Off for the Global (Org-wide default) meeting policy.",
          "RationaleStatement": "Disabling meeting recordings in the Global meeting policy ensures that only authorized users, such as organizers, co-organizers, and leads, can initiate a recording. This measure helps safeguard sensitive information by preventing unauthorized individuals from capturing and potentially sharing meeting content. Restricting recording capabilities to specific roles allows organizations to exercise greater control over what is recorded, aligning it with the meeting's confidentiality requirements.",
          "ImpactStatement": "If there are no additional policies allowing anyone to record, then recording will effectively be disabled.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com. 2. Select Settings & policies > Global (Org-wide default) settings. 3. Select Meetings to open the meeting settings section. 4. Under Recording & transcription set Meeting recording to Off. To remediate using PowerShell: 1. Connect to Teams PowerShell using Connect-MicrosoftTeams. 2. Run the following command to set the recommended state: Set-CsTeamsMeetingPolicy -Identity Global -AllowCloudRecording $false",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com. 2. Select Settings & policies > Global (Org-wide default) settings. 3. Select Meetings to open the meeting settings section. 4. Under Recording & transcription verify that Meeting recording is set to Off. To audit using PowerShell: 1. Connect to Teams PowerShell using Connect-MicrosoftTeams. 2. Run the following command to verify the recommended state: Get-CsTeamsMeetingPolicy -Identity Global | fl AllowCloudRecording. 3. Ensure the returned value is False.",
          "AdditionalInformation": "Creating a separate policy for users or groups who are allowed to record is expected and in compliance. This control is only for the default meeting policy.",
          "References": "https://learn.microsoft.com/en-us/microsoftteams/settings-policies-reference#recording--transcription",
          "DefaultValue": "On (True)"
        }
      ]
    },
    {
      "Id": "8.6.1",
      "Description": "User reporting settings allow a user to report a message as malicious for further analysis. Ensure users can report security concerns in Teams.",
      "Checks": [
        "teams_security_reporting_enabled",
        "defender_chat_report_policy_configured"
      ],
      "Attributes": [
        {
          "Section": "8 Microsoft Teams admin center",
          "SubSection": "8.6 Messaging",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Automated",
          "Description": "User reporting settings allow a user to report a message as malicious for further analysis. This recommendation is composed of 3 different settings and all must be configured to pass: In the Teams admin center: On by default and controls whether users are able to report messages from Teams. In the Microsoft 365 Defender portal: On by default for new tenants. Defender - Report message destinations: This applies to more than just Microsoft Teams and allows for an organization to keep their reports contained.",
          "RationaleStatement": "Users will be able to more quickly and systematically alert administrators of suspicious malicious messages within Teams. The content of these messages may be sensitive in nature and therefore should be kept within the organization and not shared with Microsoft without first consulting company policy.",
          "ImpactStatement": "Enabling message reporting has an impact beyond just addressing security concerns. When users of the platform report a message, the content could include messages that are threatening or harassing in nature, possibly stemming from colleagues. Due to this the security staff responsible for reviewing and acting on these reports should be equipped with the skills to discern and appropriately direct such messages to the relevant departments, such as Human Resources (HR).",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com. 2. Select Settings & policies > Global (Org-wide default) settings. 3. Select Messaging to open the messaging settings section. 4. Set Report a security concern to On. 5. Next, navigate to Microsoft 365 Defender https://security.microsoft.com/. 6. Click on Settings > Email & collaboration > User reported settings. 7. Scroll to Microsoft Teams. 8. Check Monitor reported messages in Microsoft Teams and Save. 9. Set Send reported messages to: to My reporting mailbox only with reports configured to be sent to authorized staff.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Teams admin center https://admin.teams.microsoft.com. 2. Select Settings & policies > Global (Org-wide default) settings. 3. Select Messaging to open the messaging settings section. 4. Ensure Report a security concern is On. 5. Next, navigate to Microsoft 365 Defender https://security.microsoft.com/. 6. Click on Settings > Email & collaboration > User reported settings. 7. Scroll to Microsoft Teams. 8. Ensure Monitor reported messages in Microsoft Teams is checked. 9. Ensure Send reported messages to: is set to My reporting mailbox only with report email addresses defined for authorized staff. To audit using PowerShell: 1. Connect to Teams PowerShell using Connect-MicrosoftTeams. 2. Run: Get-CsTeamsMessagingPolicy -Identity Global | fl AllowSecurityEndUserReporting. 3. Ensure the value returned is True. 4. Connect to Exchange Online PowerShell using Connect-ExchangeOnline. 5. Run: Get-ReportSubmissionPolicy | fl Report*. 6. Ensure ReportJunkToCustomizedAddress, ReportNotJunkToCustomizedAddress, ReportPhishToCustomizedAddress are True and ReportChatMessageEnabled is False, ReportChatMessageToCustomizedAddressEnabled is True.",
          "AdditionalInformation": "The reported message remains visible to the user in the Teams client. Users can report the same message multiple times. The message sender isn't notified that messages were reported.",
          "References": "https://learn.microsoft.com/en-us/defender-office-365/submissions-teams?view=o365-worldwide",
          "DefaultValue": "On (True), Report message destination: Microsoft Only"
        }
      ]
    },
    {
      "Id": "9.1.1",
      "Description": "This setting allows business-to-business (B2B) guests access to Microsoft Fabric, and contents that they have permissions to. With the setting turned off, B2B guest users receive an error when trying to access Power BI. Ensure guest user access is restricted.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "9 Microsoft Fabric",
          "SubSection": "9.1 Tenant settings",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Manual",
          "Description": "This setting allows business-to-business (B2B) guests access to Microsoft Fabric, and contents that they have permissions to. With the setting turned off, B2B guest users receive an error when trying to access Power BI. The recommended state is Enabled for a subset of the organization or Disabled.",
          "RationaleStatement": "Establishing and enforcing a dedicated security group prevents unauthorized access to Microsoft Fabric for guests collaborating in Azure that are new or assigned guest status from other applications. This upholds the principle of least privilege and uses role-based access control (RBAC). These security groups can also be used for tasks like conditional access, enhancing risk management and user accountability across the organization.",
          "ImpactStatement": "Security groups will need to be more closely tended to and monitored.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Fabric https://app.powerbi.com/admin-portal. 2. Select Tenant settings. 3. Scroll to Export and Sharing settings. 4. Set Guest users can access Microsoft Fabric to one of these states: State 1: Disabled, State 2: Enabled with Specific security groups selected and defined. Important: If the organization doesn't actively use this feature it is recommended to keep it Disabled.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Fabric https://app.powerbi.com/admin-portal. 2. Select Tenant settings. 3. Scroll to Export and Sharing settings. 4. Ensure that Guest users can access Microsoft Fabric adheres to one of these states: State 1: Disabled, State 2: Enabled with Specific security groups selected and defined.",
          "AdditionalInformation": "If the organization doesn't actively use this feature it is recommended to keep it Disabled.",
          "References": "https://learn.microsoft.com/en-us/fabric/admin/service-admin-portal-export-sharing",
          "DefaultValue": "Enabled for the entire organization"
        }
      ]
    },
    {
      "Id": "9.1.2",
      "Description": "This setting helps organizations choose whether new external users can be invited to the organization through Power BI sharing, permissions, and subscription experiences. This setting only controls the ability to invite through Power BI. Ensure external user invitations are restricted.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "9 Microsoft Fabric",
          "SubSection": "9.1 Tenant settings",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Manual",
          "Description": "This setting helps organizations choose whether new external users can be invited to the organization through Power BI sharing, permissions, and subscription experiences. This setting only controls the ability to invite through Power BI. The recommended state is Enabled for a subset of the organization or Disabled.",
          "RationaleStatement": "Establishing and enforcing a dedicated security group prevents unauthorized access to Microsoft Fabric for guests collaborating in Azure that are new or assigned guest status from other applications. This upholds the principle of least privilege and uses role-based access control (RBAC). These security groups can also be used for tasks like conditional access, enhancing risk management and user accountability across the organization.",
          "ImpactStatement": "Guest user invitations will be limited to only specific employees.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Fabric https://app.powerbi.com/admin-portal. 2. Select Tenant settings. 3. Scroll to Export and Sharing settings. 4. Set Users can invite guest users to collaborate through item sharing and permissions to one of these states: State 1: Disabled, State 2: Enabled with Specific security groups selected and defined. Important: If the organization doesn't actively use this feature it is recommended to keep it Disabled.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Fabric https://app.powerbi.com/admin-portal. 2. Select Tenant settings. 3. Scroll to Export and Sharing settings. 4. Ensure that Users can invite guest users to collaborate through item sharing and permissions adheres to one of these states: State 1: Disabled, State 2: Enabled with Specific security groups selected and defined.",
          "AdditionalInformation": "To invite external users to the organization, the user must also have the Microsoft Entra Guest Inviter role.",
          "References": "https://learn.microsoft.com/en-us/fabric/admin/service-admin-portal-export-sharing",
          "DefaultValue": "Enabled for the entire organization"
        }
      ]
    },
    {
      "Id": "9.1.3",
      "Description": "This setting allows Microsoft Entra B2B guest users to have full access to the browsing experience using the left-hand navigation pane in the organization. Guest users who have been assigned workspace roles or specific item permissions will continue to have those roles and/or permissions, even if this setting is disabled. Ensure guest access to content is restricted.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "9 Microsoft Fabric",
          "SubSection": "9.1 Tenant settings",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Manual",
          "Description": "This setting allows Microsoft Entra B2B guest users to have full access to the browsing experience using the left-hand navigation pane in the organization. Guest users who have been assigned workspace roles or specific item permissions will continue to have those roles and/or permissions, even if this setting is disabled. The recommended state is Enabled for a subset of the organization or Disabled.",
          "RationaleStatement": "Establishing and enforcing a dedicated security group prevents unauthorized access to Microsoft Fabric for guests collaborating in Entra that are new or assigned guest status from other applications. This upholds the principle of least privilege and uses role-based access control (RBAC). These security groups can also be used for tasks like conditional access, enhancing risk management and user accountability across the organization.",
          "ImpactStatement": "Security groups will need to be more closely tended to and monitored.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Fabric https://app.powerbi.com/admin-portal. 2. Select Tenant settings. 3. Scroll to Export and Sharing settings. 4. Set Guest users can browse and access Fabric content to one of these states: State 1: Disabled, State 2: Enabled with Specific security groups selected and defined. Important: If the organization doesn't actively use this feature it is recommended to keep it Disabled.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Fabric https://app.powerbi.com/admin-portal. 2. Select Tenant settings. 3. Scroll to Export and Sharing settings. 4. Ensure that Guest users can browse and access Fabric content adheres to one of these states: State 1: Disabled, State 2: Enabled with Specific security groups selected and defined.",
          "AdditionalInformation": "If the organization doesn't actively use this feature it is recommended to keep it Disabled.",
          "References": "https://learn.microsoft.com/en-us/fabric/admin/service-admin-portal-export-sharing",
          "DefaultValue": "Disabled"
        }
      ]
    },
    {
      "Id": "9.1.4",
      "Description": "Power BI enables users to share reports and materials directly on the internet from both the application's desktop version and its web user interface. This functionality generates a publicly reachable web link that doesn't necessitate authentication or the need to be an Entra ID user in order to access and view it. Ensure 'Publish to web' is restricted.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "9 Microsoft Fabric",
          "SubSection": "9.1 Tenant settings",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Manual",
          "Description": "Power BI enables users to share reports and materials directly on the internet from both the application's desktop version and its web user interface. This functionality generates a publicly reachable web link that doesn't necessitate authentication or the need to be an Entra ID user in order to access and view it. The recommended state is Enabled for a subset of the organization or Disabled.",
          "RationaleStatement": "When using Publish to Web anyone on the Internet can view a published report or visual. Viewing requires no authentication. It includes viewing detail-level data that your reports aggregate. By disabling the feature, restricting access to certain users and allowing existing embed codes organizations can mitigate the exposure of confidential or proprietary information.",
          "ImpactStatement": "Depending on the organization's utilization administrators may experience more overhead managing embed codes, and requests.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Fabric https://app.powerbi.com/admin-portal. 2. Select Tenant settings. 3. Scroll to Export and Sharing settings. 4. Set Publish to web to one of these states: State 1: Disabled, State 2: Enabled with Choose how embed codes work set to Only allow existing codes AND Specific security groups selected and defined. Important: If the organization doesn't actively use this feature it is recommended to keep it Disabled.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Fabric https://app.powerbi.com/admin-portal. 2. Select Tenant settings. 3. Scroll to Export and Sharing settings. 4. Ensure that Publish to web adheres to one of these states: State 1: Disabled, State 2: Enabled with Choose how embed codes work set to Only allow existing codes AND Specific security groups selected and defined.",
          "AdditionalInformation": "If the organization doesn't actively use this feature it is recommended to keep it Disabled.",
          "References": "https://learn.microsoft.com/en-us/power-bi/collaborate-share/service-publish-to-web",
          "DefaultValue": "Enabled for the entire organization, Only allow existing codes"
        }
      ]
    },
    {
      "Id": "9.1.5",
      "Description": "Power BI allows the integration of R and Python scripts directly into visuals. This feature allows data visualizations by incorporating custom calculations, statistical analyses, machine learning models, and more using R or Python scripts. Ensure 'Interact with and share R and Python' visuals is 'Disabled'.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "9 Microsoft Fabric",
          "SubSection": "9.1 Tenant settings",
          "Profile": "E3 Level 2",
          "AssessmentStatus": "Manual",
          "Description": "Power BI allows the integration of R and Python scripts directly into visuals. This feature allows data visualizations by incorporating custom calculations, statistical analyses, machine learning models, and more using R or Python scripts. Custom visuals can be created by embedding them directly into Power BI reports. Users can then interact with these visuals and see the results of the custom code within the Power BI interface.",
          "RationaleStatement": "Disabling this feature can reduce the attack surface by preventing potential malicious code execution leading to data breaches, or unauthorized access. The potential for sensitive or confidential data being leaked to unintended users is also increased with the use of scripts.",
          "ImpactStatement": "Use of R and Python scripting will require exceptions for developers, along with more stringent code review.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Fabric https://app.powerbi.com/admin-portal. 2. Select Tenant settings. 3. Scroll to R and Python visuals settings. 4. Set Interact with and share R and Python visuals to Disabled.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Fabric https://app.powerbi.com/admin-portal. 2. Select Tenant settings. 3. Scroll to R and Python visuals settings. 4. Ensure that Interact with and share R and Python visuals is Disabled.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/fabric/admin/service-admin-portal-r-python-visuals",
          "DefaultValue": "Enabled"
        }
      ]
    },
    {
      "Id": "9.1.6",
      "Description": "Information protection tenant settings help to protect sensitive information in the Power BI tenant. Allowing and applying sensitivity labels to content ensures that information is only seen and accessed by the appropriate users. Ensure 'Allow users to apply sensitivity labels for content' is 'Enabled'.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "9 Microsoft Fabric",
          "SubSection": "9.1 Tenant settings",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Manual",
          "Description": "Information protection tenant settings help to protect sensitive information in the Power BI tenant. Allowing and applying sensitivity labels to content ensures that information is only seen and accessed by the appropriate users. The recommended state is Enabled or Enabled for a subset of the organization.",
          "RationaleStatement": "Establishing data classifications and affixing labels to data at creation enables organizations to discern the data's criticality, sensitivity, and value. This initial identification enables the implementation of appropriate protective measures, utilizing technologies like Data Loss Prevention (DLP) to avert inadvertent exposure and enforcing access controls to safeguard against unauthorized access. This practice can also promote user awareness and responsibility in regard to the nature of the data they interact with.",
          "ImpactStatement": "Additional license requirements like Power BI Pro are required, as outlined in the Licensing and requirements page linked in the references section.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Fabric https://app.powerbi.com/admin-portal. 2. Select Tenant settings. 3. Scroll to Information protection. 4. Set Allow users to apply sensitivity labels for content to one of these states: State 1: Enabled, State 2: Enabled with Specific security groups selected and defined.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Fabric https://app.powerbi.com/admin-portal. 2. Select Tenant settings. 3. Scroll to Information protection. 4. Ensure that Allow users to apply sensitivity labels for content adheres to one of these states: State 1: Enabled, State 2: Enabled with Specific security groups selected and defined.",
          "AdditionalInformation": "Sensitivity labels and protection are only applied to files exported to Excel, PowerPoint, or PDF files, that are controlled by 'Export to Excel' and 'Export reports as PowerPoint presentation or PDF documents' settings. All other export and sharing options do not support the application of sensitivity labels and protection.",
          "References": "https://learn.microsoft.com/en-us/power-bi/enterprise/service-security-enable-data-sensitivity-labels",
          "DefaultValue": "Disabled"
        }
      ]
    },
    {
      "Id": "9.1.7",
      "Description": "Creating a shareable link allows a user to create a link to a report or dashboard, then add that link to an email or another messaging application. This setting solely deals with restrictions to People in the organization. Ensure shareable links are restricted.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "9 Microsoft Fabric",
          "SubSection": "9.1 Tenant settings",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Manual",
          "Description": "Creating a shareable link allows a user to create a link to a report or dashboard, then add that link to an email or another messaging application. There are 3 options that can be selected when creating a shareable link: People in your organization, People with existing access, Specific people. This setting solely deals with restrictions to People in the organization. The recommended state is Enabled for a subset of the organization or Disabled.",
          "RationaleStatement": "While external users are unable to utilize shareable links, disabling or restricting this feature ensures that a user cannot generate a link accessible by individuals within the same organization who lack the necessary clearance to the shared data. This measure along with proper file and folder permissions can help prevent unintended access and potential information leakage.",
          "ImpactStatement": "If the setting is Enabled then only specific people in the organization would be allowed to create general links viewable by the entire organization.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Fabric https://app.powerbi.com/admin-portal. 2. Select Tenant settings. 3. Scroll to Export and Sharing settings. 4. Set Allow shareable links to grant access to everyone in your organization to one of these states: State 1: Disabled, State 2: Enabled with Specific security groups selected and defined. Important: If the organization doesn't actively use this feature it is recommended to keep it Disabled.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Fabric https://app.powerbi.com/admin-portal. 2. Select Tenant settings. 3. Scroll to Export and Sharing settings. 4. Ensure that Allow shareable links to grant access to everyone in your organization adheres to one of these states: State 1: Disabled, State 2: Enabled with Specific security groups selected and defined.",
          "AdditionalInformation": "External users by default are not included in any of these categories, and therefore cannot use any of these links regardless of the state of this setting.",
          "References": "https://learn.microsoft.com/en-us/power-bi/collaborate-share/service-share-dashboards?wt.mc_id=powerbi_inproduct_sharedialog#link-settings",
          "DefaultValue": "Enabled for the entire organization"
        }
      ]
    },
    {
      "Id": "9.1.8",
      "Description": "Power BI admins can specify which users or user groups can share datasets externally with guests from a different tenant through the in-place mechanism. Disabling this setting prevents any user from sharing datasets externally by restricting the ability of users to turn on external sharing for datasets they own or manage. Ensure enabling of external data sharing is restricted.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "9 Microsoft Fabric",
          "SubSection": "9.1 Tenant settings",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Manual",
          "Description": "Power BI admins can specify which users or user groups can share datasets externally with guests from a different tenant through the in-place mechanism. Disabling this setting prevents any user from sharing datasets externally by restricting the ability of users to turn on external sharing for datasets they own or manage. The recommended state is Enabled for a subset of the organization or Disabled.",
          "RationaleStatement": "Establishing and enforcing a dedicated security group prevents unauthorized access to Microsoft Fabric for guests collaborating in Azure that are new or from other applications. This upholds the principle of least privilege and uses role-based access control (RBAC). These security groups can also be used for tasks like conditional access, enhancing risk management and user accountability across the organization.",
          "ImpactStatement": "Security groups will need to be more closely tended to and monitored.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Fabric https://app.powerbi.com/admin-portal. 2. Select Tenant settings. 3. Scroll to Export and Sharing settings. 4. Set Allow specific users to turn on external data sharing to one of these states: State 1: Disabled, State 2: Enabled with Specific security groups selected and defined. Important: If the organization doesn't actively use this feature it is recommended to keep it Disabled.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Fabric https://app.powerbi.com/admin-portal. 2. Select Tenant settings. 3. Scroll to Export and Sharing settings. 4. Ensure that Allow specific users to turn on external data sharing adheres to one of these states: State 1: Disabled, State 2: Enabled with Specific security groups selected and defined.",
          "AdditionalInformation": "If the organization doesn't actively use this feature it is recommended to keep it Disabled.",
          "References": "https://learn.microsoft.com/en-us/fabric/admin/service-admin-portal-export-sharing",
          "DefaultValue": "Enabled for the entire organization"
        }
      ]
    },
    {
      "Id": "9.1.9",
      "Description": "This setting blocks the use of resource key based authentication. The Block ResourceKey Authentication setting applies to streaming and PUSH datasets. If blocked users will not be allowed to send data to streaming and PUSH datasets using the API with a resource key. Ensure 'Block ResourceKey Authentication' is 'Enabled'.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "9 Microsoft Fabric",
          "SubSection": "9.1 Tenant settings",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Manual",
          "Description": "This setting blocks the use of resource key based authentication. The Block ResourceKey Authentication setting applies to streaming and PUSH datasets. If blocked users will not be allowed to send data to streaming and PUSH datasets using the API with a resource key. The recommended state is Enabled.",
          "RationaleStatement": "Resource keys are a form of authentication that allows users to access Power BI resources (such as reports, dashboards, and datasets) without requiring individual user accounts. While convenient, this method bypasses the organization's centralized identity and access management controls. Enabling ensures that access to Power BI resources is tied to the organization's authentication mechanisms, providing a more secure and controlled environment.",
          "ImpactStatement": "Developers will need to request a special exception in order to use this feature.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Fabric https://app.powerbi.com/admin-portal. 2. Select Tenant settings. 3. Scroll to Developer settings. 4. Set Block ResourceKey Authentication to Enabled.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Fabric https://app.powerbi.com/admin-portal. 2. Select Tenant settings. 3. Scroll to Developer settings. 4. Ensure that Block ResourceKey Authentication is Enabled.",
          "AdditionalInformation": "",
          "References": "https://learn.microsoft.com/en-us/fabric/admin/service-admin-portal-developer",
          "DefaultValue": "Disabled for the entire organization"
        }
      ]
    },
    {
      "Id": "9.1.10",
      "Description": "Use a service principal to access Fabric public APIs that include create, read, update, and delete (CRUD) operations, and are protected by a Fabric permission model. To allow an app to use service principal authentication, its service principal must be included in an allowed security group. Ensure access to APIs by service principals is restricted.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "9 Microsoft Fabric",
          "SubSection": "9.1 Tenant settings",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Manual",
          "Description": "Use a service principal to access Fabric public APIs that include create, read, update, and delete (CRUD) operations, and are protected by a Fabric permission model. To allow an app to use service principal authentication, its service principal must be included in an allowed security group. You can control who can access service principals by creating dedicated security groups and using these groups in other tenant settings. The recommended state is Enabled for a subset of the organization or Disabled.",
          "RationaleStatement": "Leaving API access unrestricted increases the attack surface in the event an adversary gains access to a Service Principal. APIs are a feature-rich method for programmatic access to many areas of Power BI and should be guarded closely.",
          "ImpactStatement": "Service principals will need to be members of specific security groups in order to perform public API calls.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Fabric https://app.powerbi.com/admin-portal. 2. Select Tenant settings. 3. Scroll to Developer settings. 4. Set Service principals can call Fabric public APIs to one of these states: State 1: Disabled, State 2: Enabled with Specific security groups selected and defined. Important: If the organization doesn't actively use this feature it is recommended to keep it Disabled.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Fabric https://app.powerbi.com/admin-portal. 2. Select Tenant settings. 3. Scroll to Developer settings. 4. Ensure that Service principals can call Fabric public APIs adheres to one of these states: State 1: Disabled, State 2: Enabled with Specific security groups selected and defined.",
          "AdditionalInformation": "If the organization doesn't actively use this feature it is recommended to keep it Disabled.",
          "References": "https://learn.microsoft.com/en-us/fabric/admin/service-admin-portal-developer",
          "DefaultValue": "Enabled for the entire organization"
        }
      ]
    },
    {
      "Id": "9.1.11",
      "Description": "Service principal profiles provide a flexible solution for apps used in a multitenancy deployment. The profiles enable customer data isolation and tighter security boundaries between customers that are utilizing the app. Ensure service principals cannot create and use profiles.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "9 Microsoft Fabric",
          "SubSection": "9.1 Tenant settings",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Manual",
          "Description": "Service principal profiles provide a flexible solution for apps used in a multitenancy deployment. The profiles enable customer data isolation and tighter security boundaries between customers that are utilizing the app. The recommended state is Enabled for a subset of the organization or Disabled.",
          "RationaleStatement": "Service Principals should be restricted to a security group to limit which Service Principals can interact with profiles. This supports the principle of least privilege.",
          "ImpactStatement": "Disabled is the default behavior.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Fabric https://app.powerbi.com/admin-portal. 2. Select Tenant settings. 3. Scroll to Developer settings. 4. Set Allow service principals to create and use profiles to one of these states: State 1: Disabled, State 2: Enabled with Specific security groups selected and defined. Important: If the organization doesn't actively use this feature it is recommended to keep it Disabled.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Fabric https://app.powerbi.com/admin-portal. 2. Select Tenant settings. 3. Scroll to Developer settings. 4. Ensure that Allow service principals to create and use profiles adheres to one of these states: State 1: Disabled, State 2: Enabled with Specific security groups selected and defined.",
          "AdditionalInformation": "If the organization doesn't actively use this feature it is recommended to keep it Disabled.",
          "References": "https://learn.microsoft.com/en-us/fabric/admin/service-admin-portal-developer",
          "DefaultValue": "Disabled for the entire organization"
        }
      ]
    },
    {
      "Id": "9.1.12",
      "Description": "Use a service principal to access these Fabric APIs that aren't protected by a Fabric permission model: Create Workspace, Create Connection, Create Deployment Pipeline. Ensure service principals ability to create workspaces, connections and deployment pipelines is restricted.",
      "Checks": [],
      "Attributes": [
        {
          "Section": "9 Microsoft Fabric",
          "SubSection": "9.1 Tenant settings",
          "Profile": "E3 Level 1",
          "AssessmentStatus": "Manual",
          "Description": "Use a service principal to access these Fabric APIs that aren't protected by a Fabric permission model: Create Workspace, Create Connection, Create Deployment Pipeline. To allow an app to use service principal authentication, its service principal must be included in an allowed security group. You can control who can access service principals by creating dedicated security groups and using these groups in other tenant settings. The recommended state is Enabled for a subset of the organization or Disabled.",
          "RationaleStatement": "Leaving API access unrestricted increases the attack surface in the event an adversary gains access to a Service Principal. APIs are a feature-rich method for programmatic access to many areas of Power BI and should be guarded closely.",
          "ImpactStatement": "Service principals will need to be members of specific security groups in order to perform public API calls.",
          "RemediationProcedure": "To remediate using the UI: 1. Navigate to Microsoft Fabric https://app.powerbi.com/admin-portal. 2. Select Tenant settings. 3. Scroll to Developer settings. 4. Set Service principals can create workspaces, connections, and deployment pipelines to one of these states: State 1: Disabled, State 2: Enabled with Specific security groups selected and defined. Important: If the organization doesn't actively use this feature it is recommended to keep it Disabled.",
          "AuditProcedure": "To audit using the UI: 1. Navigate to Microsoft Fabric https://app.powerbi.com/admin-portal. 2. Select Tenant settings. 3. Scroll to Developer settings. 4. Ensure that Service principals can create workspaces, connections, and deployment pipelines adheres to one of these states: State 1: Disabled, State 2: Enabled with Specific security groups selected and defined.",
          "AdditionalInformation": "If the organization doesn't actively use this feature it is recommended to keep it Disabled.",
          "References": "https://learn.microsoft.com/en-us/fabric/admin/service-admin-portal-developer",
          "DefaultValue": "Disabled for the entire organization"
        }
      ]
    }
  ]
}
