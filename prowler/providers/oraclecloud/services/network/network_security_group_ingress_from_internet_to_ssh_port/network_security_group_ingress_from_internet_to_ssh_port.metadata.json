{
  "Provider": "oraclecloud",
  "CheckID": "network_security_group_ingress_from_internet_to_ssh_port",
  "CheckTitle": "Network security group does not allow ingress from 0.0.0.0/0 to port 22 (SSH)",
  "CheckType": [],
  "ServiceName": "network",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "NetworkSecurityGroup",
  "Description": "Network security groups with **ingress** from `0.0.0.0/0` exposing **SSH** are identified. This includes rules that explicitly permit `TCP` `22`, use `all` protocols, or define TCP port ranges that encompass `22`.",
  "Risk": "Public **SSH** access enables Internet-wide probing, **brute force**, and **credential stuffing** that can grant shell access. Compromise allows **lateral movement**, data exfiltration (confidentiality), unauthorized changes or malware (integrity), and service disruption or ransomware-driven lockouts (availability).",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://www.trendmicro.com/cloudoneconformity/knowledge-base/oci/OCI-Networking/unrestricted-ssh-access-via-nsgs.html",
    "https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networksecuritygroups.htm"
  ],
  "Remediation": {
    "Code": {
      "CLI": "oci network nsg rules remove --nsg-id <nsg-ocid> --security-rule-ids '[\"<rule-ocid>\"]'",
      "NativeIaC": "",
      "Other": "1. In the OCI Console, go to Networking > Network Security Groups\n2. Open the target NSG and go to the Rules tab\n3. Find the INGRESS rule with Source 0.0.0.0/0 that includes TCP port 22\n4. Click Remove to delete that rule\n5. (If SSH is required) Add a new INGRESS rule for TCP port 22 with Source set to a specific trusted CIDR (not 0.0.0.0/0), then Save",
      "Terraform": "```hcl\n# Restrict SSH so it's not from 0.0.0.0/0\nresource \"oci_core_network_security_group_security_rule\" \"<example_resource_name>\" {\n  network_security_group_id = \"<example_resource_id>\"\n  direction                 = \"INGRESS\"\n  protocol                  = \"6\"                         # TCP\n  source                    = \"10.0.0.0/8\"               # CRITICAL: not 0.0.0.0/0; limits SSH to internal range\n\n  tcp_options {\n    destination_port_range {\n      min = 22  # CRITICAL: explicitly defines SSH port\n      max = 22\n    }\n  }\n}\n```"
    },
    "Recommendation": {
      "Text": "Enforce **least privilege**: limit SSH in NSG rules to trusted CIDRs or private networks. Prefer **bastion access** (e.g., OCI Bastion) or **VPN/private connectivity** over direct Internet exposure. Use key-based auth, disable `PasswordAuthentication`, log and monitor access, and segment workloads for **defense in depth**.",
      "Url": "https://hub.prowler.com/check/network_security_group_ingress_from_internet_to_ssh_port"
    }
  },
  "Categories": [
    "internet-exposed"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
