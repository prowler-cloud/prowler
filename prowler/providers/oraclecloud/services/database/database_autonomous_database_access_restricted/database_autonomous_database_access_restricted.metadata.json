{
  "Provider": "oraclecloud",
  "CheckID": "database_autonomous_database_access_restricted",
  "CheckTitle": "Oracle Autonomous Shared Database (ADB) is deployed within a VCN or restricts public access with whitelisted IPs excluding 0.0.0.0/0",
  "CheckType": [],
  "ServiceName": "database",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "AutonomousDatabase",
  "Description": "**Autonomous Database (shared)** network exposure is evaluated: instances are treated as restricted when using a **VCN private endpoint** or when **ACLs** allow only specified IPs/VCNs. It identifies configurations with no ACL and no VCN, or ACLs permitting `0.0.0.0/0`.",
  "Risk": "With **open access**, attackers can probe endpoints, brute-force credentials, or abuse leaked wallets to connect.\n\nImpact:\n- Confidentiality: unauthorized queries and data exfiltration\n- Integrity: malicious changes\n- Availability: heavy queries or scans causing service disruption",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.oracle.com/en/cloud/paas/autonomous-database/adbsa/autonomous-private-endpoints.html",
    "https://mjromeo81.com/2020/12/24/oracle-autonomous-database-setting-up-acls-and-private-endpoints/",
    "https://mjromeo81.com/category/cloud/autonomous-database/",
    "https://icodealot.com/dbtools-connections-with-adb-access-control-list/",
    "https://www.oracle.com/cloud/networking/private-endpoint/supported-services/"
  ],
  "Remediation": {
    "Code": {
      "CLI": "oci db autonomous-database update --autonomous-database-id <adb-ocid> --is-access-control-enabled true --whitelisted-ips '[\"<ALLOWED_IP_OR_CIDR>\"]'",
      "NativeIaC": "",
      "Other": "1. In OCI Console, go to Autonomous Database and select the instance\n2. Click More Actions > Update\n3. Under Network Access, enable Access control list (ACL)\n4. Add an allowed IP/CIDR (exclude 0.0.0.0/0) and remove any 0.0.0.0/0 entry\n5. Click Save",
      "Terraform": "```hcl\nresource \"oci_database_autonomous_database\" \"<example_resource_name>\" {\n  is_access_control_enabled = true                 # Critical: enable ACLs to restrict public access\n  whitelisted_ips           = [\"<ALLOWED_IP_OR_CIDR>\"]  # Critical: allow only specific IP/CIDR; do not use 0.0.0.0/0\n}\n```"
    },
    "Recommendation": {
      "Text": "Prefer **VCN private endpoints** to eliminate internet exposure. If public access is required, enforce **least privilege** by limiting ACLs to specific CIDRs or VCNs; never use `0.0.0.0/0`.\n\nAdd **defense in depth** with NSGs and private connectivity (VPN/peering), monitor access, and rotate client wallets regularly.",
      "Url": "https://hub.prowler.com/check/database_autonomous_database_access_restricted"
    }
  },
  "Categories": [
    "internet-exposed",
    "trust-boundaries"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
