{
  "Provider": "oraclecloud",
  "CheckID": "identity_password_policy_prevents_reuse",
  "CheckTitle": "Identity Domain password policy prevents password reuse by remembering at least 24 previous passwords",
  "CheckType": [],
  "ServiceName": "identity",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "User",
  "Description": "**OCI Identity Domains** password policies are evaluated for **password reuse prevention** via the **password history** setting. The finding expects a configured policy with `num_passwords_in_history` set to at least `24`. *Legacy IAM password policies lack password history; only Identity Domains support this setting.*",
  "Risk": "Without **password history**, users can reuse old passwords. Compromised credentials remain valid after resets, enabling account takeover, unauthorized changes, and **lateral movement**, degrading **confidentiality** and **integrity** and weakening recovery from password-related incidents.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.oracle.com/en-us/iaas/Content/Identity/home.htm",
    "https://www.pulumi.com/registry/packages/oci/api-docs/identity/getdomainspasswordpolicies/"
  ],
  "Remediation": {
    "Code": {
      "CLI": "",
      "NativeIaC": "",
      "Other": "1. Sign in to the OCI Console\n2. Go to Identity & Security > Domains and select <identity_domain_name>\n3. Open Security > Password policies\n4. Edit the affected policy (e.g., Default Password Policy)\n5. Set \"Number of passwords in history\" (Remember previous passwords) to 24\n6. Click Save\n7. Repeat for any other password policies in the domain",
      "Terraform": ""
    },
    "Recommendation": {
      "Text": "Enforce **password history** in Identity Domains with `num_passwords_in_history >= 24`. Pair with `min_password_age` to prevent rapid cycling, and maintain strong complexity and expiration rules. *If using legacy IAM, migrate to Identity Domains.* Complement with **MFA** for defense in depth.",
      "Url": "https://hub.prowler.com/check/identity_password_policy_prevents_reuse"
    }
  },
  "Categories": [
    "identity-access"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
