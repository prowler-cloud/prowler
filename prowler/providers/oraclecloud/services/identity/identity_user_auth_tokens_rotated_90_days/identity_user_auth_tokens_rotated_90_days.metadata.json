{
  "Provider": "oraclecloud",
  "CheckID": "identity_user_auth_tokens_rotated_90_days",
  "CheckTitle": "User auth token age is 90 days or less",
  "CheckType": [],
  "ServiceName": "identity",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "User",
  "Description": "**Oracle Cloud Infrastructure (OCI) IAM user auth tokens** are evaluated for **rotation age** against a `90-day` threshold using each token's creation time. Tokens older than this window indicate the token has not been recently rotated.",
  "Risk": "Stale **auth tokens** increase exposure of **confidential data** and enable **persistent unauthorized API access** if compromised. Long-lived tokens can outlast password resets and role changes, weakening **least privilege** and enabling **lateral movement** and data exfiltration.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.oracle.com/en-us/iaas/Content/Identity/home.htm",
    "https://www.trendmicro.com/cloudoneconformity/knowledge-base/oci/OCI-IAM/rotate-user-auth-tokens.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "oci iam user delete-auth-token --user-id <example_resource_id> --auth-token-id <example_resource_id> --force",
      "NativeIaC": "",
      "Other": "1. In the OCI Console, go to Identity & Security > Users\n2. Open the user with the failing auth token\n3. In the Auth Tokens tab, find tokens older than 90 days (check Created date)\n4. Select the old token and click Delete\n5. Confirm deletion\n6. Repeat for any other tokens older than 90 days",
      "Terraform": ""
    },
    "Recommendation": {
      "Text": "Enforce routine **token rotation** at `<= 90 days` and prefer **short-lived, scoped credentials**. Apply **least privilege**, revoke unused tokens, set **automatic expirations**, and monitor usage. *When possible*, replace static tokens with federated or session-based access to reduce exposure.",
      "Url": "https://hub.prowler.com/check/identity_user_auth_tokens_rotated_90_days"
    }
  },
  "Categories": [
    "identity-access",
    "secrets"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
