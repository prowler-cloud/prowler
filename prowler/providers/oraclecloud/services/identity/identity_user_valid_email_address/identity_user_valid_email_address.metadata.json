{
  "Provider": "oraclecloud",
  "CheckID": "identity_user_valid_email_address",
  "CheckTitle": "OCI IAM user has a valid email address",
  "CheckType": [],
  "ServiceName": "identity",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "low",
  "ResourceType": "User",
  "Description": "**OCI IAM user accounts** are evaluated for a populated `email` attribute that resembles an address (contains `@`). Accounts missing this attribute or with malformed values are identified.",
  "Risk": "Missing or invalid emails break **account recovery** and **MFA** flows, silencing security notifications. This degrades **availability** for legitimate users and enables attacker **persistence** on compromised or orphaned accounts, delaying containment and risking unauthorized data access.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.oracle.com/en-us/iaas/Content/Identity/home.htm"
  ],
  "Remediation": {
    "Code": {
      "CLI": "oci iam user update --user-id <example_resource_id> --email <example_email@example.com>",
      "NativeIaC": "",
      "Other": "1. Sign in to the OCI Console\n2. Go to Identity & Security > Users\n3. Select the user without a valid email\n4. Click Edit (or Update)\n5. Enter a valid email address (must include '@')\n6. Click Save",
      "Terraform": "```hcl\n# Ensure the user has a valid email address\nresource \"oci_identity_user\" \"<example_resource_name>\" {\n  compartment_id = \"<example_resource_id>\"\n  name           = \"<example_resource_name>\"\n  email          = \"<example_email@example.com>\" # Critical: sets a valid email (contains '@') to pass the check\n}\n```"
    },
    "Recommendation": {
      "Text": "Ensure every user has a unique, verified, and monitored `email`. Enforce this at creation and through periodic reviews; disable or remove accounts with invalid addresses. Prefer **federated identities** to minimize local users, and apply **least privilege** with clear ownership to support lifecycle management.",
      "Url": "https://hub.prowler.com/check/identity_user_valid_email_address"
    }
  },
  "Categories": [
    "identity-access"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
