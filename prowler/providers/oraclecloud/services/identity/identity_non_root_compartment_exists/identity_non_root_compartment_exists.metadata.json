{
  "Provider": "oraclecloud",
  "CheckID": "identity_non_root_compartment_exists",
  "CheckTitle": "Tenancy has at least one active non-root compartment",
  "CheckType": [],
  "ServiceName": "identity",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "Compartment",
  "Description": "**OCI tenancy** includes at least one **active non-root compartment**. Only compartments below the `root` level are considered, indicating that resources are organized outside the root scope.",
  "Risk": "Using only the `root` compartment removes segmentation and forces broad tenancy-wide access. This endangers **confidentiality** and **integrity** through cross-project visibility, mis-scoped policies, and accidental changes with global impact, and can affect **availability** via bulk deletions or misconfigurations.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://www.trendmicro.com/cloudoneconformity/knowledge-base/oci/OCI-IAM/create-non-root-compartment.html",
    "https://oci-ansible-modules.readthedocs.io/en/latest/modules/oci_compartment_module.html",
    "https://dasini.net/blog/2021/08/10/discovering-mysql-database-service-episode-2-create-a-compartment/",
    "https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcompartments.htm",
    "https://climbtheladder.com/10-oci-compartment-best-practices/",
    "https://www.ateam-oracle.com/post/oracle-cloud-infrastructure-compartments"
  ],
  "Remediation": {
    "Code": {
      "CLI": "oci iam compartment create --compartment-id <tenancy_ocid> --name <compartment_name> --description '<description>'",
      "NativeIaC": "",
      "Other": "1. In the OCI Console, go to Identity & Security > Compartments\n2. Click Create Compartment\n3. Enter Name: <example_resource_name> and a Description\n4. Ensure the Parent Compartment is the tenancy (root) or desired non-root parent\n5. Click Create",
      "Terraform": "```hcl\n# Creates a non-root compartment under the tenancy to pass the check\nresource \"oci_identity_compartment\" \"<example_resource_name>\" {\n  compartment_id = \"<example_resource_id>\" # Critical: parent OCID (tenancy) for non-root compartment\n  name           = \"<example_resource_name>\" # Critical: compartment name\n  description    = \"compartment\"             # Critical: required to create\n}\n```"
    },
    "Recommendation": {
      "Text": "Create dedicated **non-root compartments** per workload, environment, or team; avoid placing resources in the `root` compartment.\n\nApply granular policies at the compartment level to enforce **least privilege** and **separation of duties**. Use a clear hierarchy and tags, and review the design regularly as the tenancy evolves.",
      "Url": "https://hub.prowler.com/check/identity_non_root_compartment_exists"
    }
  },
  "Categories": [
    "identity-access",
    "trust-boundaries"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
