{
  "Provider": "oraclecloud",
  "CheckID": "identity_service_level_admins_exist",
  "CheckTitle": "Identity policy does not grant broad 'manage all-resources' permissions",
  "CheckType": [],
  "ServiceName": "identity",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "Policy",
  "Description": "**OCI IAM policies** are reviewed for **overly broad entitlements**, specifically statements granting `manage all-resources` without scoping to particular services or compartments. Only **active policies** are considered; the default tenant admin policy is excluded.",
  "Risk": "Broad `manage all-resources` grants erode **least privilege**, enabling access across the tenancy. A compromised user or misused token could cause **privilege escalation**, **data exfiltration**, destructive changes, and service disruption, impacting confidentiality, integrity, and availability.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://www.linkedin.com/pulse/identity-access-management-oracle-cloud-control-authentication-mklqc",
    "https://docs.oracle.com/en-us/iaas/Content/Identity/getstarted/identity-domains.htm",
    "https://docs.prowler.com/checks/oci/oci-iam-policies/identity_service_level_admins_exist",
    "https://dbarepository.wordpress.com/2025/03/14/identity-and-access-management-policies-in-oci/",
    "https://monowar-mukul.medium.com/cloud-identity-and-access-management-iam-for-the-beginner-392ba6de238",
    "https://diversedaily.com/iam-policy-optimization-fine-tuned-iam-policies-prevent-costly-accidental-resource-usage/",
    "https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policygetstarted.htm",
    "https://www.ateam-oracle.com/post/oracle-cloud-infrastructure-compartments"
  ],
  "Remediation": {
    "Code": {
      "CLI": "oci iam policy update --policy-id <policy-ocid> --statements '[\"Allow group <GroupName> to manage instance-family in compartment <CompartmentName>\"]'",
      "NativeIaC": "",
      "Other": "1. In OCI Console, go to Identity & Security > Policies\n2. Open the policy that contains a statement with \"manage all-resources\"\n3. Click Edit policy statements\n4. Remove the statement(s) containing \"manage all-resources\"\n5. Add a service-specific statement, e.g.: Allow group <GroupName> to manage instance-family in compartment <CompartmentName>\n6. Click Save changes",
      "Terraform": "```hcl\nresource \"oci_identity_policy\" \"<example_resource_name>\" {\n  compartment_id = \"<example_resource_id>\"\n  name           = \"<example_resource_name>\"\n  description    = \"<policy-description>\"\n\n  # Critical: restrict to a specific service family to avoid broad 'manage all-resources'\n  statements = [\n    \"Allow group <GroupName> to manage instance-family in compartment <CompartmentName>\"\n  ]\n}\n```"
    },
    "Recommendation": {
      "Text": "Apply **least privilege** and **separation of duties**:\n- Replace `manage all-resources` with service-scoped permissions and compartment limits\n- Create service-level admin groups for specific families\n- Use tags/regions for conditions, *when applicable*\n- Employ time-bound elevation and periodic reviews",
      "Url": "https://hub.prowler.com/check/identity_service_level_admins_exist"
    }
  },
  "Categories": [
    "identity-access"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
