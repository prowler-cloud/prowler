{
  "Provider": "oraclecloud",
  "CheckID": "identity_password_policy_expires_within_365_days",
  "CheckTitle": "Identity Domain password policy expires passwords within 365 days",
  "CheckType": [],
  "ServiceName": "identity",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "Policy",
  "Description": "**OCI Identity Domain password policies** are evaluated to confirm **password expiration** is configured and set to `<= 365` days (`password_expires_after`).\n\n*Legacy IAM lacks password expiration; tenancies without Identity Domains require manual assessment.*",
  "Risk": "Missing or >`365`-day **password expiration** extends the window for **credential stuffing**, **brute force**, and use of leaked passwords. This enables unauthorized access, data exposure, and configuration changes, harming **confidentiality** and **integrity**, and allowing attacker persistence after staff turnover.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.oracle.com/en-us/iaas/tools/terraform-provider-oci/7.16.0/docs/r/identity_domains_password_policy.html",
    "https://docs.oracle.com/en-us/iaas/Content/Identity/home.htm",
    "https://www.pulumi.com/registry/packages/oci/api-docs/identity/domainspasswordpolicy/"
  ],
  "Remediation": {
    "Code": {
      "CLI": "",
      "NativeIaC": "",
      "Other": "1. Sign in to the OCI Console\n2. Go to Identity & Security > Domains and select your identity domain\n3. In the domain, open Security (or Domain settings) > Password policies\n4. Edit the relevant password policy\n5. Set \"Password expires after (days)\" to 365 or less\n6. Click Save",
      "Terraform": "```hcl\nresource \"oci_identity_domains_password_policy\" \"<example_resource_name>\" {\n  idcs_endpoint = \"<example_resource_id>\"\n  name          = \"<example_resource_name>\"\n  schemas       = [\"urn:ietf:params:scim:schemas:oracle:idcs:PasswordPolicy\"]\n\n  password_expires_after = 365 # Critical: ensures passwords expire within 365 days to pass the check\n}\n```"
    },
    "Recommendation": {
      "Text": "Enforce **password rotation** at `<= 365` days in Identity Domains. Combine with **MFA**, strong composition rules, history, and minimum password age to prevent reuse. Apply **least privilege**, disable dormant accounts, and regularly review credential policies. *If on legacy IAM, adopt Identity Domains to gain expiration controls.*",
      "Url": "https://hub.prowler.com/check/identity_password_policy_expires_within_365_days"
    }
  },
  "Categories": [
    "identity-access"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
