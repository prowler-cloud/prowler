{
  "Provider": "oraclecloud",
  "CheckID": "identity_user_customer_secret_keys_rotated_90_days",
  "CheckTitle": "User customer secret key is rotated within 90 days or less",
  "CheckType": [],
  "ServiceName": "identity",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "User",
  "Description": "OCI IAM **customer secret keys** are assessed by creation timestamp to determine whether their age exceeds `90` days.",
  "Risk": "Long-lived **customer secret keys** keep compromised or brute-forced credentials valid.\nAttackers can use them to list, read, write, or delete Object Storage data, enabling exfiltration, tampering, and disruption-impacting confidentiality, integrity, and availability.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.public.content.oci.oraclecloud.com/en-us/iaas/Content/cloud-guard/using/detect-recipes.htm",
    "https://blogs.oracle.com/cloud-infrastructure/post/auto-rotation-of-oci-iam-credentials",
    "https://docs.oracle.com/en-us/iaas/Content/Identity/home.htm",
    "https://www.trendmicro.com/cloudoneconformity/knowledge-base/oci/OCI-IAM/rotate-customer-secret-keys.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "oci iam customer-secret-key delete --user-id <example_resource_id> --customer-secret-key-id <example_resource_id> --force",
      "NativeIaC": "",
      "Other": "1. Sign in to the Oracle Cloud Console\n2. Go to Identity & Security > Domains > <example_resource_name> > Users > select <example_resource_name>\n3. Open the Customer secret keys tab and click Generate secret key; save the Access Key and Secret\n4. Delete any key older than 90 days: select the old key and click Delete",
      "Terraform": ""
    },
    "Recommendation": {
      "Text": "Rotate **customer secret keys** every `<= 90` days. Apply **least privilege**, remove unused keys, and prefer short-lived identities (instance/resource principals) over static secrets. Automate rotation and alerts, avoid embedding keys in code, and continuously monitor key usage.",
      "Url": "https://hub.prowler.com/check/identity_user_customer_secret_keys_rotated_90_days"
    }
  },
  "Categories": [
    "identity-access",
    "secrets"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
