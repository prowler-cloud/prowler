{
  "Provider": "oraclecloud",
  "CheckID": "identity_iam_admins_cannot_update_tenancy_admins",
  "CheckTitle": "All IAM policies granting manage/use on groups or users in the tenancy restrict access to the Administrators group",
  "CheckType": [],
  "ServiceName": "identity",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "critical",
  "ResourceType": "Policy",
  "Description": "**OCI IAM policies** granting **manage/use** on **groups or users** in the tenancy are evaluated for a condition that excludes the **Administrators** group, such as `target.group.name != 'Administrators'`.\n\nPolicies missing this restriction are identified.",
  "Risk": "Ability to modify the **Administrators** group enables **privilege escalation** to full tenancy control. This threatens confidentiality (broad data access), integrity (policy/user changes), and availability (resource deletion). Attackers could add persistence accounts, disable safeguards, and evade oversight.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.oracle.com/en-us/iaas/Content/Identity/home.htm",
    "https://www.trendmicro.com/cloudoneconformity/knowledge-base/oci/OCI-IAM/protect-administrators-group-with-access-policies.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "oci iam policy update --policy-id <example_resource_id> --statements \"[\\\"Allow group <example_resource_name> to manage groups, users in tenancy where target.group.name != 'Administrators'\\\"]\"",
      "NativeIaC": "",
      "Other": "1. In OCI Console, go to Identity & Security > Policies\n2. Open any policy that allows a group to manage or use groups/users in the tenancy\n3. Click Edit policy and update each affected statement to append exactly:\n   where target.group.name != 'Administrators'\n4. Save changes\n5. Repeat for all such policies",
      "Terraform": "```hcl\nresource \"oci_identity_policy\" \"<example_resource_name>\" {\n  name           = \"<example_resource_name>\"\n  compartment_id = \"<example_resource_id>\"\n  description    = \"<example_resource_name>\"\n  statements = [\n    # Critical: Protect the Administrators group from modification by this policy\n    # Adds a where clause so the policy can't target the Administrators group\n    \"Allow group <example_resource_name> to manage groups, users in tenancy where target.group.name != 'Administrators'\"\n  ]\n}\n```"
    },
    "Recommendation": {
      "Text": "Apply **least privilege**: avoid tenancy-wide manage/use on groups or users. When delegation is required, include a condition excluding the **Administrators** group (e.g., `target.group.name != 'Administrators'`). Enforce **segregation of duties**, require approvals for group changes, and monitor/audit identity policy activity.",
      "Url": "https://hub.prowler.com/check/identity_iam_admins_cannot_update_tenancy_admins"
    }
  },
  "Categories": [
    "identity-access"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
