{
  "Provider": "oraclecloud",
  "CheckID": "events_rule_network_security_group_changes",
  "CheckTitle": "Event rule monitoring network security group changes has notification actions configured",
  "CheckType": [],
  "ServiceName": "events",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "EventRule",
  "Description": "OCI Events rules targeting **Network Security Group (NSG)** changes are evaluated for the presence of **notification actions**. Monitored event types: `com.oraclecloud.virtualnetwork.createnetworksecuritygroup`, `com.oraclecloud.virtualnetwork.updatenetworksecuritygroup`, `com.oraclecloud.virtualnetwork.deletenetworksecuritygroup`, `com.oraclecloud.virtualnetwork.changenetworksecuritygroupcompartment`.",
  "Risk": "Absent notifications for NSG changes enable silent policy drift.\n- **Confidentiality**: permissive edits can expose services and drive data exfiltration.\n- **Integrity**: attackers can reroute traffic or bypass micro-segmentation.\n- **Availability**: deletions/misconfigurations may isolate workloads or widen DDoS exposure.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://www.linkedin.com/pulse/oracle-cloud-events-zubair-aslam-xtfvf",
    "https://docs.oracle.com/en-us/iaas/Content/Events/home.htm",
    "https://docs.oracle.com/en-us/iaas/Content/Events/Reference/eventsproducers.htm"
  ],
  "Remediation": {
    "Code": {
      "CLI": "oci events rule create --compartment-id <compartment_ocid> --display-name <example_resource_name> --condition '{\"eventType\":[\"com.oraclecloud.virtualnetwork.changenetworksecuritygroupcompartment\",\"com.oraclecloud.virtualnetwork.createnetworksecuritygroup\",\"com.oraclecloud.virtualnetwork.deletenetworksecuritygroup\",\"com.oraclecloud.virtualnetwork.updatenetworksecuritygroup\"]}' --actions '{\"actions\":[{\"actionType\":\"ONS\",\"topicId\":\"<topic_ocid>\"}]}'",
      "NativeIaC": "",
      "Other": "1. In the OCI Console, go to Observability & Management > Events Service > Rules\n2. Click Create rule\n3. Set Display name and Compartment\n4. Under Conditions, add Event types:\n   - com.oraclecloud.virtualnetwork.changenetworksecuritygroupcompartment\n   - com.oraclecloud.virtualnetwork.createnetworksecuritygroup\n   - com.oraclecloud.virtualnetwork.deletenetworksecuritygroup\n   - com.oraclecloud.virtualnetwork.updatenetworksecuritygroup\n5. Under Actions, click Add action > Notifications, select Publish to topic, choose the ONS topic\n6. Click Create to save the rule",
      "Terraform": "```hcl\nresource \"oci_events_rule\" \"example\" {\n  compartment_id = var.compartment_id\n  display_name   = \"<example_resource_name>\"\n\n  # Critical: Monitor NSG change events to satisfy the check\n  condition = jsonencode({\n    eventType = [\n      \"com.oraclecloud.virtualnetwork.changenetworksecuritygroupcompartment\", # Required NSG event\n      \"com.oraclecloud.virtualnetwork.createnetworksecuritygroup\",            # Required NSG event\n      \"com.oraclecloud.virtualnetwork.deletenetworksecuritygroup\",            # Required NSG event\n      \"com.oraclecloud.virtualnetwork.updatenetworksecuritygroup\"             # Required NSG event\n    ]\n  })\n\n  actions {\n    actions {\n      action_type = \"ONS\"                 # Critical: Notification action required\n      topic_id    = var.topic_id           # Sends notifications to this topic\n    }\n  }\n}\n```"
    },
    "Recommendation": {
      "Text": "Implement **Events** rules for NSG lifecycle changes with **notification actions** to a monitored topic/SIEM.\n- Include `createnetworksecuritygroup`, `updatenetworksecuritygroup`, `deletenetworksecuritygroup`, `changenetworksecuritygroupcompartment`\n- Enforce **least privilege** and **separation of duties** on NSG and Events admins\n- Regularly test and tune alerts",
      "Url": "https://hub.prowler.com/check/events_rule_network_security_group_changes"
    }
  },
  "Categories": [
    "logging"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
