{
  "Provider": "oraclecloud",
  "CheckID": "events_rule_route_table_changes",
  "CheckTitle": "Event rule for route table changes has notification actions configured",
  "CheckType": [],
  "ServiceName": "events",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "EventRule",
  "Description": "**OCI Events rules** for **VCN route tables** monitor lifecycle and compartment changes and include **notification actions**.\n\nThe evaluation looks for rules that capture `create`, `update`, `delete`, and `changeCompartment` events for route tables and send notifications.",
  "Risk": "Without notifications on route table changes, **routing tampering** can persist unnoticed:\n- Exposure of private subnets to the Internet\n- Traffic hijack or blackholing\n- Segmentation bypass enabling lateral movement\nThis threatens **confidentiality**, **integrity**, and **availability**.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.oracle.com/en-us/iaas/Content/Events/home.htm"
  ],
  "Remediation": {
    "Code": {
      "CLI": "oci events rule create --compartment-id <example_compartment_ocid> --display-name <example_resource_name> --condition '{\"eventType\":[\"com.oraclecloud.virtualnetwork.changeroutetablecompartment\",\"com.oraclecloud.virtualnetwork.createroutetable\",\"com.oraclecloud.virtualnetwork.deleteroutetable\",\"com.oraclecloud.virtualnetwork.updateroutetable\"]}' --actions '{\"actions\":[{\"actionType\":\"ONS\",\"topicId\":\"<example_resource_id>\"}]}'",
      "NativeIaC": "",
      "Other": "1. In OCI Console, go to Observability & Management > Events Service > Rules.\n2. Click Create rule and select the target Compartment; set a Display name.\n3. In Condition, add event types:\n   - com.oraclecloud.virtualnetwork.changeroutetablecompartment\n   - com.oraclecloud.virtualnetwork.createroutetable\n   - com.oraclecloud.virtualnetwork.deleteroutetable\n   - com.oraclecloud.virtualnetwork.updateroutetable\n4. In Actions, add Notifications (ONS) and select the desired Topic.\n5. Ensure the rule is Enabled and click Create.",
      "Terraform": "```hcl\nresource \"oci_events_rule\" \"<example_resource_name>\" {\n  compartment_id = \"<example_compartment_ocid>\"\n  display_name   = \"<example_resource_name>\"\n\n  condition = jsonencode({\n    eventType = [\n      \"com.oraclecloud.virtualnetwork.changeroutetablecompartment\", # critical: monitor route table change events\n      \"com.oraclecloud.virtualnetwork.createroutetable\",\n      \"com.oraclecloud.virtualnetwork.deleteroutetable\",\n      \"com.oraclecloud.virtualnetwork.updateroutetable\"\n    ]\n  })\n\n  actions {\n    actions {\n      action_type = \"ONS\"                   # critical: adds notification action\n      topic_id    = \"<example_resource_id>\" # critical: ONS topic to receive notifications\n    }\n  }\n}\n```"
    },
    "Recommendation": {
      "Text": "Create an **Events rule** that captures route table `create`, `update`, `delete`, and `changeCompartment` events and routes them to **notifications** used by on-call and SIEM. Enforce **least privilege** on route edits, require **change approvals**, and apply **defense in depth** with auditing and automated response.",
      "Url": "https://hub.prowler.com/check/events_rule_route_table_changes"
    }
  },
  "Categories": [
    "logging"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
