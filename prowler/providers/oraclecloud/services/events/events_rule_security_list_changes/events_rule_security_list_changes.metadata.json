{
  "Provider": "oraclecloud",
  "CheckID": "events_rule_security_list_changes",
  "CheckTitle": "Event rule monitoring security list changes has notification actions configured",
  "CheckType": [],
  "ServiceName": "events",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "EventRule",
  "Description": "OCI Events rules for VCN **security lists** monitor lifecycle changes-create, update, delete, and compartment moves-and include **notification actions**. The evaluation looks for rules that filter these events and confirms a configured notification target.",
  "Risk": "Without timely alerts on security list changes, **unauthorized rule edits** can expose subnets to the Internet, enabling scans, brute force, and lateral movement (**confidentiality**), permit traffic manipulation (**integrity**), or block ports causing outages (**availability**). Delayed detection widens blast radius.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://www.thatfinnishguy.blog/2021/03/15/get-notified-on-unwanted-network-changes-with-oci-cloud-guard/",
    "https://docs.oracle.com/en-us/iaas/Content/Events/home.htm"
  ],
  "Remediation": {
    "Code": {
      "CLI": "oci events rule create --compartment-id <example_resource_id> --display-name <example_resource_name> --condition '{\"eventType\":[\"com.oraclecloud.virtualnetwork.changesecuritylistcompartment\",\"com.oraclecloud.virtualnetwork.createsecuritylist\",\"com.oraclecloud.virtualnetwork.deletesecuritylist\",\"com.oraclecloud.virtualnetwork.updatesecuritylist\"]}' --actions '{\"actions\":[{\"actionType\":\"ONS\",\"topicId\":\"<example_resource_id>\",\"isEnabled\":true}]}'",
      "NativeIaC": "",
      "Other": "1. In OCI Console, go to Observability & Management > Events Service > Rules\n2. Click Create rule, set a name and compartment\n3. In Condition, set Event Type to include exactly:\n   - com.oraclecloud.virtualnetwork.changesecuritylistcompartment\n   - com.oraclecloud.virtualnetwork.createsecuritylist\n   - com.oraclecloud.virtualnetwork.deletesecuritylist\n   - com.oraclecloud.virtualnetwork.updatesecuritylist\n4. Click Add action, choose Notifications, select an existing topic\n5. Ensure the action is enabled and click Create",
      "Terraform": "```hcl\nresource \"oci_events_rule\" \"<example_resource_name>\" {\n  compartment_id = \"<example_resource_id>\"\n  display_name   = \"<example_resource_name>\"\n  is_enabled     = true\n\n  # Critical: monitor security list change event types required by the check\n  # This ensures the rule matches the specific VCN Security List events\n  condition = jsonencode({\n    eventType = [\n      \"com.oraclecloud.virtualnetwork.changesecuritylistcompartment\",\n      \"com.oraclecloud.virtualnetwork.createsecuritylist\",\n      \"com.oraclecloud.virtualnetwork.deletesecuritylist\",\n      \"com.oraclecloud.virtualnetwork.updatesecuritylist\"\n    ]\n  })\n\n  actions {\n    actions {\n      action_type = \"ONS\"                 # Critical: add notification action\n      topic_id    = \"<example_resource_id>\" # ONS topic OCID to send notifications\n      is_enabled  = true                   # Ensure notifications are sent\n    }\n  }\n}\n```"
    },
    "Recommendation": {
      "Text": "Define **Events** rules for security list create/update/delete and route them to **Notifications** or automated responders. Enforce **least privilege** for network and Events admins, apply **change control** with logging, cover critical compartments/regions, and periodically test alerts for reliability.",
      "Url": "https://hub.prowler.com/check/events_rule_security_list_changes"
    }
  },
  "Categories": [
    "logging"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
