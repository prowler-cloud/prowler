{
  "Provider": "github",
  "CheckID": "repository_inactive_not_archived",
  "CheckTitle": "Repository is archived or active within the configured inactivity threshold",
  "CheckType": [],
  "ServiceName": "repository",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "",
  "Description": "**GitHub repositories** that remain **unarchived** and show no activity beyond a configured inactivity window (e.g., `180` days) are identified. The evaluation considers the most recent repository activity to surface long-idle codebases that are still unarchived.",
  "Risk": "Unarchived, long-inactive repos expand attack surface. Stale code and dependencies can hide unpatched flaws; writable state enables **integrity** compromise via malicious commits or workflow abuse; exposed secrets threaten **confidentiality**. Attackers can leverage them for lateral movement and supply-chain tampering.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.github.com/en/repositories/archiving-a-github-repository/archiving-repositories",
    "https://github.blog/news-insights/product-news/archiving-repositories/"
  ],
  "Remediation": {
    "Code": {
      "CLI": "gh repo archive <OWNER>/<REPO> --yes",
      "NativeIaC": "",
      "Other": "1. Open the repository on GitHub\n2. Click Settings\n3. Scroll to Danger Zone\n4. Click Archive this repository\n5. Type the repository name and confirm by clicking I understand the consequences, archive this repository",
      "Terraform": "```hcl\nresource \"github_repository\" \"repo\" {\n  name     = \"<example_resource_name>\"\n  archived = true  # Critical: archives the repository so inactive repos pass the check\n}\n```"
    },
    "Recommendation": {
      "Text": "Adopt **lifecycle management**:\n- Archive or delete repos no longer needed\n- If retained, update dependencies, rotate secrets, disable unused workflows, and restrict writes under **least privilege**\n- Define an inactivity policy (e.g., `180` days) with periodic reviews to prevent dormant, writable codebases",
      "Url": "https://hub.prowler.com/check/repository_inactive_not_archived"
    }
  },
  "Categories": [
    "software-supply-chain"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
