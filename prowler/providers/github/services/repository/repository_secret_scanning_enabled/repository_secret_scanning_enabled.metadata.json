{
  "Provider": "github",
  "CheckID": "repository_secret_scanning_enabled",
  "CheckTitle": "Repository has secret scanning enabled to detect sensitive data",
  "CheckType": [],
  "ServiceName": "repository",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "",
  "Description": "GitHub repository configuration for **secret scanning**-which detects secrets (API keys, tokens, passwords) in commits and Git history-is evaluated to determine if detection is active.",
  "Risk": "Without **secret scanning**, exposed credentials can persist unnoticed, enabling:\n- Unauthorized access to cloud and third-party services\n- **Supply-chain compromise** via tampered pipelines\n- Data exfiltration and repo takeover\n\nThis degrades **confidentiality** and **integrity**, and increases blast radius of a single leaked key.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.github.com/en/code-security/secret-scanning/about-secret-scanning"
  ],
  "Remediation": {
    "Code": {
      "CLI": "gh api -X PATCH repos/<OWNER>/<REPO> -H \"Accept: application/vnd.github+json\" -H \"Content-Type: application/json\" -d '{\"security_and_analysis\":{\"secret_scanning\":{\"status\":\"enabled\"}}}'",
      "NativeIaC": "",
      "Other": "1. In GitHub, open the target repository and go to Settings\n2. In the left sidebar, click Code security and analysis\n3. Under Secret scanning, click Enable (or set to Enabled)\n4. Confirm if prompted",
      "Terraform": "```hcl\nresource \"github_repository\" \"<example_resource_name>\" {\n  name = \"<example_resource_name>\"\n\n  security_and_analysis {\n    secret_scanning {           # Critical: enable secret scanning\n      status = \"enabled\"       # Turns on secret scanning for the repository\n    }\n  }\n}\n```"
    },
    "Recommendation": {
      "Text": "Enable **secret scanning** (and **push protection** where available) across repositories.\n- Store secrets in a dedicated **secrets manager**, never in code\n- Define custom patterns and enable generic detection for org-specific secrets\n- Rotate and revoke exposed credentials quickly\n- Enforce **least privilege** and add **defense-in-depth** monitoring",
      "Url": "https://hub.prowler.com/check/repository_secret_scanning_enabled"
    }
  },
  "Categories": [
    "secrets"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
