{
  "Provider": "azure",
  "CheckID": "postgresql_flexible_server_log_connections_on",
  "CheckTitle": "PostgreSQL flexible server has log_connections enabled",
  "CheckType": [],
  "ServiceName": "postgresql",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "microsoft.dbforpostgresql/flexibleservers",
  "ResourceGroup": "database",
  "Description": "**Azure Database for PostgreSQL Flexible Server** evaluates the `log_connections` setting that controls logging of client connection attempts and authentication results.\n\nThe finding indicates whether this parameter is set to `ON`.",
  "Risk": "Without **connection logging**, visibility of access attempts is lost, making **brute force** and **credential stuffing** harder to detect. This weakens **confidentiality** and **integrity**, hinders incident investigations, and can mask **lateral movement** or unauthorized data access.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://learn.microsoft.com/en-us/answers/questions/683954/log-connections-cannot-be-set-on-azure-postgresql",
    "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/PostgreSQL/log-connections.html",
    "https://learn.microsoft.com/en-us/azure/postgresql/security/security-audit?tabs=portal"
  ],
  "Remediation": {
    "Code": {
      "CLI": "",
      "NativeIaC": "",
      "Other": "1. Sign in to the Azure portal\n2. Go to: Azure Database for PostgreSQL > Flexible servers > select <example_resource_name>\n3. Under Settings, open Server parameters and search for \"log_connections\"\n4. Confirm the parameter shows Value: ON and is Read-only (no change required)",
      "Terraform": ""
    },
    "Recommendation": {
      "Text": "Set `log_connections` to `ON` and integrate logs with centralized monitoring. Define retention and alerts for abnormal patterns. Combine with **least privilege**, strong authentication, and network restrictions to deliver **defense in depth** and prevent unauthorized access.",
      "Url": "https://hub.prowler.com/check/postgresql_flexible_server_log_connections_on"
    }
  },
  "Categories": [
    "logging"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
