{
  "Provider": "m365",
  "CheckID": "teams_external_users_cannot_start_conversations",
  "CheckTitle": "External Teams users cannot start conversations",
  "CheckType": [],
  "ServiceName": "teams",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "",
  "Description": "**Teams external access** blocks conversation initiation from **unmanaged Teams accounts** when `AllowTeamsConsumerInbound=false`.",
  "Risk": "Permitting unmanaged externals to start chats enables **phishing**, **malware delivery**, and **social engineering**, leading to credential theft and data exfiltration. It also allows **user enumeration** and presence probing, aiding **account takeover** and lateral movement, impacting confidentiality and integrity.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://learn.microsoft.com/en-us/powershell/module/teams/set-cstenantfederationconfiguration?view=teams-ps",
    "https://admin.teams.microsoft.com/.",
    "https://learn.microsoft.com/en-us/microsoftteams/trusted-organizations-external-meetings-chat",
    "https://learn.microsoft.com/en-us/entra/architecture/9-secure-access-teams-sharepoint",
    "https://learn.microsoft.com/en-us/microsoftteams/communicate-with-users-from-other-organizations"
  ],
  "Remediation": {
    "Code": {
      "CLI": "Set-CsTenantFederationConfiguration -AllowTeamsConsumerInbound $false",
      "NativeIaC": "",
      "Other": "1. Sign in to the Teams admin center: https://admin.teams.microsoft.com/\n2. Go to Users > External access\n3. Under \"Teams accounts not managed by an organization\", clear the checkbox \"External users with Teams accounts not managed by an organization can contact users in my organization\"\n4. Click Save",
      "Terraform": ""
    },
    "Recommendation": {
      "Text": "Disable inbound initiation from unmanaged accounts (`AllowTeamsConsumerInbound=false`). If external collaboration is required, prefer **allowlists** for trusted domains and use **guest access** with **least privilege**. Apply **defense in depth**: conditional access, link/file scanning, user education, and monitor for anomalous external chats.",
      "Url": "https://hub.prowler.com/check/teams_external_users_cannot_start_conversations"
    }
  },
  "Categories": [
    "trust-boundaries",
    "e3"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
