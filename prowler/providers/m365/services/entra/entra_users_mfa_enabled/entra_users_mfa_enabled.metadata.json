{
  "Provider": "m365",
  "CheckID": "entra_users_mfa_enabled",
  "CheckTitle": "Multifactor authentication is enforced for all users",
  "CheckType": [],
  "ServiceName": "entra",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "critical",
  "ResourceType": "",
  "Description": "**Microsoft Entra Conditional Access** has an enforced policy requiring **multifactor authentication** for `All users` across `All cloud apps` *(not just report-only)*.",
  "Risk": "Lacking an enforced, tenant-wide **MFA** mandate enables single-factor sign-ins to M365 apps. Stolen or sprayed passwords can yield access, leading to data exfiltration, unauthorized changes, and outages. Report-only or scoped policies leave gaps that undermine confidentiality, integrity, and availability.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://www.linkedin.com/posts/rafa\u0142-fitt_conditions-in-conditional-access-policy-activity-7328448540760850432-6ker",
    "https://learn.microsoft.com/en-us/entra/identity/authentication/tutorial-enable-azure-mfa",
    "https://learn.microsoft.com/en-us/entra/identity/conditional-access/policy-all-users-mfa-strength",
    "https://docs.azure.cn/en-us/entra/identity/conditional-access/policy-guests-mfa-strength",
    "https://blog.admindroid.com/microsoft-security-defaults-vs-conditional-access-policies/",
    "https://covene.com/microsoft-entra-id-conditional-access-configuration/",
    "https://github.com/MicrosoftDocs/entra-docs/blob/main/docs/identity/conditional-access/policy-all-users-mfa-strength.md",
    "https://entra.microsoft.com."
  ],
  "Remediation": {
    "Code": {
      "CLI": "",
      "NativeIaC": "",
      "Other": "1. Sign in to Microsoft Entra admin center (https://entra.microsoft.com)\n2. Go to Protection > Conditional Access > Policies > Create new policy\n3. Users: Include > All users (do not add exclusions)\n4. Target resources: Resources (cloud apps) > Include > All resources (no exclusions)\n5. Access controls: Grant > Grant access > check Require multifactor authentication > Select\n6. Enable policy: On\n7. Create",
      "Terraform": "```hcl\nresource \"azuread_conditional_access_policy\" \"<example_resource_name>\" {\n  display_name = \"<example_resource_name>\"\n  state        = \"enabled\" # Critical: enforce policy (not report-only)\n\n  conditions {\n    users {\n      included_users = [\"All\"] # Critical: target all users\n    }\n    applications {\n      included_applications = [\"All\"] # Critical: target all cloud apps/resources\n    }\n  }\n\n  grant_controls {\n    built_in_controls = [\"mfa\"] # Critical: require multifactor authentication\n  }\n}\n```"
    },
    "Recommendation": {
      "Text": "Enforce a **Conditional Access** policy requiring **MFA** for `All users` and `All cloud apps`. Exclude only break-glass accounts, favor **phishing-resistant** or authenticator methods, and avoid long-term report-only. Monitor sign-ins, review coverage regularly, and apply **least privilege** and **zero trust** to minimize exceptions.",
      "Url": "https://hub.prowler.com/check/entra_users_mfa_enabled"
    }
  },
  "Categories": [
    "identity-access",
    "e3"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
