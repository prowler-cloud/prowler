{
  "Provider": "m365",
  "CheckID": "defenderxdr_privileged_user_exposed_credentials",
  "CheckTitle": "Defender XDR Exposure Management protects privileged users from credential exposure on vulnerable endpoints",
  "CheckType": [],
  "ServiceName": "defenderxdr",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "critical",
  "ResourceType": "Exposure Management",
  "ResourceGroup": "security",
  "Description": "Privileged users may have authentication artifacts (CLI secrets, cookies, tokens) exposed on endpoints with high risk scores. Defender XDR's Security Exposure Management detects when credentials from users with Entra ID privileged roles are present on vulnerable devices.",
  "Risk": "Exposed credentials on vulnerable endpoints enable **account takeover** through stolen tokens or cookies, **Conditional Access bypass** via primary refresh tokens, **lateral movement** to sensitive resources, and **persistence** until tokens are explicitly revoked.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://learn.microsoft.com/en-us/security-exposure-management/prerequisites",
    "https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-exposuregraphedges-table",
    "https://maester.dev/docs/tests/MT.1080"
  ],
  "Remediation": {
    "Code": {
      "CLI": "",
      "NativeIaC": "",
      "Other": "1. Navigate to Microsoft Defender portal at https://security.microsoft.com\n2. Go to **Exposure Management** > **Attack surface** > **Attack paths**\n3. Review the exposed credential findings for privileged users\n4. For each affected device, review the risk and exposure score in Device Inventory\n5. Remediate endpoint vulnerabilities and improve device security posture\n6. Revoke affected user sessions and rotate credentials\n7. Consider implementing Privileged Access Workstations (PAWs) for privileged users",
      "Terraform": ""
    },
    "Recommendation": {
      "Text": "Privileged users should only authenticate from secure, hardened devices with low exposure scores. Implement **Privileged Access Workstations (PAWs)** and enforce device compliance policies through Conditional Access to prevent credential exposure on vulnerable endpoints.",
      "Url": "https://hub.prowler.com/check/defenderxdr_privileged_user_exposed_credentials"
    }
  },
  "Categories": [
    "secrets",
    "identity-access",
    "e5"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": "This check requires Microsoft Defender XDR with Security Exposure Management enabled. The ThreatHunting.Read.All permission is required to query the ExposureGraphEdges table via the Advanced Hunting API."
}
