{
  "Provider": "m365",
  "CheckID": "defender_domain_dkim_enabled",
  "CheckTitle": "Exchange Online domain has DKIM enabled",
  "CheckType": [],
  "ServiceName": "defender",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "",
  "Description": "**Exchange Online domains** use **DKIM signing** for outbound mail. This evaluates each domain to confirm an active DKIM configuration so messages include a verifiable signature via the domain's DKIM selectors.",
  "Risk": "Without **DKIM**, recipients can't verify sender authenticity, enabling **domain spoofing** and **BEC phishing**.\n\nAttackers can impersonate trusted mail to steal credentials, deliver malware, and pivot internally, impacting **confidentiality** and **integrity**. Messages may also fail **DMARC** alignment, reducing deliverability and trust.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://www.tenable.com/audits/items/CIS_Microsoft_365_v1.4.0_E3_Level_1.audit:2555af4ce33dad1aeec6eb0988662416",
    "https://learn.microsoft.com/en-us/powershell/module/exchangepowershell/set-dkimsigningconfig?view=exchange-ps",
    "https://github.com/MicrosoftDocs/office-docs-powershell/blob/main/exchange/exchange-ps/exchange/New-DkimSigningConfig.md",
    "https://learn.microsoft.com/en-us/powershell/module/exchange/set-dkimsigningconfig?view=exchange-ps",
    "https://danielchronlund.com/2020/04/29/quickly-check-and-manage-your-exchange-online-dns-records-for-spf-dkim-and-dmarc-with-powershell/",
    "https://www.lunavi.com/blog/enable-dkim-in-exchange-online-protection",
    "https://www.alitajran.com/configure-dkim-record-for-office-365/",
    "https://security.microsoft.com/.",
    "https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/use-dkim-to-validate-outbound-email?view=o365-worldwide"
  ],
  "Remediation": {
    "Code": {
      "CLI": "Set-DkimSigningConfig -Identity <domainName> -Enabled $true",
      "NativeIaC": "",
      "Other": "1. Sign in to Microsoft 365 Defender: https://security.microsoft.com\n2. Go to Email & collaboration > Policies & rules > Threat policies > Email authentication settings > DKIM\n3. Select the domain and enable \"Sign messages for this domain with DKIM signatures\"\n4. If prompted for CNAMEs, publish the two records shown at your DNS provider, wait for DNS to update, then return and enable in step 3",
      "Terraform": ""
    },
    "Recommendation": {
      "Text": "- Enable **DKIM signing** for all sending domains and subdomains\n- Combine with **SPF** and **DMARC** to enforce alignment (defense in depth)\n- Apply **least privilege** to mail auth settings\n- Rotate DKIM keys regularly and monitor authentication results to detect anomalies",
      "Url": "https://hub.prowler.com/check/defender_domain_dkim_enabled"
    }
  },
  "Categories": [
    "email-security",
    "e3"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
