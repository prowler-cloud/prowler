{
  "Provider": "gcp",
  "CheckID": "cloudsql_instance_public_access",
  "CheckTitle": "Cloud SQL instance does not allow 0.0.0.0/0 in authorized networks",
  "CheckType": [],
  "ServiceName": "cloudsql",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "critical",
  "ResourceType": "sqladmin.googleapis.com/Instance",
  "Description": "**Cloud SQL authorized networks** are checked for the open CIDR `0.0.0.0/0` on instances using a public IP.\n\nThe finding flags configurations where a catch-all entry exists instead of specific client ranges.",
  "Risk": "Allowing `0.0.0.0/0` makes the database reachable from the Internet, degrading **confidentiality** and **availability**. Attackers can brute-force credentials, probe for vulnerable endpoints, exfiltrate data via unauthorized queries, and trigger resource exhaustion through automated scanning.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://www.trendmicro.com/trendaivisiononecloudriskmanagement/knowledge-base/gcp/CloudSQL/publicly-accessible-cloud-sql-instances.html",
    "https://cloud.google.com/sql/docs/mysql/connection-org-policy"
  ],
  "Remediation": {
    "Code": {
      "CLI": "gcloud sql instances patch <INSTANCE_NAME> --authorized-networks=\"\"",
      "NativeIaC": "",
      "Other": "1. In Google Cloud Console, go to SQL > Instances and select your instance\n2. Open the Connections tab\n3. Under Authorized networks, delete the entry 0.0.0.0/0\n4. Click Save",
      "Terraform": "```hcl\nresource \"google_sql_database_instance\" \"<example_resource_name>\" {\n  name             = \"<example_resource_name>\"\n  database_version = \"<DATABASE_VERSION>\"\n\n  settings {\n    tier = \"<TIER>\"\n\n    ip_configuration {\n      authorized_networks {\n        value = \"<ALLOWED_CIDR>\" # Critical: remove 0.0.0.0/0; allow only specific CIDR to pass the check\n      }\n    }\n  }\n}\n```"
    },
    "Recommendation": {
      "Text": "Enforce **least privilege** network access:\n- Remove `0.0.0.0/0`; allow only trusted, fixed IP ranges\n- Prefer **private IP** or **Private Service Connect** with VPC controls\n- Use proxied access (Cloud SQL Auth Proxy) over direct public connections\n- Apply org policies to prevent broad allowlists",
      "Url": "https://hub.prowler.com/check/cloudsql_instance_public_access"
    }
  },
  "Categories": [
    "internet-exposed"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
