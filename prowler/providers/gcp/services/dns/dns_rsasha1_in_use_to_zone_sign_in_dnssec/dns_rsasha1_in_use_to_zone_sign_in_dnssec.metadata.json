{
  "Provider": "gcp",
  "CheckID": "dns_rsasha1_in_use_to_zone_sign_in_dnssec",
  "CheckTitle": "Cloud DNS managed zone does not use the RSASHA1 algorithm for the DNSSEC zone-signing key",
  "CheckType": [],
  "ServiceName": "dns",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "dns.googleapis.com/ManagedZone",
  "Description": "**Cloud DNS** DNSSEC settings are inspected for the **zone-signing key algorithm**. Zones that use `rsasha1` for zone signing are identified.",
  "Risk": "Using **RSASHA1 for DNSSEC zone signing** weakens record integrity due to known **collision attacks**. Some validating resolvers no longer accept `SHA-1`, causing **resolution failures**. Adversaries may forge `RRSIGs`, enabling **DNS hijacking** or cache poisoning and redirecting traffic.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://www.trendmicro.com/trendaivisiononecloudriskmanagement/knowledge-base/gcp/CloudDNS/dns-sec-zone-signing-algorithm-in-use.html",
    "https://cloud.google.com/dns/docs/dnssec-config",
    "https://cloud-kb.sentinelone.com/dns-security-rsa-sha1-enabled",
    "https://datatracker.ietf.org/doc/html/rfc9905",
    "https://stackoverflow.com/questions/68968312/terraform-errors-deploying-google-dns-managed-zone-with-rsasha1",
    "https://docs.datadoghq.com/security/default_rules/def-000-jud/"
  ],
  "Remediation": {
    "Code": {
      "CLI": "",
      "NativeIaC": "",
      "Other": "1. In Google Cloud Console, go to Networking > Network services > Cloud DNS\n2. Click the managed zone name, then click Edit\n3. If DNSSEC is On and the Zone signing algorithm is RSASHA1: set DNSSEC to Off and Save\n4. Click Edit again, set DNSSEC to On\n5. Open Advanced settings, set Zone signing algorithm to ECDSAP256SHA256 (or RSASHA256)\n6. Click Save",
      "Terraform": "```hcl\nresource \"google_dns_managed_zone\" \"<example_resource_name>\" {\n  name     = \"<example_resource_name>\"\n  dns_name = \"example.com.\"\n\n  dnssec_config {\n    state = \"on\"\n\n    default_key_specs {\n      algorithm = \"ecdsap256sha256\"  # FIX: use a secure algorithm for zone signing\n      key_type  = \"zoneSigning\"       # Ensures the zone-signing key is not RSASHA1\n    }\n  }\n}\n```"
    },
    "Recommendation": {
      "Text": "Use **strong DNSSEC algorithms** for zone signing (e.g., `rsasha256`, `ecdsa-p256-sha256`, `ed25519`) and avoid `rsasha1`. Practice **crypto agility**: standardize secure defaults, rotate keys, and periodically validate signatures with modern resolvers. Apply **defense in depth** by monitoring DNSSEC health and limiting who can change settings.",
      "Url": "https://hub.prowler.com/check/dns_rsasha1_in_use_to_zone_sign_in_dnssec"
    }
  },
  "Categories": [
    "vulnerabilities"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
