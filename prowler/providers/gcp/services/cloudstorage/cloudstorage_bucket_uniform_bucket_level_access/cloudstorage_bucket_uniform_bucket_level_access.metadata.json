{
  "Provider": "gcp",
  "CheckID": "cloudstorage_bucket_uniform_bucket_level_access",
  "CheckTitle": "Cloud Storage bucket has uniform bucket-level access enabled",
  "CheckType": [],
  "ServiceName": "cloudstorage",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "storage.googleapis.com/Bucket",
  "ResourceGroup": "storage",
  "Description": "Cloud Storage buckets have **uniform bucket-level access (UBLA)** enabled so object permissions are controlled solely by **bucket-level IAM**, with object ACLs disabled.",
  "Risk": "Without **UBLA**, object ACLs can bypass bucket IAM, enabling unintended public reads or unauthorized writes. This threatens **confidentiality** through data exposure, undermines **integrity** via object tampering, and reduces **auditability** with fragmented, hard-to-review permissions.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://www.trendmicro.com/trendaivisiononecloudriskmanagement/knowledge-base/gcp/CloudStorage/enable-uniform-bucket-level-access.html",
    "https://docs.cloud.google.com/storage/docs/using-uniform-bucket-level-access",
    "https://docs.cloud.google.com/storage/docs/public-access-prevention",
    "https://docs.cloud.google.com/storage/docs/access-control/iam"
  ],
  "Remediation": {
    "Code": {
      "CLI": "gcloud storage buckets update gs://<example_resource_name> --uniform-bucket-level-access",
      "NativeIaC": "",
      "Other": "1. In Google Cloud Console, go to Storage > Buckets\n2. Click the bucket name (<example_resource_name>)\n3. Open the Permissions tab (or Configuration if shown)\n4. In Access control, select Uniform and click Save",
      "Terraform": "```hcl\nresource \"google_storage_bucket\" \"<example_resource_name>\" {\n  name     = \"<example_resource_name>\"\n  location = \"<LOCATION>\"\n\n  uniform_bucket_level_access = true # Critical: enables UBLA so the bucket passes the check\n}\n```"
    },
    "Recommendation": {
      "Text": "Enable **UBLA** on all buckets to centralize authorization and apply **least privilege** with IAM. Eliminate reliance on object ACLs; use **Public Access Prevention** and **organization policies** to enforce non-public defaults. Monitor access with logs and periodic reviews as part of **defense in depth**.",
      "Url": "https://hub.prowler.com/check/cloudstorage_bucket_uniform_bucket_level_access"
    }
  },
  "Categories": [
    "identity-access"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
