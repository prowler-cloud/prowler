{
  "Provider": "gcp",
  "CheckID": "iam_service_account_unused",
  "CheckTitle": "Service account was used within the configured maximum unused period",
  "CheckType": [],
  "ServiceName": "iam",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "iam.googleapis.com/ServiceAccount",
  "Description": "Google Cloud service accounts are evaluated for **recent usage** within a configurable window (default `180` days) using usage telemetry.\n\nIt highlights which accounts show activity versus those with **no observed use** in that period.",
  "Risk": "Dormant but permissioned service accounts threaten **confidentiality** and **integrity** via:\n- **Impersonation/privilege escalation** through stale roles or leaked keys\n- **Lateral movement** and persistent access\nThey also weaken **accountability**, obscuring audit trails when reactivated unnoticed.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://cloud.google.com/iam/docs/best-practices-service-accounts?ref=alphasec.io",
    "https://cloud.google.com/iam/docs/service-account-overview#identify-unused"
  ],
  "Remediation": {
    "Code": {
      "CLI": "gcloud auth print-access-token --impersonate-service-account=<SERVICE_ACCOUNT_EMAIL>",
      "NativeIaC": "",
      "Other": "1. In the Google Cloud console, open the IAM Service Account Credentials API reference for \"GenerateAccessToken\" and click \"Try this method\" (APIs Explorer)\n2. Set name to: projects/-/serviceAccounts/<SERVICE_ACCOUNT_EMAIL>\n3. Add scope: https://www.googleapis.com/auth/cloud-platform\n4. Click Execute (use an identity with roles/iam.serviceAccountTokenCreator on the service account)\n5. The generated token records recent usage for the service account, changing the finding to PASS",
      "Terraform": ""
    },
    "Recommendation": {
      "Text": "Apply **least privilege** and **reduce attack surface**:\n- Verify inactivity, then *disable* and later delete unused accounts\n- Revoke role bindings and keys; favor short-lived impersonation over keys\n- Avoid powerful defaults; enforce separation of duties\n- Continuously monitor usage and alert on dormancy",
      "Url": "https://hub.prowler.com/check/iam_service_account_unused"
    }
  },
  "Categories": [
    "identity-access"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
