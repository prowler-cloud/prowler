{
  "Provider": "gcp",
  "CheckID": "compute_configuration_changes",
  "CheckTitle": "Compute Engine resource has no recent configuration changes in audit logs",
  "CheckType": [],
  "ServiceName": "compute",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "low",
  "ResourceType": "compute.googleapis.com/Instance",
  "ResourceGroup": "monitoring",
  "Description": "This check examines Cloud Audit Logs for recent Compute Engine configuration changes. It surfaces modifications to instance settings, disks, and networks within a configurable lookback window so operators can review unexpected changes.",
  "Risk": "Unreviewed Compute Engine configuration changes may indicate:\n\n- **Unauthorized access** - Malicious actors modifying resources\n- **Lateral movement** - Attackers expanding their foothold\n- **Security policy violations** - Unapproved changes bypassing change management\n\nWithout monitoring, unexpected changes could compromise security posture.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://www.trendmicro.com/cloudoneconformity/knowledge-base/gcp/ComputeEngine/gcp-compute-engine-configuration-changes.html",
    "https://cloud.google.com/logging/docs/audit"
  ],
  "Remediation": {
    "Code": {
      "CLI": "gcloud logging read 'protoPayload.serviceName=\"compute.googleapis.com\" AND logName:\"cloudaudit.googleapis.com%2Factivity\"' --project=PROJECT_ID --limit=100 --format=json",
      "NativeIaC": "",
      "Other": "1. Navigate to **Cloud Logging** in the GCP Console\n2. Select **Logs Explorer**\n3. Filter logs with: `protoPayload.serviceName=\"compute.googleapis.com\"`\n4. Review the Admin Activity logs for unexpected changes\n5. Investigate any unauthorized modifications",
      "Terraform": ""
    },
    "Recommendation": {
      "Text": "Apply the **Principle of Least Privilege** to limit who can modify Compute Engine resources. Configure Cloud Monitoring alerts for configuration changes and establish a formal change management process to review all modifications.",
      "Url": "https://hub.prowler.com/check/compute_configuration_changes"
    }
  },
  "Categories": [
    "logging"
  ],
  "DependsOn": [],
  "RelatedTo": [
    "logging_log_metric_filter_and_alert_for_audit_configuration_changes_enabled"
  ],
  "Notes": "This check requires Cloud Audit Logs to be enabled. The lookback window is configurable via the `compute_audit_log_lookback_days` parameter in the configuration file (default: 1 day)."
}
