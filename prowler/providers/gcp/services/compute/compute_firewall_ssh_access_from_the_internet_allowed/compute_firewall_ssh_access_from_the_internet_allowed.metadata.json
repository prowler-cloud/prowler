{
  "Provider": "gcp",
  "CheckID": "compute_firewall_ssh_access_from_the_internet_allowed",
  "CheckTitle": "Firewall does not expose TCP port 22 (SSH) to the Internet",
  "CheckType": [],
  "ServiceName": "compute",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "critical",
  "ResourceType": "compute.googleapis.com/Firewall",
  "Description": "**VPC firewall rules** allowing Internet-sourced **ingress** (`0.0.0.0/0`) to `TCP port 22 (SSH)` are identified, including rules using protocol `all` or `tcp` whose ports or ranges include `22`.",
  "Risk": "Exposed **SSH (22)** enables Internet-wide scanning, **brute force** and **credential stuffing**. Compromise can yield shell access for **data exfiltration**, command execution, and **lateral movement**, undermining **confidentiality** and **integrity**, and risking **availability** through abuse or lockouts.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://cloud.google.com/vpc/docs/using-firewalls",
    "https://www.trendmicro.com/trendaivisiononecloudriskmanagement/knowledge-base/gcp/CloudVPC/unrestricted-ssh-access.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "gcloud compute firewall-rules update <example_resource_name> --source-ranges=<TRUSTED_CIDR>",
      "NativeIaC": "",
      "Other": "1. In Google Cloud Console, go to Networking > VPC network > Firewall\n2. Locate the INGRESS rule that allows tcp:22 with Source IPv4 ranges set to 0.0.0.0/0 and open it\n3. Click Edit\n4. Replace Source IPv4 ranges from 0.0.0.0/0 to your trusted CIDR (e.g., <TRUSTED_CIDR>)\n5. Click Save",
      "Terraform": "```hcl\nresource \"google_compute_firewall\" \"<example_resource_name>\" {\n  name    = \"<example_resource_name>\"\n  network = \"<example_resource_id>\"\n\n  source_ranges = [\"<TRUSTED_CIDR>\"] # Critical: removes 0.0.0.0/0 to stop exposing SSH to the Internet\n\n  allow {\n    protocol = \"tcp\"           # Critical: limit to SSH only\n    ports    = [\"22\"]\n  }\n}\n```"
    },
    "Recommendation": {
      "Text": "Restrict **SSH** to trusted sources; avoid `0.0.0.0/0`. Prefer **bastion hosts** or **IAP TCP forwarding**, or use **VPN/peering**. Enforce **least privilege** and **defense in depth**: limit to required CIDRs, use **key-based auth**, disable `PasswordAuthentication`, and monitor/alert on access attempts.",
      "Url": "https://hub.prowler.com/check/compute_firewall_ssh_access_from_the_internet_allowed"
    }
  },
  "Categories": [
    "internet-exposed"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
