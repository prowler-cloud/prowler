{
  "Provider": "gcp",
  "CheckID": "compute_instance_public_ip",
  "CheckTitle": "VM instance does not have a public IP address",
  "CheckType": [],
  "ServiceName": "compute",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "compute.googleapis.com/Instance",
  "Description": "**Compute Engine VM instances** with an assigned **external (public) IP address** on any network interface are identified.\n\nInstances without an external IP are considered internal-only.",
  "Risk": "**Internet-exposed VMs** face automated scanning, **brute force**, and **remote exploit** attempts.\n\nCompromise can enable **data exfiltration**, **service account abuse**, and **lateral movement** within the VPC, while public endpoints invite **DDoS**, degrading availability.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://cloud.google.com/compute/docs/instances/connecting-to-instance"
  ],
  "Remediation": {
    "Code": {
      "CLI": "gcloud compute instances delete-access-config <example_resource_name> --access-config-name=\"External NAT\" --zone=<example_resource_zone>",
      "NativeIaC": "",
      "Other": "1. In Google Cloud Console, go to Compute Engine > VM instances\n2. Click the VM name\n3. Click Edit\n4. Under Network interfaces, set External IP to None\n5. Click Save",
      "Terraform": "```hcl\nresource \"google_compute_instance\" \"<example_resource_name>\" {\n  name         = \"<example_resource_name>\"\n  machine_type = \"e2-micro\"\n  zone         = \"<example_resource_zone>\"\n\n  boot_disk {\n    initialize_params { image = \"debian-cloud/debian-11\" }\n  }\n\n  network_interface {\n    network = \"default\" # Critical: no access_config block -> no public IP\n  }\n}\n```"
    },
    "Recommendation": {
      "Text": "Adopt **private-only VMs** and remove external IPs.\n- Place workloads behind **load balancers** or **reverse proxies**\n- Use **Cloud NAT** for egress; admin access via **IAP**, **VPN**, or a hardened **bastion**\n- Apply **least privilege** firewall rules and network segmentation for **defense in depth**",
      "Url": "https://hub.prowler.com/check/compute_instance_public_ip"
    }
  },
  "Categories": [
    "internet-exposed"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
