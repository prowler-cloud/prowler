{
  "Provider": "gcp",
  "CheckID": "compute_firewall_rdp_access_from_the_internet_allowed",
  "CheckTitle": "Firewall rule does not allow ingress from 0.0.0.0/0 to TCP port 3389 (RDP)",
  "CheckType": [],
  "ServiceName": "compute",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "critical",
  "ResourceType": "compute.googleapis.com/Firewall",
  "Description": "**VPC firewall rules** permitting inbound **RDP** (`TCP 3389`) from `0.0.0.0/0` are flagged, including ingress rules that allow all TCP ports or `all` protocols",
  "Risk": "Exposed **RDP** enables Internet-wide scanning and **brute force**. Exploits can yield **remote code execution**, followed by **lateral movement** and data theft.\n\nThis endangers **confidentiality**, **integrity**, and **availability** (e.g., ransomware, service disruption).",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://cloud.google.com/vpc/docs/using-firewalls",
    "https://www.trendmicro.com/trendaivisiononecloudriskmanagement/knowledge-base/gcp/CloudVPC/unrestricted-rdp-access.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "gcloud compute firewall-rules delete <FIREWALL_RULE_NAME>",
      "NativeIaC": "",
      "Other": "1. In Google Cloud Console, go to Networking > VPC network > Firewall.\n2. Find the ingress rule that allows TCP port 3389 with Source IPv4 ranges set to 0.0.0.0/0.\n3. Select the rule and click Delete, then confirm.",
      "Terraform": "```hcl\nresource \"google_compute_firewall\" \"<example_resource_name>\" {\n  name    = \"<example_resource_name>\"\n  network = \"<example_resource_id>\"\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"3389\"]\n  }\n\n  source_ranges = [\"10.0.0.0/8\"] # CRITICAL: removes 0.0.0.0/0 so RDP is not exposed to the Internet\n}\n```"
    },
    "Recommendation": {
      "Text": "Restrict **RDP** to trusted IP ranges or a hardened **bastion/IAP** proxy; prefer private access with no public IPs. Apply **least privilege** and network segmentation, use just-in-time access and strong authentication, and monitor logs. Aim for **defense in depth** to minimize exposure.",
      "Url": "https://hub.prowler.com/check/compute_firewall_rdp_access_from_the_internet_allowed"
    }
  },
  "Categories": [
    "internet-exposed"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
