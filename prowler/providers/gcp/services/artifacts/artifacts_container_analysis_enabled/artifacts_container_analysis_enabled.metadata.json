{
  "Provider": "gcp",
  "CheckID": "artifacts_container_analysis_enabled",
  "CheckTitle": "GCP project has Artifact Registry Container Analysis API enabled",
  "CheckType": [],
  "ServiceName": "artifacts",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "serviceusage.googleapis.com/Service",
  "Description": "Evaluates whether **Artifact Analysis** (`containeranalysis.googleapis.com`) is enabled at the project level to support **vulnerability scanning** and metadata for container images in Artifact Registry or Container Registry.",
  "Risk": "Absent this service, images aren't continuously scanned, leaving known CVEs unnoticed. Attackers can run vulnerable containers, gain code execution, move laterally, and exfiltrate data, eroding the **integrity** and **confidentiality** of workloads and the software supply chain.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://cloud.google.com/artifact-analysis/docs",
    "https://cloud.google.com/artifact-analysis/docs/container-scanning-overview"
  ],
  "Remediation": {
    "Code": {
      "CLI": "gcloud services enable containeranalysis.googleapis.com --project <PROJECT_ID>",
      "NativeIaC": "",
      "Other": "1. In Google Cloud Console, ensure the correct project is selected\n2. Go to APIs & Services > Library\n3. Search for \"Container Analysis API\"\n4. Click the API, then click \"Enable\"",
      "Terraform": "```hcl\nresource \"google_project_service\" \"<example_resource_name>\" {\n  project = \"<example_project_id>\"\n  service = \"containeranalysis.googleapis.com\" # Enables Artifact Analysis (Container Analysis) API to pass the check\n}\n```"
    },
    "Recommendation": {
      "Text": "Enable **Artifact Analysis** (`containeranalysis.googleapis.com`) for projects hosting container images. Integrate scan results into CI/CD policy gates, apply **least privilege** to findings access, and rebuild images promptly to maintain **defense in depth**.",
      "Url": "https://hub.prowler.com/check/artifacts_container_analysis_enabled"
    }
  },
  "Categories": [],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": "By default, AR Container Analysis is disabled."
}
