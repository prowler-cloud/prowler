{
  "Provider": "aws",
  "CheckID": "datasync_task_logging_enabled",
  "CheckTitle": "DataSync task has CloudWatch Logs log group configured for logging",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices"
  ],
  "ServiceName": "datasync",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "Other",
  "Description": "**AWS DataSync tasks** are evaluated for a configured **CloudWatch Logs** destination (`CloudWatchLogGroupArn`).\n\nTasks that specify a log group are recognized as logging-enabled; those without one are identified as not publishing execution events.",
  "Risk": "**Absent DataSync task logs** create blind spots, preventing timely detection of **failed or partial transfers**, unexpected deletions, or anomalies. This undermines data **integrity** verification, obscures potential **exfiltration** indicators, and slows forensics and recovery, reducing **availability** during incidents.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://support.icompaas.com/support/solutions/articles/62000233637-ensure-datasync-tasks-should-have-logging-enabled",
    "https://docs.aws.amazon.com/datasync/latest/userguide/monitor-datasync.html#enable-logging",
    "https://sudoconsultants.com/aws-datasync-accelerating-data-transfer-for-software-and-hardware-teams/",
    "https://github.com/terraform-providers/terraform-provider-aws/issues/14666",
    "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/datasync_task",
    "https://github.com/terraform-providers/terraform-provider-aws/issues/13046",
    "https://www.datacamp.com/tutorial/aws-datasync"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws datasync update-task --task-arn <task-arn> --cloud-watch-log-group-arn <log-group-arn>",
      "NativeIaC": "```yaml\n# CloudFormation: Enable CloudWatch Logs for a DataSync task\nResources:\n  <example_resource_name>:\n    Type: AWS::DataSync::Task\n    Properties:\n      SourceLocationArn: <example_source_location_arn>\n      DestinationLocationArn: <example_destination_location_arn>\n      CloudWatchLogGroupArn: <example_log_group_arn>  # Critical: attaches a CloudWatch Logs group to enable task logging\n```",
      "Other": "1. In the AWS Console, go to DataSync > Tasks\n2. Select the task and click Edit\n3. In the Logging section, set CloudWatch Log group to an existing log group\n4. Click Save",
      "Terraform": "```hcl\n# Enable CloudWatch Logs for a DataSync task\nresource \"aws_datasync_task\" \"<example_resource_name>\" {\n  source_location_arn      = \"<example_source_location_arn>\"\n  destination_location_arn = \"<example_destination_location_arn>\"\n  cloudwatch_log_group_arn = \"<example_log_group_arn>\"  # Critical: attaches a CloudWatch Logs group to enable task logging\n}\n```"
    },
    "Recommendation": {
      "Text": "Configure each task to publish logs to a dedicated CloudWatch Logs group. Select an appropriate log level (e.g., `BASIC` or `TRANSFER`), enforce **least privilege** for log access, set **retention** and immutability, and integrate alerts. Centralize and monitor logs to support **defense in depth** and incident response.",
      "Url": "https://hub.prowler.com/check/datasync_task_logging_enabled"
    }
  },
  "Categories": [
    "logging"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
