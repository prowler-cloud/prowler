{
  "Provider": "aws",
  "CheckID": "dms_endpoint_mongodb_authentication_enabled",
  "CheckTitle": "DMS MongoDB endpoint has an authentication mechanism enabled",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "TTPs/Initial Access/Unauthorized Access",
    "Effects/Data Exposure"
  ],
  "ServiceName": "dms",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "AwsDmsEndpoint",
  "Description": "**AWS DMS MongoDB endpoints** use an authentication mechanism. Configuration expects `AuthType` not `no` (e.g., `password`) with an `authMechanism` such as `scram_sha_1` or `mongodb_cr`.",
  "Risk": "Without authentication, unauthenticated connections can access the source, degrading **confidentiality** and **integrity**. Adversaries could read or modify migrated documents, hijack CDC, inject data, or exfiltrate records during replication.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://construct-hub-testing.dev-tools.aws.dev/packages/@aws-cdk/aws-dms/v/1.204.0/api/MongoDbSettingsProperty?lang=typescript",
    "https://docs.aws.amazon.com/dms/latest/userguide/CHAP_Source.MongoDB.html",
    "https://docs.aws.amazon.com/securityhub/latest/userguide/dms-controls.html#dms-11",
    "https://sdk.amazonaws.com/java/api/2.28.24/software/amazon/awssdk/services/databasemigration/model/MongoDbSettings.html",
    "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dms_endpoint",
    "https://www.pulumi.com/registry/packages/aws/api-docs/dms/endpoint/",
    "https://sdk.amazonaws.com/java/api/latest/software/amazon/awssdk/services/databasemigration/model/MongoDbSettings.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws dms modify-endpoint --endpoint-arn <endpoint-arn> --mongodb-settings '{\"AuthType\":\"password\"}' --username <username> --password <password>",
      "NativeIaC": "```yaml\n# CloudFormation: enable authentication on a MongoDB DMS endpoint\nResources:\n  <example_resource_name>:\n    Type: AWS::DMS::Endpoint\n    Properties:\n      EndpointIdentifier: <example_resource_name>\n      EndpointType: source\n      EngineName: mongodb\n      MongoDbSettings:\n        AuthType: password  # CRITICAL: sets authentication mode to 'password' so auth is enabled\n```",
      "Other": "1. In the AWS Console, go to Database Migration Service > Endpoints\n2. Select the MongoDB endpoint and click Modify\n3. Under MongoDB settings, set Authentication mode to Password\n4. Enter Username and Password\n5. Click Save changes",
      "Terraform": "```hcl\n# Terraform: enable authentication on a MongoDB DMS endpoint\nresource \"aws_dms_endpoint\" \"<example_resource_name>\" {\n  endpoint_id   = \"<example_resource_name>\"\n  endpoint_type = \"source\"\n  engine_name   = \"mongodb\"\n\n  mongodb_settings {\n    auth_type = \"password\"  # CRITICAL: enables authentication for the MongoDB endpoint\n  }\n}\n```"
    },
    "Recommendation": {
      "Text": "Enforce **strong authentication** on MongoDB endpoints: set `AuthType` to `password` and use `authMechanism` like `scram_sha_1`. Apply **least privilege** database accounts, store secrets in **Secrets Manager**, and pair with **TLS** for defense in depth.",
      "Url": "https://hub.prowler.com/check/dms_endpoint_mongodb_authentication_enabled"
    }
  },
  "Categories": [
    "identity-access"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
