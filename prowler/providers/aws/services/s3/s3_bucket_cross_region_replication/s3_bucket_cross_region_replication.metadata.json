{
  "Provider": "aws",
  "CheckID": "s3_bucket_cross_region_replication",
  "CheckTitle": "S3 bucket has cross-region replication configured to a bucket in a different region",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Effects/Data Destruction"
  ],
  "ServiceName": "s3",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "low",
  "ResourceType": "AwsS3Bucket",
  "ResourceGroup": "storage",
  "Description": "**Amazon S3 buckets** use **cross-Region replication** with `versioning` and an enabled rule that targets a destination bucket in a different AWS Region.\n\nBuckets with same-Region targets, missing destinations, or disabled `versioning` don't meet this replication posture.",
  "Risk": "**Single-Region storage** creates an availability gap: a Regional outage, control-plane isolation, or denial of service can make data **unreachable**.\n\nLack of replication raises RPO/RTO, delaying recovery and disrupting multi-Region workloads. Missing replicas also weaken data **integrity** during restore from corruption or deletion.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/securityhub/latest/userguide/s3-controls.html#s3-7",
    "https://docs.aws.amazon.com/AmazonS3/latest/userguide/replication.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "",
      "NativeIaC": "```yaml\n# CloudFormation: Enable versioning and CRR to a bucket in another region\nResources:\n  ExampleBucket:\n    Type: AWS::S3::Bucket\n    Properties:\n      VersioningConfiguration:\n        Status: Enabled  # critical: enables versioning (required for replication)\n      ReplicationConfiguration:  # critical: enables cross-Region replication\n        Role: !GetAtt ReplicationRole.Arn\n        Rules:\n          - Status: Enabled  # critical: replication rule must be enabled\n            Destination:\n              Bucket: arn:aws:s3:::<example_destination_bucket_name>  # critical: destination bucket ARN in a different region\n\n  ReplicationRole:\n    Type: AWS::IAM::Role\n    Properties:\n      AssumeRolePolicyDocument:\n        Version: '2012-10-17'\n        Statement:\n          - Effect: Allow\n            Principal:\n              Service: s3.amazonaws.com\n            Action: sts:AssumeRole\n      Policies:\n        - PolicyName: s3-replication-minimal\n          PolicyDocument:\n            Version: '2012-10-17'\n            Statement:\n              - Effect: Allow\n                Action:\n                  - s3:ListBucket\n                  - s3:GetReplicationConfiguration\n                Resource: !Sub arn:aws:s3:::${ExampleBucket}\n              - Effect: Allow\n                Action:\n                  - s3:GetObjectVersionForReplication\n                  - s3:GetObjectVersionAcl\n                  - s3:GetObjectVersionTagging\n                Resource: !Sub arn:aws:s3:::${ExampleBucket}/*\n              - Effect: Allow\n                Action:\n                  - s3:ReplicateObject\n                  - s3:ReplicateDelete\n                  - s3:ReplicateTags\n                Resource: arn:aws:s3:::<example_destination_bucket_name>/*\n```",
      "Other": "1. In the S3 console, open the source bucket\n2. Go to Properties > Bucket Versioning and click Enable\n3. Go to Management > Replication rules > Create replication rule\n4. Scope: Apply to all objects in the bucket\n5. Destination: Select a bucket in a different AWS Region\n6. Status: Ensure Enabled is selected\n7. IAM role: Choose Create new role (recommended)\n8. Save the rule",
      "Terraform": "```hcl\n# Enable versioning and minimal CRR to a bucket in another region\nresource \"aws_s3_bucket\" \"source\" {\n  bucket = \"<example_resource_name>\"\n\n  versioning {                      \n    enabled = true  # critical: required for replication\n  }\n\n  replication_configuration {        \n    role = aws_iam_role.replication.arn  # critical: role used by S3 to replicate\n\n    rules {\n      status = \"Enabled\"  # critical: replication rule must be enabled\n      destination {\n        bucket = \"arn:aws:s3:::<example_destination_bucket_name>\"  # critical: destination bucket ARN in a different region\n      }\n    }\n  }\n}\n\nresource \"aws_iam_role\" \"replication\" {\n  name = \"<example_resource_name>-s3-replication-role\"\n  assume_role_policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [{\n      Effect    = \"Allow\"\n      Principal = { Service = \"s3.amazonaws.com\" }\n      Action    = \"sts:AssumeRole\"\n    }]\n  })\n}\n\nresource \"aws_iam_role_policy\" \"replication\" {\n  name = \"<example_resource_name>-s3-replication-policy\"\n  role = aws_iam_role.replication.id\n  policy = jsonencode({\n    Version = \"2012-10-17\",\n    Statement = [\n      {\n        Effect = \"Allow\",\n        Action = [\"s3:ListBucket\", \"s3:GetReplicationConfiguration\"],\n        Resource = \"arn:aws:s3:::${aws_s3_bucket.source.bucket}\"\n      },\n      {\n        Effect = \"Allow\",\n        Action = [\n          \"s3:GetObjectVersionForReplication\",\n          \"s3:GetObjectVersionAcl\",\n          \"s3:GetObjectVersionTagging\"\n        ],\n        Resource = \"arn:aws:s3:::${aws_s3_bucket.source.bucket}/*\"\n      },\n      {\n        Effect = \"Allow\",\n        Action = [\"s3:ReplicateObject\", \"s3:ReplicateDelete\", \"s3:ReplicateTags\"],\n        Resource = \"arn:aws:s3:::<example_destination_bucket_name>/*\"\n      }\n    ]\n  })\n}\n```"
    },
    "Recommendation": {
      "Text": "Enable **CRR** to a different Region with `versioning` and least-privilege roles.\n\n- Replicate needed prefixes and metadata\n- Consider `S3 Replication Time Control` for tighter RPO\n- Protect deletes via `delete marker` strategy and Object Lock\n- Monitor replication metrics and test DR regularly\n\nAlign with **defense in depth** and availability by design.",
      "Url": "https://hub.prowler.com/check/s3_bucket_cross_region_replication"
    }
  },
  "Categories": [
    "resilience"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
