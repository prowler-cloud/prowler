{
  "Provider": "aws",
  "CheckID": "s3_access_point_public_access_block",
  "CheckTitle": "S3 access point has all Block Public Access settings enabled",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices/Network Reachability",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark",
    "Effects/Data Exposure"
  ],
  "ServiceName": "s3",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "critical",
  "ResourceType": "AwsS3AccessPoint",
  "ResourceGroup": "storage",
  "Description": "**Amazon S3 access points** have **Block Public Access** configured with all settings enabled: `block_public_acls`, `ignore_public_acls`, `block_public_policy`, and `restrict_public_buckets`.\n\nThe evaluation inspects each access point's public access block configuration.",
  "Risk": "Without block public access on an access point, ACLs or policies can expose objects publicly despite intended restrictions. This enables unauthorized reads (**confidentiality** loss), writes or deletions (**integrity/availability** impact), and supports bulk data exfiltration or destructive actions.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/config/latest/developerguide/s3-access-point-public-access-blocks.html",
    "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-points.html#access-points-policies",
    "https://docs.aws.amazon.com/securityhub/latest/userguide/s3-controls.html#s3-19"
  ],
  "Remediation": {
    "Code": {
      "CLI": "",
      "NativeIaC": "```yaml\n# CloudFormation: S3 Access Point with all Block Public Access settings enabled\nResources:\n  <example_resource_name>:\n    Type: AWS::S3::AccessPoint\n    Properties:\n      Bucket: <example_bucket_name>\n      PublicAccessBlockConfiguration:\n        BlockPublicAcls: true        # Critical: block public ACLs\n        IgnorePublicAcls: true       # Critical: ignore any public ACLs\n        BlockPublicPolicy: true      # Critical: block public policies\n        RestrictPublicBuckets: true  # Critical: restrict public buckets\n```",
      "Other": "1. In the AWS console, go to S3 > Access points\n2. Select the noncompliant access point and click Delete access point\n3. Click Create access point, select the same bucket\n4. Ensure Block public access is enabled (all options On by default)\n5. Click Create access point",
      "Terraform": "```hcl\n# Terraform: S3 Access Point with all Block Public Access settings enabled\nresource \"aws_s3_access_point\" \"<example_resource_name>\" {\n  name   = \"<example_resource_name>\"\n  bucket = \"<example_bucket_name>\"\n\n  public_access_block_configuration {\n    block_public_acls       = true  # Critical: block public ACLs\n    ignore_public_acls      = true  # Critical: ignore any public ACLs\n    block_public_policy     = true  # Critical: block public policies\n    restrict_public_buckets = true  # Critical: restrict public buckets\n  }\n}\n```"
    },
    "Recommendation": {
      "Text": "Enable all access-point Block Public Access settings (`block_public_acls`, `ignore_public_acls`, `block_public_policy`, `restrict_public_buckets`).\n\nApply **least privilege**, prefer **VPC-only** access points, and layer account and bucket blocks for **defense in depth**. Regularly audit for public principals like `Principal: *`.",
      "Url": "https://hub.prowler.com/check/s3_access_point_public_access_block"
    }
  },
  "Categories": [
    "internet-exposed"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
