{
  "Provider": "aws",
  "CheckID": "s3_multi_region_access_point_public_access_block",
  "CheckTitle": "S3 Multi-Region Access Point has all Block Public Access settings enabled",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices/Network Reachability",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "Effects/Data Exposure"
  ],
  "ServiceName": "s3",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "AwsS3AccessPoint",
  "ResourceGroup": "storage",
  "Description": "**Amazon S3 Multi-Region Access Points** are evaluated for **Block Public Access** being fully enabled (`block_public_acls`, `ignore_public_acls`, `block_public_policy`, `restrict_public_buckets`).\n\nFocus is on the MRAP's own settings, separate from bucket or account configurations.",
  "Risk": "Without MRAP **Block Public Access**, the global endpoint can accept internet traffic, exposing linked buckets.\n\nThis undermines confidentiality (object listing/reads) and integrity (unauthorized writes or policy abuse), and can trigger costly egress and data tampering across Regions.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/AmazonS3/latest/userguide/multi-region-access-point-block-public-access.html",
    "https://aws.amazon.com/es/getting-started/hands-on/getting-started-with-amazon-s3-multi-region-access-points/",
    "https://docs.aws.amazon.com/securityhub/latest/userguide/s3-controls.html#s3-24"
  ],
  "Remediation": {
    "Code": {
      "CLI": "",
      "NativeIaC": "```yaml\n# CloudFormation: MRAP with Block Public Access enabled (cannot be changed after creation)\nResources:\n  <example_resource_name>:\n    Type: AWS::S3::MultiRegionAccessPoint\n    Properties:\n      Name: <example_resource_name>\n      PublicAccessBlockConfiguration:           # Critical: enable all Block Public Access settings\n        BlockPublicAcls: true                   # Critical: blocks ACLs granting public access\n        IgnorePublicAcls: true                  # Critical: ignores any public ACLs\n        BlockPublicPolicy: true                 # Critical: blocks public bucket policies\n        RestrictPublicBuckets: true             # Critical: restricts public bucket policies\n      Regions:\n        - Bucket: <example_bucket_name_1>\n        - Bucket: <example_bucket_name_2>\n```",
      "Other": "1. In the AWS Console, go to S3 > Multi-Region Access Points\n2. Select the failing Multi-Region Access Point and choose Delete (settings cannot be edited after creation)\n3. Click Create Multi-Region Access Point\n4. Enter a name and select at least two buckets in different Regions\n5. Ensure Block public access is enabled for all four settings (default): BlockPublicAcls, IgnorePublicAcls, BlockPublicPolicy, RestrictPublicBuckets\n6. Create the Multi-Region Access Point",
      "Terraform": "```hcl\n# Terraform: MRAP with Block Public Access enabled (must be set at creation)\nresource \"aws_s3control_multi_region_access_point\" \"<example_resource_name>\" {\n  account_id = \"<example_account_id>\"\n\n  details {\n    name = \"<example_resource_name>\"\n\n    public_access_block {                 # Critical: enable all Block Public Access settings\n      block_public_acls       = true      # Critical\n      ignore_public_acls      = true      # Critical\n      block_public_policy     = true      # Critical\n      restrict_public_buckets = true      # Critical\n    }\n\n    region { bucket = \"<example_bucket_name_1>\" }\n    region { bucket = \"<example_bucket_name_2>\" }\n  }\n}\n```"
    },
    "Recommendation": {
      "Text": "Adopt **deny-by-default**: keep all MRAP **Block Public Access** settings enabled; avoid public ACLs or policies.\n- Enforce **least privilege**\n- Prefer private access (VPC endpoints)\n- Periodically review permissions and logs\n\n*MRAP public access settings are immutable after creation.*",
      "Url": "https://hub.prowler.com/check/s3_multi_region_access_point_public_access_block"
    }
  },
  "Categories": [
    "internet-exposed"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
