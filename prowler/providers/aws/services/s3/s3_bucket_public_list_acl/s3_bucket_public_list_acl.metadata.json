{
  "Provider": "aws",
  "CheckID": "s3_bucket_public_list_acl",
  "CheckTitle": "S3 bucket is not publicly listable by Everyone or any authenticated AWS user",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices/Network Reachability",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "Effects/Data Exposure",
    "TTPs/Initial Access/Unauthorized Access"
  ],
  "ServiceName": "s3",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "critical",
  "ResourceType": "AwsS3Bucket",
  "ResourceGroup": "storage",
  "Description": "**Amazon S3 buckets** are evaluated for **public listing via ACLs**. Grants of `READ`, `READ_ACP`, or `FULL_CONTROL` to the `AllUsers` or `AuthenticatedUsers` groups are identified. Effective **Block Public Access** at account or bucket level (notably `IgnorePublicAcls` and `RestrictPublicBuckets`) is considered in the evaluation.",
  "Risk": "**Public listability** reveals object names, counts, and structure, enabling reconnaissance and targeted scraping. `READ_ACP` exposes permission details for further abuse. With `FULL_CONTROL`, attackers could alter ACLs and disrupt access, undermining **confidentiality** and risking **integrity** and **availability**.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
    "https://www.trendmicro.com/trendaivisiononecloudriskmanagement-staging/knowledge-base/aws/S3/s3-bucket-public-read-access.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws s3api put-public-access-block --bucket <bucket_name> --public-access-block-configuration IgnorePublicAcls=true,RestrictPublicBuckets=true",
      "NativeIaC": "```yaml\n# CloudFormation: Block public listing via bucket-level Public Access Block\nResources:\n  ExamplePublicAccessBlock:\n    Type: AWS::S3::BucketPublicAccessBlock\n    Properties:\n      Bucket: \"<example_resource_name>\"\n      PublicAccessBlockConfiguration:\n        IgnorePublicAcls: true        # Critical: ignore any public ACLs so they don't grant list access\n        RestrictPublicBuckets: true   # Critical: restrict buckets with public policies to trusted principals\n```",
      "Other": "1. In the AWS Console, go to S3 and open the bucket\n2. Select the Permissions tab\n3. Click Edit under Block public access (bucket settings)\n4. Enable:\n   - Ignore public ACLs (bucket and objects)\n   - Restrict public buckets\n5. Click Save",
      "Terraform": "```hcl\n# Block public listing by enabling bucket-level Public Access Block\nresource \"aws_s3_bucket_public_access_block\" \"<example_resource_name>\" {\n  bucket                 = \"<example_resource_id>\"\n  ignore_public_acls     = true  # Critical: ignore any public ACLs\n  restrict_public_buckets = true # Critical: restrict buckets with public policies\n}\n```"
    },
    "Recommendation": {
      "Text": "Enable account-level **S3 Block Public Access** (`BlockPublicAcls`, `IgnorePublicAcls`, `BlockPublicPolicy`, `RestrictPublicBuckets`).\n- Remove ACL grants to `AllUsers`/`AuthenticatedUsers`; apply **least privilege** with IAM/bucket policies.\n- Favor private patterns (VPC endpoints, CloudFront OAC, presigned URLs) and disable ACLs via Object Ownership.",
      "Url": "https://hub.prowler.com/check/s3_bucket_public_list_acl"
    }
  },
  "Categories": [
    "internet-exposed"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
