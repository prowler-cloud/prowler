{
  "Provider": "aws",
  "CheckID": "s3_account_level_public_access_blocks",
  "CheckTitle": "S3 account-level Block Public Access ignores public ACLs and restricts public buckets",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark",
    "Effects/Data Exposure"
  ],
  "ServiceName": "s3",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "AwsS3AccountPublicAccessBlock",
  "ResourceGroup": "storage",
  "Description": "**Amazon S3** account-level **Block Public Access** is assessed for `ignore_public_acls` and `restrict_public_buckets` to confirm centralized blocking of ACL-based public access and limiting buckets with public policies to in-account principals.",
  "Risk": "Absent these settings, **public ACLs** and broad bucket policies may grant internet or cross-account access. This risks:\n- Confidentiality: bulk data exfiltration\n- Integrity: object overwrite/tampering\n- Availability: malicious deletions or malware hosting, triggering takedowns",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws s3control put-public-access-block --account-id <account_id> --public-access-block-configuration IgnorePublicAcls=true,RestrictPublicBuckets=true",
      "NativeIaC": "```yaml\n# CloudFormation: Enable required S3 Account-level Block Public Access settings\nResources:\n  <example_resource_name>:\n    Type: AWS::S3::AccountPublicAccessBlock\n    Properties:\n      AccountId: !Ref AWS::AccountId\n      IgnorePublicAcls: true         # Critical: Ignores any public ACLs at the account level\n      RestrictPublicBuckets: true    # Critical: Restricts buckets with public policies to only same-account principals\n```",
      "Other": "1. In the AWS Console, go to S3\n2. Click Block public access (account settings)\n3. Click Edit\n4. Turn on: Ignore public ACLs and Restrict public buckets\n5. Click Save changes",
      "Terraform": "```hcl\n# Terraform: Enable required S3 Account-level Block Public Access settings\nresource \"aws_s3_account_public_access_block\" \"<example_resource_name>\" {\n  ignore_public_acls     = true  # Critical: Ignores any public ACLs account-wide\n  restrict_public_buckets = true # Critical: Restricts buckets with public policies to same-account principals\n}\n```"
    },
    "Recommendation": {
      "Text": "Turn on account-level **Block Public Access** (prefer enabling all four: `block_public_acls`, `ignore_public_acls`, `block_public_policy`, `restrict_public_buckets`) to enforce least privilege. For legitimate access, use private buckets with **CloudFront**, VPC endpoints, or presigned URLs. Regularly review policies with IAM Access Analyzer.",
      "Url": "https://hub.prowler.com/check/s3_account_level_public_access_blocks"
    }
  },
  "Categories": [
    "internet-exposed"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
