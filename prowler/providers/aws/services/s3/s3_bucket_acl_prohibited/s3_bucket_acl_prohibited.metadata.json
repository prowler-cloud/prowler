{
  "Provider": "aws",
  "CheckID": "s3_bucket_acl_prohibited",
  "CheckTitle": "S3 bucket has bucket ACLs disabled",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark"
  ],
  "ServiceName": "s3",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "AwsS3Bucket",
  "ResourceGroup": "storage",
  "Description": "**Amazon S3 buckets** are evaluated for **Object Ownership** set to `BucketOwnerEnforced`, which disables bucket and object ACLs. Buckets using any other ownership setting indicate that ACLs remain enabled.",
  "Risk": "With **ACLs enabled**, access can bypass centralized policy controls, impacting confidentiality and integrity.\n- Unintended public or cross-account reads/writes\n- Object-writer ownership blocking bucket-owner governance\n- Per-object grants hinder auditing, enabling data exfiltration or tampering",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/AmazonS3/latest/userguide/about-object-ownership.html",
    "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ensure-object-ownership.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws s3api put-bucket-ownership-controls --bucket <bucket-name> --ownership-controls \"Rules=[{ObjectOwnership=BucketOwnerEnforced}]\"",
      "NativeIaC": "```yaml\n# CloudFormation: Disable ACLs by enforcing bucket owner for all objects\nResources:\n  <example_resource_name>OwnershipControls:\n    Type: AWS::S3::BucketOwnershipControls\n    Properties:\n      Bucket: <example_resource_name>\n      OwnershipControls:\n        Rules:\n          - ObjectOwnership: BucketOwnerEnforced  # Critical: Disables ACLs and makes bucket owner the object owner\n```",
      "Other": "1. In the AWS Console, go to S3 > Buckets and select the target bucket\n2. Open the Permissions tab\n3. In Object Ownership, click Edit\n4. Select Bucket owner enforced (ACLs disabled)\n5. Click Save changes",
      "Terraform": "```hcl\n# Disable ACLs by enforcing bucket owner for all objects\nresource \"aws_s3_bucket_ownership_controls\" \"<example_resource_name>\" {\n  bucket = \"<example_resource_id>\"\n  rule {\n    object_ownership = \"BucketOwnerEnforced\" # Critical: Disables ACLs and enforces bucket owner\n  }\n}\n```"
    },
    "Recommendation": {
      "Text": "Disable ACLs by setting **Object Ownership** to `BucketOwnerEnforced` and manage access with **IAM** and **bucket policies** under **least privilege**. Centralize authorization, review policies regularly, and use organizational guardrails to prevent re-enabling ACLs. *Migrate ACL-based grants into policies before the change.*",
      "Url": "https://hub.prowler.com/check/s3_bucket_acl_prohibited"
    }
  },
  "Categories": [
    "identity-access"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
