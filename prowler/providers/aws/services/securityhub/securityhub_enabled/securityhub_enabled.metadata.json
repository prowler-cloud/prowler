{
  "Provider": "aws",
  "CheckID": "securityhub_enabled",
  "CheckTitle": "Security Hub is enabled with standards or integrations configured",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards"
  ],
  "ServiceName": "securityhub",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "Other",
  "ResourceGroup": "security",
  "Description": "**AWS Security Hub** is `ACTIVE` in the Region and has at least one enabled **security standard** or connected **integration**. Otherwise, it is either not enabled or enabled without standards/integrations.",
  "Risk": "Absent **Security Hub coverage** or standards, security signals are fragmented and **control checks** don't run. High-risk findings can be missed or delayed, enabling data exfiltration, persistence, and lateral movement. This reduces **visibility** and undermines **confidentiality, integrity, and availability** across accounts/Regions.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-settingup.html",
    "https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-enable-disable.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "",
      "NativeIaC": "```yaml\n# CloudFormation: Enable Security Hub and at least one standard\nResources:\n  <example_resource_name>Hub:\n    Type: AWS::SecurityHub::Hub\n    # Critical: Enables Security Hub in this account/Region\n\n  <example_resource_name>Standard:\n    Type: AWS::SecurityHub::Standard\n    Properties:\n      StandardsArn: arn:aws:securityhub:<REGION>::standards/aws-foundational-security-best-practices/v/1.0.0  # Critical: enables a standard so the check passes\n```",
      "Other": "1. Open the AWS console and go to Security Hub\n2. If prompted (first use): click Enable Security Hub and keep the default standards selected, then choose Enable\n3. If Security Hub is already enabled: go to Security standards and enable AWS Foundational Security Best Practices\n4. Wait for the status to show Enabled",
      "Terraform": "```hcl\n# Enable Security Hub\nresource \"aws_securityhub_account\" \"<example_resource_name>\" {}\n\n# Critical: Enable at least one standard so the check passes\nresource \"aws_securityhub_standards_subscription\" \"<example_resource_name>_fsbp\" {\n  standards_arn = \"arn:aws:securityhub:<REGION>::standards/aws-foundational-security-best-practices/v/1.0.0\" # Enables AWS FSBP\n}\n```"
    },
    "Recommendation": {
      "Text": "- Enable in all required accounts/Regions\n- Turn on relevant **standards** (`AWS FSBP`, `CIS`)\n- Connect AWS and third-party **integrations**\n- Use **central configuration** and **least privilege**\n- Automate triage and monitor continuously for **defense in depth**",
      "Url": "https://hub.prowler.com/check/securityhub_enabled"
    }
  },
  "Categories": [],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
