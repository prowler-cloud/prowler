{
  "Provider": "aws",
  "CheckID": "iam_password_policy_reuse_24",
  "CheckTitle": "IAM password policy prevents reuse of the last 24 passwords",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark"
  ],
  "ServiceName": "iam",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "AwsIamPolicy",
  "ResourceGroup": "IAM",
  "Description": "**IAM account password policy** uses **password reuse prevention** set to `24` remembered passwords (maximum history) for IAM users",
  "Risk": "If fewer than `24` passwords are remembered, users can cycle back to recent secrets, undermining rotation. Attackers with previously exposed passwords can regain console access after a change, reducing **confidentiality** and **integrity** and increasing success of credential-stuffing with known credentials.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws iam update-account-password-policy --password-reuse-prevention 24",
      "NativeIaC": "```yaml\nResources:\n  <example_resource_name>:\n    Type: AWS::IAM::AccountPasswordPolicy\n    Properties:\n      PasswordReusePrevention: 24  # Critical: prevents reuse of the last 24 passwords\n```",
      "Other": "1. Open the AWS Management Console and go to IAM\n2. In the left menu, select Account settings\n3. In Password policy, click Edit\n4. Select Custom (if not already)\n5. Set Prevent password reuse to 24\n6. Click Save changes",
      "Terraform": "```hcl\nresource \"aws_iam_account_password_policy\" \"<example_resource_name>\" {\n  password_reuse_prevention = 24  # Critical: require last 24 passwords cannot be reused\n}\n```"
    },
    "Recommendation": {
      "Text": "Set the password policy to remember `24` previous passwords to block reuse. Combine with **MFA**, strong length and complexity, and avoid rotation practices that encourage predictable patterns. Apply **least privilege** and monitor authentication events as part of **defense in depth**.",
      "Url": "https://hub.prowler.com/check/iam_password_policy_reuse_24"
    }
  },
  "Categories": [
    "identity-access"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
