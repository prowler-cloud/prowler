{
  "Provider": "aws",
  "CheckID": "iam_rotate_access_key_90_days",
  "CheckTitle": "IAM user does not have active access keys older than 90 days",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark"
  ],
  "ServiceName": "iam",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "AwsIamUser",
  "ResourceGroup": "IAM",
  "Description": "**IAM user access keys** are assessed via the credential report. For each active key, the `last_rotated` timestamp is compared to `90 days`; keys exceeding this age are identified. Users without keys or with only recent rotations are noted.",
  "Risk": "Long-lived access keys widen the attack window. If a key is leaked in code, logs, or tooling, lack of rotation keeps it valid for abuse, enabling unauthorized API calls, data exfiltration, and tampering. This degrades **confidentiality** and **integrity** and can impact **availability** and cost through destructive or excessive operations.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_getting-report.html",
    "https://www.trendmicro.com/trendaivisiononecloudriskmanagement/knowledge-base/aws/IAM/access-keys-rotated-90-days.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws iam update-access-key --user-name <USER_NAME> --access-key-id <ACCESS_KEY_ID> --status Inactive",
      "NativeIaC": "",
      "Other": "1. Open the IAM console and go to Users\n2. Select the affected user\n3. Open the Security credentials tab\n4. Under Access keys, find any key older than 90 days\n5. Click Actions > Deactivate (or Delete) for that key\n6. Repeat for any other active keys older than 90 days",
      "Terraform": "```hcl\nresource \"aws_iam_access_key\" \"<example_resource_name>\" {\n  user   = \"<example_resource_name>\"\n  status = \"Inactive\" # Critical: disables the access key to ensure no active key is older than 90 days\n}\n```"
    },
    "Recommendation": {
      "Text": "Apply **least privilege** and limit static credentials:\n- Rotate active access keys at or before `90 days`\n- Prefer **IAM roles** with short-lived tokens\n- Maintain only one active key during rotation; delete the old one\n- Monitor `last_used` and remove dormant keys\n- Automate alerts and periodic reviews of key age",
      "Url": "https://hub.prowler.com/check/iam_rotate_access_key_90_days"
    }
  },
  "Categories": [
    "secrets"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
