{
  "Provider": "aws",
  "CheckID": "iam_customer_unattached_policy_no_administrative_privileges",
  "CheckTitle": "Unattached customer managed IAM policy does not allow '*:*' administrative privileges",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark",
    "TTPs/Privilege Escalation"
  ],
  "ServiceName": "iam",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "AwsIamPolicy",
  "ResourceGroup": "IAM",
  "Description": "**Customer-managed IAM policies** that are **unattached** are evaluated for statements granting **full administrative access** using `*:*` wildcards.\n\nThe focus is on policies whose documents include unrestricted actions on all resources.",
  "Risk": "An unattached policy with `*:*` can be attached accidentally or maliciously, granting account-wide control. Attackers could read sensitive data (**confidentiality**), alter or delete resources (**integrity**), and disrupt services (**availability**), enabling rapid **privilege escalation** and lateral movement.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html",
    "https://www.trendmicro.com/trendaivisiononecloudriskmanagement/knowledge-base/aws/IAM/iam-policy-for-administration.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws iam create-policy-version --policy-arn <example_resource_arn> --set-as-default --policy-document '{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Action\":\"iam:GetAccountSummary\",\"Resource\":\"*\"}]}'",
      "NativeIaC": "```yaml\n# CloudFormation: managed policy without administrative '*:*' privileges\nResources:\n  <example_resource_name>:\n    Type: AWS::IAM::ManagedPolicy\n    Properties:\n      PolicyDocument:\n        Version: '2012-10-17'\n        Statement:\n          - Effect: Allow\n            Action: iam:GetAccountSummary  # Critical: use a specific action instead of '*'\n            Resource: \"*\"                 # Critical: combined with specific action, avoids '*:*'\n```",
      "Other": "1. In the AWS Console, go to IAM > Policies\n2. Find the unattached customer managed policy and choose it\n3. Click Edit policy > JSON\n4. Remove any statement that allows Action \"*\" on Resource \"*\", or replace it with a specific action (e.g., \"iam:GetAccountSummary\")\n5. Save changes",
      "Terraform": "```hcl\n# IAM policy without '*:*' administrative privileges\nresource \"aws_iam_policy\" \"<example_resource_name>\" {\n  name   = \"<example_resource_name>\"\n  policy = jsonencode({\n    Version   = \"2012-10-17\"\n    Statement = [\n      {\n        Effect   = \"Allow\"\n        Action   = \"iam:GetAccountSummary\"   # Critical: specific action, not '*'\n        Resource = \"*\"                        # Critical: avoids '*:*' admin privileges\n      }\n    ]\n  })\n}\n```"
    },
    "Recommendation": {
      "Text": "Remove or redesign these policies to enforce **least privilege**:\n- Avoid `*` in actions/resources; scope precisely and use conditions\n- Apply **permissions boundaries** and **SCPs** as guardrails\n- Require peer review and policy validation before attachment\n- Use analysis tools to refine permissions and delete unused policies",
      "Url": "https://hub.prowler.com/check/iam_customer_unattached_policy_no_administrative_privileges"
    }
  },
  "Categories": [
    "identity-access"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": "CAF Security Epic: IAM"
}
