{
  "Provider": "aws",
  "CheckID": "iam_user_no_setup_initial_access_key",
  "CheckTitle": "IAM user does not have active access keys that have never been used",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark"
  ],
  "ServiceName": "iam",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "AwsIamUser",
  "ResourceGroup": "IAM",
  "Description": "**IAM users** with a console password and active **access keys** that have `last_used` as `N/A` are identified.\n\nThis highlights accounts where programmatic credentials exist but have never been exercised.",
  "Risk": "Active yet unused **access keys** expand the attack surface. If exposed, attackers gain programmatic access for unauthorized API calls, causing data exfiltration (**confidentiality**), unauthorized changes (**integrity**), and service disruption (**availability**). Dormant keys also bloat credential inventory, delaying detection and rotation.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_getting-report.html",
    "https://support.icompaas.com/support/solutions/articles/62000228293-ensure-there-is-only-one-active-access-key-available-for-any-single-iam-user"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws iam delete-access-key --user-name <example_resource_name> --access-key-id <example_resource_id>",
      "NativeIaC": "```yaml\n# CloudFormation: ensure IAM access key is not active\nResources:\n  AccessKey:\n    Type: AWS::IAM::AccessKey\n    Properties:\n      UserName: \"<example_resource_name>\"\n      Status: Inactive  # Critical: disables the key so it isn't active and cannot be flagged as never used\n```",
      "Other": "1. In the AWS Console, go to IAM > Users and select the user.\n2. Open the Security credentials tab.\n3. Under Access keys, find keys with Last used = N/A and Status = Active.\n4. Choose Deactivate or Delete for each such key.\n5. Save changes.",
      "Terraform": "```hcl\n# Ensure IAM access key is not active\nresource \"aws_iam_access_key\" \"<example_resource_name>\" {\n  user   = \"<example_resource_name>\"\n  status = \"Inactive\"  # Critical: disables the key so it isn't active and cannot be flagged as never used\n}\n```"
    },
    "Recommendation": {
      "Text": "Apply **least privilege** to programmatic access:\n- Do not provision access keys by default for console users\n- Prefer **IAM roles** and temporary credentials\n- Require justification and time-bounded key creation\n- Regularly review usage and disable/delete unused keys\n- Limit to one active key per user and enforce rotation with monitoring",
      "Url": "https://hub.prowler.com/check/iam_user_no_setup_initial_access_key"
    }
  },
  "Categories": [
    "identity-access",
    "secrets"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": "CAF Security Epic: IAM"
}
