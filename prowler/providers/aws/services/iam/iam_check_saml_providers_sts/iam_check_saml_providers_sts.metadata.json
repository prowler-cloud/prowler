{
  "Provider": "aws",
  "CheckID": "iam_check_saml_providers_sts",
  "CheckTitle": "IAM SAML provider exists in the account",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices"
  ],
  "ServiceName": "iam",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "low",
  "ResourceType": "Other",
  "ResourceGroup": "IAM",
  "Description": "**IAM SAML providers** enable **federated role assumption** via STS `AssumeRoleWithSAML`.\n\nThis evaluates whether such providers exist in the account.",
  "Risk": "Without **SAML federation**, users rely on **long-lived IAM keys**. Compromised keys enable persistent API access, causing **data exfiltration (C)**, unauthorized resource or policy changes (**I**), and difficult revocation. Lack of IdP controls (e.g., **MFA**, session limits) weakens **accountability** and access governance.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRoleWithSAML.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws iam create-saml-provider --name <SAML_PROVIDER_NAME> --saml-metadata-document file://<SAML_METADATA_XML_FILE>",
      "NativeIaC": "```yaml\n# CloudFormation: create an IAM SAML provider to satisfy the check\nResources:\n  <example_resource_name>:\n    Type: AWS::IAM::SAMLProvider\n    Properties:\n      SamlMetadataDocument: \"<SAML_METADATA_XML_CONTENT>\"  # Critical: creates the SAML provider so the check passes\n      Name: <example_resource_name>\n```",
      "Other": "1. In the AWS console, go to IAM\n2. In the left menu, select Identity providers\n3. Click Add provider\n4. Set Provider type to SAML\n5. Upload the SAML metadata XML and enter a Provider name\n6. Click Add provider",
      "Terraform": "```hcl\n# Create an IAM SAML provider to satisfy the check\nresource \"aws_iam_saml_provider\" \"<example_resource_name>\" {\n  name                   = \"<example_resource_name>\"\n  saml_metadata_document = file(\"<SAML_METADATA_XML_FILE>\") # Critical: creates the SAML provider so the check passes\n}\n```"
    },
    "Recommendation": {
      "Text": "Adopt **SAML federation** to issue **short-lived STS credentials**. Map users to roles with **least privilege**, enforce **MFA** at the IdP, and set conservative session durations. Retire IAM user access keys for interactive use and monitor role sessions as **defense in depth**. *If federation isn't possible*, tightly scope, rotate, and audit keys.",
      "Url": "https://hub.prowler.com/check/iam_check_saml_providers_sts"
    }
  },
  "Categories": [
    "identity-access"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
