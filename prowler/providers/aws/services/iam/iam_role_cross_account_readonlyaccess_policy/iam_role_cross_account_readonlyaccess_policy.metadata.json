{
  "Provider": "aws",
  "CheckID": "iam_role_cross_account_readonlyaccess_policy",
  "CheckTitle": "IAM role does not grant ReadOnlyAccess to external AWS accounts",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "TTPs/Initial Access/Unauthorized Access",
    "Effects/Data Exposure"
  ],
  "ServiceName": "iam",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "AwsIamRole",
  "ResourceGroup": "IAM",
  "Description": "**IAM roles** are assessed for the AWS-managed **ReadOnlyAccess** policy combined with a trust policy that allows **external AWS principals** or `*`. This identifies roles that expose broad read permissions to other accounts.",
  "Risk": "Granting **cross-account read access** can expose sensitive data and metadata, impacting **confidentiality**. External principals can read S3/DynamoDB contents and enumerate resources, policies, and logs, enabling targeted recon and easier **privilege escalation** paths.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_job-functions.html#awsmp_readonlyaccess",
    "https://support.icompaas.com/support/solutions/articles/62000233802-ensure-iam-roles-do-not-have-readonlyaccess-access-for-external-aws-accounts"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws iam detach-role-policy --role-name <ROLE_NAME> --policy-arn arn:aws:iam::aws:policy/ReadOnlyAccess",
      "NativeIaC": "```yaml\n# CloudFormation snippet to prevent cross-account access on a role\nResources:\n  <example_resource_name>:\n    Type: AWS::IAM::Role\n    Properties:\n      AssumeRolePolicyDocument:\n        Version: '2012-10-17'\n        Statement:\n          - Effect: Allow\n            Principal:\n              AWS: arn:aws:iam::<example_account_id>:root  # Critical: restrict trust to this account only to avoid cross-account access\n            Action: sts:AssumeRole\n```",
      "Other": "1. Open the AWS Management Console > IAM > Roles\n2. Select the role granting external access\n3. On the Permissions tab, locate the policy ReadOnlyAccess\n4. Click Detach policy and confirm\n5. Verify the role no longer lists ReadOnlyAccess",
      "Terraform": "```hcl\n# Terraform snippet to prevent cross-account access on a role\nresource \"aws_iam_role\" \"<example_resource_name>\" {\n  name = \"<example_resource_name>\"\n\n  assume_role_policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [{\n      Effect = \"Allow\"\n      Principal = {\n        AWS = \"arn:aws:iam::<example_account_id>:root\" # Critical: trust only the same account to avoid cross-account access\n      }\n      Action = \"sts:AssumeRole\"\n    }]\n  })\n}\n```"
    },
    "Recommendation": {
      "Text": "Avoid attaching `ReadOnlyAccess` to roles trusted by other accounts. Apply **least privilege** with custom, tightly scoped policies. Restrict trust to explicit principals, avoid `*`, and use conditions like `aws:PrincipalOrgID` and `sts:ExternalId` for **defense in depth**.",
      "Url": "https://hub.prowler.com/check/iam_role_cross_account_readonlyaccess_policy"
    }
  },
  "Categories": [
    "trust-boundaries",
    "identity-access"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": "CAF Security Epic: IAM"
}
