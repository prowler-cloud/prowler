{
  "Provider": "aws",
  "CheckID": "iam_no_expired_server_certificates_stored",
  "CheckTitle": "IAM server certificate is not expired",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark"
  ],
  "ServiceName": "iam",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "AwsCertificateManagerCertificate",
  "ResourceGroup": "IAM",
  "Description": "IAM server certificates stored in **AWS IAM** are evaluated for **expiration** by comparing their validity period to the current time. Certificates with a `NotAfter` date in the past are identified as expired.",
  "Risk": "Retaining **expired TLS certificates** risks **availability** loss from failed handshakes and browser warnings, eroding trust.\n\nIf attached to endpoints, users may bypass warnings, weakening **confidentiality** and **integrity**. Stale certs also hinder **secure rotation** and may be picked by automation, causing outages.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_server-certs.html",
    "https://www.trendmicro.com/trendaivisiononecloudriskmanagement/knowledge-base/aws/IAM/expired-ssl-tls-certificate.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws iam delete-server-certificate --server-certificate-name <CERTIFICATE_NAME>",
      "NativeIaC": "",
      "Other": "1. Deleting IAM server certificates is not supported in the AWS Management Console.\n2. Use the CLI to remove the expired certificate: aws iam delete-server-certificate --server-certificate-name <CERTIFICATE_NAME>",
      "Terraform": ""
    },
    "Recommendation": {
      "Text": "Remove **expired certificates** from IAM and ensure endpoints use current, trusted TLS.\n\nPrefer **AWS Certificate Manager** for issuance and auto-renewal, enforce **lifecycle management** with inventory, tagging, and alerts, and apply **least privilege** to certificate access with standardized rotation policies.",
      "Url": "https://hub.prowler.com/check/iam_no_expired_server_certificates_stored"
    }
  },
  "Categories": [
    "encryption"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": "Data Protection"
}
