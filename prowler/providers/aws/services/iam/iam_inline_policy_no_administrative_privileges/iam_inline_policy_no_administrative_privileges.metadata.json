{
  "Provider": "aws",
  "CheckID": "iam_inline_policy_no_administrative_privileges",
  "CheckTitle": "Inline IAM policy does not allow '*:*' administrative privileges",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark",
    "TTPs/Privilege Escalation"
  ],
  "ServiceName": "iam",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "critical",
  "ResourceType": "AwsIamPolicy",
  "ResourceGroup": "IAM",
  "Description": "**IAM inline policies** on identities are evaluated for statements allowing `Action:\"*\"` on `Resource:\"*\"`, which indicates **unrestricted administrative access**.",
  "Risk": "Granting `*:*` to an identity collapses **least privilege**, enabling total control over AWS. A compromised principal can exfiltrate data (**confidentiality**), alter configs or disable logging (**integrity**), and delete resources or keys (**availability**), enabling rapid **lateral movement** and persistent takeover.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html",
    "https://support.icompaas.com/support/solutions/articles/62000233799-ensure-iam-inline-policies-that-allow-full-administrative-privileges-are-not-associated-to-iam-id"
  ],
  "Remediation": {
    "Code": {
      "CLI": "",
      "NativeIaC": "```yaml\n# CloudFormation: Inline policy without '*:*' privileges\nResources:\n  <example_resource_name>Policy:\n    Type: AWS::IAM::Policy\n    Properties:\n      PolicyName: leastpriv\n      PolicyDocument:\n        Version: '2012-10-17'\n        Statement:\n          - Effect: Allow\n            Action: s3:ListBucket        # Critical: specific action, not \"*\"\n            Resource: arn:aws:s3:::<example_resource_name>  # Critical: specific resource, not \"*\"\n      Roles:\n        - <example_resource_name>\n```",
      "Other": "1. In the AWS Console, open IAM\n2. Go to Users, Roles, or Groups (whichever has the inline policy)\n3. Select the entity, then open the Inline policies section\n4. Edit the inline policy JSON and remove any statement with \"Effect\": \"Allow\" and both \"Action\": \"*\" and \"Resource\": \"*\"\n5. Replace it with only the specific actions and specific resource ARNs required\n6. Save changes",
      "Terraform": "```hcl\n# Terraform: Inline role policy without '*:*' privileges\nresource \"aws_iam_role_policy\" \"<example_resource_name>\" {\n  name = \"leastpriv\"\n  role = \"<example_resource_name>\"\n\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [{\n      Effect   = \"Allow\"\n      Action   = \"s3:ListBucket\"                   # Critical: specific action, not \"*\"\n      Resource = \"arn:aws:s3:::<example_resource_name>\"  # Critical: specific resource, not \"*\"\n    }]\n  })\n}\n```"
    },
    "Recommendation": {
      "Text": "Remove `Action:\"*\"` with `Resource:\"*\"` from inline policies. Apply **least privilege** with granular actions scoped to specific resources and conditions. Prefer versioned customer-managed policies over broad inline ones, enforce **separation of duties**, and use **permissions boundaries** or guardrails to prevent accidental admin grants.",
      "Url": "https://hub.prowler.com/check/iam_inline_policy_no_administrative_privileges"
    }
  },
  "Categories": [
    "identity-access"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": "CAF Security Epic: IAM"
}
