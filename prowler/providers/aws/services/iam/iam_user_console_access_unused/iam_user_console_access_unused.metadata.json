{
  "Provider": "aws",
  "CheckID": "iam_user_console_access_unused",
  "CheckTitle": "IAM user console access is disabled, used within the configured inactivity period, or never used",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark",
    "TTPs/Initial Access"
  ],
  "ServiceName": "iam",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "AwsIamUser",
  "ResourceGroup": "IAM",
  "Description": "**IAM users** with console access are evaluated by `password_last_used`. Inactivity beyond `max_console_access_days` (default `45`) marks **stale console access**.\n\n*Users without console access are excluded*.",
  "Risk": "**Dormant console credentials** stay valid and invite **password spraying**, **credential stuffing**, and breach reuse. Compromise yields interactive access for data discovery/exfiltration and unauthorized IAM or resource changes, degrading **confidentiality** and **integrity**, and risking **availability**.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_finding-unused.html",
    "https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws iam delete-login-profile --user-name <USER_NAME>",
      "NativeIaC": "```yaml\n# CloudFormation: IAM user without console access\nResources:\n  <example_resource_name>:\n    Type: AWS::IAM::User\n    Properties:\n      UserName: <example_resource_name>\n      # Critical: No LoginProfile property -> disables console access for the user\n```",
      "Other": "1. Open the IAM console and go to Users\n2. Select the user\n3. Open the Security credentials tab\n4. Click Manage console access\n5. Select Disable console access and Save",
      "Terraform": "```hcl\n# IAM user with console access disabled by not creating a login profile\nresource \"aws_iam_user\" \"<example_resource_name>\" {\n  name = \"<example_resource_name>\"\n  # Critical: Do not define aws_iam_user_login_profile for this user -> no console access\n}\n```"
    },
    "Recommendation": {
      "Text": "Remove or disable console passwords for users inactive beyond your window (e.g., `45` days). Prefer roles or federation over long-lived IAM users. Enforce **least privilege**, require **MFA** for remaining console users, and run periodic reviews and deprovisioning to prevent unused credentials.",
      "Url": "https://hub.prowler.com/check/iam_user_console_access_unused"
    }
  },
  "Categories": [
    "identity-access"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
