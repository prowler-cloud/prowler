{
  "Provider": "aws",
  "CheckID": "iam_password_policy_number",
  "CheckTitle": "IAM password policy requires at least one number",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark"
  ],
  "ServiceName": "iam",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "AwsIamPolicy",
  "ResourceGroup": "IAM",
  "Description": "**IAM account password policy** requires at least one **numeric character** (`0-9`) in IAM user passwords",
  "Risk": "Passwords without numbers have lower entropy, making **brute-force** and **credential-stuffing** more effective. A compromised IAM user can gain console access, enabling data exposure (**confidentiality**), configuration changes (**integrity**), and resource abuse or deletion (**availability**).",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws iam update-account-password-policy --require-numbers",
      "NativeIaC": "```yaml\n# CloudFormation: Enforce at least one number in IAM user passwords\nResources:\n  <example_resource_name>:\n    Type: AWS::IAM::AccountPasswordPolicy\n    Properties:\n      RequireNumbers: true  # Critical: requires at least one number in passwords\n```",
      "Other": "1. Open the AWS Management Console and go to IAM\n2. In the left menu, click Account settings\n3. In Password policy, click Edit\n4. Check Require at least one number\n5. Click Save changes and confirm Set custom",
      "Terraform": "```hcl\n# Enforce at least one number in IAM user passwords\nresource \"aws_iam_account_password_policy\" \"<example_resource_name>\" {\n  require_numbers = true  # Critical: requires at least one number in passwords\n}\n```"
    },
    "Recommendation": {
      "Text": "Enforce the password policy option to `require at least one number`. Combine with strong length, mixed case, and symbols, and prevent reuse. Enable **MFA** for all users and prefer **federated access** to limit static credentials, supporting **defense in depth** against guessing attacks.",
      "Url": "https://hub.prowler.com/check/iam_password_policy_number"
    }
  },
  "Categories": [
    "identity-access"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
