{
  "Provider": "aws",
  "CheckID": "iam_group_administrator_access_policy",
  "CheckTitle": "IAM group does not have AdministratorAccess policy attached",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "TTPs/Privilege Escalation"
  ],
  "ServiceName": "iam",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "AwsIamGroup",
  "ResourceGroup": "IAM",
  "Description": "**IAM groups** are assessed for the AWS-managed `AdministratorAccess` policy attachment.\n\nThe finding reports any group that has this policy among its attached permissions.",
  "Risk": "Group-wide `AdministratorAccess` gives all members unrestricted control. A stolen or misused account can:\n- Read/exfiltrate sensitive data (C)\n- Modify or delete resources and configs (I/A)\n- Disable logging and weaken defenses, enabling persistence and lateral movement",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_groups_manage.html",
    "https://www.trendmicro.com/trendaivisiononecloudriskmanagement/knowledge-base/aws/IAM/group-with-privileged-access.html",
    "https://support.icompaas.com/support/solutions/articles/62000233798-ensure-no-iam-groups-have-administrator-access-policy",
    "https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws iam detach-group-policy --group-name <groupname> --policy-arn arn:aws:iam::aws:policy/AdministratorAccess",
      "NativeIaC": "```yaml\n# CloudFormation: IAM group without AdministratorAccess attached\nResources:\n  <example_resource_name>:\n    Type: AWS::IAM::Group\n    Properties:\n      GroupName: <example_resource_name>\n      ManagedPolicyArns: []  # Critical: empty list ensures AdministratorAccess is NOT attached to the group\n```",
      "Other": "1. In the AWS Console, go to IAM > User groups\n2. Select the target group (<groupname>)\n3. Open the Permissions tab > Attached policies\n4. Select the policy AdministratorAccess and click Detach\n5. Confirm to remove the policy",
      "Terraform": "```hcl\n# IAM group with no AdministratorAccess attachment\nresource \"aws_iam_group\" \"<example_resource_name>\" {\n  name = \"<example_resource_name>\"\n  # Critical: do NOT create any aws_iam_group_policy_attachment with\n  # policy_arn = \"arn:aws:iam::aws:policy/AdministratorAccess\" for this group\n}\n```"
    },
    "Recommendation": {
      "Text": "Remove `AdministratorAccess` from groups. Apply **least privilege** with task-scoped, customer-managed policies and **separation of duties**. Use roles for admin tasks with MFA, time-bound elevation, and auditing. Regularly review group membership and permissions; prefer **defense-in-depth** guardrails.",
      "Url": "https://hub.prowler.com/check/iam_group_administrator_access_policy"
    }
  },
  "Categories": [
    "identity-access"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
