{
  "Provider": "aws",
  "CheckID": "iam_aws_attached_policy_no_administrative_privileges",
  "CheckTitle": "Attached AWS-managed IAM policy does not allow '*:*' administrative privileges",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "Industry and Regulatory Standards/CIS AWS Foundations Benchmark",
    "TTPs/Privilege Escalation"
  ],
  "ServiceName": "iam",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "critical",
  "ResourceType": "AwsIamPolicy",
  "Description": "**IAM AWS-managed policies** attached to identities are inspected for statements that allow `Action:'*'` on `Resource:'*'`-i.e., full administrative `*:*` permissions",
  "Risk": "**Unrestricted `*:*` access** enables any action on any resource, risking:\n- Data exfiltration (**confidentiality**)\n- Unauthorized changes and policy tampering (**integrity**)\n- Service deletion or shutdown (**availability**)\nAttackers can disable logging, create backdoor principals, and expand lateral movement.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.prowler.com/checks/aws/iam-policies/iam_47#terraform",
    "https://www.elastic.co/guide/en/security/current/prebuilt-rule-8-17-4-aws-iam-administratoraccess-policy-attached-to-user.html",
    "https://medium.com/@haroldfinch01/terraform-correct-way-to-attach-aws-managed-policies-to-a-role-1572c8408b33",
    "https://docs.aws.amazon.com/aws-managed-policy/latest/reference/AdministratorAccess.html",
    "https://docs.prowler.com/checks/aws/iam-policies/iam_47",
    "https://docs.kertos.io/en/article/ensure-no-iam-aws-managed-policies-grant-full-administrative-access",
    "https://support.icompaas.com/support/solutions/articles/62000233815-ensure-iam-roles-do-not-have-administratoraccess-policy-attached",
    "http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html",
    "https://docs.datadoghq.com/security/default_rules/def-000-ilw/"
  ],
  "Remediation": {
    "Code": {
      "CLI": "",
      "NativeIaC": "```yaml\n# CloudFormation: ensure no AWS-managed admin policy ('*:*') is attached\nResources:\n  <example_resource_name>:\n    Type: AWS::IAM::Role\n    Properties:\n      AssumeRolePolicyDocument:\n        Version: '2012-10-17'\n        Statement:\n          - Effect: Allow\n            Principal:\n              Service: ec2.amazonaws.com\n            Action: sts:AssumeRole\n      ManagedPolicyArns: []  # FIX: empty list detaches/removes any attached AWS-managed admin policy (e.g., AdministratorAccess)\n```",
      "Other": "1. In the AWS Console, go to IAM > Policies\n2. Search for the flagged AWS-managed policy (e.g., AdministratorAccess) and open it\n3. Click Attached entities\n4. Select all Users, Groups, and Roles shown and click Detach\n5. Confirm the policy shows 0 attached entities\n6. Rerun the check to verify it passes",
      "Terraform": "```hcl\n# Replace full admin attachment with a non-admin policy (ensure AdministratorAccess is not attached)\nresource \"aws_iam_role_policy_attachment\" \"<example_resource_name>\" {\n  role       = \"<example_resource_name>\"\n  policy_arn = \"arn:aws:iam::aws:policy/ReadOnlyAccess\"  # FIX: avoids '*:*' admin privileges; replace AdministratorAccess\n}\n```"
    },
    "Recommendation": {
      "Text": "Apply **least privilege**: avoid attaching AWS-managed policies that grant `*:*`.\n- Use **customer-managed, scoped policies** per role\n- Enforce **separation of duties** and **permissions boundaries**\n- Prefer **temporary, time-bound elevation** for emergencies with MFA\n- Regularly review access and use conditions to constrain context",
      "Url": "https://hub.prowler.com/check/iam_aws_attached_policy_no_administrative_privileges"
    }
  },
  "Categories": [
    "identity-access"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": "CAF Security Epic: IAM"
}
