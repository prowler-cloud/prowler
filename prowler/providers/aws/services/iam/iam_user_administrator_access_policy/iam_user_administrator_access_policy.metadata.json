{
  "Provider": "aws",
  "CheckID": "iam_user_administrator_access_policy",
  "CheckTitle": "IAM user does not have AdministratorAccess policy attached",
  "CheckType": [
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark",
    "TTPs/Privilege Escalation"
  ],
  "ServiceName": "iam",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "critical",
  "ResourceType": "AwsIamUser",
  "ResourceGroup": "IAM",
  "Description": "**IAM users** are evaluated for a direct attachment of the AWS managed policy `AdministratorAccess`. The finding identifies identities where this policy appears among the user's attached policies.",
  "Risk": "Assigning an IAM user full admin rights concentrates power in long-lived credentials. If compromised, attackers gain:\n- **Confidentiality**: read/export all data\n- **Integrity**: change configs, policies, code\n- **Availability**: delete resources, disrupt services\nAlso enables persistence and uncontrolled spend.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://www.trendmicro.com/trendaivisiononecloudriskmanagement/knowledge-base/aws/IAM/admin-permissions.html",
    "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_users.html",
    "https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws iam detach-user-policy --user-name <username> --policy-arn arn:aws:iam::aws:policy/AdministratorAccess",
      "NativeIaC": "```yaml\n# CloudFormation: ensure IAM user does NOT have AdministratorAccess attached\nResources:\n  <example_resource_name>:\n    Type: AWS::IAM::User\n    Properties:\n      ManagedPolicyArns: []  # Critical: empty list ensures 'AdministratorAccess' is NOT attached to this user\n```",
      "Other": "1. Sign in to the AWS Console and open IAM\n2. Go to Users and select the target user\n3. Open the Permissions tab\n4. In Attached policies (or Permissions policies), find AdministratorAccess\n5. Select it and click Detach policy (or Remove)\n6. Confirm to detach",
      "Terraform": ""
    },
    "Recommendation": {
      "Text": "Remove direct `AdministratorAccess` from users.\n- Apply **least privilege** with scoped policies\n- Use **federation** and **roles** for temporary admin access\n- Enforce **separation of duties** and approvals\n- Add guardrails (SCPs, permissions boundaries)\n- Require **MFA** and rotate any remaining long-lived credentials",
      "Url": "https://hub.prowler.com/check/iam_user_administrator_access_policy"
    }
  },
  "Categories": [
    "identity-access"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
