{
  "Provider": "aws",
  "CheckID": "iam_securityaudit_role_created",
  "CheckTitle": "At least one IAM role has the SecurityAudit AWS managed policy attached",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark"
  ],
  "ServiceName": "iam",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "low",
  "ResourceType": "AwsIamPolicy",
  "ResourceGroup": "IAM",
  "Description": "**IAM roles** with the AWS managed `SecurityAudit` policy (`arn:aws:iam::aws:policy/SecurityAudit`) are identified. The focus is on whether a role exists that grants read-only visibility into security-relevant configuration across AWS services.",
  "Risk": "Without a dedicated **read-only audit role**, security teams lack safe visibility into configs and logs, enabling **undetected misconfigurations**, slower incident triage, and reliance on over-privileged access. This erodes **confidentiality** and **integrity** by letting exposure persist unnoticed.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/aws-managed-policy/latest/reference/SecurityAudit.html",
    "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_job-functions.html#jf_security-auditor",
    "https://docs.aws.amazon.com/IAM/latest/UserGuide/iam_example_iam_AttachRolePolicy_section.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws iam attach-role-policy --role-name <example_resource_name> --policy-arn arn:aws:iam::aws:policy/SecurityAudit",
      "NativeIaC": "```yaml\n# CloudFormation: create a minimal IAM role with SecurityAudit attached\nResources:\n  <example_resource_name>:\n    Type: AWS::IAM::Role\n    Properties:\n      AssumeRolePolicyDocument:\n        Version: '2012-10-17'\n        Statement:\n          - Effect: Allow\n            Principal:\n              AWS: arn:aws:iam::<example_account_id>:root\n            Action: sts:AssumeRole\n      ManagedPolicyArns:\n        - arn:aws:iam::aws:policy/SecurityAudit  # CRITICAL: attaches the AWS managed SecurityAudit policy to this role, satisfying the check\n```",
      "Other": "1. In the AWS Console, go to IAM > Roles\n2. Open any existing role that is appropriate for read-only security auditing\n3. Click \"Add permissions\" > \"Attach policies\"\n4. Search for \"SecurityAudit\", check the box for the AWS managed policy named SecurityAudit\n5. Click \"Add permissions\" to attach the policy (the account now has at least one role with SecurityAudit attached)",
      "Terraform": "```hcl\n# Minimal IAM role plus attachment of the AWS managed SecurityAudit policy\nresource \"aws_iam_role\" \"example\" {\n  name               = \"<example_resource_name>\"\n  assume_role_policy = <<POLICY\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": { \"AWS\": \"arn:aws:iam::<example_account_id>:root\" },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}\nPOLICY\n}\n\nresource \"aws_iam_role_policy_attachment\" \"security_audit\" {\n  role       = aws_iam_role.example.name\n  policy_arn = \"arn:aws:iam::aws:policy/SecurityAudit\" # CRITICAL: attaches SecurityAudit to the role to pass the check\n}\n```"
    },
    "Recommendation": {
      "Text": "Establish a dedicated **audit role** and attach the AWS managed `SecurityAudit` policy. Enforce **least privilege** and **separation of duties**: restrict who can assume it, require **MFA**, monitor usage, and avoid write permissions. Prefer **federated access** and regularly review and rotate access.",
      "Url": "https://hub.prowler.com/check/iam_securityaudit_role_created"
    }
  },
  "Categories": [
    "identity-access"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
