{
  "Provider": "aws",
  "CheckID": "rds_cluster_critical_event_subscription",
  "CheckTitle": "RDS cluster event subscription is enabled for maintenance and failure categories",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices"
  ],
  "ServiceName": "rds",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "AwsRdsEventSubscription",
  "ResourceGroup": "database",
  "Description": "**RDS event subscriptions** for the `db-cluster` source type are enabled and cover critical cluster event categories: **`maintenance`** and **`failure`** (or all cluster events).",
  "Risk": "Without notifications for **cluster maintenance** and **failure**, teams may miss engine updates, failovers, or node crashes, impacting **availability** and increasing MTTR. Prolonged degraded states can cause replication lag and potential **data integrity** issues, hindering timely containment.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Events.html",
    "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Events.Subscribing.html",
    "https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-19"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws rds create-event-subscription --subscription-name <example_resource_name> --sns-topic-arn <example_resource_arn> --source-type db-cluster --event-categories maintenance failure --enabled",
      "NativeIaC": "```yaml\nResources:\n  <example_resource_name>:\n    Type: AWS::RDS::EventSubscription\n    Properties:\n      SnsTopicArn: <example_resource_arn>       # Critical: SNS topic to receive notifications\n      SourceType: db-cluster                    # Critical: Scope to DB clusters\n      EventCategories:                          # Critical: Subscribe to required categories only\n        - maintenance\n        - failure\n      Enabled: true                             # Critical: Must be enabled to pass\n```",
      "Other": "1. In the AWS Console, go to RDS > Event subscriptions > Create event subscription\n2. Name: enter <example_resource_name>\n3. Send notifications to: Choose existing Amazon SNS ARN and select <example_resource_arn>\n4. Source type: select Clusters\n5. Event categories: select only Maintenance and Failure (unselect others)\n6. Ensure Enabled is on\n7. Click Create",
      "Terraform": "```hcl\nresource \"aws_db_event_subscription\" \"<example_resource_name>\" {\n  name            = \"<example_resource_name>\"\n  sns_topic       = \"<example_resource_arn>\"           # Critical: SNS topic ARN\n  source_type     = \"db-cluster\"                        # Critical: Scope to clusters\n  event_categories = [\"maintenance\", \"failure\"]        # Critical: Required categories\n  enabled         = true                                  # Critical: Must be enabled\n}\n```"
    },
    "Recommendation": {
      "Text": "Enable **event subscriptions** for RDS clusters that include `maintenance` and `failure`, delivered via **SNS** to monitored channels.\n- Enforce **least privilege** on topics\n- Separate topics per environment\n- Integrate with on-call/IR playbooks and test alerts\n- Add multiple recipients and escalation for **defense in depth**",
      "Url": "https://hub.prowler.com/check/rds_cluster_critical_event_subscription"
    }
  },
  "Categories": [
    "logging"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
