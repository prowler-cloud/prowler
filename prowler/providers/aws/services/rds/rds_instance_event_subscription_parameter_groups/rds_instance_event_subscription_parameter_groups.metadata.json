{
  "Provider": "aws",
  "CheckID": "rds_instance_event_subscription_parameter_groups",
  "CheckTitle": "RDS DB parameter group event subscription is enabled and subscribes to configuration change events or all categories",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices"
  ],
  "ServiceName": "rds",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "low",
  "ResourceType": "AwsRdsEventSubscription",
  "ResourceGroup": "database",
  "Description": "**RDS event subscriptions** for **DB parameter groups** notify on `configuration change` events (or all categories) when the subscription is enabled",
  "Risk": "Missing alerts on parameter changes erodes visibility. Attackers or mistakes can lower TLS requirements, disable auditing, or relax auth, enabling data exposure (**confidentiality**), unauthorized writes (**integrity**), or outages from unsafe settings (**availability**).",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Events.html",
    "https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-21"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws rds create-event-subscription --subscription-name <example_resource_name> --sns-topic-arn <sns-topic-arn> --source-type db-parameter-group --event-categories \"configuration change\" --enabled",
      "NativeIaC": "```yaml\nResources:\n  <example_resource_name>:\n    Type: AWS::RDS::EventSubscription\n    Properties:\n      SnsTopicArn: <sns-topic-arn>\n      SourceType: db-parameter-group  # Critical: targets DB parameter group events\n      EventCategories:\n        - configuration change        # Critical: subscribes to configuration change events\n      Enabled: true                   # Critical: subscription must be enabled\n```",
      "Other": "1. In the AWS Console, go to Amazon RDS > Event subscriptions\n2. Click Create event subscription\n3. Send notifications to: select an existing SNS topic\n4. Source type: Parameter groups\n5. Event categories: select Configuration change (or choose All event categories)\n6. Ensure Enabled is On\n7. Click Create",
      "Terraform": "```hcl\nresource \"aws_db_event_subscription\" \"<example_resource_name>\" {\n  name             = \"<example_resource_name>\"\n  sns_topic        = \"<sns-topic-arn>\"\n  source_type      = \"db-parameter-group\"          # Critical: target DB parameter groups\n  event_categories = [\"configuration change\"]       # Critical: include configuration change events\n}\n```"
    },
    "Recommendation": {
      "Text": "Create and maintain an **SNS-backed event subscription** for **DB parameter groups** that includes `configuration change` (or all) and keep it enabled.\n\n- Apply **least privilege** to SNS topics\n- Route to on-call/SIEM and test alerts\n- Enforce change control and monitoring across all Regions",
      "Url": "https://hub.prowler.com/check/rds_instance_event_subscription_parameter_groups"
    }
  },
  "Categories": [
    "logging"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
