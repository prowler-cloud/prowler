{
  "Provider": "aws",
  "CheckID": "rds_instance_protected_by_backup_plan",
  "CheckTitle": "RDS instance is protected by an AWS Backup plan",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "Effects/Data Destruction"
  ],
  "ServiceName": "rds",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "AwsRdsDbInstance",
  "ResourceGroup": "database",
  "Description": "**RDS DB instances** (non-Aurora) are included in an **AWS Backup plan**, indicating scheduled backups and retention are applied to the resource.\n\n*Aurora engines are evaluated separately.*",
  "Risk": "Without an **AWS Backup plan**, databases lack assured recovery, degrading **availability** and **integrity**. Likely outcomes: accidental deletion, corruption, or malicious wipes with no recent restore point. Expect missed `RPO/RTO`, extended outages, and data inconsistency after incidents.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/aws-backup/latest/devguide/assigning-resources.html",
    "https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-26"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws backup create-backup-selection --backup-plan-id <example_backup_plan_id> --backup-selection '{\"SelectionName\":\"<selection_name>\",\"IamRoleArn\":\"<example_role_arn>\",\"Resources\":[\"<rds-instance-arn>\"]}'",
      "NativeIaC": "```yaml\n# CloudFormation: assign an RDS instance to an AWS Backup plan\nResources:\n  <example_resource_name>:\n    Type: AWS::Backup::BackupSelection\n    Properties:\n      BackupPlanId: <example_backup_plan_id>  # CRITICAL: targets the backup plan to protect the instance\n      BackupSelection:\n        SelectionName: <selection_name>\n        IamRoleArn: <example_role_arn>        # CRITICAL: role AWS Backup uses to back up the resource\n        Resources:\n          - <rds-instance-arn>                # CRITICAL: assigns the RDS instance to the plan\n```",
      "Other": "1. In the AWS Console, open AWS Backup\n2. Go to Settings > Service opt-in and enable Amazon RDS (if not already)\n3. Go to Backup plans and select an existing plan (or Create backup plan with defaults)\n4. Click Assign resources\n5. Enter a name, select an IAM role, and add the RDS instance (by ARN or resource picker)\n6. Click Assign resources to save",
      "Terraform": "```hcl\n# Assign an RDS instance to an AWS Backup plan\nresource \"aws_backup_selection\" \"<example_resource_name>\" {\n  name         = \"<selection_name>\"\n  plan_id      = \"<example_backup_plan_id>\"   # CRITICAL: attaches to the backup plan\n  iam_role_arn = \"<example_role_arn>\"         # CRITICAL: role AWS Backup uses\n  resources    = [\"<rds-instance-arn>\"]       # CRITICAL: RDS instance protected by the plan\n}\n```"
    },
    "Recommendation": {
      "Text": "Assign all non-Aurora RDS to an **AWS Backup plan** aligned to business `RPO/RTO`. Use **tags** for automatic coverage, define retention and lifecycle, and store backups in **immutable** vaults where possible. Regularly perform restore tests. Enforce **least privilege** and **separation of duties** for backup administration.",
      "Url": "https://hub.prowler.com/check/rds_instance_protected_by_backup_plan"
    }
  },
  "Categories": [
    "resilience"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
