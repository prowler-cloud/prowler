{
  "Provider": "aws",
  "CheckID": "rds_instance_backup_enabled",
  "CheckTitle": "RDS instance has backup retention period greater than 0 days",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "Effects/Data Destruction"
  ],
  "ServiceName": "rds",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "AwsRdsDbInstance",
  "ResourceGroup": "database",
  "Description": "**RDS DB instances** are evaluated for **automated backups** by confirming the backup retention period is greater than `0` days, indicating point-in-time recovery is configured.",
  "Risk": "Without automated backups, you lose **point-in-time recovery**, impacting **availability** and **integrity**.\n\nAccidental deletes, destructive queries, or compromised accounts can cause unrecoverable data loss and prolonged outages, preventing reliable rollback during incidents.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_WorkingWithAutomatedBackups.html",
    "https://www.trendmicro.com/trendaivisiononecloudriskmanagement/knowledge-base/aws/RDS/rds-automated-backups-enabled.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws rds modify-db-instance --db-instance-identifier <db_instance_id> --backup-retention-period 1 --apply-immediately",
      "NativeIaC": "```yaml\n# CloudFormation: enable automated backups on an RDS instance\nResources:\n  <example_resource_name>:\n    Type: AWS::RDS::DBInstance\n    Properties:\n      DBInstanceClass: db.t3.micro\n      Engine: mysql\n      AllocatedStorage: 20\n      MasterUsername: admin\n      MasterUserPassword: <example_password>\n      BackupRetentionPeriod: 1  # CRITICAL: Enables automated backups (>0 days)\n```",
      "Other": "1. Open the AWS Management Console and go to RDS > Databases\n2. Select the target DB instance and click Modify\n3. In Backup section, set Backup retention period to 1 day (or more)\n4. Check Apply immediately\n5. Click Continue (if shown) and then Modify DB instance",
      "Terraform": "```hcl\n# Terraform: enable automated backups on an RDS instance\nresource \"aws_db_instance\" \"<example_resource_name>\" {\n  allocated_storage      = 20\n  engine                 = \"mysql\"\n  instance_class         = \"db.t3.micro\"\n  username               = \"admin\"\n  password               = \"<example_password>\"\n  backup_retention_period = 1  # CRITICAL: Enables automated backups (>0 days)\n}\n```"
    },
    "Recommendation": {
      "Text": "Enable **automated backups** with retention > `0` aligned to RPO/RTO. Regularly test restores to validate **PITR**.\n\nApply **least privilege** to backup access, encrypt snapshots, and replicate critical backups to separate locations for **defense in depth** and resilient recovery.",
      "Url": "https://hub.prowler.com/check/rds_instance_backup_enabled"
    }
  },
  "Categories": [
    "resilience"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
