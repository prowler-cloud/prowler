{
  "Provider": "aws",
  "CheckID": "rds_instance_minor_version_upgrade_enabled",
  "CheckTitle": "RDS instance has minor version upgrade enabled",
  "CheckType": [
    "Software and Configuration Checks/Patch Management"
  ],
  "ServiceName": "rds",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "AwsRdsDbInstance",
  "ResourceGroup": "database",
  "Description": "**RDS DB instances** are evaluated for the `auto_minor_version_upgrade` setting that enables **automatic minor engine updates** during maintenance windows.",
  "Risk": "Without automatic minor upgrades, databases miss **security patches**, leaving known vulnerabilities exploitable and risking **unauthorized data access**. Unapplied fixes can cause **data corruption** and outages, harming **integrity** and **availability**.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://aws.amazon.com/blogs/database/best-practices-for-upgrading-amazon-rds-to-major-and-minor-versions-of-postgresql/",
    "https://www.trendmicro.com/trendaivisiononecloudriskmanagement/knowledge-base/aws/RDS/rds-auto-minor-version-upgrade.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws rds modify-db-instance --db-instance-identifier <db_instance_id> --auto-minor-version-upgrade --apply-immediately",
      "NativeIaC": "```yaml\n# CloudFormation: Enable auto minor version upgrades on an RDS instance\nResources:\n  <example_resource_name>:\n    Type: AWS::RDS::DBInstance\n    Properties:\n      DBInstanceIdentifier: <example_resource_id>\n      DBInstanceClass: db.t3.micro\n      Engine: mysql\n      MasterUsername: <username>\n      MasterUserPassword: <password>\n      AllocatedStorage: '20'\n      AutoMinorVersionUpgrade: true  # Critical: ensures RDS applies minor engine updates automatically\n```",
      "Other": "1. In the AWS Console, go to RDS > Databases\n2. Select the DB instance and click Modify\n3. Find \"Auto minor version upgrade\" and set it to Enable\n4. Click Continue, check Apply immediately, then click Modify DB instance",
      "Terraform": "```hcl\n# Enable auto minor version upgrades on an RDS instance\nresource \"aws_db_instance\" \"<example_resource_name>\" {\n  allocated_storage          = 20\n  engine                     = \"mysql\"\n  instance_class             = \"db.t3.micro\"\n  username                   = \"<username>\"\n  password                   = \"<password>\"\n  auto_minor_version_upgrade = true  # Critical: turns on automatic minor engine upgrades\n}\n```"
    },
    "Recommendation": {
      "Text": "Enable `auto_minor_version_upgrade` on RDS instances so minor releases are applied promptly. Use maintenance windows and stage testing to limit impact. Follow **defense in depth** and **least privilege**; keep reliable backups and Multi-AZ to preserve continuity if upgrades require rollback.",
      "Url": "https://hub.prowler.com/check/rds_instance_minor_version_upgrade_enabled"
    }
  },
  "Categories": [
    "vulnerabilities"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
