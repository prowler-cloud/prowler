{
  "Provider": "aws",
  "CheckID": "rds_cluster_protected_by_backup_plan",
  "CheckTitle": "RDS cluster is protected by an AWS Backup plan",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices"
  ],
  "ServiceName": "rds",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "AwsRdsDbCluster",
  "ResourceGroup": "database",
  "Description": "**RDS DB clusters** are covered by an **AWS Backup backup plan** when resource assignments include the cluster, either explicitly, by tags, or via an appropriate resource scope.",
  "Risk": "Lack of centralized backups enables irreversible **data loss** and **corruption**, reducing **availability** and **integrity**. Accidental deletion, ransomware, or bad changes may become unrecoverable. Weak retention or no immutability undermines rollback and can breach recovery objectives.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/aws-backup/latest/devguide/assigning-resources.html",
    "https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-26"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws backup create-backup-selection --backup-plan-id <example_backup_plan_id> --backup-selection '{\"SelectionName\":\"rds-clusters\",\"IamRoleArn\":\"arn:aws:iam::<example_account_id>:role/service-role/AWSBackupDefaultServiceRole\",\"Resources\":[\"arn:aws:rds:*:*:cluster:*\"]}'",
      "NativeIaC": "```yaml\n# CloudFormation: assign RDS clusters to an AWS Backup plan\nResources:\n  <example_resource_name>:\n    Type: AWS::Backup::BackupSelection\n    Properties:\n      BackupPlanId: \"<example_backup_plan_id>\"\n      BackupSelection:\n        SelectionName: \"rds-clusters\"\n        IamRoleArn: \"arn:aws:iam::<example_account_id>:role/service-role/AWSBackupDefaultServiceRole\"\n        Resources:\n          - \"arn:aws:rds:*:*:cluster:*\"  # Critical: includes all RDS clusters in the plan to mark them protected\n```",
      "Other": "1. In the AWS Backup console, go to Settings > Service opt-in and enable RDS if it is not enabled.\n2. Go to Backup plans and select an existing plan (create a minimal plan if none exists).\n3. Click Assign resources.\n4. Set a name and choose IAM role: AWSBackupDefaultServiceRole.\n5. Under Resources, choose By resource ID and select the target RDS DB cluster (or use the ARN), then click Assign resources.\n6. The cluster now appears as protected by the backup plan.",
      "Terraform": "```hcl\n# Assign RDS clusters to an existing AWS Backup plan\nresource \"aws_backup_selection\" \"<example_resource_name>\" {\n  name         = \"rds-clusters\"\n  plan_id      = \"<example_backup_plan_id>\"\n  iam_role_arn = \"arn:aws:iam::<example_account_id>:role/service-role/AWSBackupDefaultServiceRole\"\n\n  resources = [\n    \"arn:aws:rds:*:*:cluster:*\" # Critical: includes all RDS clusters in the plan to pass the check\n  ]\n}\n```"
    },
    "Recommendation": {
      "Text": "Include RDS clusters in an **AWS Backup backup plan**. Apply **defense in depth**: define schedules and retention, enable immutable vault controls and cross-Region copies, use tags for consistent coverage, enforce **least privilege** for backup roles, and regularly test restores to validate RPO/RTO.",
      "Url": "https://hub.prowler.com/check/rds_cluster_protected_by_backup_plan"
    }
  },
  "Categories": [
    "resilience"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
