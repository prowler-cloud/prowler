{
  "Provider": "aws",
  "CheckID": "storagegateway_gateway_fault_tolerant",
  "CheckTitle": "AWS Storage Gateway gateway is not hosted on EC2",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Effects/Denial of Service"
  ],
  "ServiceName": "storagegateway",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "Other",
  "ResourceGroup": "storage",
  "Description": "AWS Storage Gateway hosted on an **EC2 instance** is flagged by assessing each gateway's hosting environment, distinguishing **single-instance EC2** deployments from **non-EC2** platforms that can leverage platform-level high availability.",
  "Risk": "A **single EC2-hosted gateway** concentrates failure risk. Instance or AZ disruption, reboots, or network faults can halt file access, causing downtime and stalled writes. This degrades **availability** and can affect **integrity** via partial operations or cache desynchronization.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/filegateway/latest/files3/resource-vm-setup.html",
    "https://docs.aws.amazon.com/filegateway/latest/files3/disaster-recovery-resiliency.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "",
      "NativeIaC": "",
      "Other": "1. In the AWS Console, go to Storage Gateway and click Create gateway\n2. Choose your gateway type, then under Host platform select VMware ESXi, Microsoft Hyper-V, Linux KVM, or Hardware Appliance (do not select Amazon EC2)\n3. Download and deploy the VM on your host, power it on, and note its IP\n4. In the console, connect to and Activate the new gateway\n5. Recreate equivalent resources (shares/volumes/tapes) on the new gateway and update clients to use the new gateway IP/DNS\n6. In Storage Gateway > Gateways, delete the old EC2-hosted gateway\n7. Verify the new gateway's details show Host platform not equal to Amazon EC2",
      "Terraform": ""
    },
    "Recommendation": {
      "Text": "Design for **high availability**: avoid single-instance gateways for critical workloads. Prefer managed multi-AZ services like **EFS** or **FSx**, or use multiple gateways with client failover and resilient naming. Apply **defense in depth**, validate failover regularly, and monitor health to prevent outages.",
      "Url": "https://hub.prowler.com/check/storagegateway_gateway_fault_tolerant"
    }
  },
  "Categories": [
    "resilience"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
