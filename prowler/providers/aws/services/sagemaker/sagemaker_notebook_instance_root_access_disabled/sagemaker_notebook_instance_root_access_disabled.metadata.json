{
  "Provider": "aws",
  "CheckID": "sagemaker_notebook_instance_root_access_disabled",
  "CheckTitle": "Amazon SageMaker notebook instance has root access disabled",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "TTPs/Privilege Escalation"
  ],
  "ServiceName": "sagemaker",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "AwsSageMakerNotebookInstance",
  "ResourceGroup": "ai_ml",
  "Description": "**Amazon SageMaker notebook instances** with user **root access disabled**. The evaluation checks whether interactive users can obtain root privileges on the instance, highlighting notebooks where `RootAccess` is not set to `Disabled`.",
  "Risk": "Allowing user **root access** enables full system control, risking **integrity** (tampering with code, packages, and kernels), **confidentiality** (reading secrets, credentials, data copies), and **availability** (disabling agents or breaking environments). Compromise of a notebook can lead to lateral movement via the instance role.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/sagemaker/latest/dg/nbi-root-access.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws sagemaker update-notebook-instance --notebook-instance-name <example_resource_name> --root-access Disabled",
      "NativeIaC": "```yaml\n# CloudFormation: Disable root access on a SageMaker Notebook Instance\nResources:\n  Notebook:\n    Type: AWS::SageMaker::NotebookInstance\n    Properties:\n      InstanceType: ml.t3.medium\n      RoleArn: <example_role_arn>\n      RootAccess: Disabled  # Critical: disables user root access to pass the check\n```",
      "Other": "1. In the AWS Console, go to SageMaker > Notebook instances\n2. Select <example_resource_name> and click Stop if it is running\n3. After it stops, click Edit\n4. Set Root access to Disabled\n5. Save changes, then click Start",
      "Terraform": "```hcl\n# Terraform: Disable root access on a SageMaker Notebook Instance\nresource \"aws_sagemaker_notebook_instance\" \"notebook\" {\n  name          = \"<example_resource_name>\"\n  role_arn      = \"<example_role_arn>\"\n  instance_type = \"ml.t3.medium\"\n  root_access   = \"Disabled\"  # Critical: disables user root access to pass the check\n}\n```"
    },
    "Recommendation": {
      "Text": "Apply **least privilege**: set `RootAccess` to `Disabled` for notebook users. Provide needed software via **managed images** or **lifecycle automation**, not ad-hoc root installs. Limit the notebook IAM role, enforce **defense in depth** (network isolation and monitoring), and require controlled admin workflows for privileged changes.",
      "Url": "https://hub.prowler.com/check/sagemaker_notebook_instance_root_access_disabled"
    }
  },
  "Categories": [
    "identity-access",
    "gen-ai"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
