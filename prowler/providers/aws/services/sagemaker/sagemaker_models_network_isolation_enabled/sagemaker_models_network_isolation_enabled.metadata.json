{
  "Provider": "aws",
  "CheckID": "sagemaker_models_network_isolation_enabled",
  "CheckTitle": "Amazon SageMaker model has network isolation enabled",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices/Network Reachability",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "Effects/Data Exfiltration"
  ],
  "ServiceName": "sagemaker",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "Other",
  "ResourceGroup": "ai_ml",
  "Description": "**SageMaker models** are evaluated for **network isolation** status, indicating whether model containers are blocked from initiating network connections during hosting/inference, aside from required service control traffic.",
  "Risk": "**Disabled network isolation** allows model containers to reach external networks, enabling exfiltration of inputs, outputs, or credentials, retrieval of untrusted code, and covert callbacks. This compromises confidentiality and integrity and can facilitate lateral movement from the hosting environment.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/sagemaker/latest/dg/studio-notebooks-and-internet-access.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "",
      "NativeIaC": "```yaml\n# CloudFormation: SageMaker Model with network isolation enabled\nResources:\n  <example_resource_name>:\n    Type: AWS::SageMaker::Model\n    Properties:\n      ExecutionRoleArn: <example_resource_arn>\n      PrimaryContainer:\n        Image: <example_image>\n      EnableNetworkIsolation: true  # Critical: ensures the model container has network isolation enabled\n```",
      "Other": "1. In the AWS console, go to SageMaker > Inference > Models\n2. Click Create model\n3. Enter a name and select the execution role; set the container Image\n4. Check Enable network isolation\n5. Click Create model\n6. If used by an endpoint, create a new endpoint configuration with this model and update the endpoint, then remove the old non-isolated model",
      "Terraform": "```hcl\n# SageMaker Model with network isolation enabled\nresource \"aws_sagemaker_model\" \"<example_resource_name>\" {\n  name               = \"<example_resource_name>\"\n  execution_role_arn = \"<example_resource_arn>\"\n\n  primary_container {\n    image = \"<example_image>\"\n  }\n\n  enable_network_isolation = true  # Critical: enables network isolation to pass the check\n}\n```"
    },
    "Recommendation": {
      "Text": "Enable **network isolation** for all hosted models. Run endpoints in a **private VPC**, restrict egress with tight **security groups** and **VPC endpoints**, and enforce **least privilege IAM**. Adopt **defense in depth**: avoid public routes, allow-list destinations, and monitor outbound traffic.",
      "Url": "https://hub.prowler.com/check/sagemaker_models_network_isolation_enabled"
    }
  },
  "Categories": [
    "trust-boundaries",
    "container-security",
    "gen-ai"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
