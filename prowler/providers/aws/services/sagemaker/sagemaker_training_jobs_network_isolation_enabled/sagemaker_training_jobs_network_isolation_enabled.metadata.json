{
  "Provider": "aws",
  "CheckID": "sagemaker_training_jobs_network_isolation_enabled",
  "CheckTitle": "Amazon SageMaker training job has network isolation enabled",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices/Network Reachability",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "Effects/Data Exfiltration"
  ],
  "ServiceName": "sagemaker",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "Other",
  "ResourceGroup": "ai_ml",
  "Description": "**SageMaker training jobs** have **network isolation** enabled, preventing the training container from making any inbound or outbound network calls during execution",
  "Risk": "Without `network isolation`, training code can reach the internet or internal services, enabling:\n- **Data exfiltration** of datasets and model artifacts\n- **Supply-chain compromise** via untrusted downloads\n- **C2 beacons** and resource abuse\nThis harms **confidentiality** and **integrity**, and may impact **availability**.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/sagemaker/latest/dg/interface-vpc-endpoint.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "",
      "NativeIaC": "```yaml\n# CloudFormation: SageMaker Training Job with network isolation enabled\nResources:\n  <example_resource_name>:\n    Type: AWS::SageMaker::TrainingJob\n    Properties:\n      TrainingJobName: <example_resource_name>\n      RoleArn: <example_resource_id>\n      AlgorithmSpecification:\n        TrainingImage: <example_resource_id>\n        TrainingInputMode: File\n      OutputDataConfig:\n        S3OutputPath: s3://<example_resource_name>/\n      ResourceConfig:\n        InstanceType: ml.m5.large\n        InstanceCount: 1\n        VolumeSizeInGB: 10\n      StoppingCondition:\n        MaxRuntimeInSeconds: 3600\n      InputDataConfig:\n        - ChannelName: training\n          DataSource:\n            S3DataSource:\n              S3DataType: S3Prefix\n              S3Uri: s3://<example_resource_name>/input/\n      EnableNetworkIsolation: true  # Critical: blocks all network access from the training container\n```",
      "Other": "1. In the AWS Console, open SageMaker > Training jobs\n2. Click Create training job\n3. Fill required fields (role, image, input/output, resources)\n4. Enable the setting: Enable network isolation\n5. Create the job\n\nNote: You cannot edit an existing training job to enable this; create a new job with network isolation and retire non-compliant jobs.",
      "Terraform": "```hcl\n# SageMaker Training Job with network isolation enabled\nresource \"aws_sagemaker_training_job\" \"<example_resource_name>\" {\n  name     = \"<example_resource_name>\"\n  role_arn = \"<example_resource_id>\"\n\n  algorithm_specification {\n    training_image      = \"<example_resource_id>\"\n    training_input_mode = \"File\"\n  }\n\n  output_data_config {\n    s3_output_path = \"s3://<example_resource_name>/\"\n  }\n\n  resource_config {\n    instance_type  = \"ml.m5.large\"\n    instance_count = 1\n    volume_size_gb = 10\n  }\n\n  stopping_condition {\n    max_runtime_in_seconds = 3600\n  }\n\n  input_data_config {\n    channel_name = \"training\"\n    data_source {\n      s3_data_source {\n        s3_data_type = \"S3Prefix\"\n        s3_uri       = \"s3://<example_resource_name>/input/\"\n      }\n    }\n  }\n\n  enable_network_isolation = true # Critical: blocks all network access from the training container\n}\n```"
    },
    "Recommendation": {
      "Text": "Enable **network isolation** for training jobs by default. If network access is required, enforce **least privilege** and **defense in depth**:\n- Use private networking and `VPC endpoints`\n- Restrict egress and narrow IAM permissions\n- Prepackage dependencies to avoid external downloads",
      "Url": "https://hub.prowler.com/check/sagemaker_training_jobs_network_isolation_enabled"
    }
  },
  "Categories": [
    "trust-boundaries",
    "gen-ai"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
