{
  "Provider": "aws",
  "CheckID": "networkfirewall_logging_enabled",
  "CheckTitle": "Network Firewall has logging enabled",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53 Controls (USA)"
  ],
  "ServiceName": "networkfirewall",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "AwsNetworkFirewallFirewall",
  "ResourceGroup": "network",
  "Description": "**AWS Network Firewall** has stateful engine logging configured with at least one log type (`FLOW`, `ALERT`, or `TLS`) and an active log destination",
  "Risk": "Absent Network Firewall logs reduce **visibility** and **forensics**. Malicious flows, C2 traffic, and data exfiltration can go **undetected**, impacting:\n- Confidentiality (leakage)\n- Integrity (unauthorized traffic allowed)\n- Availability (DDoS patterns unnoticed)",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/network-firewall/latest/developerguide/firewall-logging.html",
    "https://docs.aws.amazon.com/network-firewall/latest/developerguide/firewall-update-logging-configuration.html",
    "https://docs.aws.amazon.com/securityhub/latest/userguide/networkfirewall-controls.html#networkfirewall-2"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws network-firewall update-logging-configuration --firewall-arn <FIREWALL_ARN> --logging-configuration 'LogDestinationConfigs=[{LogType=FLOW,LogDestinationType=CLOUDWATCH_LOGS,LogDestination={LogGroup=<LOG_GROUP_NAME>}}]'",
      "NativeIaC": "```yaml\nResources:\n  <example_resource_name>:\n    Type: AWS::NetworkFirewall::LoggingConfiguration\n    Properties:\n      FirewallArn: <example_resource_id>  # CRITICAL: Targets the firewall to enable logging\n      LoggingConfiguration:\n        LogDestinationConfigs:\n          - LogType: FLOW                  # CRITICAL: Enables at least one log type\n            LogDestinationType: CloudWatchLogs  # CRITICAL: Selects a valid destination type\n            LogDestination:\n              logGroup: <example_log_group_name>  # CRITICAL: Existing CloudWatch Logs group to receive logs\n```",
      "Other": "1. Open the AWS console and go to VPC > Network Firewall > Firewalls\n2. Select your firewall and open the Firewall details tab\n3. In the Logging section, click Edit\n4. Enable at least one Log type (e.g., Flow)\n5. Choose Destination type: CloudWatch Logs and select an existing log group\n6. Click Save",
      "Terraform": "```hcl\nresource \"aws_networkfirewall_logging_configuration\" \"<example_resource_name>\" {\n  firewall_arn = \"<example_resource_id>\"  # CRITICAL: Targets the firewall to enable logging\n\n  logging_configuration {\n    log_destination_config {\n      log_type             = \"FLOW\"              # CRITICAL: Enables at least one log type\n      log_destination_type = \"CloudWatchLogs\"   # CRITICAL: Selects a valid destination type\n      log_destination = {\n        logGroup = \"<example_log_group_name>\"   # CRITICAL: Existing CloudWatch Logs group to receive logs\n      }\n    }\n  }\n}\n```"
    },
    "Recommendation": {
      "Text": "Enable comprehensive firewall logging and send `FLOW`, `ALERT`, and *when applicable* `TLS` events to a centralized, tamper-resistant destination. Apply **least privilege** to writers/readers, enforce **encryption** and **retention**, and integrate alerts with monitoring for **defense in depth**.",
      "Url": "https://hub.prowler.com/check/networkfirewall_logging_enabled"
    }
  },
  "Categories": [
    "logging"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
