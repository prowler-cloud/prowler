{
  "Provider": "aws",
  "CheckID": "appstream_fleet_maximum_session_duration",
  "CheckTitle": "AppStream fleet maximum user session duration is less than 10 hours",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices"
  ],
  "ServiceName": "appstream",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "Other",
  "ResourceGroup": "compute",
  "Description": "**AppStream fleets** enforce a **maximum user session duration**. This finding evaluates each fleet's configured limit against a threshold-default `10 hours` (`36000` seconds)-and identifies fleets whose session duration exceeds that limit.",
  "Risk": "Overlong sessions widen the window for **session hijacking**, **lateral movement**, and **data exfiltration** if endpoints or tokens are compromised. Reduced reauthentication weakens **confidentiality** and **integrity**, and extended access can increase **costs** and resource contention.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/appstream2/latest/developerguide/set-up-stacks-fleets.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws appstream update-fleet --name <example_resource_name> --max-user-duration-in-seconds 3600",
      "NativeIaC": "```yaml\n# CloudFormation: Set AppStream Fleet session duration below 10 hours\nResources:\n  AppStreamFleet:\n    Type: AWS::AppStream::Fleet\n    Properties:\n      Name: \"<example_resource_name>\"\n      MaxUserDurationInSeconds: 3600  # CRITICAL: ensures max session duration is < 10h to pass the check\n```",
      "Other": "1. Open the AWS Console and go to Amazon AppStream 2.0\n2. Click Fleets and select <example_resource_name>\n3. Click Edit\n4. Set Maximum session duration to a value under 10 hours (e.g., 3600 seconds)\n5. Save changes",
      "Terraform": "```hcl\n# Terraform: Set AppStream Fleet session duration below 10 hours\nresource \"aws_appstream_fleet\" \"<example_resource_name>\" {\n  name                         = \"<example_resource_name>\"\n  max_user_duration_in_seconds = 3600 # CRITICAL: ensures max session duration is < 10h to pass the check\n}\n```"
    },
    "Recommendation": {
      "Text": "Configure the **maximum session duration** to `<= 10 hours` (e.g., `600` minutes) or less based on data sensitivity. Prefer shorter limits, enforce **reauthentication** on renewal, apply **least privilege**, and enable **idle timeouts**. Monitor session activity as part of **defense in depth**.",
      "Url": "https://hub.prowler.com/check/appstream_fleet_maximum_session_duration"
    }
  },
  "Categories": [],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": "Infrastructure Security"
}
