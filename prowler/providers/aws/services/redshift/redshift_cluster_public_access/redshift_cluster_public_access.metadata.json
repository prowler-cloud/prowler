{
  "Provider": "aws",
  "CheckID": "redshift_cluster_public_access",
  "CheckTitle": "Redshift cluster is not publicly exposed to the Internet",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices/Network Reachability",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices"
  ],
  "ServiceName": "redshift",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "critical",
  "ResourceType": "AwsRedshiftCluster",
  "ResourceGroup": "analytics",
  "Description": "Amazon Redshift clusters with `publicly accessible` endpoints in **public subnets** and security groups allowing TCP from `0.0.0.0/0` or `::/0` are identified as internet-exposed.\n\nPublic endpoints without internet reachability due to private subnets or restrictive rules are recognized separately.",
  "Risk": "Internet-exposed Redshift endpoints allow direct DB access from any host, impacting:\n- **Confidentiality**: credential brute force, unauthorized queries, data exfiltration\n- **Integrity**: unauthorized writes or schema changes\n- **Availability**: scanning/abuse leading to connection exhaustion or disruption",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/de_de/redshift/latest/mgmt/rs-ra3-VPC-public-private.html",
    "https://www.trendmicro.com/trendaivisiononecloudriskmanagement/knowledge-base/aws/Redshift/redshift-cluster-publicly-accessible.html",
    "https://docs.aws.amazon.com/redshift/latest/mgmt/managing-clusters-vpc.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws redshift modify-cluster --cluster-identifier <CLUSTER_ID> --no-publicly-accessible",
      "NativeIaC": "```yaml\n# CloudFormation: Redshift cluster not publicly accessible\nResources:\n  <example_resource_name>:\n    Type: AWS::Redshift::Cluster\n    Properties:\n      ClusterType: single-node\n      DBName: <example_db_name>\n      MasterUsername: <example_username>\n      MasterUserPassword: <example_password>\n      NodeType: dc2.large\n      PubliclyAccessible: false  # Critical: disables public access to prevent Internet exposure\n```",
      "Other": "1. Open the AWS Management Console and go to Amazon Redshift\n2. Select your cluster\n3. Click Edit (or Actions > Modify)\n4. Set Publicly accessible to Off/No\n5. Save changes and apply the modification",
      "Terraform": "```hcl\n# Redshift cluster not publicly accessible\nresource \"aws_redshift_cluster\" \"<example_resource_name>\" {\n  cluster_identifier  = \"<example_resource_id>\"\n  node_type           = \"dc2.large\"\n  cluster_type        = \"single-node\"\n  master_username     = \"<example_username>\"\n  master_password     = \"<example_password>\"\n\n  publicly_accessible = false  # Critical: disables public access to prevent Internet exposure\n}\n```"
    },
    "Recommendation": {
      "Text": "Prefer **private connectivity**: disable public access, place clusters in private subnets, and apply **least privilege** security groups limited to trusted CIDRs or VPC sources. Use **defense in depth** with VPN/peering/endpoints, strong authentication, and monitoring. Avoid `0.0.0.0/0` or `::/0` to database ports.",
      "Url": "https://hub.prowler.com/check/redshift_cluster_public_access"
    }
  },
  "Categories": [
    "internet-exposed"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
