{
  "Provider": "aws",
  "CheckID": "redshift_cluster_non_default_database_name",
  "CheckTitle": "Redshift cluster does not use the default database name dev",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "TTPs/Discovery"
  ],
  "ServiceName": "redshift",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "low",
  "ResourceType": "AwsRedshiftCluster",
  "ResourceGroup": "analytics",
  "Description": "**Amazon Redshift clusters** are identified when the database name equals the default `dev`, rather than a custom name.",
  "Risk": "Using the predictable `dev` name weakens **confidentiality** and **integrity**. Mis-scoped IAM or network rules may unintentionally match the database, and known names aid enumeration and targeted connection attempts, increasing the likelihood of unauthorized queries and data exposure.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/securityhub/latest/userguide/redshift-controls.html#redshift-9",
    "https://docs.aws.amazon.com/redshift/latest/gsg/getting-started.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "",
      "NativeIaC": "```yaml\n# CloudFormation: Create a Redshift cluster with a non-default DB name\nResources:\n  <example_resource_name>:\n    Type: AWS::Redshift::Cluster\n    Properties:\n      ClusterType: single-node\n      NodeType: <NODE_TYPE>\n      MasterUsername: <MASTER_USERNAME>\n      MasterUserPassword: <MASTER_PASSWORD>\n      DBName: <new-db-name>  # Critical: set initial database name to a value other than \"dev\" to pass the check\n```",
      "Other": "1. In the AWS Management Console, go to Amazon Redshift > Provisioned clusters\n2. Click Create cluster\n3. In Database configurations, set Database name to a value that is not \"dev\"\n4. Complete the wizard and create the cluster\n5. Migrate workloads to the new cluster and delete the old cluster that used the default \"dev\" database name",
      "Terraform": "```hcl\n# Terraform: Redshift cluster with non-default database name\nresource \"aws_redshift_cluster\" \"example\" {\n  cluster_identifier = \"<example_resource_id>\"\n  node_type          = \"<NODE_TYPE>\"\n  cluster_type       = \"single-node\"\n  master_username    = \"<MASTER_USERNAME>\"\n  master_password    = \"<MASTER_PASSWORD>\"\n  database_name      = \"<new-db-name>\" # Critical: ensure this is not \"dev\" to pass the check\n}\n```"
    },
    "Recommendation": {
      "Text": "Use a **unique, non-default database name** per cluster. Define a naming standard that avoids generic values (e.g., `dev`, `test`) and supports **least privilege** by preventing broad policy conditions. Review IAM and network rules to reference only intended, explicit resources.",
      "Url": "https://hub.prowler.com/check/redshift_cluster_non_default_database_name"
    }
  },
  "Categories": [
    "vulnerabilities"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
