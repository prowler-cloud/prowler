{
  "Provider": "aws",
  "CheckID": "redshift_cluster_audit_logging",
  "CheckTitle": "Redshift cluster has audit logging enabled",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices"
  ],
  "ServiceName": "redshift",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "AwsRedshiftCluster",
  "ResourceGroup": "analytics",
  "Description": "Amazon Redshift clusters are evaluated for **database audit logging** that exports connection, user, and user-activity events to Amazon S3 or CloudWatch.",
  "Risk": "Without audit logs, malicious logins and queries can evade detection, impacting **confidentiality** (data exfiltration), **integrity** (unauthorized user/role changes), and **availability** of investigations due to missing evidence for forensics and incident response.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/redshift/latest/mgmt/db-auditing.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws redshift enable-logging --cluster-identifier <example_resource_id> --bucket-name <S3_BUCKET_NAME>",
      "NativeIaC": "```yaml\nResources:\n  <example_resource_name>:\n    Type: AWS::Redshift::Cluster\n    Properties:\n      ClusterType: single-node\n      NodeType: dc2.large\n      DBName: mydb\n      MasterUsername: masteruser\n      MasterUserPassword: <PASSWORD>\n      # Critical: Enables Redshift audit logging to S3\n      LoggingProperties:\n        BucketName: <S3_BUCKET_NAME>  # Critical: Required to turn on logging\n```",
      "Other": "1. Open the Amazon Redshift console and go to Clusters\n2. Select the target cluster and open the Properties tab\n3. In Database audit logging, click Edit\n4. Enable logging and select an S3 bucket\n5. Click Save changes",
      "Terraform": "```hcl\nresource \"aws_redshift_cluster\" \"<example_resource_name>\" {\n  cluster_identifier = \"<example_resource_id>\"\n  node_type          = \"dc2.large\"\n  master_username    = \"masteruser\"\n  master_password    = \"SuperSecretPassw0rd!\"\n  cluster_type       = \"single-node\"\n\n  logging {\n    enable      = true                 # Critical: Turns on audit logging\n    bucket_name = \"<S3_BUCKET_NAME>\"  # Critical: S3 destination required\n  }\n}\n```"
    },
    "Recommendation": {
      "Text": "Enable comprehensive **Redshift audit logging** and include user-activity events. Centralize logs in a protected destination, enforce **least privilege** access, retention, and immutability. Implement **alerts** for anomalous connections and queries as part of **defense in depth**.",
      "Url": "https://hub.prowler.com/check/redshift_cluster_audit_logging"
    }
  },
  "Categories": [
    "logging",
    "forensics-ready"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
