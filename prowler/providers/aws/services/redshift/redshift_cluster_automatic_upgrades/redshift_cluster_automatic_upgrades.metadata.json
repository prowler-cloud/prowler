{
  "Provider": "aws",
  "CheckID": "redshift_cluster_automatic_upgrades",
  "CheckTitle": "Redshift cluster has automatic version upgrade enabled",
  "CheckType": [
    "Software and Configuration Checks/Patch Management",
    "Software and Configuration Checks/AWS Security Best Practices"
  ],
  "ServiceName": "redshift",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "AwsRedshiftCluster",
  "ResourceGroup": "analytics",
  "Description": "**Amazon Redshift clusters** have automatic major engine upgrades allowed via `AllowVersionUpgrade` so updates are applied during the maintenance window.",
  "Risk": "Without automatic upgrades, clusters can run **vulnerable engine versions**, enabling exploits against known flaws.\n\nAttackers may read or tamper data (**confidentiality/integrity**), and unresolved bugs can cause downtime (**availability**). Delayed patching increases exposure window and operational risk.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/systems-manager-automation-runbooks/latest/userguide/automation-aws-modify-redshift-maintenance.html",
    "https://docs.aws.amazon.com/redshift/latest/mgmt/managing-cluster-operations.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws redshift modify-cluster --cluster-identifier <cluster_id> --allow-version-upgrade",
      "NativeIaC": "```yaml\n# CloudFormation to ensure Redshift allows major version upgrades\nResources:\n  <example_resource_name>:\n    Type: AWS::Redshift::Cluster\n    Properties:\n      ClusterType: single-node\n      DBName: <db_name>\n      MasterUsername: <master_username>\n      MasterUserPassword: <master_user_password>\n      NodeType: <node_type>\n      AllowVersionUpgrade: true  # Critical: enables automatic major version upgrades during the maintenance window\n```",
      "Other": "1. Open the Amazon Redshift console\n2. Go to Clusters and select your cluster\n3. Click Edit (or Edit maintenance settings)\n4. Enable \"Major version upgrades\" (Allow version upgrade)\n5. Click Save changes",
      "Terraform": "```hcl\n# Redshift cluster allowing automatic major version upgrades\nresource \"aws_redshift_cluster\" \"<example_resource_name>\" {\n  cluster_identifier = \"<example_resource_id>\"\n  node_type          = \"<node_type>\"\n  master_username    = \"<master_username>\"\n  master_password    = \"<master_user_password>\"\n\n  allow_version_upgrade = true  # Critical: enables automatic major version upgrades\n}\n```"
    },
    "Recommendation": {
      "Text": "Enable `AllowVersionUpgrade` to keep clusters patched. Use a controlled maintenance window and an appropriate maintenance track; validate upgrades in staging before production.\n\nAlign with **secure-by-default** and **defense in depth**; keep tested backups and rollback plans. *Document justified exceptions and review regularly*.",
      "Url": "https://hub.prowler.com/check/redshift_cluster_automatic_upgrades"
    }
  },
  "Categories": [
    "vulnerabilities"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
