{
  "Provider": "aws",
  "CheckID": "redshift_cluster_non_default_username",
  "CheckTitle": "Amazon Redshift cluster does not use the default admin username",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "TTPs/Initial Access/Unauthorized Access"
  ],
  "ServiceName": "redshift",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "AwsRedshiftCluster",
  "ResourceGroup": "analytics",
  "Description": "**Amazon Redshift clusters** are assessed for use of a **non-default admin username**; clusters using the known default `awsuser` are identified.",
  "Risk": "Default admin names make accounts predictable, enabling username enumeration, password spraying, and brute-force attempts. A takeover can expose warehouse data (**confidentiality**), enable unauthorized queries or schema changes (**integrity**), and disrupt analytics workloads (**availability**).",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/securityhub/latest/userguide/redshift-controls.html#redshift-8",
    "https://www.trendmicro.com/trendaivisiononecloudriskmanagement/knowledge-base/aws/Redshift/master-username.html",
    "https://docs.aws.amazon.com/redshift/latest/gsg/rs-gsg-prereq.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "",
      "NativeIaC": "```yaml\n# CloudFormation: Redshift cluster with non-default admin username\nResources:\n  <example_resource_name>:\n    Type: AWS::Redshift::Cluster\n    Properties:\n      ClusterType: single-node\n      NodeType: <example_node_type>\n      MasterUsername: <new-username>  # Critical: not 'awsuser' to pass the check\n      MasterUserPassword: <password>\n```",
      "Other": "1. In the Amazon Redshift console, choose Create cluster\n2. Set Admin user name to a value other than awsuser (critical)\n3. Enter the required minimal settings (password, node type) and create the cluster\n4. Migrate data from the old cluster if needed\n5. Delete the old cluster that uses the awsuser admin to remove the failing resource",
      "Terraform": "```hcl\nresource \"aws_redshift_cluster\" \"<example_resource_name>\" {\n  cluster_identifier = \"<example_resource_id>\"\n  node_type          = \"<example_node_type>\"\n  cluster_type       = \"single-node\"\n  master_username    = \"<new-username>\"  # Critical: not 'awsuser' to pass the check\n  master_password    = \"<password>\"\n}\n```"
    },
    "Recommendation": {
      "Text": "Use a **unique, non-predictable** admin username at creation instead of `awsuser`. Apply **least privilege** by using dedicated roles and limiting superuser use. Enforce strong authentication, rotate credentials, and audit access. *For existing clusters*, create a new one with a unique admin and migrate.",
      "Url": "https://hub.prowler.com/check/redshift_cluster_non_default_username"
    }
  },
  "Categories": [
    "identity-access"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
