{
  "Provider": "aws",
  "CheckID": "redshift_cluster_encrypted_at_rest",
  "CheckTitle": "Redshift cluster is encrypted at rest",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark",
    "Effects/Data Exposure"
  ],
  "ServiceName": "redshift",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "critical",
  "ResourceType": "AwsRedshiftCluster",
  "ResourceGroup": "analytics",
  "Description": "**Amazon Redshift clusters** use **encryption at rest**. The evaluation inspects the cluster's encryption setting to determine if on-disk data and snapshots are protected with a managed key.",
  "Risk": "Without **encryption at rest**, data blocks and snapshots can be read if storage media or backups are accessed by unauthorized parties. This compromises **confidentiality**, enabling bulk **data exfiltration** and exposure of sensitive analytics, which can facilitate further compromise.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/redshift/latest/mgmt/changing-cluster-encryption.html",
    "https://docs.aws.amazon.com/redshift/latest/mgmt/working-with-db-encryption.html",
    "https://docs.aws.amazon.com/securityhub/latest/userguide/redshift-controls.html#redshift-10"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws redshift modify-cluster --cluster-identifier <cluster-id> --encrypted",
      "NativeIaC": "```yaml\n# CloudFormation: Enable at-rest encryption for a Redshift cluster\nResources:\n  <example_resource_name>:\n    Type: AWS::Redshift::Cluster\n    Properties:\n      ClusterIdentifier: \"<example_resource_id>\"\n      DBName: \"<DB_NAME>\"\n      MasterUsername: \"<MASTER_USERNAME>\"\n      MasterUserPassword: \"<MASTER_PASSWORD>\"\n      NodeType: \"<NODE_TYPE>\"\n      ClusterType: \"<CLUSTER_TYPE>\"\n      Encrypted: true  # Critical: enables encryption at rest to pass the check\n```",
      "Other": "1. Open the AWS Management Console and go to Amazon Redshift\n2. Choose Clusters, then select your cluster\n3. Open the Properties tab > Database configurations > Edit > Edit encryption\n4. Select Enable encryption (use AWS-managed or a specific KMS key)\n5. Click Save changes",
      "Terraform": "```hcl\n# Terraform: Enable at-rest encryption for a Redshift cluster\nresource \"aws_redshift_cluster\" \"<example_resource_name>\" {\n  cluster_identifier = \"<example_resource_id>\"\n  node_type          = \"<NODE_TYPE>\"\n  cluster_type       = \"<CLUSTER_TYPE>\"\n  master_username    = \"<MASTER_USERNAME>\"\n  master_password    = \"<MASTER_PASSWORD>\"\n\n  encrypted = true  # Critical: enables encryption at rest to pass the check\n}\n```"
    },
    "Recommendation": {
      "Text": "Enable **encryption at rest** for all clusters and prefer **customer-managed keys** (`CMEK`) for control and auditing. Apply **least privilege** to key usage, rotate keys, and restrict snapshot access and cross-Region copies. Monitor key health and access events as part of **defense-in-depth**.",
      "Url": "https://hub.prowler.com/check/redshift_cluster_encrypted_at_rest"
    }
  },
  "Categories": [
    "encryption"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
