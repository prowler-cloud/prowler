{
  "Provider": "aws",
  "CheckID": "redshift_cluster_automated_snapshot",
  "CheckTitle": "Redshift cluster has automated snapshots enabled",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices"
  ],
  "ServiceName": "redshift",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "AwsRedshiftCluster",
  "ResourceGroup": "analytics",
  "Description": "**Amazon Redshift clusters** are evaluated for **automated snapshots** being enabled with a retention period `> 0`, confirming that periodic backups are created and retained.",
  "Risk": "Without **automated snapshots**, clusters lack recent recovery points, degrading **availability** and **integrity**.\n\nAccidental deletion, malicious changes, or failed ETL can cause data loss and prolonged recovery, increasing RPO/RTO and limiting effective forensic analysis.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/AWS_Redshift.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws redshift modify-cluster --cluster-identifier <example_resource_id> --automated-snapshot-retention-period 1",
      "NativeIaC": "```yaml\n# CloudFormation: Enable automated snapshots for a Redshift cluster\nResources:\n  <example_resource_name>:\n    Type: AWS::Redshift::Cluster\n    Properties:\n      ClusterType: single-node\n      NodeType: <NODE_TYPE>\n      DBName: <DB_NAME>\n      MasterUsername: <MASTER_USERNAME>\n      MasterUserPassword: <MASTER_PASSWORD>\n      AutomatedSnapshotRetentionPeriod: 1  # Critical: enables automated snapshots by retaining them for 1 day\n```",
      "Other": "1. Open the AWS Console and go to Amazon Redshift\n2. Select your cluster and click Modify\n3. Under Backup, set Automated snapshot retention period to 1 (or greater)\n4. Click Save changes and apply the modification",
      "Terraform": "```hcl\n# Terraform: Enable automated snapshots for a Redshift cluster\nresource \"aws_redshift_cluster\" \"<example_resource_name>\" {\n  cluster_identifier = \"<example_resource_id>\"\n  cluster_type       = \"single-node\"\n  node_type          = \"<NODE_TYPE>\"\n  database_name      = \"<DB_NAME>\"\n  master_username    = \"<MASTER_USERNAME>\"\n  master_password    = \"<MASTER_PASSWORD>\"\n\n  automated_snapshot_retention_period = 1  # Critical: enables automated snapshots by retaining them for 1 day\n}\n```"
    },
    "Recommendation": {
      "Text": "Enable **automated snapshots** with retention aligned to RPO/RTO. Enforce **least privilege** on snapshot access and use **encryption**. Regularly test restores and monitor backup health.\n\n*For resilience*, replicate snapshots to another Region/account and separate backup administration from data owners.",
      "Url": "https://hub.prowler.com/check/redshift_cluster_automated_snapshot"
    }
  },
  "Categories": [
    "resilience"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
