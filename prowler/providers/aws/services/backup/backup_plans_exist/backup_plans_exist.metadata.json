{
  "Provider": "aws",
  "CheckID": "backup_plans_exist",
  "CheckTitle": "At least one AWS Backup plan exists",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices"
  ],
  "ServiceName": "backup",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "low",
  "ResourceType": "AwsBackupBackupPlan",
  "ResourceGroup": "storage",
  "Description": "**AWS Backup** is assessed for the existence of at least one **backup plan** that schedules and retains recovery points for selected resources.\n\nThe evaluation determines whether any plan is configured; when none is found-even if backup vaults exist-the absence of a plan is noted.",
  "Risk": "Without a backup plan, resources lack scheduled recovery points, undermining RPO/RTO.\n- Irrecoverable data after deletion or corruption (integrity)\n- Prolonged outages due to unavailable restores (availability)\n- Inconsistent backups that hinder investigations and controlled recovery",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://awscli.amazonaws.com/v2/documentation/api/2.0.33/reference/backup/create-backup-plan.html",
    "https://docs.aws.amazon.com/aws-backup/latest/devguide/about-backup-plans.html",
    "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/backup_plan",
    "https://medium.com/@christopheradamson253/backup-strategies-using-aws-backup-1b17b94a7957"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws backup create-backup-plan --backup-plan \"{\\\"BackupPlanName\\\":\\\"<example_resource_name>\\\",\\\"Rules\\\":[{\\\"RuleName\\\":\\\"<example_resource_name>\\\",\\\"TargetBackupVaultName\\\":\\\"Default\\\"}]}\"",
      "NativeIaC": "```yaml\n# CloudFormation: create a minimal AWS Backup Plan to pass the check\nResources:\n  <example_resource_name>:\n    Type: AWS::Backup::BackupPlan\n    Properties:\n      BackupPlan:\n        BackupPlanName: <example_resource_name>  # Critical: ensures at least one Backup Plan exists\n        Rules:\n          - RuleName: <example_resource_name>     # Critical: minimal required rule\n            TargetBackupVault: Default            # Critical: required vault for the rule\n```",
      "Other": "1. In the AWS Console, go to AWS Backup\n2. Click Backup plans > Create backup plan\n3. Choose Build a new plan\n4. Enter Plan name: <example_resource_name>\n5. Under Backup rule, set Rule name: <example_resource_name> and Target backup vault: Default\n6. Click Create plan",
      "Terraform": "```hcl\n# Terraform: minimal AWS Backup Plan to satisfy the check\nresource \"aws_backup_plan\" \"<example_resource_name>\" {\n  name = \"<example_resource_name>\"  # Critical: creates the Backup Plan so the check passes\n\n  rule {\n    rule_name         = \"<example_resource_name>\"  # Critical: minimal rule\n    target_vault_name = \"Default\"                  # Critical: required vault\n  }\n}\n```"
    },
    "Recommendation": {
      "Text": "Establish and enforce **backup plans** for critical workloads:\n- Define schedules, retention, and lifecycle to meet RPO/RTO\n- Use tagging to include all required resources by policy\n- Enable cross-Region/account copies and immutability where feasible\n- Apply least privilege to backup roles\n- Regularly test restores and review reports",
      "Url": "https://hub.prowler.com/check/backup_plans_exist"
    }
  },
  "Categories": [
    "resilience"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
