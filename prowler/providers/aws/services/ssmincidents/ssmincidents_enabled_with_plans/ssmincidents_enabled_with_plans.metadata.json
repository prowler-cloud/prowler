{
  "Provider": "aws",
  "CheckID": "ssmincidents_enabled_with_plans",
  "CheckTitle": "SSM Incidents replication set is ACTIVE and has at least one response plan",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/NIST CSF Controls (USA)"
  ],
  "ServiceName": "ssmincidents",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "Other",
  "ResourceGroup": "monitoring",
  "Description": "**Incident Manager** uses a **replication set** and **response plans**. This evaluates whether a replication set exists and is `ACTIVE`, and that at least one response plan is configured for coordinated incident handling.",
  "Risk": "Without an `ACTIVE` replication set or response plans, incidents lack coordinated engagement and automation, raising MTTR and impacting availability and integrity.\n\nThreats include prolonged outages, lateral movement, and data exfiltration from delayed containment and misrouted escalation.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/incident-manager/latest/userguide/response-plans.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "",
      "NativeIaC": "```yaml\n# CloudFormation: create a minimal Incident Manager response plan\nResources:\n  ResponsePlan:\n    Type: AWS::SSMIncidents::ResponsePlan\n    Properties:\n      Name: <example_resource_name>  # Critical: ensures at least one response plan exists\n      IncidentTemplate:              # Critical: required template for the response plan\n        Title: <example_title>       # Critical: required\n        Impact: 5                    # Critical: required (1=highest, 5=lowest)\n```",
      "Other": "1. In the AWS Console, go to Systems Manager > Incident Manager\n2. Replication sets > Create replication set > add at least one Region > Create; wait until Status is ACTIVE\n3. Response plans > Create response plan > set Name, Title, and Impact > Create\n4. Verify: Replication set shows ACTIVE and at least one response plan exists",
      "Terraform": "```hcl\n# Ensure replication set exists and becomes ACTIVE\nresource \"aws_ssmincidents_replication_set\" \"example\" {\n  regions {                      # Critical: creates the replication set so it can be ACTIVE\n    region_name = \"us-east-1\"\n  }\n}\n\n# Create a minimal response plan\nresource \"aws_ssmincidents_response_plan\" \"example\" {\n  name = \"<example_resource_name>\"  # Critical: ensures at least one response plan exists\n\n  incident_template {                # Critical: required template for the plan\n    title  = \"<example_title>\"\n    impact = 5\n  }\n}\n```"
    },
    "Recommendation": {
      "Text": "Establish an `ACTIVE` **replication set** and create **response plans** that define engagement, escalation, runbooks, severity, and communication.\n\nApply **least privilege** to automation roles, test plans regularly, integrate with monitoring to trigger them, and use **defense in depth** with redundant contacts and Regions.",
      "Url": "https://hub.prowler.com/check/ssmincidents_enabled_with_plans"
    }
  },
  "Categories": [
    "resilience"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
