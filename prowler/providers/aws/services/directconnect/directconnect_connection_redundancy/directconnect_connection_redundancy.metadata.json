{
  "Provider": "aws",
  "CheckID": "directconnect_connection_redundancy",
  "CheckTitle": "Direct Connect connections span at least two locations per region",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/AWS Security Best Practices/Network Reachability"
  ],
  "ServiceName": "directconnect",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "Other",
  "Description": "**AWS Direct Connect** connectivity is provisioned with **connection and location redundancy**-multiple connections spread across **at least two distinct Direct Connect locations** in each Region.",
  "Risk": "Missing **connection/location redundancy** creates a **single point of failure**, degrading **availability**. A router, fiber, or site outage can sever private paths to AWS, stalling app traffic, data replication, and admin access, leading to timeouts or extended downtime until alternate paths are restored.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://www.amazonaws.cn/en/directconnect/resiliency-recommendation/",
    "https://www.coresite.com/blog/how-to-configure-network-with-aws-direct-connect",
    "https://tutorialsdojo.com/aws-direct-connect/",
    "https://www.examtopics.com/discussions/amazon/view/35678-exam-aws-certified-solutions-architect-associate-saa-c02/",
    "https://docs.aws.amazon.com/awssupport/latest/user/fault-tolerance-checks.html#amazon-direct-connect-location-resiliency",
    "https://repost.aws/knowledge-center/direct-connect-physical-redundancy",
    "https://aws.amazon.com/directconnect/resiliency-recommendation/"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws directconnect create-connection --region <REGION> --location <NEW_DX_LOCATION_CODE> --bandwidth 1Gbps --connection-name <example_resource_name>",
      "NativeIaC": "```yaml\n# CloudFormation: add a second Direct Connect connection in a different location\nResources:\n  DXConnection:\n    Type: AWS::DirectConnect::Connection\n    Properties:\n      ConnectionName: \"<example_resource_name>\"\n      Bandwidth: \"1Gbps\"\n      Location: \"<NEW_DX_LOCATION_CODE>\"  # Critical: use a different DX location in this Region to add location redundancy\n```",
      "Other": "1. In the AWS Console, go to Direct Connect > Connections\n2. Click Create connection\n3. Region: select the Region where the existing connection resides\n4. Name: enter <example_resource_name>\n5. Location: select a different Direct Connect location than your existing connection\n6. Bandwidth: choose a supported value (e.g., 1 Gbps)\n7. Click Create connection",
      "Terraform": "```hcl\n# Create an additional Direct Connect connection in a different location\nresource \"aws_dx_connection\" \"example\" {\n  name      = \"<example_resource_name>\"\n  bandwidth = \"1Gbps\"\n  location  = \"<NEW_DX_LOCATION_CODE>\" # Critical: choose a different DX location in the same Region to achieve location redundancy\n}\n```"
    },
    "Recommendation": {
      "Text": "Apply **redundancy** and **defense in depth**:\n- Deploy 2 Direct Connect connections across **two distinct locations**\n- Use **dynamic, active/active routing** for automatic failover\n- Ensure **provider/device diversity**\n- Size capacity so one link loss doesn't overload remaining paths\n- Consider a **VPN** as tertiary backup",
      "Url": "https://hub.prowler.com/check/directconnect_connection_redundancy"
    }
  },
  "Categories": [
    "resilience"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
