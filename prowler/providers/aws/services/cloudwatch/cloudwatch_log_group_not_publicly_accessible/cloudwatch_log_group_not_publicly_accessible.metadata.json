{
  "Provider": "aws",
  "CheckID": "cloudwatch_log_group_not_publicly_accessible",
  "CheckTitle": "CloudWatch Log Group is not publicly accessible",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices/Network Reachability",
    "TTPs/Initial Access/Unauthorized Access",
    "Effects/Data Exposure"
  ],
  "ServiceName": "cloudwatch",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "Other",
  "Description": "**CloudWatch Log Groups** with resource policies that grant access to any principal are identified. Statements using `Principal:\"*\"` or wildcard `Resource` that reference a log group ARN indicate that the log group is exposed through a public policy.",
  "Risk": "Public access to log groups enables unauthorized reading of logs, revealing secrets and operational metadata, harming **confidentiality**. If broad actions are allowed, attackers can modify subscriptions or logs, undermining **integrity** and disrupting **availability** of audit evidence.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/iam-access-control-overview-cwl.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws logs delete-resource-policy --policy-name <policy-name>",
      "NativeIaC": "```yaml\nResources:\n  <example_resource_name>:\n    Type: AWS::Logs::ResourcePolicy\n    Properties:\n      PolicyName: <example_resource_name>\n      PolicyDocument:\n        Version: '2012-10-17'\n        Statement:\n          - Effect: Allow\n            Principal:\n              AWS: \"<example_account_id>\"  # FIX: restrict to specific account (not *) to prevent public access\n            Action: logs:PutSubscriptionFilter\n            Resource: \"arn:aws:logs:<region>:<account-id>:destination:<example_resource_name>\"\n```",
      "Other": "1. Open the CloudWatch console\n2. Go to Logs > Resource policies\n3. Select the policy that exposes your log groups (Principal set to \"*\" or Resource \"*\")\n4. Click Delete and confirm",
      "Terraform": "```hcl\nresource \"aws_cloudwatch_log_resource_policy\" \"<example_resource_name>\" {\n  policy_name     = \"<example_resource_name>\"\n  policy_document = jsonencode({\n    Version   = \"2012-10-17\"\n    Statement = [{\n      Effect    = \"Allow\"\n      Principal = { AWS = \"<example_account_id>\" } # FIX: restrict Principal (not \"*\") to avoid public access\n      Action    = \"logs:PutSubscriptionFilter\"\n      Resource  = \"arn:aws:logs:<region>:<account-id>:destination:<example_resource_name>\"\n    }]\n  })\n}\n```"
    },
    "Recommendation": {
      "Text": "Remove public access from log group resource policies. Replace `Principal:\"*\"` and `Resource:\"*\"` with narrowly scoped principals and specific ARNs. Grant only necessary actions, apply conditions to constrain use, and enforce **least privilege** and **separation of duties** with regular policy reviews.",
      "Url": "https://hub.prowler.com/check/cloudwatch_log_group_not_publicly_accessible"
    }
  },
  "Categories": [
    "internet-exposed",
    "identity-access"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
