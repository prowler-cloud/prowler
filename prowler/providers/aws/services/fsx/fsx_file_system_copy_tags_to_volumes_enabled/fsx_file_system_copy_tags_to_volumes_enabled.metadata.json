{
  "Provider": "aws",
  "CheckID": "fsx_file_system_copy_tags_to_volumes_enabled",
  "CheckTitle": "FSx file system has copy tags to volumes enabled",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices"
  ],
  "ServiceName": "fsx",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "low",
  "ResourceType": "Other",
  "ResourceGroup": "storage",
  "Description": "**Amazon FSx file systems** are configured to **copy tags to volumes** via `copy_tags_to_volumes`.\n\nIdentifies file systems where volume resources will not inherit the file system's tags.",
  "Risk": "Without tag propagation, volumes lack consistent labels used for **ABAC**, classification, and automation. This can erode confidentiality through mis-scoped access controls and impact availability if backups or safeguards aren't applied to untagged volumes.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/securityhub/latest/userguide/fsx-controls.html#fsx-1",
    "https://docs.aws.amazon.com/config/latest/developerguide/fsx-openzfs-copy-tags-enabled.html",
    "https://docs.aws.amazon.com/fsx/latest/OpenZFSGuide/updating-file-system.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws fsx update-file-system --file-system-id <file-system-id> --open-zfs-configuration CopyTagsToVolumes=true",
      "NativeIaC": "```yaml\n# CloudFormation: Enable copying tags to volumes for FSx for OpenZFS\nResources:\n  <example_resource_name>:\n    Type: AWS::FSx::FileSystem\n    Properties:\n      FileSystemType: OPENZFS\n      SubnetIds:\n        - <example_resource_id>\n      OpenZFSConfiguration:\n        DeploymentType: SINGLE_AZ_1\n        ThroughputCapacity: 64\n        CopyTagsToVolumes: true  # Critical: ensures volumes inherit file system tags\n```",
      "Other": "1. Open the AWS Console and go to Amazon FSx\n2. Select your FSx for OpenZFS file system\n3. Click Actions > Update file system\n4. Set Copy tags to volumes to On\n5. Click Update to save",
      "Terraform": "```hcl\n# FSx for OpenZFS with copy tags to volumes enabled\nresource \"aws_fsx_openzfs_file_system\" \"<example_resource_name>\" {\n  deployment_type      = \"SINGLE_AZ_1\"\n  subnet_ids           = [\"<example_resource_id>\"]\n  throughput_capacity  = 64\n  copy_tags_to_volumes = true  # Critical: ensures volumes inherit file system tags\n}\n```"
    },
    "Recommendation": {
      "Text": "Enable `copy_tags_to_volumes` and adopt a **mandatory tagging policy** (owner, environment, data class). Apply **least privilege/ABAC** using tags and integrate tags into backup, retention, and monitoring workflows to enforce **defense in depth**.",
      "Url": "https://hub.prowler.com/check/fsx_file_system_copy_tags_to_volumes_enabled"
    }
  },
  "Categories": [],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
