{
  "Provider": "aws",
  "CheckID": "workspaces_volume_encryption_enabled",
  "CheckTitle": "Amazon WorkSpaces workspace root and user volumes are encrypted",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "Effects/Data Exposure"
  ],
  "ServiceName": "workspaces",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "AwsEc2Volume",
  "ResourceGroup": "compute",
  "Description": "**Amazon WorkSpaces** evaluates **encryption at rest** on each workspace's EBS volumes. It checks whether the **root** and **user** volumes are encrypted with a KMS key and identifies workspaces where either volume is unencrypted.",
  "Risk": "Unencrypted volumes allow offline access to files, cached credentials, and profile data from snapshots or underlying storage, harming **confidentiality**. Storage-level access can enable data tampering, impacting **integrity**, and facilitate token reuse for lateral movement.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/workspaces/latest/adminguide/encrypt-workspaces.html",
    "https://www.trendmicro.com/trendaivisiononecloudriskmanagement/knowledge-base/aws/WorkSpaces/storage-encryption.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "",
      "NativeIaC": "```yaml\n# CloudFormation: create a WorkSpace with both volumes encrypted\nResources:\n  ExampleWorkspace:\n    Type: AWS::WorkSpaces::Workspace\n    Properties:\n      BundleId: <example_bundle_id>\n      DirectoryId: <example_directory_id>\n      UserName: <example_user_name>\n      RootVolumeEncryptionEnabled: true  # Critical: encrypts the root volume to pass the check\n      UserVolumeEncryptionEnabled: true  # Critical: encrypts the user volume to pass the check\n```",
      "Other": "1. In the AWS Console, go to WorkSpaces > WorkSpaces and click Launch WorkSpaces\n2. Select the directory and user, proceed to the WorkSpaces Configuration step\n3. Under Encryption, enable Root volume and User volume\n4. Keep the default AWS managed key (aws/workspaces) or select a CMK if required\n5. Launch the WorkSpace, then migrate the user and terminate the unencrypted WorkSpace\n6. Verify the Volume Encryption column shows Enabled for both volumes",
      "Terraform": "```hcl\n# Terraform: create a WorkSpace with both volumes encrypted\nresource \"aws_workspaces_workspace\" \"example\" {\n  bundle_id    = \"<example_bundle_id>\"\n  directory_id = \"<example_directory_id>\"\n  user_name    = \"<example_user_name>\"\n\n  root_volume_encryption_enabled = true  # Critical: encrypts the root volume\n  user_volume_encryption_enabled = true  # Critical: encrypts the user volume\n}\n```"
    },
    "Recommendation": {
      "Text": "Enable KMS-backed encryption for both **root** and **user** volumes on all WorkSpaces. Prefer **customer-managed keys**, enforce **least privilege** on key use, and enable rotation. Embed encryption into provisioning templates and policies to block unencrypted launches. *Keep required keys enabled for rebuilds and restores*.",
      "Url": "https://hub.prowler.com/check/workspaces_volume_encryption_enabled"
    }
  },
  "Categories": [
    "encryption"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
