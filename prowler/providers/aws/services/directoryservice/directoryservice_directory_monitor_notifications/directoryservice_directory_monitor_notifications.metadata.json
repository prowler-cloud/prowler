{
  "Provider": "aws",
  "CheckID": "directoryservice_directory_monitor_notifications",
  "CheckTitle": "Directory Service directory has SNS notifications enabled",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices"
  ],
  "ServiceName": "directoryservice",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "Other",
  "Description": "**AWS Directory Service** directories are associated with **Amazon SNS topics** to send status change notifications (e.g., `Active`  `Impaired`).\n\nThe evaluation looks for directories that have SNS event topics configured for monitoring alerts.",
  "Risk": "Missing directory notifications reduces visibility into health changes, causing delayed response to `Impaired` states. This threatens availability of authentication, Kerberos/LDAP lookups, and domain joins; increases MTTR; and can enable silent replication or trust failures that impact integrity across dependent workloads.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/directoryservice/latest/admin-guide/ms_ad_enable_notifications.html",
    "https://www.pulumi.com/ai/answers/sCKVuHuFR5SrFdQgsa27GS/integrating-aws-sns-with-aws-directory-service",
    "https://support.icompaas.com/support/solutions/articles/62000233533-ensure-directory-service-has-sns-notifications-enabled"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws ds create-event-topic --directory-id <DIRECTORY_ID> --topic-name <SNS_TOPIC_NAME>",
      "NativeIaC": "```yaml\n# CloudFormation: Associate an SNS topic with a Directory Service directory\nResources:\n  <example_resource_name>:\n    Type: AWS::DirectoryService::EventTopic\n    Properties:\n      DirectoryId: <example_resource_id>  # CRITICAL: Directory to receive notifications\n      TopicName: <example_resource_name>  # CRITICAL: SNS topic name to publish directory events\n```",
      "Other": "1. Open AWS Console > Directory Service > Directories and select your directory\n2. Go to the Maintenance or Monitoring/Notifications section\n3. Click Actions > Create notification (or Set up notifications)\n4. Select an existing SNS topic (or create one) and Save",
      "Terraform": "```hcl\n# Terraform: Associate an SNS topic with a Directory Service directory\nresource \"aws_directory_service_event_topic\" \"<example_resource_name>\" {\n  directory_id = \"<example_resource_id>\"   # CRITICAL: Directory to receive notifications\n  topic_name   = \"<example_resource_name>\"  # CRITICAL: SNS topic name to publish directory events\n}\n```"
    },
    "Recommendation": {
      "Text": "Configure **AWS Directory Service** to publish directory status changes to an **SNS topic**, and subscribe your operations channels for timely alerts.\n\nApply **least privilege** on topic permissions, integrate alerts with incident response, and use **defense in depth** by pairing notifications with logs and dashboards.",
      "Url": "https://hub.prowler.com/check/directoryservice_directory_monitor_notifications"
    }
  },
  "Categories": [
    "logging"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
