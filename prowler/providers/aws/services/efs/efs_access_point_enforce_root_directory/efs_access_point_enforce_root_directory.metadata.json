{
  "Provider": "aws",
  "CheckID": "efs_access_point_enforce_root_directory",
  "CheckTitle": "EFS file system has no access points allowing access to the root directory",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "Effects/Data Exposure"
  ],
  "ServiceName": "efs",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "AwsEfsAccessPoint",
  "ResourceGroup": "storage",
  "Description": "**Amazon EFS access points** are evaluated to ensure they enforce a non-root directory. The check identifies access points whose configured root directory `Path` is `/`, meaning clients would mount the file system's root instead of a scoped subdirectory.",
  "Risk": "Exposing the file system root via an access point undermines **confidentiality** and **integrity** by allowing traversal beyond intended datasets. Attackers or misconfigured apps could:\n- Read sensitive directories\n- Modify or delete shared data\n- Pivot across tenants, impacting **availability**",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/efs/latest/ug/enforce-root-directory-access-point.html",
    "https://docs.aws.amazon.com/securityhub/latest/userguide/efs-controls.html#efs-3"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws efs delete-access-point --access-point-id <access-point-id>",
      "NativeIaC": "```yaml\n# CloudFormation: EFS access point enforcing a non-root directory\nResources:\n  <example_resource_name>:\n    Type: AWS::EFS::AccessPoint\n    Properties:\n      FileSystemId: <example_resource_id>\n      RootDirectory:\n        Path: /data  # Critical: set to a non-root path to avoid \"/\" and pass the check\n        # This enforces the access point root to /data instead of the file system root\n```",
      "Other": "1. In the AWS Console, go to EFS > Access points\n2. Select the access point showing Root directory as /\n3. Click Delete and confirm\n4. Click Create access point\n5. Select the file system and set Root directory Path to a non-root path (for example, /data)\n6. Click Create access point",
      "Terraform": "```hcl\n# Terraform: EFS access point enforcing a non-root directory\nresource \"aws_efs_access_point\" \"<example_resource_name>\" {\n  file_system_id = \"<example_resource_id>\"\n\n  root_directory {\n    path = \"/data\"  # Critical: not \"/\"; enforces a subdirectory as root to pass the check\n  }\n}\n```"
    },
    "Recommendation": {
      "Text": "Apply **least privilege**: set each access point `Path` to a dedicated subdirectory and avoid `/`.\n- Use per-application access points\n- Enforce POSIX identity and directory permissions\n- Layer controls (network segmentation, monitoring) for **defense in depth**",
      "Url": "https://hub.prowler.com/check/efs_access_point_enforce_root_directory"
    }
  },
  "Categories": [
    "vulnerabilities"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
