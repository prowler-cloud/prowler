{
  "Provider": "aws",
  "CheckID": "eks_control_plane_logging_all_types_enabled",
  "CheckTitle": "EKS cluster has control plane logging enabled for api, audit, authenticator, controllerManager, and scheduler",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices"
  ],
  "ServiceName": "eks",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "AwsEksCluster",
  "ResourceGroup": "container",
  "Description": "**Amazon EKS clusters** are evaluated for **control plane logging** coverage of required types: `api`, `audit`, `authenticator`, `controllerManager`, `scheduler`.\n\nThe finding identifies clusters where any of these log types are not configured.",
  "Risk": "Gaps in **control plane logging** reduce visibility across the cluster.\n- Confidentiality: undetected API access, RBAC abuse, token misuse\n- Integrity: untraceable config changes and policy edits\n- Availability: scheduler/controller issues lack evidence, delaying recovery and masking attacker persistence",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/eks/latest/userguide/logging-monitoring.html",
    "https://support.icompaas.com/support/solutions/articles/62000233623-ensure-eks-control-plane-logging-is-enabled-for-all-required-log-types",
    "https://docs.aws.amazon.com/eks/latest/userguide/control-plane-logs.html",
    "https://docs.aws.amazon.com/prescriptive-guidance/latest/implementing-logging-monitoring-cloudwatch/kubernetes-eks-logging.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws eks update-cluster-config --name <cluster_name> --logging '{\"clusterLogging\":[{\"types\":[\"api\",\"audit\",\"authenticator\",\"controllerManager\",\"scheduler\"],\"enabled\":true}]}'",
      "NativeIaC": "```yaml\n# CloudFormation: enable all EKS control plane log types\nResources:\n  <example_resource_name>:\n    Type: AWS::EKS::Cluster\n    Properties:\n      RoleArn: <example_role_arn>\n      ResourcesVpcConfig:\n        SubnetIds: [<example_subnet_id>]\n      Logging:\n        ClusterLogging:\n          - EnabledTypes:\n              - Type: api            # Critical: enable required control plane log types\n              - Type: audit          # Critical: enable required control plane log types\n              - Type: authenticator  # Critical: enable required control plane log types\n              - Type: controllerManager  # Critical: enable required control plane log types\n              - Type: scheduler      # Critical: enable required control plane log types\n```",
      "Other": "1. In the AWS console, go to Amazon EKS and open your cluster\n2. Open the Observability (or Logging) tab and click Manage logging\n3. Turn on: api, audit, authenticator, controllerManager, scheduler\n4. Click Save changes",
      "Terraform": "```hcl\n# Enable all required EKS control plane log types\nresource \"aws_eks_cluster\" \"<example_resource_name>\" {\n  enabled_cluster_log_types = [\n    \"api\",            # Critical: required control plane log types\n    \"audit\",          # Critical: required control plane log types\n    \"authenticator\",  # Critical: required control plane log types\n    \"controllerManager\", # Critical: required control plane log types\n    \"scheduler\"       # Critical: required control plane log types\n  ]\n}\n```"
    },
    "Recommendation": {
      "Text": "Enable and standardize **EKS control plane logging** for all required types `[\"api\",\"audit\",\"authenticator\",\"controllerManager\",\"scheduler\"]`.\n\nApply least privilege to log access, set retention and alerts, and centralize analysis to support defense in depth, rapid detection, and reliable forensics.",
      "Url": "https://hub.prowler.com/check/eks_control_plane_logging_all_types_enabled"
    }
  },
  "Categories": [
    "logging",
    "forensics-ready"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
