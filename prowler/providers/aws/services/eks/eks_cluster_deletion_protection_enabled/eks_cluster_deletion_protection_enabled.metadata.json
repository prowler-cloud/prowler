{
  "Provider": "aws",
  "CheckID": "eks_cluster_deletion_protection_enabled",
  "CheckTitle": "EKS cluster has deletion protection enabled",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Effects/Data Destruction"
  ],
  "ServiceName": "eks",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "AwsEksCluster",
  "ResourceGroup": "container",
  "Description": "**Amazon EKS clusters** have **deletion protection** enabled blocking cluster removal until protection is explicitly disabled.",
  "Risk": "Without **deletion protection**, automation errors or a compromised admin can remove the cluster control plane, causing immediate **availability** loss and downtime. Destructive actions can also affect the **integrity** of deployments, leave orphaned resources, hinder recovery, and raise **operational cost**.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/eks/latest/APIReference/API_UpdateClusterConfig.html",
    "https://docs.aws.amazon.com/eks/latest/userguide/deletion-protection.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws eks update-cluster-config --name <cluster_name> --region <region_name> --deletion-protection",
      "NativeIaC": "```yaml\n# CloudFormation: enable deletion protection on the EKS cluster\nResources:\n  <example_resource_name>:\n    Type: AWS::EKS::Cluster\n    Properties:\n      RoleArn: <example_role_arn>\n      ResourcesVpcConfig:\n        SubnetIds: [<example_subnet_id_1>, <example_subnet_id_2>]\n      DeletionProtection: true  # critical: prevents cluster deletion until disabled\n```",
      "Other": "1. Open the AWS Management Console and go to Amazon EKS\n2. Select your cluster\n3. Go to the Configuration tab and click Edit\n4. Enable Deletion protection\n5. Click Save changes",
      "Terraform": "```hcl\n# Enable deletion protection for the EKS cluster\nresource \"aws_eks_cluster\" \"<example_resource_name>\" {\n  name     = \"<example_resource_name>\"\n  role_arn = \"<example_role_arn>\"\n\n  vpc_config {\n    subnet_ids = [\"<subnet_id_1>\", \"<subnet_id_2>\"]\n  }\n\n  deletion_protection = true  # critical: prevents cluster deletion until disabled\n}\n```"
    },
    "Recommendation": {
      "Text": "Enable **deletion protection** on critical clusters (`deletionProtection=true`). Enforce **least privilege** so only narrowly scoped roles can disable or delete clusters. Require **change control** with approvals and **separation of duties**, and apply guardrails to prevent broad delete permissions.",
      "Url": "https://hub.prowler.com/check/eks_cluster_deletion_protection_enabled"
    }
  },
  "Categories": [
    "resilience"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
