{
  "Provider": "aws",
  "CheckID": "guardduty_ec2_malware_protection_enabled",
  "CheckTitle": "GuardDuty Malware Protection Enabled",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices"
  ],
  "ServiceName": "guardduty",
  "SubServiceName": "",
  "ResourceIdTemplate": "arn:aws:guardduty:region:account-id/detector-id",
  "Severity": "high",
  "ResourceType": "AwsGuardDutyDetector",
  "Description": "GuardDuty Malware Protection for EC2 helps you detect the potential presence of malware by scanning the Amazon Elastic Block Store (Amazon EBS) volumes that are attached to Amazon Elastic Compute Cloud (Amazon EC2) instances and container workloads. Malware Protection provides scan options where you can decide if you want to include or exclude specific EC2 instances and container workloads at the time of scanning. It also provides an option to retain the snapshots of EBS volumes attached to the EC2 instances or container workloads, in your GuardDuty accounts. The snapshots get retained only when malware is found and Malware Protection findings are generated.",
  "Risk": "Malware can compromise your EC2 instances and container workloads, leading to data breaches, data exfiltration, and other security incidents.",
  "RelatedUrl": "https://docs.aws.amazon.com/guardduty/latest/ug/malware-protection.html",
  "Remediation": {
    "Code": {
      "CLI": "aws guardduty update-detector --detector-id <detector-id> --data-sources MalwareProtection={ScanEc2InstanceWithFindings={EbsVolumes=true}}",
      "NativeIaC": "",
      "Other": "",
      "Terraform": ""
    },
    "Recommendation": {
      "Text": "Enable Malware Protection for your GuardDuty detector.",
      "Url": "https://docs.aws.amazon.com/securityhub/latest/userguide/guardduty-controls.html#guardduty-8"
    }
  },
  "Categories": [],
  "Notes": "",
  "DependsOn": [],
  "RelatedTo": []
}
