{
  "Provider": "aws",
  "CheckID": "vpc_different_regions",
  "CheckTitle": "VPCs are present in more than one region",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Effects/Denial of Service"
  ],
  "ServiceName": "vpc",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "AwsEc2Vpc",
  "ResourceGroup": "network",
  "Description": "Non-default **VPCs** are evaluated across the account to determine whether they exist in **more than one region**. The result reflects if your custom network topology is regionally distributed or concentrated in a single region.",
  "Risk": "Single-region VPC deployment weakens **availability** and **resilience**. A regional outage, service disruption, or network control misconfiguration can cause broad downtime, hinder recovery, and increase the **blast radius** of incidents impacting business continuity.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/vpc/latest/userguide/vpc-example-private-subnets-nat.html",
    "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_Scenario2.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws ec2 create-vpc --region <OTHER_REGION> --cidr-block <CIDR_BLOCK>",
      "NativeIaC": "```yaml\n# Deploy this stack in a second AWS region to pass the check\nResources:\n  <example_resource_name>:\n    Type: AWS::EC2::VPC\n    Properties:\n      CidrBlock: 10.0.0.0/16  # Critical: creates a non-default VPC in this region\n```",
      "Other": "1. Open the AWS Console and go to VPC\n2. In the Region selector (top right), choose a different region than your existing non-default VPCs\n3. Click Create VPC > VPC only\n4. Enter an IPv4 CIDR block (e.g., 10.0.0.0/16)\n5. Click Create VPC\n6. Verify a non-default VPC now exists in this second region",
      "Terraform": "```hcl\nprovider \"aws\" {\n  alias  = \"other\"\n  region = \"<OTHER_REGION>\" # Critical: ensures the VPC is created in a second region\n}\n\nresource \"aws_vpc\" \"<example_resource_name>\" {\n  provider   = aws.other\n  cidr_block = \"10.0.0.0/16\" # Critical: creates a non-default VPC in that region\n}\n```"
    },
    "Recommendation": {
      "Text": "Adopt a **multi-region network design**:\n- Create VPCs in at least two regions for critical workloads\n- Replicate routing, security controls, and endpoints consistently\n- Apply **fault tolerance** and **defense in depth** with data replication and resilient DNS/failover to avoid single-region dependency",
      "Url": "https://hub.prowler.com/check/vpc_different_regions"
    }
  },
  "Categories": [
    "resilience"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
