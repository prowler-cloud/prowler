{
  "Provider": "aws",
  "CheckID": "neptune_cluster_snapshot_encrypted",
  "CheckTitle": "Neptune DB cluster snapshot is encrypted at rest",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices/Encryption at Rest",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "Effects/Data Exposure"
  ],
  "ServiceName": "neptune",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "AwsRdsDbClusterSnapshot",
  "Description": "*Neptune DB cluster snapshots* are evaluated for **encryption at rest**. A snapshot is reported **PASS** when its `encrypted` attribute is true and **FAIL** when the snapshot is stored without encryption, indicating the snapshot data is not protected by at-rest encryption.\n\nThe check inspects each snapshot's encryption flag.",
  "Risk": "**Unencrypted Neptune snapshots** undermine data confidentiality. If accessed or shared due to compromised credentials or misconfiguration, attackers can restore or download snapshot contents, enabling **data exfiltration**, exposure of sensitive records, and regulatory nonâ€‘compliance. This weakens overall data protection posture.",
  "RelatedUrl": [
    "https://trendmicro.com/cloudoneconformity/knowledge-base/aws/Neptune/sufficient-backup-retention-period.html",
    "https://stackoverflow.com/questions/67409560/anonymous-authentication-by-default-in-amazon-neptune",
    "https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-6",
    "https://docs.aws.amazon.com/neptune/latest/userguide/backup-restore-create-snapshot.html",
    "https://hub.powerpipe.io/mods/turbot/steampipe-mod-aws-compliance/benchmarks/control.rds_db_snapshot_encrypted_at_rest"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws rds copy-db-cluster-snapshot --source-db-cluster-snapshot-identifier <source-snapshot> --target-db-cluster-snapshot-identifier <encrypted-snapshot> --kms-key-id <kms-key-id>",
      "NativeIaC": "",
      "Terraform": "```hcl\nresource \"aws_neptune_cluster\" \"restored\" {\n  cluster_identifier  = \"restored-cluster\"\n  snapshot_identifier = \"<source-snapshot>\"\n  storage_encrypted   = true\n  kms_key_id          = \"<kms-key-id>\"\n}\n```",
      "Other": "1. Sign in to the AWS Management Console and open Amazon Neptune\n2. In the left pane choose **Snapshots**\n3. Select the unencrypted snapshot and click **Actions** > **Restore snapshot**\n4. In the Restore page enable **Encryption** and select a KMS key\n5. Click **Restore DB cluster**\n6. After the cluster is restored, create a new snapshot of the restored (encrypted) cluster"
    },
    "Recommendation": {
      "Text": "Protect snapshot data by enforcing **encryption at rest** and strong key governance.\n\n- Use **customer-managed keys** with controlled lifecycle and rotation\n- Apply **least privilege** to snapshot access and sharing\n- Prevent creation of unencrypted snapshots via organizational configuration and policy controls",
      "Url": ""
    }
  },
  "Categories": [
    "encryption"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
