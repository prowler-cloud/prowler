{
  "Provider": "aws",
  "CheckID": "opensearch_service_domains_audit_logging_enabled",
  "CheckTitle": "Amazon OpenSearch Service domain has audit logging enabled",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices"
  ],
  "ServiceName": "opensearch",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "AwsOpenSearchServiceDomain",
  "ResourceGroup": "database",
  "Description": "**Amazon OpenSearch Service domains** have **audit logs** enabled via `AUDIT_LOGS`",
  "Risk": "Without audit logs, critical actions lack accountability, reducing **confidentiality** and **integrity**.\n\nUnauthorized access, privilege misuse, and index tampering can go **undetected**, hindering **incident response** and **forensics**, and enabling data exfiltration and lateral movement without traceability.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/audit-logs.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws opensearch update-domain-config --domain-name <example_resource_name> --log-publishing-options \"AUDIT_LOGS={CloudWatchLogsLogGroupArn=<CLOUDWATCH_LOG_GROUP_ARN>,Enabled=true}\"",
      "NativeIaC": "```yaml\n# CloudFormation: Enable AUDIT_LOGS for an OpenSearch domain\nResources:\n  OpenSearchDomain:\n    Type: AWS::OpenSearchService::Domain\n    Properties:\n      DomainName: <example_resource_name>\n      LogPublishingOptions:\n        AUDIT_LOGS:\n          CloudWatchLogsLogGroupArn: <CLOUDWATCH_LOG_GROUP_ARN>  # Critical: where audit logs are sent\n          Enabled: true  # Critical: turns on AUDIT_LOGS to pass the check\n```",
      "Other": "1. Open the AWS console and go to OpenSearch Service\n2. Select the domain <example_resource_name>\n3. Open the Logs tab, find Audit logs, and click Enable\n4. Choose or create a CloudWatch log group and confirm the resource policy if prompted\n5. Click Save changes to enable AUDIT_LOGS\n6. If Fine-grained access control is not enabled, enable it first, then repeat steps 3-5",
      "Terraform": "```hcl\n# Enable AUDIT_LOGS for an OpenSearch domain\nresource \"aws_opensearch_domain\" \"example\" {\n  domain_name = \"<example_resource_name>\"\n\n  log_publishing_options {\n    log_type                 = \"AUDIT_LOGS\"\n    cloudwatch_log_group_arn = \"<CLOUDWATCH_LOG_GROUP_ARN>\"  # Critical: destination for audit logs\n    enabled                  = true                           # Critical: turns on AUDIT_LOGS to pass the check\n  }\n}\n```"
    },
    "Recommendation": {
      "Text": "Enable `AUDIT_LOGS` for all domains and route them to a centralized, durable log store.\n\nTune categories to record auth failures and sensitive index operations. Apply **least privilege** to log access, enforce retention and immutability, and integrate alerts to provide **defense in depth** and timely response.",
      "Url": "https://hub.prowler.com/check/opensearch_service_domains_audit_logging_enabled"
    }
  },
  "Categories": [
    "logging",
    "forensics-ready"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
