{
  "Provider": "aws",
  "CheckID": "ec2_client_vpn_endpoint_connection_logging_enabled",
  "CheckTitle": "EC2 Client VPN endpoint has client connection logging enabled",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53 Controls (USA)"
  ],
  "ServiceName": "ec2",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "low",
  "ResourceType": "AwsEc2ClientVpnEndpoint",
  "ResourceGroup": "network",
  "Description": "**AWS Client VPN endpoints** are evaluated for **client connection logging** that records client connect/disconnect events to CloudWatch Logs. The evaluation detects endpoints where this logging is disabled.",
  "Risk": "Without **Client VPN connection logs**, remote access lacks an **audit trail**, reducing detection and accountability.\n- Stolen credentials can be used unnoticed\n- Lateral movement and data exfiltration persist\nImpacts **confidentiality** and **integrity**; delayed investigation can degrade **availability**.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/vpn/latest/clientvpn-admin/what-is.html",
    "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-51",
    "https://docs.aws.amazon.com/config/latest/developerguide/ec2-client-vpn-connection-log-enabled.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws ec2 modify-client-vpn-endpoint --client-vpn-endpoint-id <CLIENT_VPN_ENDPOINT_ID> --connection-log-options Enabled=true,CloudWatchLogGroup=<CLOUDWATCH_LOG_GROUP_NAME>",
      "NativeIaC": "```yaml\n# CloudFormation: enable connection logging on a Client VPN endpoint\nResources:\n  <example_resource_name>:\n    Type: AWS::EC2::ClientVpnEndpoint\n    Properties:\n      ClientCidrBlock: 10.0.0.0/22\n      ServerCertificateArn: arn:aws:acm:<REGION>:<ACCOUNT_ID>:certificate/<example_resource_id>\n      AuthenticationOptions:\n        - Type: certificate-authentication\n          MutualAuthentication:\n            ClientRootCertificateChainArn: arn:aws:acm:<REGION>:<ACCOUNT_ID>:certificate/<example_resource_id>\n      ConnectionLogOptions:               # CRITICAL: enables client connection logging\n        Enabled: true                     # CRITICAL: turns on logging\n        CloudWatchLogGroup: <example_resource_name>  # CRITICAL: destination log group\n```",
      "Other": "1. Open the Amazon VPC console and go to Client VPN Endpoints\n2. Select the endpoint and choose Actions > Modify client VPN endpoint\n3. Under Connection logging, check Enable\n4. For CloudWatch log group, select an existing log group\n5. Click Save changes",
      "Terraform": "```hcl\n# Terraform: enable connection logging on a Client VPN endpoint\nresource \"aws_ec2_client_vpn_endpoint\" \"<example_resource_name>\" {\n  server_certificate_arn = \"arn:aws:acm:<REGION>:<ACCOUNT_ID>:certificate/<example_resource_id>\"\n  client_cidr_block      = \"10.0.0.0/22\"\n\n  authentication_options {\n    type                       = \"certificate-authentication\"\n    root_certificate_chain_arn = \"arn:aws:acm:<REGION>:<ACCOUNT_ID>:certificate/<example_resource_id>\"\n  }\n\n  connection_log_options {                # CRITICAL: enables client connection logging\n    enabled             = true            # CRITICAL: turns on logging\n    cloudwatch_log_group = \"<example_resource_name>\"  # CRITICAL: destination log group\n  }\n}\n```"
    },
    "Recommendation": {
      "Text": "Enable **client connection logging** on all Client VPN endpoints and send events to a centralized log group.\n- Enforce least privilege on log access\n- Define retention and immutability\n- Integrate with monitoring/alerts\n- Separate VPN operations from log administration\n- Review anomalous login patterns",
      "Url": "https://hub.prowler.com/check/ec2_client_vpn_endpoint_connection_logging_enabled"
    }
  },
  "Categories": [
    "logging"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
