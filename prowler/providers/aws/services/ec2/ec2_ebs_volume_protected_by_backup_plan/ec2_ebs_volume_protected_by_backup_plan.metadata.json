{
  "Provider": "aws",
  "CheckID": "ec2_ebs_volume_protected_by_backup_plan",
  "CheckTitle": "EBS volume is protected by a backup plan",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "Effects/Data Destruction"
  ],
  "ServiceName": "ec2",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "AwsEc2Volume",
  "ResourceGroup": "compute",
  "Description": "**EBS volumes** are evaluated for coverage by an **AWS Backup plan**, whether explicitly targeted or included via broad resource selection, confirming scheduled, policy-driven backups exist for the volume.",
  "Risk": "Absent backup coverage, volumes face **data loss**, weakened **integrity**, and reduced **availability**. Deletion or corruption-whether accidental or malicious-can leave no recovery path, causing prolonged outages, failed point-in-time restoration, unmet retention needs, and harder incident response.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.amazonaws.cn/en_us/aws-backup/latest/devguide/vault-lock.html",
    "https://aws.amazon.com/blogs/storage/protecting-your-critical-amazon-ebs-volumes-using-aws-backup/",
    "https://docs.aws.amazon.com/config/latest/developerguide/ebs-resources-protected-by-backup-plan.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws backup create-backup-selection --backup-plan-id <BACKUP_PLAN_ID> --backup-selection '{\"SelectionName\":\"<example_resource_name>\",\"IamRoleArn\":\"arn:aws:iam::<example_account_id>:role/service-role/AWSBackupDefaultServiceRole\",\"Resources\":[\"arn:aws:ec2:*:*:volume/*\"]}'",
      "NativeIaC": "```yaml\n# CloudFormation: protect all EBS volumes by assigning them to a backup plan\nResources:\n  <example_resource_name>BackupPlan:\n    Type: AWS::Backup::BackupPlan\n    Properties:\n      BackupPlan:\n        BackupPlanName: <example_resource_name>\n        Rules:\n          - RuleName: <example_rule_name>\n            TargetBackupVault: Default\n\n  <example_resource_name>BackupSelection:\n    Type: AWS::Backup::BackupSelection\n    Properties:\n      BackupPlanId: !Ref <example_resource_name>BackupPlan\n      BackupSelection:\n        SelectionName: <example_resource_name>\n        IamRoleArn: arn:aws:iam::<example_account_id>:role/service-role/AWSBackupDefaultServiceRole\n        Resources:\n          - arn:aws:ec2:*:*:volume/*  # Critical: wildcard includes all EBS volumes so they are covered by the plan\n```",
      "Other": "1. In the AWS Backup console, go to Backup plans and click Create backup plan\n2. Choose Start with a template (any), keep the Default vault, and create the plan\n3. Open the plan and click Assign resources\n4. Set Selection name and choose IAM role AWSBackupDefaultServiceRole\n5. Under Assign resources, choose Include specific resource types and select EBS\n6. For Resources, select all EBS volumes (or the specific volumes to protect) and click Assign resources",
      "Terraform": "```hcl\n# Minimal AWS Backup plan protecting all EBS volumes\nresource \"aws_backup_plan\" \"<example_resource_name>\" {\n  name = \"<example_resource_name>\"\n\n  rule {\n    rule_name         = \"<example_rule_name>\"\n    target_vault_name = \"Default\"\n  }\n}\n\nresource \"aws_backup_selection\" \"<example_resource_name>\" {\n  name         = \"<example_resource_name>\"\n  plan_id      = aws_backup_plan.<example_resource_name>.id\n  iam_role_arn = \"arn:aws:iam::<example_account_id>:role/service-role/AWSBackupDefaultServiceRole\"\n\n  resources = [\n    \"arn:aws:ec2:*:*:volume/*\" # Critical: selects all EBS volumes to satisfy the check\n  ]\n}\n```"
    },
    "Recommendation": {
      "Text": "Include all critical EBS volumes in standardized **AWS Backup** plans aligned to your `RPO`/`RTO`. Use tags for automatic assignment, enable cross-Region/account copies, apply **Vault Lock** for WORM retention, encrypt with KMS, enforce least-privilege access, and regularly test restores to verify integrity.",
      "Url": "https://hub.prowler.com/check/ec2_ebs_volume_protected_by_backup_plan"
    }
  },
  "Categories": [
    "resilience"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
