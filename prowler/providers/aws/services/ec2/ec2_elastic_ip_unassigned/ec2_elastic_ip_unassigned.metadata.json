{
  "Provider": "aws",
  "CheckID": "ec2_elastic_ip_unassigned",
  "CheckTitle": "Elastic IP is associated with an instance or network interface",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Effects/Resource Consumption"
  ],
  "ServiceName": "ec2",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "low",
  "ResourceType": "AwsEc2Eip",
  "ResourceGroup": "network",
  "Description": "**EC2 Elastic IPs** that are allocated but **not associated** with any instance or network interface. The evaluation identifies EIPs present in the account without an active association.",
  "Risk": "Unused Elastic IPs consume public IPv4 capacity and incur ongoing charges. Hoarded addresses can exhaust quotas, blocking new allocations and delaying deployments (**availability**). Lack of ownership tracking increases operational drift and misconfigurations, risking unintended exposure when later reassigned.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/elastic-ip-addresses-eip.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws ec2 release-address --allocation-id <ALLOCATION_ID>",
      "NativeIaC": "```yaml\n# Associate an existing unassigned Elastic IP to an instance\nResources:\n  <example_resource_name>:\n    Type: AWS::EC2::EIPAssociation\n    Properties:\n      AllocationId: <example_allocation_id>  # Critical: selects the unassigned EIP to associate\n      InstanceId: <example_instance_id>      # Critical: associates the EIP to this instance, fixing the finding\n```",
      "Other": "1. In the AWS console, go to EC2 > Network & Security > Elastic IPs\n2. Select the Elastic IP with Status = Not associated\n3. Choose Actions > Associate Elastic IP address\n4. Select Instance (or Network interface), pick the target, and click Associate\n5. Alternatively, to remove the finding by deleting the unused EIP: Actions > Release Elastic IP address > Release",
      "Terraform": "```hcl\n# Associate an existing unassigned Elastic IP to an instance\nresource \"aws_eip_association\" \"<example_resource_name>\" {\n  allocation_id = \"<example_allocation_id>\"  # Critical: target unassigned EIP\n  instance_id   = \"<example_instance_id>\"     # Critical: attach EIP to this instance to pass the check\n}\n```"
    },
    "Recommendation": {
      "Text": "Release **unused Elastic IPs** or promptly associate them only where required. Enforce **least privilege** for address allocation, apply **tagging** to track ownership, and schedule periodic audits. Prefer **private networking** or managed front ends to reduce public IPv4 use. Automate reclaiming of `unassociated` addresses in lifecycle policies.",
      "Url": "https://hub.prowler.com/check/ec2_elastic_ip_unassigned"
    }
  },
  "Categories": [
    "internet-exposed"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
