{
  "Provider": "aws",
  "CheckID": "ec2_instance_paravirtual_type",
  "CheckTitle": "EC2 instance virtualization type is HVM",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices"
  ],
  "ServiceName": "ec2",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "AwsEc2Instance",
  "ResourceGroup": "compute",
  "Description": "**EC2 instances** are evaluated for their virtualization mode. Instances with `virtualization_type` set to `paravirtual` are identified; those using **HVM** are recognized as hardware-assisted virtualization.",
  "Risk": "Using **paravirtual (PV)** weakens isolation versus **HVM/Nitro** and blocks features like `ENA` and `NVMe`. Confidentiality and integrity can suffer due to reliance on legacy hypercalls/drivers; availability and performance may degrade under load, increasing exposure to kernel/driver exploits and noisy-neighbor impacts.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-24",
    "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-resize.html",
    "https://docs.aws.amazon.com/config/latest/developerguide/ec2-paravirtual-instance-check.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws ec2 terminate-instances --instance-ids <INSTANCE_ID>",
      "NativeIaC": "```yaml\n# Launch an EC2 instance using an HVM-based AMI\nResources:\n  <example_resource_name>:\n    Type: AWS::EC2::Instance\n    Properties:\n      ImageId: <HVM_AMI_ID>  # Critical: Using an HVM AMI ensures virtualization type is HVM\n      InstanceType: t3.micro\n```",
      "Other": "1. In the AWS Console, go to EC2 > Instances and select the instance with Virtualization type = paravirtual\n2. Launch a replacement instance using any HVM-based AMI (e.g., Amazon Linux 2)\n3. Verify the new instance is running\n4. Back in EC2 > Instances, select the paravirtual instance, choose Instance state > Terminate instance, and confirm",
      "Terraform": "```hcl\n# EC2 instance launched from an HVM AMI\nresource \"aws_instance\" \"<example_resource_name>\" {\n  ami           = \"<HVM_AMI_ID>\"  # Critical: AMI must be HVM to pass the check\n  instance_type = \"t3.micro\"\n}\n```"
    },
    "Recommendation": {
      "Text": "Standardize on **HVM/Nitro**. Migrate PV workloads to HVM AMIs and current instance families; ensure support for `ENA` and `NVMe`, current kernels, and hardened configs. Apply **defense in depth** and **least privilege**. Use immutable images with staged testing, then retire PV images to prevent drift and regressions.",
      "Url": "https://hub.prowler.com/check/ec2_instance_paravirtual_type"
    }
  },
  "Categories": [
    "node-security"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
