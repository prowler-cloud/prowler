{
  "Provider": "aws",
  "CheckID": "ec2_launch_template_no_public_ip",
  "CheckTitle": "Amazon EC2 launch template has no public IP addresses configured on network interfaces",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices/Network Reachability",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices"
  ],
  "ServiceName": "ec2",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "AwsEc2LaunchTemplate",
  "ResourceGroup": "compute",
  "Description": "**EC2 launch templates** with versions that either enable `associate_public_ip_address` for network interfaces or reference **ENIs** already associated with public IPs",
  "Risk": "Assigning **public IPs** makes instances Internet-reachable, enabling:\n- Loss of **confidentiality** via unauthorized access and data exfiltration\n- Compromised **integrity** through remote exploitation and tampering\n- Reduced **availability** from DDoS and brute-force traffic\nAttackers can scan exposed services and pivot within the VPC.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/autoscaling/ec2/userguide/create-launch-template.html#change-network-interface",
    "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-25",
    "https://docs.aws.amazon.com/config/latest/developerguide/ec2-launch-template-public-ip-disabled.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws ec2 create-launch-template-version --launch-template-id <example_resource_id> --launch-template-data '{\"NetworkInterfaces\":[{\"DeviceIndex\":0,\"AssociatePublicIpAddress\":false}]}' --set-default-version",
      "NativeIaC": "```yaml\n# CloudFormation: Launch template configured to not assign public IPs\nResources:\n  <example_resource_name>:\n    Type: AWS::EC2::LaunchTemplate\n    Properties:\n      LaunchTemplateData:\n        NetworkInterfaces:\n          - DeviceIndex: 0\n            AssociatePublicIpAddress: false  # Critical: disables public IP assignment on the primary ENI\n```",
      "Other": "1. Open the EC2 console and go to Launch Templates\n2. Select the template and choose Actions > Create new version\n3. Under Network settings > Advanced network configuration, set Auto-assign public IP to Disable\n4. Ensure no Network interface is attached that already has a public IP\n5. Check Set as default version and choose Create launch template version",
      "Terraform": "```hcl\n# EC2 launch template configured to not assign public IPs\nresource \"aws_launch_template\" \"<example_resource_name>\" {\n  name = \"<example_resource_name>\"\n\n  network_interfaces {\n    device_index                = 0\n    associate_public_ip_address = false  # Critical: disables public IP assignment on the primary ENI\n  }\n}\n```"
    },
    "Recommendation": {
      "Text": "Apply **least privilege** and network segmentation:\n- Set `associate_public_ip_address=false` in launch templates\n- Avoid referencing ENIs with public IPs\n- Place instances in private subnets behind **NAT/ALB**\n- Use **Session Manager**, bastions, or **VPC endpoints/PrivateLink** for access\nAdopt **defense in depth** to minimize exposure.",
      "Url": "https://hub.prowler.com/check/ec2_launch_template_no_public_ip"
    }
  },
  "Categories": [
    "internet-exposed"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
