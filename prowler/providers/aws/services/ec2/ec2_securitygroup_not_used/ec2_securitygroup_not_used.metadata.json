{
  "Provider": "aws",
  "CheckID": "ec2_securitygroup_not_used",
  "CheckTitle": "Non-default EC2 security group is in use",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices"
  ],
  "ServiceName": "ec2",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "low",
  "ResourceType": "AwsEc2SecurityGroup",
  "ResourceGroup": "network",
  "Description": "EC2 security groups, except `default`, are assessed for **unused** status: zero attached network interfaces, no AWS Lambda associations, and no references from other security groups.",
  "Risk": "Orphaned security groups may later be attached with **overly permissive rules** without review, enabling unintended inbound or lateral access that compromises **confidentiality** and **integrity**. They also create **configuration drift**, increasing the chance of misapplied access controls.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://www.trendmicro.com/trendaivisiononecloudriskmanagement/knowledge-base/aws/EC2/default-security-group-unrestricted.html",
    "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security-groups.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws ec2 delete-security-group --group-id <SECURITY_GROUP_ID>",
      "NativeIaC": "",
      "Other": "1. In the AWS Console, go to EC2 > Security Groups\n2. Select the non-default security group that shows Used by = 0 (no network interfaces or resources)\n3. Click Actions > Delete security group > Delete",
      "Terraform": "```hcl\n# Destroy the unused non-default security group\nresource \"aws_security_group\" \"<example_resource_name>\" {\n  count = 0 # Critical: setting count=0 removes/destroys this unused SG\n}\n```"
    },
    "Recommendation": {
      "Text": "Apply **least privilege** and strong lifecycle management: delete or quarantine **unused security groups**, enforce ownership tags and retention policies, review regularly, and manage changes via IaC with approvals. Restrict who can attach groups and use guardrails to prevent reuse of stale or permissive groups.",
      "Url": "https://hub.prowler.com/check/ec2_securitygroup_not_used"
    }
  },
  "Categories": [
    "trust-boundaries"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
