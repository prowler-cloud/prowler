{
  "Provider": "aws",
  "CheckID": "ec2_securitygroup_from_launch_wizard",
  "CheckTitle": "Security group not created using the EC2 Launch Wizard",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices/Network Reachability"
  ],
  "ServiceName": "ec2",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "AwsEc2SecurityGroup",
  "ResourceGroup": "network",
  "Description": "**EC2 security groups** whose names include `launch-wizard` are identified as created by the **EC2 Launch Wizard**, distinguishing auto-generated groups from curated, baseline-controlled groups.",
  "Risk": "Wizard-generated groups often include **overly permissive rules** (e.g., `0.0.0.0/0` to admin ports), expanding exposure. Attackers can run **port scans** and **brute-force** to gain entry, then **lateral movement** and **data exfiltration**, impacting **confidentiality** and **integrity**; broad egress aids command-and-control.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://www.trendmicro.com/trendaivisiononecloudriskmanagement/knowledge-base/aws/EC2/security-group-prefixed-with-launch-wizard.html",
    "https://docs.aws.amazon.com/eks/latest/userguide/sec-group-reqs.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws ec2 delete-security-group --group-id <SECURITY_GROUP_ID>",
      "NativeIaC": "```yaml\n# CloudFormation: create a security group not named by Launch Wizard\nResources:\n  <example_resource_name>:\n    Type: AWS::EC2::SecurityGroup\n    Properties:\n      GroupDescription: SG not created by Launch Wizard\n      VpcId: <example_resource_id>\n      GroupName: <example_resource_name>  # Critical: name does NOT contain \"launch-wizard\" to avoid FAIL\n```",
      "Other": "1. In the AWS console, go to EC2 > Network & Security > Security Groups\n2. In the search box, filter by Name contains \"launch-wizard\"\n3. For each matching group, open the References tab and remove it from any ENIs/instances by replacing it with a different security group\n4. Select the launch-wizard security group and choose Actions > Delete security group > Delete\n5. Verify no security groups remain with names containing \"launch-wizard\"",
      "Terraform": "```hcl\n# Create a security group not named by Launch Wizard\nresource \"aws_security_group\" \"<example_resource_name>\" {\n  name   = \"<example_resource_name>\"  # Critical: name does NOT contain \"launch-wizard\" to avoid FAIL\n  vpc_id = \"<example_resource_id>\"\n}\n```"
    },
    "Recommendation": {
      "Text": "Replace or harden these groups. Apply **least privilege**: restrict inbound to required sources, avoid public admin ports, and minimize egress. Use approved baseline security groups, enforce change control with IaC and guardrails, prefer private administration (bastion or Session Manager), and remove unused rules.",
      "Url": "https://hub.prowler.com/check/ec2_securitygroup_from_launch_wizard"
    }
  },
  "Categories": [],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
