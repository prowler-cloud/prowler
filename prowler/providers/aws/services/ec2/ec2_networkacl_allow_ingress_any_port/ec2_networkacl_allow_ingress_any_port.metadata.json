{
  "Provider": "aws",
  "CheckID": "ec2_networkacl_allow_ingress_any_port",
  "CheckTitle": "Network ACL does not allow ingress from 0.0.0.0/0 to any port",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices/Network Reachability",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark",
    "TTPs/Initial Access/Unauthorized Access",
    "Effects/Data Exposure"
  ],
  "ServiceName": "ec2",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "AwsEc2NetworkAcl",
  "ResourceGroup": "network",
  "Description": "**VPC network ACLs** with **inbound entries** that permit traffic from `0.0.0.0/0` to any port (any protocol) are identified at the subnet boundary.",
  "Risk": "Allowing Internet-wide ingress at the subnet layer enables broad port scanning and unsolicited connections. Attackers can probe and exploit exposed services, risking data disclosure and tampering (confidentiality, integrity) and causing outages via floods or brute-force (availability). Any security group lapse then lacks a compensating control.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html",
    "https://support.icompaas.com/support/solutions/articles/62000233809-ensure-no-network-acls-allow-ingress-from-0-0-0-0-0-to-any-port"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws ec2 replace-network-acl-entry --network-acl-id <example_resource_id> --ingress --rule-number <RULE_NUMBER> --protocol -1 --rule-action deny --cidr-block 0.0.0.0/0",
      "NativeIaC": "```yaml\n# CloudFormation: deny all inbound from the Internet on the NACL\nResources:\n  NetworkAclDenyAllIngress:\n    Type: AWS::EC2::NetworkAclEntry\n    Properties:\n      NetworkAclId: \"<example_resource_id>\"\n      RuleNumber: 100\n      Protocol: -1\n      Egress: false\n      RuleAction: deny       # CRITICAL: Denies ingress\n      CidrBlock: 0.0.0.0/0  # CRITICAL: From the Internet (any IP)\n```",
      "Other": "1. In AWS Console, go to VPC > Network ACLs\n2. Select the NACL used by the affected subnet\n3. Open the Inbound rules tab and click Edit inbound rules\n4. Find any rule that allows 0.0.0.0/0 to all ports and change Action to Deny (or delete the allow-all rule)\n5. Save changes",
      "Terraform": "```hcl\n# Deny all inbound from the Internet on the NACL\nresource \"aws_network_acl_rule\" \"<example_resource_name>\" {\n  network_acl_id = \"<example_resource_id>\"\n  rule_number    = 100\n  egress         = false\n  protocol       = \"-1\"\n  rule_action    = \"deny\"          # CRITICAL: Denies ingress\n  cidr_block     = \"0.0.0.0/0\"      # CRITICAL: From the Internet (any IP)\n}\n```"
    },
    "Recommendation": {
      "Text": "Adopt a **deny-by-default** NACL posture: block `0.0.0.0/0` and allow only required ports from trusted CIDRs. Apply **least privilege** using security groups for fine-grained access, with NACLs as coarse stateless filters. Review and prune rules regularly, and employ **defense in depth** with monitoring and alerting.",
      "Url": "https://hub.prowler.com/check/ec2_networkacl_allow_ingress_any_port"
    }
  },
  "Categories": [
    "internet-exposed"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
