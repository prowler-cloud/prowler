{
  "Provider": "aws",
  "CheckID": "organizations_opt_out_ai_services_policy",
  "CheckTitle": "AWS Organization has opted out of all AI services and child accounts cannot override the policy",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Effects/Data Exposure"
  ],
  "ServiceName": "organizations",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "Other",
  "ResourceGroup": "governance",
  "Description": "**AWS Organizations** is assessed for an AI services opt-out policy that sets `services.default.opt_out_policy` to `optOut` and blocks child overrides via `@@operators_allowed_for_child_policies` set to `@@none`.",
  "Risk": "Without an enforced opt-out, AI services may store and use your content for model training, weakening **confidentiality** and **data sovereignty**. If child accounts can override, they can re-enable data use, risking unintended cross-Region retention and exposure of logs, documents, or code processed by these services.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/organizations/latest/userguide/disable-policy-type.html",
    "https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_ai-opt-out_all.html",
    "https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_ai-opt-out_syntax.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "",
      "NativeIaC": "```yaml\n# CloudFormation: Opt out of all AI services and prevent child overrides\nResources:\n  AiServicesOptOutPolicy:\n    Type: AWS::Organizations::Policy\n    Properties:\n      Name: <example_resource_name>\n      Type: AISERVICES_OPT_OUT_POLICY\n      Content: |\n        { \"services\": { \"default\": { \"opt_out_policy\": { \"@@assign\": \"optOut\", \"@@operators_allowed_for_child_policies\": [\"@@none\"] } } } }\n        # Critical: @@assign \"optOut\" opts out org-wide; @@operators... [\"@@none\"] blocks child overrides\n      TargetIds:\n        - <example_resource_id> # Critical: attach to the organization root (e.g., r-xxxx)\n```",
      "Other": "1. In the AWS Management Console, open AWS Organizations using the management account\n2. Go to Policies > AI services opt-out\n3. Click Opt out from all services and confirm\n4. Verify the policy is attached to the Root and shows default -> opt_out_policy -> @@assign: optOut with @@operators_allowed_for_child_policies set to [\"@@none\"]",
      "Terraform": "```hcl\n# Enable AI services opt-out policy type\nresource \"aws_organizations_organization\" \"<example_resource_name>\" {\n  enabled_policy_types = [\"AISERVICES_OPT_OUT_POLICY\"]  # Critical: allow AI opt-out policies\n}\n\n# Create the AI opt-out policy\nresource \"aws_organizations_policy\" \"<example_resource_name>\" {\n  name    = \"<example_resource_name>\"\n  type    = \"AISERVICES_OPT_OUT_POLICY\"\n  content = <<JSON\n{ \"services\": { \"default\": { \"opt_out_policy\": { \"@@assign\": \"optOut\", \"@@operators_allowed_for_child_policies\": [\"@@none\"] } } } }\nJSON\n  # Critical: @@assign \"optOut\" opts out; @@operators... [\"@@none\"] prevents child overrides\n}\n\n# Attach policy to the org root\nresource \"aws_organizations_policy_attachment\" \"<example_resource_name>\" {\n  policy_id = aws_organizations_policy.<example_resource_name>.id\n  target_id = aws_organizations_organization.<example_resource_name>.roots[0].id  # Critical: attach to root\n}\n```"
    },
    "Recommendation": {
      "Text": "Establish an org-wide AI services opt-out: set the default to `optOut` and prohibit child policy overrides (`@@none`). Apply at the highest scope, gate exceptions through change control, and review periodically. Align with **least privilege** and **data minimization** to prevent unintended content sharing with managed AI services.",
      "Url": "https://hub.prowler.com/check/organizations_opt_out_ai_services_policy"
    }
  },
  "Categories": [
    "gen-ai"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
