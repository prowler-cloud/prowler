{
  "Provider": "aws",
  "CheckID": "organizations_tags_policies_enabled_and_attached",
  "CheckTitle": "AWS Organization has tag policies enabled and attached",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices"
  ],
  "ServiceName": "organizations",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "low",
  "ResourceType": "Other",
  "ResourceGroup": "governance",
  "Description": "**AWS Organizations** tag policies are evaluated for their presence and attachment to organization targets (accounts or OUs), distinguishing between no policies, policies defined but not attached, and policies attached to at least one target.",
  "Risk": "Absent or unattached tag policies cause inconsistent or missing tags, undermining:\n- **Confidentiality** via bypassed tag-based access conditions\n- **Integrity** through misclassified resources and drift\n- **Availability** when automation, cost routing, or incident scoping that rely on tags break",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_tag-policies.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "",
      "NativeIaC": "```yaml\n# CloudFormation: Create and attach a Tag Policy\nResources:\n  TagPolicy:\n    Type: AWS::Organizations::Policy\n    Properties:\n      Name: <example_resource_name>\n      Type: TAG_POLICY  # Critical: defines a Tag Policy type\n      Content:\n        tags:\n          Environment:\n            tag_key:\n              \"@@assign\": \"Environment\"\n      TargetIds:\n        - <example_resource_id>  # Critical: attaches the policy to an account/OU/root\n```",
      "Other": "1. Sign in to the AWS Management Console with the organization management account\n2. Open AWS Organizations > Policies > Tag policies\n3. If prompted, click Enable tag policies\n4. Click Create policy, enter a name, add minimal valid content (e.g., define one tag key), and create the policy\n5. Select the policy and click Attach\n6. Choose the Root, an OU, or at least one account and confirm\n7. The check passes when a tag policy exists and is attached to a target",
      "Terraform": "```hcl\n# Create a Tag Policy\nresource \"aws_organizations_policy\" \"<example_resource_name>\" {\n  name    = \"<example_resource_name>\"\n  type    = \"TAG_POLICY\"  # Critical: defines a Tag Policy type\n  content = jsonencode({\n    tags = {\n      Environment = {\n        tag_key = { \"@@assign\" = \"Environment\" }\n      }\n    }\n  })\n}\n\n# Attach the Tag Policy to a target (Root/OU/Account)\nresource \"aws_organizations_policy_attachment\" \"<example_resource_name>\" {\n  policy_id = aws_organizations_policy.<example_resource_name>.id\n  target_id = \"<example_resource_id>\"  # Critical: attaches the policy to an account/OU/root\n}\n```"
    },
    "Recommendation": {
      "Text": "Enable **tag policies** and attach them to relevant roots/OUs/accounts. Define mandatory keys (e.g., `Environment`, `CostCenter`) with allowed values. Apply **defense in depth** by using tags in IAM conditions and SCPs. Start with validation-only, then enforce, and continuously monitor compliance across accounts.",
      "Url": "https://hub.prowler.com/check/organizations_tags_policies_enabled_and_attached"
    }
  },
  "Categories": [],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
