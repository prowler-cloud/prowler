{
  "Provider": "aws",
  "CheckID": "autoscaling_group_deletion_protection_enabled",
  "CheckTitle": "Auto Scaling group has deletion protection enabled",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices"
  ],
  "ServiceName": "autoscaling",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "AwsAutoScalingAutoScalingGroup",
  "ResourceGroup": "compute",
  "Description": "**EC2 Auto Scaling groups** are evaluated for having **deletion protection** enabled. AWS ASGs support three levels of deletion protection: `none` (default), `prevent-force-deletion`, and `prevent-all-deletion`. Groups without deletion protection (`none`) can be accidentally deleted, potentially causing service disruptions.",
  "Risk": "Without deletion protection, Auto Scaling groups can be accidentally or maliciously deleted, leading to immediate loss of capacity, service outages, and potential data loss. This is especially critical for production workloads where unplanned capacity removal can cascade into wider failures.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/autoscaling/ec2/APIReference/API_UpdateAutoScalingGroup.html",
    "https://docs.aws.amazon.com/autoscaling/ec2/userguide/resource-deletion-protection.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws autoscaling update-auto-scaling-group --auto-scaling-group-name <example_resource_name> --deletion-protection prevent-all-deletion",
      "NativeIaC": "```yaml\n# CloudFormation: Enable deletion protection on an Auto Scaling group\nResources:\n  <example_resource_name>:\n    Type: AWS::AutoScaling::AutoScalingGroup\n    Properties:\n      DeletionProtection: prevent-all-deletion\n      MinSize: \"1\"\n      MaxSize: \"3\"\n      VPCZoneIdentifier:\n        - <subnet_id_1>\n        - <subnet_id_2>\n      LaunchTemplate:\n        LaunchTemplateId: <launch_template_id>\n        Version: $Latest\n```",
      "Other": "1. In the AWS Console, go to EC2 > Auto Scaling Groups and select <example_resource_name>\n2. Click Edit\n3. Under Details, find Deletion protection\n4. Select prevent-all-deletion\n5. Click Update to save",
      "Terraform": "```hcl\n# Terraform: Enable deletion protection on an Auto Scaling group\nresource \"aws_autoscaling_group\" \"<example_resource_name>\" {\n  name               = \"<example_resource_name>\"\n  min_size           = 1\n  max_size           = 3\n  vpc_zone_identifier = [\"<subnet_id_1>\", \"<subnet_id_2>\"]\n  deletion_protection = \"prevent-all-deletion\"\n\n  launch_template {\n    id      = \"<launch_template_id>\"\n    version = \"$Latest\"\n  }\n}\n```"
    },
    "Recommendation": {
      "Text": "Enable **deletion protection** on Auto Scaling groups to prevent accidental or unauthorized removal:\n- Use `prevent-all-deletion` to block all deletion attempts\n- Use `prevent-force-deletion` to block force deletion while allowing normal deletion after scaling to zero\nApply deletion protection to all production Auto Scaling groups as a safeguard against operational errors.",
      "Url": "https://hub.prowler.com/check/autoscaling_group_deletion_protection_enabled"
    }
  },
  "Categories": [
    "resilience"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
