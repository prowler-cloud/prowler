{
  "Provider": "aws",
  "CheckID": "transfer_server_in_transit_encryption_enabled",
  "CheckTitle": "Transfer Family server has encryption in transit enabled",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53 Controls",
    "Software and Configuration Checks/Industry and Regulatory Standards/PCI-DSS",
    "Software and Configuration Checks/Industry and Regulatory Standards/HIPAA Controls (USA)",
    "Effects/Data Exposure"
  ],
  "ServiceName": "transfer",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "Other",
  "ResourceGroup": "storage",
  "Description": "**AWS Transfer Family servers** are evaluated for presence of the unencrypted `FTP` protocol among enabled protocols, as opposed to encrypted options like SFTP, FTPS, or AS2.",
  "Risk": "Allowing **FTP** exposes credentials and file contents in cleartext, breaking confidentiality. Adversaries can sniff or perform **MITM** to read or alter files, compromising integrity and enabling credential theft that can be reused for broader unauthorized access.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/config/latest/developerguide/transfer-family-server-no-ftp.html",
    "https://docs.aws.amazon.com/transfer/latest/userguide/edit-server-config.html#edit-protocols",
    "https://docs.aws.amazon.com/securityhub/latest/userguide/transfer-controls.html#transfer-2"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws transfer update-server --server-id <server-id> --protocols SFTP",
      "NativeIaC": "```yaml\n# CloudFormation: ensure FTP is not enabled\nResources:\n  <example_resource_name>:\n    Type: AWS::Transfer::Server\n    Properties:\n      Protocols:\n        - SFTP  # CRITICAL: Use SFTP only; excludes FTP (unencrypted)\n```",
      "Other": "1. Open AWS Console > AWS Transfer Family\n2. Go to Servers and select the server (<example_resource_id>)\n3. Click Edit next to Protocols\n4. Uncheck FTP and ensure at least SFTP (or FTPS/AS2) is selected\n5. Save",
      "Terraform": "```hcl\n# Ensure FTP is not enabled\nresource \"aws_transfer_server\" \"<example_resource_name>\" {\n  protocols = [\"SFTP\"]  # CRITICAL: Excludes FTP to enforce encryption in transit\n}\n```"
    },
    "Recommendation": {
      "Text": "Remove `FTP`; permit only **SFTP**, **FTPS**, or **AS2** to enforce **encryption in transit**.\n\nApply defense in depth: restrict by network location (allowlists/VPC), enforce strong cryptographic policies, and use least-privilege roles with monitoring.",
      "Url": "https://hub.prowler.com/check/transfer_server_in_transit_encryption_enabled"
    }
  },
  "Categories": [
    "encryption"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
