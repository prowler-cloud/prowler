{
    "Provider": "aws",
    "CheckID": "secretsmanager_using_cmk",
    "CheckTitle": "Check if all secrets in AWS Secrets Manager are encrypted using the AWS managed key (aws/secretsmanager) or a customer managed key created in AWS KMS.",
    "CheckType": [],
    "ServiceName": "secretsmanager",
    "SubServiceName": "",
    "ResourceIdTemplate": "arn:aws:secretsmanager:region:account-id:secret:secret-name",
    "Severity": "medium",
    "ResourceType": "AwsSecretsManagerSecret",
    "Description": "Checks if all secrets in AWS Secrets Manager are encrypted using the AWS managed key (aws/secretsmanager) or a customer managed key created in AWS KMS. The rule is COMPLIANT if a secret is encrypted using a customer managed key. This rule is NON_COMPLIANT if a secret is encrypted using aws/secretsmanager.",
    "Risk": "Using AWS managed keys for secrets encryption can pose a risk if the keys are compromised or not managed properly.",
    "RelatedUrl": "https://docs.aws.amazon.com/secretsmanager/latest/userguide/security-encryption.html",
    "Remediation": {
      "Code": {
        "CLI": "aws secretsmanager update-secret --secret-id <SECRET-ID> --kms-key-id <CUSTOMER-MANAGED-KEY-ID>",
        "NativeIaC": "",
        "Other": "",
        "Terraform": ""
      },
      "Recommendation": {
        "Text": "Ensure that secrets are encrypted using customer managed keys created in AWS KMS.",
        "Url": "https://docs.aws.amazon.com/secretsmanager/latest/userguide/security-encryption.html"
      }
    },
    "Categories": [],
    "DependsOn": [],
    "RelatedTo": [],
    "Notes": "Infrastructure Protection"
  }
  