{
  "Provider": "aws",
  "CheckID": "secretsmanager_secret_rotated_periodically",
  "CheckTitle": "AWS Secrets Manager secret is rotated within the configured maximum number of days",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices"
  ],
  "ServiceName": "secretsmanager",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "AwsSecretsManagerSecret",
  "ResourceGroup": "security",
  "Description": "**AWS Secrets Manager secrets** are evaluated for **periodic rotation** within a configured window (default `90` days).\n\nSecrets with no recorded rotation, or with rotation older than the allowed window, are identified for review.",
  "Risk": "**Long-lived or never-rotated secrets** widen the attack window. Leaked or brute-forced credentials stay valid, enabling unauthorized access to databases and APIs, **data exfiltration**, and unauthorized changes-compromising **confidentiality** and **integrity**.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/secretsmanager/latest/userguide/rotate-secrets_turn-on-for-other.html",
    "https://docs.aws.amazon.com/secretsmanager/latest/userguide/rotating-secrets.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws secretsmanager rotate-secret --secret-id <secret-id>",
      "NativeIaC": "```yaml\n# CloudFormation: enable rotation and rotate now\nResources:\n  <example_resource_name>:\n    Type: AWS::SecretsManager::RotationSchedule\n    Properties:\n      SecretId: <example_resource_id>  # CRITICAL: target secret to rotate\n      RotationLambdaARN: <example_resource_id>  # CRITICAL: Lambda ARN used to perform rotation\n      ScheduleExpression: rate(30 days)  # CRITICAL: ensures rotation occurs within max allowed days\n      RotateImmediatelyOnUpdate: true  # CRITICAL: triggers an immediate rotation to pass the check\n```",
      "Other": "1. Open the AWS Console > Secrets Manager\n2. Select the secret\n3. If Rotation status is Enabled: click Rotate secret immediately\n4. If Rotation is Disabled: click Edit rotation, turn on Automatic rotation, choose the rotation Lambda function, Save, then click Rotate secret immediately",
      "Terraform": "```hcl\n# Enable rotation for the secret\nresource \"aws_secretsmanager_secret_rotation\" \"<example_resource_name>\" {\n  secret_id          = \"<example_resource_id>\"  # CRITICAL: target secret\n  rotation_lambda_arn = \"<example_resource_id>\" # CRITICAL: Lambda ARN used to rotate\n\n  rotation_rules {                          \n    automatically_after_days = 30            # CRITICAL: rotate within allowed days\n  }\n}\n```"
    },
    "Recommendation": {
      "Text": "Enable **automatic rotation** for all secrets with intervals aligned to sensitivity (**`90` days or more frequent). Ensure apps retrieve secrets at runtime. Apply **least privilege** to rotation roles and KMS keys, use **separation of duties**, and monitor rotation health with alerts. Avoid hard-coded credentials and retire unused secrets.",
      "Url": "https://hub.prowler.com/check/secretsmanager_secret_rotated_periodically"
    }
  },
  "Categories": [
    "secrets"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
