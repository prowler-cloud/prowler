{
    "Provider": "aws",
    "CheckID": "secretsmanager_scheduled_rotation_success_check",
    "CheckTitle": "Check if AWS Secrets Manager secrets rotated successfully according to the rotation schedule.",
    "CheckType": [],
    "ServiceName": "secretsmanager",
    "SubServiceName": "",
    "ResourceIdTemplate": "arn:aws:secretsmanager:region:account-id:secret:secret-name",
    "Severity": "medium",
    "ResourceType": "AwsSecretsManagerSecret",
    "Description": "Checks if AWS Secrets Manager secrets rotated successfully according to the rotation schedule. Secrets Manager calculates the date the rotation should happen. The rule is NON_COMPLIANT if the date passes and the secret isn't rotated. The rule returns NOT_APPLICABLE for secrets without rotation.",
    "Risk": "Not rotating secrets as scheduled can lead to the usage of outdated and potentially compromised secrets.",
    "RelatedUrl": "https://docs.aws.amazon.com/secretsmanager/latest/userguide/rotating-secrets_strategies.html",
    "Remediation": {
      "Code": {
        "CLI": "aws secretsmanager rotate-secret --region <REGION> --secret-id <SECRET-ID> --rotation-lambda-arn <LAMBDA-ARN> --rotation-rules AutomaticallyAfterDays=30",
        "NativeIaC": "",
        "Other": "",
        "Terraform": ""
      },
      "Recommendation": {
        "Text": "Ensure that secrets are rotated according to the defined rotation schedule.",
        "Url": "https://docs.aws.amazon.com/secretsmanager/latest/userguide/rotating-secrets_strategies.html"
      }
    },
    "Categories": [],
    "DependsOn": [],
    "RelatedTo": [],
    "Notes": "Infrastructure Protection"
  }
  