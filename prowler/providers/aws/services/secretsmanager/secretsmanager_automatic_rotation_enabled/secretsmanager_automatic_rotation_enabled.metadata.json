{
  "Provider": "aws",
  "CheckID": "secretsmanager_automatic_rotation_enabled",
  "CheckTitle": "Secrets Manager secret has rotation enabled",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53 Controls (USA)",
    "Software and Configuration Checks/Industry and Regulatory Standards/NIST CSF Controls (USA)"
  ],
  "ServiceName": "secretsmanager",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "AwsSecretsManagerSecret",
  "ResourceGroup": "security",
  "Description": "**AWS Secrets Manager secrets** are evaluated for **automatic rotation**; the check determines if a rotation schedule is enabled for each secret",
  "Risk": "Absent rotation, **long-lived secrets** widen the attack window:\n- Valid after leakage in code, images, or logs\n- Enable **unauthorized access** and **lateral movement**\n- Complicate incident response and recovery\nThis impacts **confidentiality** and **integrity**, and can threaten **availability** if revocation lags.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/secretsmanager/latest/userguide/rotating-secrets_strategies.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws secretsmanager rotate-secret --secret-id <example_resource_id> --rotation-lambda-arn <example_resource_id> --rotation-rules AutomaticallyAfterDays=30",
      "NativeIaC": "```yaml\nResources:\n  <example_resource_name>:\n    Type: AWS::SecretsManager::RotationSchedule\n    Properties:\n      SecretId: <example_resource_id>\n      RotationLambdaARN: <example_resource_id>\n      RotationRules:\n        AutomaticallyAfterDays: 30  # Critical: enables rotation on a 30-day schedule\n```",
      "Other": "1. Open AWS Console > Secrets Manager\n2. Select the secret\n3. Click Rotation > Enable automatic rotation\n4. Choose the rotation Lambda function\n5. Set rotation interval to 30 days\n6. Save",
      "Terraform": "```hcl\nresource \"aws_secretsmanager_secret_rotation\" \"<example_resource_name>\" {\n  secret_id          = \"<example_resource_id>\"\n  rotation_lambda_arn = \"<example_resource_id>\"\n  rotation_rules {\n    automatically_after_days = 30  # Critical: enables rotation schedule\n  }\n}\n```"
    },
    "Recommendation": {
      "Text": "Enable **automatic rotation** for secrets and set schedules based on sensitivity (e.g., `30-90 days`). Enforce **least privilege** for accessing and rotating secrets and apply **separation of duties**. Monitor rotation health. Avoid hardcoded credentials; retrieve secrets at runtime and support versioned updates.",
      "Url": "https://hub.prowler.com/check/secretsmanager_automatic_rotation_enabled"
    }
  },
  "Categories": [
    "secrets"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": "Infrastructure Protection"
}
