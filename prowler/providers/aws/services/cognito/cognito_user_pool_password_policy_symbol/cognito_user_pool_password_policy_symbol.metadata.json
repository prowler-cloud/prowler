{
  "Provider": "aws",
  "CheckID": "cognito_user_pool_password_policy_symbol",
  "CheckTitle": "Cognito user pool password policy requires at least one symbol",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "TTPs/Credential Access"
  ],
  "ServiceName": "cognito",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "Other",
  "Description": "**Amazon Cognito user pool** password policy includes a **symbol requirement** for user passwords.\n\nAssesses the presence of a policy and whether `require_symbols` is configured.",
  "Risk": "Absent a **symbol requirement**, passwords have lower entropy, increasing success of **brute force** and **credential stuffing**.\n\nCompromised accounts enable unauthorized token issuance, data access, and profile changes, impacting **confidentiality** and **integrity** across apps relying on the pool.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-policies.html",
    "https://docs.aws.amazon.com/cognito/latest/developerguide/managing-users-passwords.html",
    "https://lgallardo.com/2019/11/23/terraform-module-for-amazon-cognito-user-pool",
    "https://stackoverflow.com/questions/77985497/cognito-user-pool-saying-password-policy-is-not-expected",
    "https://github.com/lgallard/terraform-aws-cognito-user-pool",
    "https://boto3.amazonaws.com/v1/documentation/api/1.26.93/reference/services/cognito-idp/client/describe_user_pool.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws cognito-idp update-user-pool --user-pool-id <example_resource_id> --policies \"PasswordPolicy={RequireSymbols=true}\"",
      "NativeIaC": "```yaml\n# CloudFormation: ensure Cognito User Pool requires at least one symbol in passwords\nResources:\n  <example_resource_name>:\n    Type: AWS::Cognito::UserPool\n    Properties:\n      Policies:\n        PasswordPolicy:\n          RequireSymbols: true  # Critical: enforce at least one symbol to pass the check\n```",
      "Other": "1. Open the Amazon Cognito console and go to User pools\n2. Select the target user pool\n3. Go to Authentication (or Sign-in experience) > Password policy\n4. Enable Require special characters (Require symbols)\n5. Click Save changes",
      "Terraform": "```hcl\n# Terraform: ensure Cognito User Pool requires at least one symbol in passwords\nresource \"aws_cognito_user_pool\" \"<example_resource_name>\" {\n  name = \"<example_resource_name>\"\n\n  password_policy {\n    require_symbols = true  # Critical: enforce at least one symbol to pass the check\n  }\n}\n```"
    },
    "Recommendation": {
      "Text": "Enforce a strong **password complexity** policy with `require_symbols=true`, adequate length, and mixed character sets. Combine with **MFA**, throttling or lockout, and credential hygiene to reduce takeover risk. Apply **defense in depth** and **least privilege** to limit blast radius if an account is compromised.",
      "Url": "https://hub.prowler.com/check/cognito_user_pool_password_policy_symbol"
    }
  },
  "Categories": [
    "identity-access"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
