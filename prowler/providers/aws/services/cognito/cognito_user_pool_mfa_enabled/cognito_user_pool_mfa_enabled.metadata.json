{
  "Provider": "aws",
  "CheckID": "cognito_user_pool_mfa_enabled",
  "CheckTitle": "Amazon Cognito user pool requires Multi-Factor Authentication (MFA)",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "TTPs/Initial Access/Unauthorized Access"
  ],
  "ServiceName": "cognito",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "Other",
  "Description": "**Amazon Cognito user pools** with **MFA** set to `ON`, indicating an additional factor is enforced during authentication",
  "Risk": "Without **MFA**, password-only sign-in increases **account takeover** via phishing, brute force, and credential stuffing. Compromised accounts yield valid tokens to access data and APIs, alter configurations, and move laterally, eroding **confidentiality** and **integrity**, and potentially affecting **availability** through abuse.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-mfa.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws cognito-idp set-user-pool-mfa-config --user-pool-id <example_resource_id> --software-token-mfa-configuration Enabled=true --mfa-configuration ON",
      "NativeIaC": "```yaml\n# CloudFormation: Require MFA and enable TOTP\nResources:\n  <example_resource_name>:\n    Type: AWS::Cognito::UserPool\n    Properties:\n      MfaConfiguration: ON  # Critical: sets MFA to required\n      SoftwareTokenMfaConfiguration:\n        Enabled: true       # Critical: enables TOTP so ON is valid\n```",
      "Other": "1. In AWS Console, go to Amazon Cognito > User pools\n2. Select your user pool\n3. Open Sign-in > Multi-factor authentication > Edit\n4. Set MFA enforcement to Require MFA\n5. Enable Authenticator app (TOTP) under MFA methods\n6. Click Save changes",
      "Terraform": "```hcl\n# Terraform: Require MFA and enable TOTP\nresource \"aws_cognito_user_pool\" \"<example_resource_name>\" {\n  name              = \"<example_resource_name>\"\n  mfa_configuration = \"ON\" # Critical: sets MFA to required\n\n  software_token_mfa_configuration {\n    enabled = true # Critical: enables TOTP so ON is valid\n  }\n}\n```"
    },
    "Recommendation": {
      "Text": "Enable **MFA** at the user pool level (`Required` or risk-based) as a **defense-in-depth** control. Prefer **TOTP** or phishing-resistant methods over SMS. Require factor enrollment during onboarding, and enforce **least privilege** on downstream permissions. Complement with anomaly detection and session hardening to prevent and contain ATO.",
      "Url": "https://hub.prowler.com/check/cognito_user_pool_mfa_enabled"
    }
  },
  "Categories": [
    "identity-access"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
