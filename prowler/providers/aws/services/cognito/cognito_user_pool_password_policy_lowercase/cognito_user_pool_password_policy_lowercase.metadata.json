{
  "Provider": "aws",
  "CheckID": "cognito_user_pool_password_policy_lowercase",
  "CheckTitle": "Cognito user pool password policy requires at least one lowercase letter",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "TTPs/Initial Access"
  ],
  "ServiceName": "cognito",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "Other",
  "Description": "**Cognito user pools** are assessed for a password policy that includes a **lowercase character requirement**. Pools with `require_lowercase` set are distinguished from those without a policy, which inherently lack this requirement.",
  "Risk": "Absent a **lowercase requirement** reduces password complexity and the overall **keyspace**, making **brute-force** and credential stuffing more feasible. Successful guessing enables account takeover, exposing user data and tokens and permitting profile changes, harming **confidentiality** and **integrity**.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://stackoverflow.com/questions/70274192/terraform-error-while-creating-aws-cognito-user-pool",
    "https://docs.aws.amazon.com/cognito/latest/developerguide/managing-users-passwords.html",
    "https://docs.w3cub.com/terraform/providers/aws/r/cognito_user_pool.html",
    "https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-policies.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws cognito-idp update-user-pool --user-pool-id <example_resource_id> --policies \"PasswordPolicy={RequireLowercase=true}\"",
      "NativeIaC": "```yaml\nResources:\n  UserPool:\n    Type: AWS::Cognito::UserPool\n    Properties:\n      Policies:\n        PasswordPolicy:\n          RequireLowercase: true  # Critical: requires at least one lowercase letter in passwords\n```",
      "Other": "1. Open the Amazon Cognito console and go to User pools\n2. Select your user pool\n3. Navigate to Authentication (or Authentication methods) > Password policy\n4. Enable Require lowercase (Lowercase letters)\n5. Click Save changes",
      "Terraform": "```hcl\nresource \"aws_cognito_user_pool\" \"pool\" {\n  name = \"<example_resource_name>\"\n\n  password_policy {\n    require_lowercase = true  # Critical: enforces at least one lowercase character\n  }\n}\n```"
    },
    "Recommendation": {
      "Text": "Enforce a strong password policy with `require_lowercase: true`, adequate length, and mixed character types. Complement with **defense in depth**: enable **MFA**, apply rate limiting or lockout for failed attempts, and block common passwords. Review regularly to match business risk and user population.",
      "Url": "https://hub.prowler.com/check/cognito_user_pool_password_policy_lowercase"
    }
  },
  "Categories": [
    "identity-access"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
