{
  "Provider": "aws",
  "CheckID": "cognito_user_pool_password_policy_minimum_length_14",
  "CheckTitle": "Cognito user pool has a password policy with a minimum length of 14 characters or more",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "TTPs/Initial Access",
    "TTPs/Credential Access"
  ],
  "ServiceName": "cognito",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "Other",
  "Description": "**Cognito user pools** should have a **password policy** requiring a **minimum length** of `14`.\n\nThis evaluation detects pools without a policy or with `minimum_length` below `14`.",
  "Risk": "Low or missing password minimums enable weak credentials, increasing successful **brute force**, **password spraying**, and **credential stuffing** against sign-in endpoints.\n\nResulting **account takeover** threatens confidentiality (data exposure) and integrity/availability (unauthorized changes and abuse).",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://github.com/lgallard/terraform-aws-cognito-user-pool",
    "https://nivleshc.wordpress.com/2025/03/24/create-a-photo-location-map-using-amazon-cognito-amazon-api-gateway-aws-lambda-and-amazon-s3-part-1/",
    "https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/cognito-idp.html",
    "https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-policies.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws cognito-idp update-user-pool --user-pool-id <example_resource_id> --policies \"PasswordPolicy={MinimumLength=14}\"",
      "NativeIaC": "```yaml\nResources:\n  <example_resource_name>:\n    Type: AWS::Cognito::UserPool\n    Properties:\n      Policies:\n        PasswordPolicy:\n          MinimumLength: 14  # Critical: sets minimum password length to >=14 to pass the check\n```",
      "Other": "1. Open the Amazon Cognito console and go to User pools\n2. Select your user pool\n3. Go to Authentication (or Authentication methods) > Password policy\n4. Set Minimum password length to 14\n5. Click Save changes",
      "Terraform": "```hcl\nresource \"aws_cognito_user_pool\" \"<example_resource_name>\" {\n  name = \"<example_resource_name>\"\n\n  password_policy {\n    minimum_length = 14  # Critical: enforce min length >=14 to pass the check\n  }\n}\n```"
    },
    "Recommendation": {
      "Text": "Adopt a strong **password policy** with `minimum_length`  `14`, favoring long passphrases.\n- Require mixed character types and block common passwords\n- Enforce password history where appropriate\n- Pair with **MFA** and adaptive risk controls for defense in depth",
      "Url": "https://hub.prowler.com/check/cognito_user_pool_password_policy_minimum_length_14"
    }
  },
  "Categories": [
    "identity-access"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
