{
  "Provider": "aws",
  "CheckID": "lightsail_instance_automated_snapshots",
  "CheckTitle": "Lightsail instance has automated snapshots enabled",
  "CheckType": [
    "Software and Configuration Checks/AWS Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices",
    "Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53 Controls (USA)",
    "Software and Configuration Checks/Industry and Regulatory Standards/ISO 27001 Controls",
    "Software and Configuration Checks/Industry and Regulatory Standards/PCI-DSS",
    "Effects/Data Destruction"
  ],
  "ServiceName": "lightsail",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "Other",
  "ResourceGroup": "compute",
  "Description": "**Amazon Lightsail instances** with **automatic daily snapshots** enabled are identified. The evaluation checks if an instance is configured to take recurring snapshots at a scheduled time.",
  "Risk": "Absent automation, data lacks **point-in-time recovery**, increasing **availability** risk from accidental deletion, corruption, or ransomware. Failed updates or compromise hinder quick rollback, degrading **integrity** and extending RPO/RTO, causing prolonged outages.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://docs.aws.amazon.com/lightsail/latest/userguide/amazon-lightsail-changing-automatic-snapshot-time.html",
    "https://docs.aws.amazon.com/lightsail/latest/userguide/amazon-lightsail-configuring-automatic-snapshots.html"
  ],
  "Remediation": {
    "Code": {
      "CLI": "aws lightsail enable-add-on --region <REGION> --resource-name <example_resource_name> --add-on-request addOnType=AutoSnapshot",
      "NativeIaC": "```yaml\n# CloudFormation: Enable automatic snapshots for a Lightsail instance\nResources:\n  <example_resource_name>:\n    Type: AWS::Lightsail::Instance\n    Properties:\n      InstanceName: <example_resource_name>\n      AvailabilityZone: <example_az>\n      BlueprintId: <example_blueprint_id>\n      BundleId: <example_bundle_id>\n      AddOns:\n        - AddOnType: AutoSnapshot  # Critical: enables automatic snapshots for the instance\n```",
      "Other": "1. Open the AWS Management Console and go to Lightsail\n2. Click Instances and select <example_resource_name>\n3. Open the Snapshots tab\n4. In Automatic snapshots, toggle On and confirm\n5. (Optional) Set a snapshot time if needed; otherwise the default time is used",
      "Terraform": "```hcl\n# Enable automatic snapshots for a Lightsail instance\nresource \"aws_lightsail_instance\" \"<example_resource_name>\" {\n  name              = \"<example_resource_name>\"\n  availability_zone = \"<example_az>\"\n  blueprint_id      = \"<example_blueprint_id>\"\n  bundle_id         = \"<example_bundle_id>\"\n\n  add_on {\n    type   = \"AutoSnapshot\"  # Critical: enables automatic snapshots\n    status = \"Enabled\"       # Critical: turns the add-on on\n  }\n}\n```"
    },
    "Recommendation": {
      "Text": "Enable **automatic snapshots** on Lightsail instances and align the schedule with low-traffic windows. Apply **least privilege** to snapshot create/delete, and regularly test restores. Use **defense in depth**: retain multiple versions and replicate backups *for critical workloads* across regions or accounts.",
      "Url": "https://hub.prowler.com/check/lightsail_instance_automated_snapshots"
    }
  },
  "Categories": [
    "resilience"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
