{
  "Provider": "mongodbatlas",
  "CheckID": "organizations_service_account_secrets_expiration",
  "CheckTitle": "Organization has maximum validity period of 8 hours or less for Admin API Service Account secrets",
  "CheckType": [],
  "ServiceName": "organizations",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "",
  "Description": "MongoDB Atlas organization setting `maxServiceAccountSecretValidityInHours` caps the lifetime of new **Admin API service account secrets**. Evaluation focuses on whether a limit is configured and whether it is at or below the defined policy threshold (default `8` hours).",
  "Risk": "Overlong or unset lifetimes for **Admin API service account secrets** expand the attack window. If leaked, an adversary can maintain API access to:\n- Exfiltrate data (confidentiality)\n- Alter org or project configs (integrity)\n- Disable services or change access controls (availability)",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://www.mongodb.com/docs/api/doc/atlas-admin-api-v2/2025-03-12/operation/operation-getorganizationsettings#operation-getorganizationsettings-200-body-application-vnd-atlas-2023-01-01-json-maxserviceaccountsecretvalidityinhours",
    "https://mongodb.prakticum-team.ru/docs/atlas/tutorial/activity-feed/"
  ],
  "Remediation": {
    "Code": {
      "CLI": "curl --user \"<PUBLIC_KEY>:<PRIVATE_KEY>\" --digest -H \"Content-Type: application/json\" -X PATCH \"https://cloud.mongodb.com/api/atlas/v2/orgs/<ORG_ID>/settings\" --data '{\"maxServiceAccountSecretValidityInHours\":8}'",
      "NativeIaC": "",
      "Other": "1. In the MongoDB Atlas UI, select your organization\n2. Go to Organization > Settings\n3. Set \"Maximum validity for Admin API Service Account secrets\" to 8 hours (or less)\n4. Click Save",
      "Terraform": "```hcl\nresource \"mongodbatlas_organization_settings\" \"<example_resource_name>\" {\n  org_id = \"<example_resource_id>\"\n\n  max_service_account_secret_validity_in_hours = 8 # Critical: enforce <= 8 hours for Admin API Service Account secrets\n}\n```"
    },
    "Recommendation": {
      "Text": "Set a strict cap via `maxServiceAccountSecretValidityInHours` to `8` hours or less. Apply **least privilege** to service accounts, automate secret **rotation/revocation**, and monitor usage. Store secrets in a secure vault and limit where they can be used *e.g., network allowlisting* as part of **defense in depth**.",
      "Url": "https://hub.prowler.com/check/organizations_service_account_secrets_expiration"
    }
  },
  "Categories": [
    "secrets"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
