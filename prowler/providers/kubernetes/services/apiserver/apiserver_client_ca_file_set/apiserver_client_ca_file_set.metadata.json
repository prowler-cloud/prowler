{
  "Provider": "kubernetes",
  "CheckID": "apiserver_client_ca_file_set",
  "CheckTitle": "API server pod has the --client-ca-file argument set",
  "CheckType": [],
  "ServiceName": "apiserver",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "Pod",
  "Description": "**Kubernetes API server** uses a configured **client CA** (`--client-ca-file`) to validate x509 client certificates presented for API authentication",
  "Risk": "**Absent a client CA**, the API server cannot validate x509 client identities, disabling mutual TLS.\n\nThis weakens authentication and can enable unauthorized reads or writes to cluster resources, impacting **confidentiality** and **integrity**, especially if other methods (e.g., anonymous or weak tokens) are misconfigured.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://kubernetes.io/docs/setup/best-practices/certificates/",
    "https://stackoverflow.com/questions/59940927/k3s-create-user-with-client-certificate",
    "https://cjyabraham.gitlab.io/docs/reference/command-line-tools-reference/kube-apiserver/",
    "https://blog.codefarm.me/2019/02/01/access-kubernetes-api-with-client-certificates/",
    "https://medium.com/@mrJTY/kubernetes-tls-4de567964cd5",
    "https://kubernetes.io/docs/setup/best-practices/certificates/#certificate-paths"
  ],
  "Remediation": {
    "Code": {
      "CLI": "",
      "NativeIaC": "",
      "Other": "1. SSH to each control-plane node\n2. Edit /etc/kubernetes/manifests/kube-apiserver.yaml\n3. In the kube-apiserver container command, add this flag (use your CA path if different):\n   ```\n   - --client-ca-file=/etc/kubernetes/pki/ca.crt\n   ```\n4. Save the file; the kubelet will restart the API server automatically",
      "Terraform": ""
    },
    "Recommendation": {
      "Text": "Establish a trusted **client CA** for the API server and require **certificate-based client authentication**. Combine with **RBAC** and **least privilege**, disable anonymous access, and enforce **key rotation** and auditing to provide **defense in depth**.",
      "Url": "https://hub.prowler.com/check/apiserver_client_ca_file_set"
    }
  },
  "Categories": [
    "identity-access",
    "cluster-security"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": "The client CA file is a critical component of TLS authentication and should be properly managed and securely stored."
}
