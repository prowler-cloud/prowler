{
  "Provider": "kubernetes",
  "CheckID": "apiserver_tls_config",
  "CheckTitle": "API server pod has --tls-cert-file and --tls-private-key-file configured",
  "CheckType": [],
  "ServiceName": "apiserver",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "Pod",
  "Description": "**Kubernetes API server** configuration is checked for explicit TLS settings via `--tls-cert-file` and `--tls-private-key-file`. The presence of both flags indicates HTTPS is configured with a specified certificate and private key for client connections.",
  "Risk": "Improper or unmanaged TLS on the API endpoint can cause untrusted certs and verification bypass, enabling MITM to capture admin credentials or tokens and modify requests. This compromises **confidentiality** and **integrity**, and unexpected certificate expiry can affect **availability**.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://kubernetes.io/docs/setup/best-practices/certificates/",
    "https://kubernetes.io/docs/setup/best-practices/certificates/#certificate-paths"
  ],
  "Remediation": {
    "Code": {
      "CLI": "",
      "NativeIaC": "",
      "Other": "1. SSH to each control-plane node\n2. Edit the API server static pod manifest:\n   sudo vi /etc/kubernetes/manifests/kube-apiserver.yaml\n3. In spec.containers[0].command, add both flags:\n   ```\n   - --tls-cert-file=/etc/kubernetes/pki/apiserver.crt\n   - --tls-private-key-file=/etc/kubernetes/pki/apiserver.key\n   ```\n4. Save the file; the kubelet will automatically restart the API server",
      "Terraform": ""
    },
    "Recommendation": {
      "Text": "Configure the API server to use **TLS** with a valid certificate and key via `--tls-cert-file` and `--tls-private-key-file`.\n\nUse a trusted CA with correct SANs, restrict network access to the endpoint, and automate certificate rotation and expiry monitoring to uphold **defense in depth** and **least privilege**.",
      "Url": "https://hub.prowler.com/check/apiserver_tls_config"
    }
  },
  "Categories": [
    "encryption",
    "cluster-security"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": "TLS should be a standard security measure for all Kubernetes deployments to protect sensitive data."
}
