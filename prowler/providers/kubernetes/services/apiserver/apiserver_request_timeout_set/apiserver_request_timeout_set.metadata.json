{
  "Provider": "kubernetes",
  "CheckID": "apiserver_request_timeout_set",
  "CheckTitle": "Kubernetes API server pod has --request-timeout configured",
  "CheckType": [],
  "ServiceName": "apiserver",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "Pod",
  "Description": "**Kubernetes API server** has a global request timeout configured via `--request-timeout`.\n\nThe presence of that flag on API server containers is assessed.",
  "Risk": "Without a defined, appropriate timeout, requests can linger and tie up handlers, reducing **availability**. Attackers can perform slowloris-style holds or heavy reads to cause **resource exhaustion** and backlog growth. Overly short timeouts can cut valid calls, disrupting controllers and clients.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/",
    "https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/#options"
  ],
  "Remediation": {
    "Code": {
      "CLI": "",
      "NativeIaC": "",
      "Other": "1. SSH to each control-plane node\n2. Edit /etc/kubernetes/manifests/kube-apiserver.yaml\n3. In the kube-apiserver container's command list, add:\n   ```yaml\n   - --request-timeout=300s\n   ```\n4. Save the file; the kubelet will automatically restart the API server\n5. Repeat on all control-plane nodes",
      "Terraform": ""
    },
    "Recommendation": {
      "Text": "Set `--request-timeout` to a bounded value aligned to typical non-watch calls; *when needed*, tune `--min-request-timeout` for watches. Combine with **priority and fairness**, rate limiting, and load testing to prevent starvation. Monitor latency and errors to adjust. Apply **defense in depth**.",
      "Url": "https://hub.prowler.com/check/apiserver_request_timeout_set"
    }
  },
  "Categories": [
    "cluster-security",
    "resilience"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": "The default timeout is set to 60 seconds. Adjust according to the specific requirements and constraints of your Kubernetes environment."
}
