{
  "Provider": "kubernetes",
  "CheckID": "rbac_minimize_wildcard_use_roles",
  "CheckTitle": "Role or ClusterRole does not use wildcard resources or verbs",
  "CheckType": [],
  "ServiceName": "rbac",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "ClusterRole",
  "Description": "**Kubernetes RBAC Roles/ClusterRoles** are evaluated for wildcard use in rule `resources` or `verbs`. The presence of `*` means all resources or all actions are granted. This finding highlights roles whose rules include such wildcards.",
  "Risk": "Using `*` broadens access beyond intent:\n- Confidentiality: unrestricted reads of sensitive data\n- Integrity/Availability: create/update/delete across resources\n- Privilege escalation and lateral movement\n- Future drift: new APIs/verbs inherit access automatically",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://kubernetes.io/docs/reference/access-authn-authz/rbac/",
    "https://kubernetes.io/docs/reference/access-authn-authz/rbac/#referring-to-resources"
  ],
  "Remediation": {
    "Code": {
      "CLI": "kubectl patch clusterrole <example_resource_name> --type=merge -p '{\"rules\":[{\"apiGroups\":[\"\"],\"resources\":[\"pods\"],\"verbs\":[\"get\"]}]}'",
      "NativeIaC": "",
      "Other": "1. Run: kubectl edit clusterrole <example_resource_name>\n2. In rules, replace any resources: [\"*\"] with only the needed resources (e.g., [\"pods\"]).\n3. Replace any verbs: [\"*\"] with only required verbs (e.g., [\"get\"]).\n4. Save and exit. Repeat for any Role or ClusterRole still using wildcards.",
      "Terraform": "```hcl\nresource \"kubernetes_cluster_role_v1\" \"<example_resource_name>\" {\n  metadata { name = \"<example_resource_name>\" }\n\n  rule {\n    api_groups = [\"\"]\n    resources  = [\"pods\"]  # critical: replace wildcard resources with specific resource\n    verbs      = [\"get\"]   # critical: replace wildcard verbs with specific verb\n  }\n}\n```"
    },
    "Recommendation": {
      "Text": "Apply **least privilege**: replace `*` with explicit `resources`, `verbs`, and `resourceNames`. Split read/write duties, scope Roles to namespaces, use ClusterRoles only when needed, and bind to specific subjects. Periodically review roles to prevent privilege creep as part of **defense in depth**.",
      "Url": "https://hub.prowler.com/check/rbac_minimize_wildcard_use_roles"
    }
  },
  "Categories": [
    "identity-access",
    "cluster-security"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": "Care should be taken to ensure that replacing wildcards does not disrupt normal operations of the cluster."
}
