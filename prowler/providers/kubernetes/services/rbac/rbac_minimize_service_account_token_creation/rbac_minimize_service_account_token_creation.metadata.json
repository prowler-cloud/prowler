{
  "Provider": "kubernetes",
  "CheckID": "rbac_minimize_service_account_token_creation",
  "CheckTitle": "User or group does not have permission to create service account tokens",
  "CheckType": [],
  "ServiceName": "rbac",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "critical",
  "ResourceType": "ClusterRoleBinding",
  "Description": "Cluster-wide RBAC identifies users or groups granted `create` on `serviceaccounts/token` via **ClusterRoles/ClusterRoleBindings**.\n\nHighlights principals allowed to mint **service account tokens** through the TokenRequest subresource.",
  "Risk": "Ability to mint **service account tokens** lets users assume those accounts' API rights, bypassing intended boundaries.\n\nThis enables privilege escalation, persistent access, and lateral movement, threatening confidentiality and integrity of cluster resources.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://kubernetes.io/docs/concepts/security/rbac-good-practices/#token-request"
  ],
  "Remediation": {
    "Code": {
      "CLI": "kubectl delete clusterrolebinding <example_resource_name>",
      "NativeIaC": "",
      "Other": "1. Identify the ClusterRoleBinding that grants a User/Group the role with create on serviceaccounts/token\n2. Edit the referenced ClusterRole and remove any rule that allows create on resource \"serviceaccounts/token\":\n   - kubectl edit clusterrole <example_resource_name>\n   - In .rules[], delete entries with resources: [\"serviceaccounts/token\"] and verb: [\"create\"]\n3. If the permission is only needed for other subjects, alternatively remove the specific User/Group from the ClusterRoleBinding:\n   - kubectl edit clusterrolebinding <example_resource_name>\n   - Delete the matching subject under .subjects and save",
      "Terraform": ""
    },
    "Recommendation": {
      "Text": "Enforce **least privilege**: avoid granting `create` on `serviceaccounts/token` to human users or broad groups. Restrict to trusted controllers and scope narrowly with namespaced **Role**/**RoleBinding**.\n\nApply **separation of duties**, periodic RBAC reviews, and **defense in depth** to limit token issuance.",
      "Url": "https://hub.prowler.com/check/rbac_minimize_service_account_token_creation"
    }
  },
  "Categories": [
    "identity-access",
    "cluster-security"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": "Consider using role-based access control to precisely define and manage permissions related to service account token creation."
}
