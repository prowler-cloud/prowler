{
  "Provider": "kubernetes",
  "CheckID": "kubelet_conf_file_ownership",
  "CheckTitle": "Node kubelet.conf file ownership is set to root:root",
  "CheckType": [],
  "ServiceName": "kubelet",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "Node",
  "Description": "**Node kubeconfig** at `/etc/kubernetes/kubelet.conf` is evaluated for file ownership `root:root`. The check focuses on who owns the file that defines the kubelet's API client settings and certificates.",
  "Risk": "Non-root ownership lets local users alter kubelet API credentials and endpoints, enabling **node impersonation**, unauthorized control of Pods, and **data exfiltration** via the kubelet. This threatens **integrity** (config tampering), **confidentiality** (secrets access), and **availability** (pod eviction or node disruption).",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/kubelet-integration/",
    "https://stackarmor.com/securing-kubernetes-for-compliance-with-fedramp-fisma-or-cmmc-requirements/",
    "https://blog.palark.com/kubernetes-security-with-kube-bench-and-kube-hunter/",
    "https://learn.microsoft.com/en-us/azure/aks/cis-kubernetes",
    "https://www.bordergate.co.uk/kubernetes-penetration-testing/",
    "https://kubernetes.io/docs/tasks/administer-cluster/kubelet-config-file/"
  ],
  "Remediation": {
    "Code": {
      "CLI": "chown root:root /etc/kubernetes/kubelet.conf",
      "NativeIaC": "",
      "Other": "1. SSH into the affected node\n2. Run: sudo chown root:root /etc/kubernetes/kubelet.conf",
      "Terraform": ""
    },
    "Recommendation": {
      "Text": "Set `/etc/kubernetes/kubelet.conf` ownership to `root:root` and use restrictive perms (e.g., `600`). Apply **least privilege** on node access, protect kubelet dirs, and enable **file integrity monitoring**. Use **defense in depth**: configuration management to enforce state and periodic audits to detect drift.",
      "Url": "https://hub.prowler.com/check/kubelet_conf_file_ownership"
    }
  },
  "Categories": [
    "node-security"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": "Regular checks of kubelet.conf file ownership are essential for maintaining node security."
}
