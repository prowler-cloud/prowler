{
  "Provider": "kubernetes",
  "CheckID": "kubelet_manage_iptables",
  "CheckTitle": "Kubelet configuration has makeIPTablesUtilChains set to true",
  "CheckType": [],
  "ServiceName": "kubelet",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "ConfigMap",
  "Description": "**Kubelet** configured with `makeIPTablesUtilChains` manages **iptables utility chains**, keeping node firewall primitives aligned with dynamic pod networking. The setting is expected to be present and enabled in kubelet configuration.",
  "Risk": "Without kubelet-managed iptables chains, nodes can drift to inconsistent firewall states, enabling:\n- Traffic drops and service outages (availability)\n- Unintended inter-pod exposure (confidentiality)\n- Conflicting rules altering expected flows (integrity)",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/",
    "https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/#options"
  ],
  "Remediation": {
    "Code": {
      "CLI": "",
      "NativeIaC": "",
      "Other": "1. SSH to each node running kubelet\n2. Edit the kubelet config file:\n   - sudo vi /var/lib/kubelet/config.yaml\n3. In the KubeletConfiguration, set:\n   - makeIPTablesUtilChains: true\n4. Save and restart kubelet:\n   - sudo systemctl restart kubelet",
      "Terraform": ""
    },
    "Recommendation": {
      "Text": "Enable kubelet management of **iptables utility chains** by setting `makeIPTablesUtilChains=true`.\n\nPrefer **automation over manual iptables edits** to prevent drift. Combine with **network policies**, least privilege, and **defense in depth** to control east-west traffic. *If your CNI replaces iptables, document the exception*.",
      "Url": "https://hub.prowler.com/check/kubelet_manage_iptables"
    }
  },
  "Categories": [
    "node-security"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": "If you are using another iptables management solution, ensure it is compatible with the kubelet's management of iptables."
}
