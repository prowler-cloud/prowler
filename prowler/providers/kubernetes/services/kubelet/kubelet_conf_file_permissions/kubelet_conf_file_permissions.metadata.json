{
  "Provider": "kubernetes",
  "CheckID": "kubelet_conf_file_permissions",
  "CheckTitle": "Node kubelet.conf file permissions are set to 600 or more restrictive",
  "CheckType": [],
  "ServiceName": "kubelet",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "Node",
  "Description": "**Kubelet kubeconfig** at `/etc/kubernetes/kubelet.conf` must have **owner-only** permissions (`0600` or stricter). The check evaluates the file mode to ensure it is not more permissive than `0600`.",
  "Risk": "**Overly permissive `kubelet.conf`** exposes kubelet credentials, allowing local users or malware to act as the node.\n- Integrity: modify workloads or node state\n- Confidentiality: access secrets/metadata\n- Availability: disrupt scheduling or drain nodes",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/kubelet-integration/",
    "https://kubernetes.io/docs/tasks/administer-cluster/kubelet-config-file/"
  ],
  "Remediation": {
    "Code": {
      "CLI": "sudo chmod 600 /etc/kubernetes/kubelet.conf",
      "NativeIaC": "",
      "Other": "1. SSH into the node running kubelet\n2. Set restrictive permissions:\n   ```\n   sudo chmod 600 /etc/kubernetes/kubelet.conf\n   ```\n3. Verify it reads 600:\n   ```\n   stat -c \"%a %n\" /etc/kubernetes/kubelet.conf\n   ```",
      "Terraform": ""
    },
    "Recommendation": {
      "Text": "Apply **least privilege** to `/etc/kubernetes/kubelet.conf`:\n- Set permissions to `0600` or stricter\n- Restrict ownership to the kubelet user; no group/world access\n- Limit shell access and monitor file changes\n- Layer controls with **RBAC** and certificate/key rotation",
      "Url": "https://hub.prowler.com/check/kubelet_conf_file_permissions"
    }
  },
  "Categories": [
    "node-security"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": "Regular checks of kubelet.conf file permissions are essential for maintaining node security."
}
