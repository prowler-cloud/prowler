{
  "Provider": "kubernetes",
  "CheckID": "controllermanager_service_account_credentials",
  "CheckTitle": "Controller Manager pod has --use-service-account-credentials=true",
  "CheckType": [],
  "ServiceName": "controllermanager",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "Pod",
  "Description": "Evaluates whether the **Kubernetes controller manager** uses per-controller service account credentials via `--use-service-account-credentials=true`, meaning each controller runs with its own identity rather than a shared credential.",
  "Risk": "Without per-controller credentials, one token can grant broad controller privileges. Compromise or misuse enables unauthorized state changes, data exposure, and lateral movement, while reducing audit granularity-impacting confidentiality and integrity.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://kubernetes.io/docs/reference/command-line-tools-reference/kube-controller-manager/#options",
    "https://kubernetes.io/docs/reference/command-line-tools-reference/kube-controller-manager/"
  ],
  "Remediation": {
    "Code": {
      "CLI": "",
      "NativeIaC": "",
      "Other": "1. SSH to each control-plane node\n2. Edit the static Pod manifest: /etc/kubernetes/manifests/kube-controller-manager.yaml\n3. Under spec.containers[0].command, add a new item: --use-service-account-credentials=true\n4. Save the file; the kubelet will automatically restart the controller-manager",
      "Terraform": ""
    },
    "Recommendation": {
      "Text": "Enable `--use-service-account-credentials=true` and enforce **least privilege**: assign a dedicated service account per controller with minimal RBAC, limit token scope/lifetime, and monitor controller actions. This upholds **separation of duties** and **defense in depth**.",
      "Url": "https://hub.prowler.com/check/controllermanager_service_account_credentials"
    }
  },
  "Categories": [
    "cluster-security",
    "identity-access"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": "Ensure that appropriate roles and permissions are set for each service account when enabling this feature."
}
