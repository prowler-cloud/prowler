{
  "Provider": "kubernetes",
  "CheckID": "controllermanager_root_ca_file_set",
  "CheckTitle": "Controller Manager pod has --root-ca-file argument set",
  "CheckType": [],
  "ServiceName": "controllermanager",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "critical",
  "ResourceType": "Pod",
  "Description": "**Kubernetes Controller Manager** uses `--root-ca-file` to reference a certificate bundle so pods get a `ca.crt` for validating the API server's TLS certificate.",
  "Risk": "Without a configured root CA, pods cannot reliably verify the API server, enabling on-path spoofing. This exposes API traffic and service account tokens, allowing session hijack, data exfiltration, and malicious config changes-compromising confidentiality and integrity, and potentially disrupting availability.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://kubernetes.io/docs/setup/best-practices/certificates/",
    "https://kubernetes.io/docs/setup/best-practices/certificates/#certificate-paths"
  ],
  "Remediation": {
    "Code": {
      "CLI": "",
      "NativeIaC": "",
      "Other": "1. SSH to a control-plane node with sudo privileges\n2. Edit the static Pod manifest: /etc/kubernetes/manifests/kube-controller-manager.yaml\n3. In the kube-controller-manager container command list, add this flag:\n   - --root-ca-file=/etc/kubernetes/pki/ca.crt\n4. Save the file; kubelet will automatically restart the Pod",
      "Terraform": ""
    },
    "Recommendation": {
      "Text": "Set a trusted CA bundle via `--root-ca-file` on the controller manager to ensure verified TLS for in-cluster API calls. Use a cluster-controlled CA, rotate and monitor certificates, and keep the bundle aligned with the API server chain. Apply **defense in depth** and **least privilege** for service accounts.",
      "Url": "https://hub.prowler.com/check/controllermanager_root_ca_file_set"
    }
  },
  "Categories": [
    "encryption",
    "cluster-security"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": "Ensure that the certificate bundle file is properly maintained and updated as needed."
}
