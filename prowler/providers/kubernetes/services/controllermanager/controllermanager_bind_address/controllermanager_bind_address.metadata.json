{
  "Provider": "kubernetes",
  "CheckID": "controllermanager_bind_address",
  "CheckTitle": "Controller Manager pod is bound to the loopback address 127.0.0.1",
  "CheckType": [],
  "ServiceName": "controllermanager",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "Pod",
  "Description": "**Kubernetes controller manager** uses the **loopback bind address** `127.0.0.1` via `--bind-address` or `--address`, keeping its health, metrics, and debug endpoints reachable only from the host",
  "Risk": "Listening on a non-loopback address exposes **health**, **metrics**, and **debug** endpoints to the network, enabling control-plane **reconnaissance** and leakage of internal state. Heavy scraping or profiling can drive resource exhaustion, reducing control-plane **availability** and stability.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://kubernetes.io/docs/reference/command-line-tools-reference/kube-controller-manager/"
  ],
  "Remediation": {
    "Code": {
      "CLI": "",
      "NativeIaC": "",
      "Other": "1. SSH to the control-plane node running the Controller Manager\n2. Edit the static Pod manifest: /etc/kubernetes/manifests/kube-controller-manager.yaml\n3. Under spec.containers[0] command/args, add the flag:\n   - --bind-address=127.0.0.1\n4. Save the file; the kubelet will automatically restart the Pod with the new setting",
      "Terraform": ""
    },
    "Recommendation": {
      "Text": "Bind to `127.0.0.1` and apply **defense in depth**:\n- Prefer local-only endpoints; avoid `0.0.0.0`\n- Use **TLS** and authentication if exposure is unavoidable\n- Enforce **network segmentation** for control-plane access\n- Disable profiling when not needed; apply **least privilege** for telemetry",
      "Url": "https://hub.prowler.com/check/controllermanager_bind_address"
    }
  },
  "Categories": [
    "cluster-security",
    "internet-exposed"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": "Check for the --address argument as well, as it might be used instead of --bind-address in certain Kubernetes versions."
}
