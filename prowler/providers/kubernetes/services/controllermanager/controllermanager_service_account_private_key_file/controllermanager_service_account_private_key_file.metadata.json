{
  "Provider": "kubernetes",
  "CheckID": "controllermanager_service_account_private_key_file",
  "CheckTitle": "Controller Manager pod has the --service-account-private-key-file argument set",
  "CheckType": [],
  "ServiceName": "controllermanager",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "high",
  "ResourceType": "Pod",
  "Description": "**Kubernetes controller manager** uses a **service account signing key** configured via `--service-account-private-key-file`.\n\nThe evaluation identifies whether this argument is present, indicating the component can sign service account tokens.",
  "Risk": "Without a configured signing key, the token controller can't mint service account tokens, breaking pod-to-API auth and controller operations (**availability**). Inability to rotate keys prolongs validity of stolen or stale tokens, weakening **integrity** and **confidentiality**.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://kubernetes.io/docs/reference/access-authn-authz/service-accounts-admin/",
    "https://kubernetes.io/docs/reference/access-authn-authz/service-accounts-admin/#token-controller"
  ],
  "Remediation": {
    "Code": {
      "CLI": "",
      "NativeIaC": "",
      "Other": "1. SSH to the control plane node\n2. Edit /etc/kubernetes/manifests/kube-controller-manager.yaml\n3. Under containers[].command, add: - --service-account-private-key-file=/etc/kubernetes/pki/sa.key\n4. Save the file; the kubelet will restart the kube-controller-manager pod automatically",
      "Terraform": ""
    },
    "Recommendation": {
      "Text": "Set a dedicated **signing key** using `--service-account-private-key-file`, or adopt an approved external signer.\n\nApply **least privilege** to key access, enforce **regular rotation** and rollover, separate **signing/verification** duties, and prefer short-lived tokens with strict **RBAC**.",
      "Url": "https://hub.prowler.com/check/controllermanager_service_account_private_key_file"
    }
  },
  "Categories": [
    "cluster-security",
    "secrets"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": "Ensure the private key file is securely maintained and periodically rotated as per the organization's policy."
}
