{
  "Provider": "kubernetes",
  "CheckID": "controllermanager_rotate_kubelet_server_cert",
  "CheckTitle": "Controller Manager pod has RotateKubeletServerCertificate set to true",
  "CheckType": [],
  "ServiceName": "controllermanager",
  "SubServiceName": "",
  "ResourceIdTemplate": "",
  "Severity": "medium",
  "ResourceType": "Pod",
  "Description": "**Kubernetes controller manager** configuration includes the `RotateKubeletServerCertificate=true` feature gate for automatic rotation of **kubelet server certificates**",
  "Risk": "Without **certificate rotation**, kubelet HTTPS endpoints can use expired or long-lived certs, triggering TLS failures and operational gaps. Teams may bypass verification, enabling **MitM** and tampering. This harms **availability** and **integrity**, and extends exposure if a private key is compromised.",
  "RelatedUrl": "",
  "AdditionalURLs": [
    "https://kubernetes.io/docs/tasks/tls/certificate-rotation/#understanding-the-certificate-rotation-configuration",
    "https://kubernetes.io/docs/tasks/tls/certificate-rotation/"
  ],
  "Remediation": {
    "Code": {
      "CLI": "",
      "NativeIaC": "",
      "Other": "1. SSH to a control-plane node and open the controller manager static pod manifest:\n   - /etc/kubernetes/manifests/kube-controller-manager.yaml\n2. In spec.containers[0].command, add or update this flag:\n   ```\n   --feature-gates=RotateKubeletServerCertificate=true\n   ```\n3. Save the file; the kubelet will automatically restart the pod with the updated setting.",
      "Terraform": ""
    },
    "Recommendation": {
      "Text": "Enable `RotateKubeletServerCertificate=true` on the controller manager and ensure kubelets participate in rotation.\n\nUse short-lived certs, automated renewal, and strict TLS validation to maintain **availability**, protect **integrity**, and uphold **cryptographic hygiene**. Avoid insecure fallbacks.",
      "Url": "https://hub.prowler.com/check/controllermanager_rotate_kubelet_server_cert"
    }
  },
  "Categories": [
    "encryption",
    "cluster-security"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": "Ensure that your cluster setup supports kubelet server certificate rotation."
}
